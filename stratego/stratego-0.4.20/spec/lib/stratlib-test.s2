[SDef("tpaste",["u_33"],Scope([],Call(SVar("Scope"),[Call(SVar("u_33"),[]),Id]))),SDef("Var",["h_15"],Cong("Var",[Call(SVar("h_15"),[])])),SDef("IsVar",[],Scope(["y_10"],Seq(Match(Op("Var",[Var("y_10")])),Seq(Id,Seq(Build(Var("y_10")),Id))))),SDef("DistBinding",["s_17","t_17"],Scope(["j_4","k_4","l_4"],Seq(Match(Op("TCons",[Var("l_4"),Op("TCons",[Var("k_4"),Op("TCons",[Var("j_4"),Op("TNil",[])])])])),Seq(Id,Seq(Seq(Build(Var("l_4")),Call(SVar("t_17"),[Scope(["m_4"],Seq(Match(Var("m_4")),Seq(Id,Seq(Seq(Build(Op("TCons",[Var("m_4"),Op("TCons",[Var("j_4"),Op("TNil",[])])])),Call(SVar("s_17"),[])),Id)))),Scope(["n_4"],Seq(Match(Var("n_4")),Seq(Id,Seq(Seq(Build(Op("TCons",[Var("n_4"),Op("TCons",[Var("k_4"),Op("TNil",[])])])),Call(SVar("s_17"),[])),Id)))),Id])),Id))))),SDef("at_end",["g_28"],Scope([],Rec("h_28",Choice(Call(SVar("Cons"),[Id,Call(SVar("h_28"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("g_28"),[])))))),SDef("conc",[],Scope(["s_9","t_9"],Seq(Match(Op("TCons",[Var("t_9"),Op("TCons",[Var("s_9"),Op("TNil",[])])])),Seq(Id,Seq(Seq(Build(Var("t_9")),Call(SVar("at_end"),[Build(Var("s_9"))])),Id))))),SDef("new",[],Scope([],Prim("_ST_new"))),SDef("map",["t_27"],Scope([],Rec("u_27",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("t_27"),[]),Call(SVar("u_27"),[])]))))),SDef("RnBinding",["u_17","v_17"],Scope(["o_4","p_4","q_4","r_4","s_4"],Seq(Match(Op("TCons",[Var("o_4"),Op("TCons",[Var("r_4"),Op("TNil",[])])])),Seq(Where(Seq(Seq(Seq(Build(Var("o_4")),Call(SVar("u_17"),[])),Match(Var("p_4"))),Seq(Seq(Call(SVar("map"),[Call(SVar("new"),[])]),Match(Var("q_4"))),Seq(Seq(Scope(["w_35"],Seq(Seq(Build(Op("TCons",[Var("p_4"),Op("TCons",[Var("q_4"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("w_35")),Id))),Build(Op("TCons",[Var("w_35"),Op("TCons",[Var("r_4"),Op("TNil",[])])])))),Call(SVar("conc"),[])),Match(Var("s_4")))))),Seq(Scope(["d_36"],Seq(Seq(Build(Var("o_4")),Seq(Call(SVar("v_17"),[Build(Var("q_4"))]),Seq(Match(Var("d_36")),Id))),Build(Op("TCons",[Var("d_36"),Op("TCons",[Var("r_4"),Op("TCons",[Var("s_4"),Op("TNil",[])])])])))),Id))))),SDef("SubsVar",["b_19","c_19"],Scope(["t_10","u_10","v_10"],Seq(Match(Var("t_10")),Seq(Where(Seq(Seq(Seq(Build(Var("t_10")),Call(SVar("b_19"),[])),Match(Var("u_10"))),Seq(Call(SVar("c_19"),[]),Match(Var("v_10"))))),Seq(Seq(Build(Op("TCons",[Var("u_10"),Op("TCons",[Var("v_10"),Op("TNil",[])])])),Call(SVar("lookup"),[])),Id))))),SDef("Fst",[],Scope(["w_9","x_9"],Seq(Match(Op("TCons",[Var("x_9"),Var("w_9")])),Seq(Id,Seq(Build(Var("x_9")),Id))))),SDef("Look2",[],Scope(["g_5","h_5"],Seq(Match(Op("TCons",[Var("g_5"),Op("TCons",[Op("Cons",[Wld,Var("h_5")]),Op("TNil",[])])])),Seq(Id,Seq(Build(Op("TCons",[Var("g_5"),Op("TCons",[Var("h_5"),Op("TNil",[])])])),Id))))),SDef("Look1",[],Scope(["e_5","f_5"],Seq(Match(Op("TCons",[Var("e_5"),Op("TCons",[Op("Cons",[Op("TCons",[Var("e_5"),Op("TCons",[Var("f_5"),Op("TNil",[])])]),Wld]),Op("TNil",[])])])),Seq(Id,Seq(Build(Var("f_5")),Id))))),SDef("lookup",[],Scope([],Rec("e_25",LChoice(Call(SVar("Look1"),[]),Seq(Call(SVar("Look2"),[]),Call(SVar("e_25"),[])))))),SDef("RnVar",["p_17"],Scope(["y_3","z_3"],Seq(Match(Op("TCons",[Var("z_3"),Op("TCons",[Var("y_3"),Op("TNil",[])])])),Seq(Id,Seq(Seq(Build(Var("z_3")),Call(SVar("p_17"),[Seq(Call(SVar("split"),[Id,Build(Var("y_3"))]),Call(SVar("lookup"),[]))])),Id))))),SDef("dist",["l_17"],Scope(["n_3","o_3"],Seq(Match(Op("TCons",[Var("o_3"),Op("TCons",[Var("n_3"),Op("TNil",[])])])),Seq(Id,Seq(Seq(Build(Var("o_3")),All(Scope(["p_3"],Seq(Match(Var("p_3")),Seq(Id,Seq(Seq(Build(Op("TCons",[Var("p_3"),Op("TCons",[Var("n_3"),Op("TNil",[])])])),Call(SVar("l_17"),[])),Id)))))),Id))))),SDef("env-alltd",["a_23"],Scope([],Rec("b_23",LChoice(Call(SVar("a_23"),[]),Call(SVar("dist"),[Call(SVar("b_23"),[])]))))),SDef("Zip3",[],Scope(["h_7","i_7"],Seq(Match(Op("TCons",[Var("h_7"),Op("TCons",[Var("i_7"),Op("TNil",[])])])),Seq(Id,Seq(Build(Op("Cons",[Var("h_7"),Var("i_7")])),Id))))),SDef("Zip2",[],Scope(["x_6","y_6","z_6","a_7"],Seq(Match(Op("TCons",[Op("Cons",[Var("x_6"),Var("z_6")]),Op("TCons",[Op("Cons",[Var("y_6"),Var("a_7")]),Op("TNil",[])])])),Seq(Id,Seq(Build(Op("TCons",[Op("TCons",[Var("x_6"),Op("TCons",[Var("y_6"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("z_6"),Op("TCons",[Var("a_7"),Op("TNil",[])])]),Op("TNil",[])])])),Id))))),SDef("Zip1",[],Scope([],Seq(Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Id,Seq(Build(Op("Nil",[])),Id))))),SDef("genzip",["g_26","h_26","i_26","j_26"],Scope([],Rec("k_26",Choice(Call(SVar("g_26"),[]),Seq(Call(SVar("h_26"),[]),Seq(Call(SVar("TCons"),[Call(SVar("j_26"),[]),Call(SVar("TCons"),[Call(SVar("k_26"),[]),Call(SVar("TNil"),[])])]),Call(SVar("i_26"),[]))))))),SDef("zip",["l_26"],Scope([],Call(SVar("genzip"),[Call(SVar("Zip1"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("l_26"),[])]))),SDef("subs-args",[],Scope(["p_14","q_14"],LChoice(Seq(Id,Match(Op("TCons",[Var("p_14"),Op("TCons",[Var("q_14"),Op("TNil",[])])]))),Scope(["r_14","s_14","t_14"],Seq(Match(Op("TCons",[Var("r_14"),Op("TCons",[Var("s_14"),Op("TCons",[Var("t_14"),Op("TNil",[])])])])),Seq(Id,Seq(Scope(["i_38"],Seq(Seq(Build(Op("TCons",[Var("r_14"),Op("TCons",[Var("s_14"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("i_38")),Id))),Build(Op("TCons",[Var("i_38"),Op("TCons",[Var("t_14"),Op("TNil",[])])])))),Id))))))),SDef("substitute",["x_32","y_32","z_32","a_33","b_33","c_33"],Scope(["w_14","x_14"],Seq(Seq(Call(SVar("subs-args"),[]),Match(Op("TCons",[Var("x_14"),Op("TCons",[Var("w_14"),Op("TNil",[])])]))),Seq(Build(Op("TCons",[Var("w_14"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Rec("d_33",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("y_32"),[])]),LChoice(Seq(Call(SVar("Fst"),[]),Seq(Call(SVar("SubsVar"),[Call(SVar("x_32"),[]),Build(Var("x_14"))]),Call(SVar("c_33"),[]))),Seq(Call(SVar("RnBinding"),[Call(SVar("z_32"),[]),Call(SVar("b_33"),[])]),Call(SVar("DistBinding"),[Call(SVar("d_33"),[]),Call(SVar("a_33"),[])]))))])))))),SDef("substitute",["e_33","f_33","g_33","h_33","i_33"],Scope([],Call(SVar("substitute"),[Call(SVar("e_33"),[]),Call(SVar("f_33"),[]),Call(SVar("g_33"),[]),Call(SVar("h_33"),[]),Call(SVar("i_33"),[]),Id]))),SDef("tsubstitute",[],Scope([],Call(SVar("substitute"),[Call(SVar("IsVar"),[]),Call(SVar("Var"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[]),Call(SVar("tpaste"),[])]))),SDef("tsubstitute-test1",[],Scope([],Call(SVar("apply-test"),[Build(Str("tsubstitute-test1")),Call(SVar("tsubstitute"),[]),Build(Op("TCons",[Op("Cons",[Op("TCons",[Str("x"),Op("TCons",[Op("Var",[Str("a")]),Op("TNil",[])])]),Op("Cons",[Op("TCons",[Str("y"),Op("TCons",[Op("Op",[Str("Add"),Op("Cons",[Op("Var",[Str("y")]),Op("Cons",[Op("Var",[Str("z")]),Op("Nil",[])])])]),Op("TNil",[])])]),Op("Nil",[])])]),Op("TCons",[Op("Op",[Str("BinExp"),Op("Cons",[Op("Var",[Str("x")]),Op("Cons",[Op("Str",[Str("*")]),Op("Cons",[Op("Var",[Str("y")]),Op("Nil",[])])])])]),Op("TNil",[])])])),Build(Op("Op",[Str("BinExp"),Op("Cons",[Op("Var",[Str("a")]),Op("Cons",[Op("Str",[Str("*")]),Op("Cons",[Op("Op",[Str("Add"),Op("Cons",[Op("Var",[Str("y")]),Op("Cons",[Op("Var",[Str("z")]),Op("Nil",[])])])]),Op("Nil",[])])])])]))]))),SDef("tvars-test2",[],Scope([],Call(SVar("apply-test"),[Build(Str("tvars-test2")),Call(SVar("tvars"),[]),Build(Op("Real",[Real(1.100000)])),Build(Op("Nil",[]))]))),SDef("Scope",["x_16","y_16"],Cong("Scope",[Call(SVar("x_16"),[]),Call(SVar("y_16"),[])])),SDef("tboundin",["v_33","w_33","x_33"],Scope([],Call(SVar("Scope"),[Call(SVar("x_33"),[]),Call(SVar("v_33"),[])]))),SDef("Bind0",[],Choice(Scope(["d_11","e_11"],Seq(Match(Op("Scope",[Var("e_11"),Var("d_11")])),Seq(Id,Seq(Build(Var("e_11")),Id)))),Choice(Scope(["f_11","g_11","h_11"],Seq(Match(Op("LRule",[Op("Rule",[Var("h_11"),Var("f_11"),Var("g_11")])])),Seq(Id,Seq(Seq(Build(Var("h_11")),Call(SVar("tvars"),[])),Id)))),Fail))),SDef("Add1",[],Scope(["w_10"],Seq(Match(Op("Var",[Var("w_10")])),Seq(Id,Seq(Build(Op("Cons",[Var("w_10"),Op("Nil",[])])),Id))))),SDef("union",[],Scope(["p_5","q_5"],Seq(Match(Op("TCons",[Var("q_5"),Op("TCons",[Var("p_5"),Op("TNil",[])])])),Seq(Id,Seq(Seq(Build(Var("q_5")),Rec("e_18",LChoice(Seq(Call(SVar("Nil"),[]),Build(Var("p_5"))),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("p_5"))]),Call(SVar("e_18"),[])),Call(SVar("Cons"),[Id,Call(SVar("e_18"),[])]))))),Id))))),SDef("foldr",["m_24","n_24","o_24"],Scope([],Rec("p_24",Choice(Seq(Call(SVar("Nil"),[]),Call(SVar("m_24"),[])),Seq(Scope(["x_12","y_12"],Seq(Match(Op("Cons",[Var("x_12"),Var("y_12")])),Seq(Id,Seq(Scope(["b_40"],Seq(Seq(Build(Var("x_12")),Seq(Call(SVar("o_24"),[]),Seq(Match(Var("b_40")),Id))),Scope(["f_40"],Seq(Seq(Build(Var("y_12")),Seq(Call(SVar("p_24"),[]),Seq(Match(Var("f_40")),Id))),Build(Op("TCons",[Var("b_40"),Op("TCons",[Var("f_40"),Op("TNil",[])])])))))),Id)))),Call(SVar("n_24"),[])))))),SDef("foldr-kids",["k_18","l_18","m_18"],Scope(["y_5"],Seq(Scope(["m_40"],Seq(Match(Var("m_40")),Where(Seq(Build(Var("m_40")),Seq(Prim("_ST_explode_term"),Seq(Match(Op("TCons",[Wld,Op("TCons",[Var("y_5"),Op("TNil",[])])])),Id)))))),Seq(Id,Seq(Seq(Build(Var("y_5")),Call(SVar("foldr"),[Call(SVar("k_18"),[]),Call(SVar("l_18"),[]),Call(SVar("m_18"),[])])),Id))))),SDef("collect-kids",["k_25"],Scope([],Call(SVar("foldr-kids"),[Build(Op("Nil",[])),Call(SVar("union"),[]),Call(SVar("k_25"),[])]))),SDef("Cons",["f_15","g_15"],Cong("Cons",[Call(SVar("f_15"),[]),Call(SVar("g_15"),[])])),SDef("fetch",["c_28"],Scope([],Rec("d_28",LChoice(Call(SVar("Cons"),[Call(SVar("c_28"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("d_28"),[])]))))),SDef("HdMember",["b_18"],Scope(["k_5","l_5"],Seq(Match(Op("Cons",[Var("l_5"),Var("k_5")])),Seq(Where(Seq(Call(SVar("b_18"),[]),Call(SVar("fetch"),[Seq(Id,Match(Var("l_5")))]))),Seq(Build(Var("k_5")),Id))))),SDef("Nil",[],Cong("Nil",[])),SDef("diff",[],Scope(["r_5","s_5"],Seq(Match(Op("TCons",[Var("s_5"),Op("TCons",[Var("r_5"),Op("TNil",[])])])),Seq(Id,Seq(Seq(Build(Var("s_5")),Rec("f_18",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("r_5"))]),Call(SVar("f_18"),[])),Call(SVar("Cons"),[Id,Call(SVar("f_18"),[])]))))),Id))))),SDef("free-vars",["f_22","g_22","h_22"],Scope([],Rec("i_22",LChoice(Call(SVar("f_22"),[]),LChoice(Seq(Scope(["p_12"],Seq(Where(Seq(Call(SVar("g_22"),[]),Match(Var("p_12")))),Call(SVar("h_22"),[Seq(Call(SVar("split"),[Call(SVar("i_22"),[]),Build(Var("p_12"))]),Call(SVar("diff"),[])),Call(SVar("i_22"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("i_22"),[])])))))),SDef("tvars",[],Scope([],Call(SVar("free-vars"),[Call(SVar("Add1"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[])]))),SDef("FAIL",[],Scope([],Scope(["o_14"],Seq(Seq(Id,Match(Var("o_14"))),Seq(Id,Match(Op("TCons",[Var("o_14"),Op("TCons",[Var("o_14"),Op("TNil",[])])]))))))),SDef("debug",[],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Scope(["d_12"],Seq(Match(Var("d_12")),Seq(Id,Seq(Build(Op("Cons",[Var("d_12"),Op("Nil",[])])),Id))))]),Call(SVar("printnl"),[]))))),SDef("record-failure",[],Scope([],Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Scope(["j_12"],Seq(Match(Var("j_12")),Seq(Id,Seq(Seq(Build(Op("TCons",[Var("j_12"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("add"),[])),Id)))),Call(SVar("TNil"),[])])]))),SDef("add",[],Scope([],Prim("_ST_add"))),SDef("record-success",[],Scope([],Call(SVar("TCons"),[Scope(["i_12"],Seq(Match(Var("i_12")),Seq(Id,Seq(Seq(Build(Op("TCons",[Var("i_12"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("add"),[])),Id)))),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]))),SDef("do-test",["g_21","h_21"],Scope([],Seq(Where(Seq(Call(SVar("g_21"),[]),Call(SVar("debug"),[]))),LChoice(Seq(Where(Call(SVar("h_21"),[])),Call(SVar("record-success"),[])),Call(SVar("record-failure"),[]))))),SDef("apply-test",["k_21","l_21","m_21","n_21"],Scope(["k_12","l_12"],Call(SVar("do-test"),[Call(SVar("k_21"),[]),Seq(LChoice(Seq(Call(SVar("m_21"),[]),Seq(Call(SVar("l_21"),[]),Match(Var("k_12")))),Seq(Seq(Build(Str("  failed")),Call(SVar("debug"),[])),Call(SVar("FAIL"),[]))),Seq(Seq(Call(SVar("n_21"),[]),Match(Var("l_12"))),LChoice(Seq(Build(Var("l_12")),Match(Var("k_12"))),Seq(Seq(Seq(Build(Var("k_12")),Call(SVar("debug"),[Build(Str("  result not equal: "))])),Seq(Build(Var("l_12")),Call(SVar("debug"),[Build(Str("  expected: "))]))),Call(SVar("FAIL"),[])))))]))),SDef("tvars-test1",[],Scope([],Call(SVar("apply-test"),[Build(Str("tvars-test1")),Call(SVar("tvars"),[]),Build(Op("Int",[Int(1)])),Build(Op("Nil",[]))]))),SDef("exit",[],Scope([],Prim("_ST_exit"))),SDef("check-for-failures",[],Scope([],LChoice(Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Match(Int(0)),Call(SVar("TNil"),[])])]),Seq(Build(Int(0)),Call(SVar("exit"),[]))),Seq(Build(Int(1)),Call(SVar("exit"),[]))))),SDef("TNil",[],Cong("TNil",[])),SDef("TCons",["b_15","c_15"],Cong("TCons",[Call(SVar("b_15"),[]),Call(SVar("c_15"),[])])),SDef("report-test",[],Scope([],Call(SVar("TCons"),[Call(SVar("debug"),[Build(Str("successes: "))]),Call(SVar("TCons"),[Call(SVar("debug"),[Build(Str("failures: "))]),Call(SVar("TNil"),[])])]))),SDef("init-record",[],Scope([],Build(Op("TCons",[Int(0),Op("TCons",[Int(0),Op("TNil",[])])])))),SDef("printnl",[],Scope([],Prim("_ST_printnl"))),SDef("split",["w_18","x_18"],Scope(["l_10"],Seq(Match(Var("l_10")),Seq(Id,Seq(Scope(["j_43"],Seq(Seq(Build(Var("l_10")),Seq(Call(SVar("w_18"),[]),Seq(Match(Var("j_43")),Id))),Scope(["n_43"],Seq(Seq(Build(Var("l_10")),Seq(Call(SVar("x_18"),[]),Seq(Match(Var("n_43")),Id))),Build(Op("TCons",[Var("j_43"),Op("TCons",[Var("n_43"),Op("TNil",[])])])))))),Id))))),SDef("debug",["v_20"],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Scope(["e_12"],Seq(Match(Var("e_12")),Seq(Id,Seq(Scope(["x_43"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("v_20"),[]),Seq(Match(Var("x_43")),Id))),Build(Op("Cons",[Var("x_43"),Op("Cons",[Var("e_12"),Op("Nil",[])])])))),Id))))]),Call(SVar("printnl"),[]))))),SDef("test-suite",["e_21","f_21"],Scope([],Seq(Call(SVar("e_21"),[]),Seq(Call(SVar("debug"),[Build(Str("test suite: "))]),Seq(Call(SVar("init-record"),[]),Seq(Call(SVar("f_21"),[]),Seq(Call(SVar("report-test"),[]),Call(SVar("check-for-failures"),[])))))))),SDef("main",[],Scope([],Call(SVar("test-suite"),[Build(Str("stratlib-test")),Seq(Call(SVar("tvars-test1"),[]),Seq(Call(SVar("tvars-test2"),[]),Call(SVar("tsubstitute-test1"),[])))])))]
