[SDef("t_1",[],Prim("_ST_implode_string")),SDef("u_1",[],Prim("_ST_explode_string")),SDef("v_1",[],Seq(Call(SVar("u_1"),[]),Seq(LChoice(Rec("z_0",LChoice(Cong("Cons",[Id,Call(SVar("z_0"),[])]),Scope(["r_0","s_0","y_0"],Let(SDef([DontInline],"f_0",[],Build(Op("Nil",[]))),Seq(Assign(Var("r_0")),Case("k_0",Var("r_0"),[Alt(Fun("Cons",2),[Var("s_0"),Var("y_0")],Case("l_0",Var("s_0"),[Alt(Int(46),[],Call(SVar("f_0"),[]))],Fail))],Fail)))))),Id),Call(SVar("t_1"),[])))),SDef("w_1",[],Scope(["j_2","l_2","m_2","n_2","o_2","p_2"],Let(SDef([DontInline],"g_1",[],Seq(Assign(Var("j_2"),Var("m_2")),Assign(Var("j_2"),Var("o_2")))),Seq(Assign(Var("j_2")),Seq(Assign(Var("l_2")),Case("m_1",Var("l_2"),[Alt(Fun("TCons",2),[Var("m_2"),Var("n_2")],Case("n_1",Var("n_2"),[Alt(Fun("TCons",2),[Var("o_2"),Var("p_2")],Case("i_2",Var("p_2"),[Alt(Fun("TNil",0),[],Call(SVar("g_1"),[]))],Fail))],Fail))],Fail)))))),SDef("x_1",[],Where(Scope(["u_2"],Seq(Assign(Var("u_2")),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Var("u_2"),Op("Nil",[])]),Op("TNil",[])])])),Call(SVar("h_2"),[])))))),SDef("y_1",[],Cong("TCons",[Id,Cong("TCons",[Scope(["d_3"],Seq(Assign(Var("d_3")),Seq(Build(Op("TCons",[Var("d_3"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("z_1"),[])))),Call(SVar("e_2"),[])])])),SDef("z_1",[],Prim("_ST_add")),SDef("a_2",[],Cong("TCons",[Scope(["g_3"],Seq(Assign(Var("g_3")),Seq(Build(Op("TCons",[Var("g_3"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("z_1"),[])))),Cong("TCons",[Id,Call(SVar("e_2"),[])])])),SDef("b_2",[],Scope(["v_3","w_3"],Seq(Where(Seq(Build(Str("basename-test")),Call(SVar("x_1"),[]))),LChoice(Seq(Where(Seq(LChoice(Scope(["x_3"],Seq(Build(Str("./number.r")),Seq(Call(SVar("v_1"),[]),Seq(Assign(Var("x_3")),Assign(Var("v_3"),Var("x_3")))))),Seq(Build(Str("  failed")),Seq(Call(SVar("x_1"),[]),Call(SVar("w_1"),[])))),Seq(Build(Str("./number")),Seq(Assign(Var("w_3"),Str("./number")),LChoice(Seq(Build(Var("w_3")),Assign(Var("v_3"),Var("w_3"))),Seq(Build(Var("v_3")),Seq(Where(Scope(["a_4"],Seq(Assign(Var("a_4")),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("  result not equal: "),Op("Cons",[Var("a_4"),Op("Nil",[])])]),Op("TNil",[])])])),Call(SVar("h_2"),[]))))),Seq(Build(Var("w_3")),Seq(Where(Scope(["k_4"],Seq(Assign(Var("k_4")),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("  expected: "),Op("Cons",[Var("k_4"),Op("Nil",[])])]),Op("TNil",[])])])),Call(SVar("h_2"),[]))))),Call(SVar("w_1"),[])))))))))),Call(SVar("a_2"),[])),Call(SVar("y_1"),[]))))),SDef("c_2",[],Prim("_ST_exit")),SDef("d_2",[],LChoice(Seq(Cong("TCons",[Id,Cong("TCons",[Scope(["w_4"],Let(SDef([DontInline],"u_4",[],Id),Seq(Assign(Var("w_4")),Case("v_4",Var("w_4"),[Alt(Int(0),[],Call(SVar("u_4"),[]))],Fail)))),Call(SVar("e_2"),[])])]),Seq(Build(Int(0)),Call(SVar("c_2"),[]))),Seq(Build(Int(1)),Call(SVar("c_2"),[])))),SDef("e_2",[],Scope(["z_4"],Let(SDef([DontInline],"x_4",[],Id),Seq(Assign(Var("z_4")),Case("y_4",Var("z_4"),[Alt(Fun("TNil",0),[],Call(SVar("x_4"),[]))],Fail))))),SDef("f_2",[],Cong("TCons",[Where(Scope(["k_5"],Seq(Assign(Var("k_5")),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("successes: "),Op("Cons",[Var("k_5"),Op("Nil",[])])]),Op("TNil",[])])])),Call(SVar("h_2"),[]))))),Cong("TCons",[Where(Scope(["u_5"],Seq(Assign(Var("u_5")),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("failures: "),Op("Cons",[Var("u_5"),Op("Nil",[])])]),Op("TNil",[])])])),Call(SVar("h_2"),[]))))),Call(SVar("e_2"),[])])])),SDef("g_2",[],Build(Op("TCons",[Int(0),Op("TCons",[Int(0),Op("TNil",[])])]))),SDef("h_2",[],Prim("_ST_printnl")),SDef("main",[],Seq(Build(Str("string-test")),Seq(Where(Scope(["j_6"],Seq(Assign(Var("j_6")),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("test suite: "),Op("Cons",[Var("j_6"),Op("Nil",[])])]),Op("TNil",[])])])),Call(SVar("h_2"),[]))))),Seq(Call(SVar("g_2"),[]),Seq(Call(SVar("b_2"),[]),Seq(Call(SVar("f_2"),[]),Call(SVar("d_2"),[])))))))]
