Specification([Strategies([SDef("matrix-to-dfa",[],Seq(Call(SVar("init-matrix-table"),[]),Seq(Call(SVar("topdown"),[Call(SVar("repeat"),[Choice(Call(SVar("reduce-matrix"),[]),Choice(Call(SVar("MatrixScope"),[]),Call(SVar("Simplify"),[])))])]),Call(SVar("destroy-matrix-table"),[])))),SDef("reduce-matrix",[],LChoice(Call(SVar("MatrixSeenBefore"),[]),LChoice(Call(SVar("MatrixRowsEmpty"),[]),LChoice(Call(SVar("SkipWild"),[]),LChoice(Call(SVar("ShiftColumn"),[]),Call(SVar("Mixture"),[]))))))]),Strategies([SDef("init-matrix-table",[],Where(BA(Call(SVar("create-table"),[]),Str("matrix")))),SDef("destroy-matrix-table",[],Where(BA(Call(SVar("destroy-table"),[]),Str("matrix"))))]),Rules([RDef("memo-matrix",[],Rule(Op("TCons",[Var("m"),Op("TCons",[Var("f"),Op("TNil",[])])]),App(Call(SVar("table-put"),[]),Op("TCons",[Str("matrix"),Op("TCons",[Var("m"),Op("TCons",[Var("f"),Op("TNil",[])])])])),Id)),RDef("matrix-is-defined",[],Rule(Var("m"),App(Call(SVar("table-get"),[]),Op("TCons",[Str("matrix"),Op("TCons",[Var("m"),Op("TNil",[])])])),Id))]),Rules([RDef("MatrixScope",[],Rule(Op("Matrix",[Var("ps"),Var("rows")]),Op("Scope",[Var("ps"),Op("Lets",[Var("sdefs"),Op("Seq",[Op("Assign",[Op("Var",[Op("Cons",[Int(0),Op("Nil",[])])])]),Op("Matrix",[Var("rows'")])])])]),Where(AM(BA(Call(SVar("unzip"),[Call(SVar("RowLet"),[])]),Var("rows")),Op("TCons",[Var("sdefs"),Op("TCons",[Var("rows'"),Op("TNil",[])])]))))),RDef("RowLet",[],Rule(Op("Row",[Var("ts"),Var("s")]),Op("TCons",[Op("SDef",[Var("f"),Op("Nil",[]),Var("s")]),Op("TCons",[Op("Row",[Op("Nil",[]),Var("ts"),Op("Call",[Op("SVar",[Var("f")]),Op("Nil",[])])]),Op("TNil",[])])]),Where(AM(Call(SVar("new"),[]),Var("f"))))),RDef("MatrixSeenBefore",[],Rule(Op("Matrix",[Var("rows")]),Op("Continue",[Var("label")]),Where(AM(BA(Call(SVar("matrix-is-defined"),[]),Var("rows")),Var("label"))))),RDef("MatrixRowsEmpty",[],Rule(Op("Matrix",[Var("rows")]),Op("LChoices",[Var("states")]),Where(AM(BA(Call(SVar("map"),[LRule(Rule(Op("Row",[Op("Nil",[]),Op("Nil",[]),Var("s")]),Var("s"),Id))]),Var("rows")),Var("states"))))),RDef("SkipWild",[],Rule(Op("Matrix",[Var("rows")]),Op("Matrix",[Var("rows'")]),Where(AM(BA(Call(SVar("map"),[Call(SVar("Row"),[Id,Seq(Call(SVar("Cons"),[Call(SVar("As"),[Id,Call(SVar("Wld"),[])]),Id]),Call(SVar("Tl"),[])),Id])]),Var("rows")),Var("rows'"))))),RDef("ShiftColumn",[],Rule(Op("Matrix",[Var("rows")]),Op("Matrix",[Var("rows'")]),Where(Seq(BA(Not(Call(SVar("map"),[Call(SVar("Row"),[Call(SVar("Cons"),[Call(SVar("As"),[Id,Not(Call(SVar("Wld"),[]))]),Id]),Id,Id])])),Var("rows")),AM(BA(Call(SVar("map"),[Call(SVar("ShiftColumnRow"),[])]),Var("rows")),Var("rows'")))))),RDef("ShiftColumnRow",[],Rule(Op("Row",[Var("ts1"),Op("Cons",[Var("t"),Var("ts2")]),Var("s")]),Op("Row",[Op("Cons",[Var("t"),Var("ts1")]),Var("ts2"),Var("s")]),Id)),RDef("Mixture",[],Rule(Op("Matrix",[Var("rows")]),Op("Case",[Var("label"),Op("Var",[Var("path")]),Var("alts"),Var("def")]),Where(Seq(AM(BA(Call(SVar("get-path"),[]),Var("rows")),Var("path")),Seq(AM(BA(Call(SVar("outedges"),[]),Var("rows")),Var("cs")),Seq(AM(BA(Call(SVar("transitions"),[]),Op("TCons",[Var("rows"),Op("TCons",[Var("cs"),Op("TNil",[])])])),Var("alts")),Seq(AM(BA(Call(SVar("default-state"),[]),Var("rows")),Var("def")),Seq(AM(Call(SVar("new"),[]),Var("label")),BA(Call(SVar("memo-matrix"),[]),Op("TCons",[Var("rows"),Op("TCons",[Var("label"),Op("TNil",[])])])))))))))),RDef("get-path",[],Rule(Op("Cons",[Op("Row",[Op("Cons",[Op("As",[Op("Off",[Var("path")]),Wld]),Wld]),Wld,Wld]),Wld]),Var("path"),Id))]),Strategies([SDef("outedges",[],Seq(Call(SVar("filter"),[Call(SVar("ConsArgs"),[])]),Call(SVar("uniq"),[]))),SDef("offsets",[],Call(SVar("map"),[LRule(Rule(Op("As",[Op("Off",[Var("p")]),Var("t")]),Op("Var",[Var("p")]),Id))]))]),Rules([RDef("ConsArgs",[],Rule(Op("Row",[Op("Cons",[Op("As",[Wld,Op("Op",[Var("c"),Var("ts")])]),Wld]),Wld,Wld]),Op("TCons",[Op("Fun",[Var("c"),App(Call(SVar("length"),[]),Var("ts"))]),Op("TCons",[App(Call(SVar("offsets"),[]),Var("ts")),Op("TNil",[])])]),Id)),RDef("ConsArgs",[],Rule(Op("Row",[Op("Cons",[Op("As",[Wld,Op("Int",[Var("n")])]),Wld]),Wld,Wld]),Op("TCons",[Op("Int",[Var("n")]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),RDef("ConsArgs",[],Rule(Op("Row",[Op("Cons",[Op("As",[Wld,Op("Str",[Var("x")])]),Wld]),Wld,Wld]),Op("TCons",[Op("Str",[Var("x")]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id))]),Strategies([SDef("transitions",[],Call(SVar("rzip"),[Call(SVar("Transition"),[])]))]),Rules([RDef("Transition",[],Rule(Op("TCons",[Var("rows"),Op("TCons",[Op("TCons",[Var("c"),Op("TCons",[Var("args"),Op("TNil",[])])]),Op("TNil",[])])]),Op("Alt",[Var("c"),Var("args"),Op("Matrix",[Var("rows'")])]),Where(AM(BA(Call(SVar("filter"),[Call(SVar("ConsTransition"),[Call(SVar("MatchCons"),[Build(Var("c")),Build(Var("args"))])])]),Var("rows")),Var("rows'"))))),RDef("ConsTransition",["match-cons"],Rule(Op("Row",[Op("Cons",[Op("As",[Wld,Var("t")]),Var("pats")]),Var("pats'"),Var("fin")]),Op("Row",[Var("pats"),App(Call(SVar("conc"),[]),Op("TCons",[Var("pats''"),Op("TCons",[Var("pats'"),Op("TNil",[])])])),Var("fin")]),Where(AM(BA(Call(SVar("match-cons"),[]),Var("t")),Var("pats''"))))),RDef("MatchCons",["mkc","mkargs"],Rule(Op("Op",[Var("c"),Var("ts")]),Var("ts"),Where(Seq(AM(Call(SVar("mkc"),[]),Op("Fun",[Var("c"),Var("ar")])),BA(Call(SVar("eq"),[]),Op("TCons",[App(Call(SVar("length"),[]),Var("ts")),Op("TCons",[Var("ar"),Op("TNil",[])])])))))),RDef("MatchCons",["mkc","mkargs"],Rule(Op("Str",[Var("x")]),Op("Nil",[]),Where(Seq(AM(Call(SVar("mkc"),[]),Op("Str",[Var("x")])),AM(Call(SVar("mkargs"),[]),Op("Nil",[])))))),RDef("MatchCons",["mkc","mkargs"],Rule(Op("Real",[Var("r")]),Op("Nil",[]),Where(Seq(AM(Call(SVar("mkc"),[]),Op("Real",[Var("r")])),AM(Call(SVar("mkargs"),[]),Op("Nil",[])))))),RDef("MatchCons",["mkc","mkargs"],Rule(Op("Int",[Var("n")]),Op("Nil",[]),Where(Seq(AM(Call(SVar("mkc"),[]),Op("Int",[Var("n")])),AM(Call(SVar("mkargs"),[]),Op("Nil",[])))))),RDef("MatchCons",["mkc","mkargs"],Rule(Var("Wld"),Var("ts"),Where(Seq(Call(SVar("mkargs"),[]),AM(Call(SVar("map"),[LRule(Rule(Op("Var",[Var("p")]),Op("As",[Op("Off",[Var("p")]),Var("Wld")]),Id))]),Var("ts"))))))]),Strategies([SDef("default-state",[],Seq(Call(SVar("filter"),[Call(SVar("WildPat"),[])]),LRule(Rule(Var("rows"),Op("Matrix",[Var("rows")]),Id))))]),Rules([RDef("WildPat",[],Rule(Op("Row",[Op("Cons",[Op("As",[Wld,Var("Wld")]),Var("pats")]),Var("pats'"),Var("fin")]),Op("Row",[Var("pats"),Var("pats'"),Var("fin")]),Id))]),Rules([RDef("MatchingCongruence",[],Rule(Op("Cong",[Var("f"),Var("ss")]),Op("Match",[Op("Op",[Var("f"),Var("ts")])]),Where(AM(BA(Call(SVar("map"),[Choice(LRule(Rule(Op("Match",[Var("t")]),Var("t"),Id)),LRule(Rule(Var("Id"),Var("Wld"),Id)))]),Var("ss")),Var("ts"))))),RDef("TransformingCongruence",[],Rule(Op("Cong",[Var("f"),Var("ss")]),Op("Scope",[Var("xs"),Op("Seq",[Op("Match",[Op("Op",[Var("f"),Var("xs'")])]),Op("Build",[Op("Op",[Var("f"),Var("ts")])])])]),Where(Seq(AM(BA(Call(SVar("map"),[Call(SVar("new"),[])]),Var("ss")),Var("xs")),Seq(AM(BA(Call(SVar("map"),[LRule(Rule(Var("x"),Op("Var",[Var("x")]),Id))]),Var("xs")),Var("xs'")),AM(BA(Call(SVar("zip"),[LRule(Rule(Op("TCons",[Var("x"),Op("TCons",[Var("s"),Op("TNil",[])])]),Op("App",[Var("s"),Var("x")]),Id))]),Op("TCons",[Var("xs'"),Op("TCons",[Var("ss"),Op("TNil",[])])])),Var("ts")))))))]),Strategies([SDef("ElimId",[],Choice(Call(SVar("I1"),[]),Choice(Call(SVar("I2"),[]),Choice(Call(SVar("I3"),[]),Choice(Call(SVar("I4"),[]),Choice(Call(SVar("I7"),[]),Choice(Call(SVar("I8"),[]),Choice(Call(SVar("I9"),[]),Choice(Call(SVar("I10"),[]),Choice(Call(SVar("I12"),[]),Call(SVar("I16"),[])))))))))))]),Rules([RDef("I1",[],Rule(Op("Test",[Var("Id")]),Var("Id"),Id)),RDef("I2",[],Rule(Op("Not",[Var("Id")]),Var("Fail"),Id)),RDef("I3",[],Rule(Op("Seq",[Var("Id"),Var("s")]),Var("s"),Id)),RDef("I4",[],Rule(Op("Seq",[Var("s"),Var("Id")]),Var("s"),Id)),RDef("I5",[],Rule(Op("Choice",[Var("s"),Var("Id")]),Var("Id"),Id)),RDef("I6",[],Rule(Op("Choice",[Var("Id"),Var("s")]),Var("Id"),Id)),RDef("I7",[],Rule(Op("LChoice",[Var("Id"),Var("s")]),Var("Id"),Id)),RDef("I8",[],Rule(Op("Scope",[Var("xs"),Var("Id")]),Var("Id"),Id)),RDef("I9",[],Rule(Op("Rec",[Var("x"),Var("Id")]),Var("Id"),Id)),RDef("I10",[],Rule(Op("All",[Var("Id")]),Var("Id"),Id)),RDef("I12",[],Rule(Op("Where",[Var("Id")]),Var("Id"),Id)),RDef("I16",[],Rule(Op("Match",[Var("Wld")]),Var("Id"),Id)),RDef("NotValid",[],Rule(Op("One",[Var("Id")]),Var("Id"),Id)),RDef("NotValid",[],Rule(Op("Some",[Var("Id")]),Var("Id"),Id))]),Strategies([SDef("ElimFail",[],Choice(Call(SVar("F1"),[]),Choice(Call(SVar("F2"),[]),Choice(Call(SVar("F3"),[]),Choice(Call(SVar("F5"),[]),Choice(Call(SVar("F6"),[]),Choice(Call(SVar("F7"),[]),Choice(Call(SVar("F8"),[]),Choice(Call(SVar("F9"),[]),Choice(Call(SVar("F10"),[]),Choice(Call(SVar("F11"),[]),Choice(Call(SVar("F12"),[]),Choice(Call(SVar("F13"),[]),Choice(Call(SVar("F14"),[]),Call(SVar("F15"),[])))))))))))))))]),Rules([RDef("F1",[],Rule(Op("Test",[Var("Fail")]),Var("Fail"),Id)),RDef("F2",[],Rule(Op("Not",[Var("Fail")]),Var("Id"),Id)),RDef("F3",[],Rule(Op("Seq",[Var("Fail"),Var("s")]),Var("Fail"),Id)),RDef("F4",[],Rule(Op("Seq",[Var("s"),Var("Fail")]),Var("Fail"),Id)),RDef("F5",[],Rule(Op("Scope",[Var("xs"),Var("Fail")]),Var("Fail"),Id)),RDef("F6",[],Rule(Op("Rec",[Var("x"),Var("Fail")]),Var("Fail"),Id)),RDef("F7",[],Rule(Op("Some",[Var("Fail")]),Var("Fail"),Id)),RDef("F8",[],Rule(Op("One",[Var("Fail")]),Var("Fail"),Id)),RDef("F9",[],Rule(Op("Path",[Var("i"),Var("Fail")]),Var("Fail"),Id)),RDef("F10",[],Rule(Op("Cong",[Var("f"),Var("ls")]),Var("Fail"),Where(BA(Call(SVar("fetch"),[AM(Id,Var("Fail"))]),Var("ls"))))),RDef("F11",[],Rule(Op("Choice",[Var("Fail"),Var("s")]),Var("s"),Id)),RDef("F12",[],Rule(Op("Choice",[Var("s"),Var("Fail")]),Var("s"),Id)),RDef("F13",[],Rule(Op("LChoice",[Var("Fail"),Var("s")]),Var("s"),Id)),RDef("F14",[],Rule(Op("LChoice",[Var("s"),Var("Fail")]),Var("s"),Id)),RDef("F15",[],Rule(Op("Where",[Var("Fail")]),Var("Fail"),Id)),RDef("NotValid",[],Rule(Op("All",[Var("Fail")]),Var("Fail"),Id))]),Rules([RDef("Inline1",[],Rule(Op("Let",[Op("SDef",[Var("f"),Op("Nil",[]),Var("s")]),Op("Call",[Op("SVar",[Var("f")]),Op("Nil",[])])]),Var("s"),Id)),RDef("Inline",[],Rule(Op("Let",[Op("SDef",[Var("f"),Op("Nil",[]),Var("s1")]),Var("s2")]),Var("s2'"),Where(Seq(AM(BA(Call(SVar("oncetd-stop"),[Seq(AM(Id,Op("Call",[Op("SVar",[Var("f")]),Op("Nil",[])])),Build(Var("s1"))),Choice(Call(SVar("Case"),[Id,Id,Id,Id]),Call(SVar("Matrix"),[Id,Id]))]),Var("s2")),Var("s2'")),BA(Not(Call(SVar("in"),[])),Op("TCons",[Op("Call",[Op("SVar",[Var("f")]),Op("Nil",[])]),Op("TCons",[Var("s2'"),Op("TNil",[])])])))))),RDef("InlineDont",[],Rule(Op("Let",[Op("SDef",[Var("f"),Op("Nil",[]),Var("s1")]),Var("s2")]),Op("Let",[Op("SDef",[Op("Cons",[Var("DontInline"),Op("Nil",[])]),Var("f"),Op("Nil",[]),Var("s1")]),Var("s2")]),Id)),RDef("Dead",[],Rule(Op("Let",[Op("SDef",[Var("f"),Op("Nil",[]),Var("s1")]),Var("s2")]),Var("s2"),Where(BA(Not(Call(SVar("in"),[])),Op("TCons",[Op("Call",[Op("SVar",[Var("f")]),Op("Nil",[])]),Op("TCons",[Var("s2"),Op("TNil",[])])]))))),RDef("HoistLet",[],Rule(Op("Seq",[Var("s1"),Op("Let",[Var("sdef"),Var("s2")])]),Op("Let",[Var("sdef"),Op("Seq",[Var("s1"),Var("s2")])]),Id)),RDef("HoistLetFromCase",[],Rule(Op("Case",[Var("lab"),Var("t"),Var("alts"),Var("def")]),Op("Lets",[Var("sdefs"),Op("Case",[Var("lab"),Var("t"),Var("alts'"),Var("def")])]),Where(Seq(AM(AM(BA(Call(SVar("map"),[Call(SVar("AltGiveSDef"),[])]),Var("alts")),Var("sdefs")),Op("Cons",[Wld,Wld])),AM(BA(Call(SVar("map"),[Call(SVar("AltDropLet"),[])]),Var("alts")),Var("alts'")))))),RDef("AltDropLet",[],Rule(Op("Alt",[Var("c"),Var("args"),Op("Let",[Var("sdef"),Var("s")])]),Op("Alt",[Var("c"),Var("args"),Var("s")]),Id)),RDef("AltGiveSDef",[],Rule(Op("Alt",[Var("c"),Var("args"),Op("Let",[Var("sdef"),Var("s")])]),Var("sdef"),Id))]),Rules([RDef("NoEffect",[],Rule(Op("Seq",[Op("Build",[Var("t1")]),Op("Seq",[Op("Build",[Var("t2")]),Var("s")])]),Op("Seq",[Op("Build",[Var("t2")]),Var("s")]),Id)),RDef("CopyPropagation",[],Rule(Op("Seq",[Op("Build",[Var("t")]),Op("Scope",[Var("xs"),Op("Seq",[Op("Assign",[Op("Var",[Var("x")])]),Var("s")])])]),Op("Seq",[Op("Build",[Var("t")]),Op("Scope",[Var("ys"),App(Call(SVar("tsubs"),[]),Op("TCons",[Op("Cons",[Var("x"),Op("Nil",[])]),Op("TCons",[Op("Cons",[Var("t"),Op("Nil",[])]),Op("TCons",[Var("s"),Op("TNil",[])])])]))])]),Where(Seq(BA(Call(SVar("in"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])])),AM(BA(Call(SVar("diff"),[]),Op("TCons",[Var("xs"),Op("TCons",[Op("Cons",[Var("x"),Op("Nil",[])]),Op("TNil",[])])])),Var("ys")))))),RDef("CopyPropagation",[],Rule(Op("Scope",[Var("xs"),Op("Seq",[Op("Assign",[Op("Var",[Var("x")]),Op("Var",[Var("y")])]),Var("s")])]),Op("Scope",[Var("ys"),App(Call(SVar("tsubs"),[]),Op("TCons",[Op("Cons",[Var("x"),Op("Nil",[])]),Op("TCons",[Op("Cons",[Op("Var",[Var("y")]),Op("Nil",[])]),Op("TCons",[Var("s"),Op("TNil",[])])])]))]),Where(Seq(BA(Call(SVar("in"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])])),AM(BA(Call(SVar("diff"),[]),Op("TCons",[Var("xs"),Op("TCons",[Op("Cons",[Var("x"),Op("Nil",[])]),Op("TNil",[])])])),Var("ys")))))),RDef("CopyPropagation",[],Rule(Op("Scope",[Var("xs"),Op("Seq",[Op("Assign",[Op("Var",[Var("x")])]),Op("Seq",[Op("Assign",[Op("Var",[Var("y")])]),Var("s")])])]),Op("Scope",[Var("ys"),Op("Seq",[Op("Assign",[Op("Var",[Var("x")])]),App(Call(SVar("tsubs"),[]),Op("TCons",[Op("Cons",[Var("y"),Op("Nil",[])]),Op("TCons",[Op("Cons",[Op("Var",[Var("x")]),Op("Nil",[])]),Op("TCons",[Var("s"),Op("TNil",[])])])]))])]),Where(Seq(BA(Call(SVar("in"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])])),Seq(BA(Call(SVar("in"),[]),Op("TCons",[Var("y"),Op("TCons",[Var("xs"),Op("TNil",[])])])),AM(BA(Call(SVar("diff"),[]),Op("TCons",[Var("xs"),Op("TCons",[Op("Cons",[Var("y"),Op("Nil",[])]),Op("TNil",[])])])),Var("ys"))))))),RDef("CopyPropagation",[],Rule(Op("Scope",[Var("xs"),Op("Seq",[Op("Assign",[Op("Var",[Var("x")])]),Op("Seq",[Op("Assign",[Op("Var",[Var("y")]),Op("Var",[Var("x")])]),Var("s")])])]),Op("Scope",[Var("ys"),Op("Seq",[Op("Assign",[Op("Var",[Var("x")])]),App(Call(SVar("tsubs"),[]),Op("TCons",[Op("Cons",[Var("y"),Op("Nil",[])]),Op("TCons",[Op("Cons",[Op("Var",[Var("x")]),Op("Nil",[])]),Op("TCons",[Var("s"),Op("TNil",[])])])]))])]),Where(Seq(BA(Call(SVar("in"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])])),Seq(BA(Call(SVar("in"),[]),Op("TCons",[Var("y"),Op("TCons",[Var("xs"),Op("TNil",[])])])),AM(BA(Call(SVar("diff"),[]),Op("TCons",[Var("xs"),Op("TCons",[Op("Cons",[Var("y"),Op("Nil",[])]),Op("TNil",[])])])),Var("ys"))))))),RDef("CopyPropagation",[],Rule(Op("Seq",[Op("Assign",[Op("Var",[Var("x")])]),Op("Seq",[Op("Build",[Op("Var",[Var("x")])]),Var("s")])]),Op("Seq",[Op("Assign",[Op("Var",[Var("x")])]),Var("s")]),Id)),RDef("CopyPropagationNotValid",[],Rule(Op("Seq",[Op("Assign",[Var("x")]),Op("Seq",[Op("Assign",[Var("y"),Var("x")]),Var("s")])]),Op("Seq",[Op("Assign",[Var("x")]),Op("Seq",[Op("Assign",[Var("y")]),Var("s")])]),Id))]),Rules([RDef("FuseScope",[],Rule(Op("Scope",[Op("Nil",[]),Var("s")]),Var("s"),Id)),RDef("FuseScope",[],Rule(Op("Scope",[Var("xs"),Op("Scope",[Var("ys"),Var("s")])]),Op("Scope",[App(Call(SVar("conc"),[]),Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])])),Var("s")]),Id)),RDef("WidenScope",[],Rule(Op("Seq",[Op("Scope",[Var("xs"),Var("s1")]),Var("s2")]),Op("Scope",[Var("xs"),Op("Seq",[Var("s1"),Var("s2")])]),Id)),RDef("WidenScope",[],Rule(Op("Seq",[Var("s1"),Op("Scope",[Var("xs"),Var("s2")])]),Op("Scope",[Var("xs"),Op("Seq",[Var("s1"),Var("s2")])]),Id)),RDef("CleanupScope",[],Rule(Op("Scope",[Var("xs"),Var("s")]),Op("Scope",[Var("ys"),Var("s")]),Where(Seq(AM(BA(Call(SVar("isect"),[]),Op("TCons",[Var("xs"),Op("TCons",[App(Call(SVar("tvars"),[]),Var("s")),Op("TNil",[])])])),Var("ys")),Not(AM(Id,Var("xs"))))))),RDef("NarrowScope",[],Rule(Op("Scope",[Var("xs"),Op("Seq",[Var("s1"),Var("s2")])]),Op("Scope",[Var("ys"),Op("Seq",[Var("s1"),Op("Scope",[Var("zs"),Var("s2")])])]),Where(Seq(AM(BA(Call(SVar("isect"),[]),Op("TCons",[App(Call(SVar("tvars"),[]),Var("s1")),Op("TCons",[Var("xs"),Op("TNil",[])])])),Var("ys")),Seq(AM(BA(Call(SVar("diff"),[]),Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])])),Var("zs")),Not(Call(SVar("Nil"),[])))))))]),Strategies([SDef("Simplify",[],Choice(Call(SVar("ElimId"),[]),Choice(Call(SVar("ElimFail"),[]),Choice(Call(SVar("Ass"),[]),Choice(Call(SVar("P"),[]),Call(SVar("HL"),[])))))),SDef("Optimize",[],Choice(Call(SVar("Simplify"),[]),Choice(Call(SVar("HoistLet"),[]),Choice(Call(SVar("CopyPropagation"),[]),Choice(Call(SVar("FuseScope"),[]),Choice(Call(SVar("NoEffect"),[]),LChoice(Call(SVar("Inline"),[]),Call(SVar("InlineDont"),[])))))))),SDef("simplify",[],Call(SVar("downup"),[Call(SVar("repeat"),[Call(SVar("Optimize"),[])])])),SDef("simplify-cong",[],Seq(Call(SVar("downup"),[Call(SVar("repeat"),[Choice(Call(SVar("Optimize"),[]),Call(SVar("MatchingCongruence"),[]))])]),Call(SVar("topdown"),[Call(SVar("try"),[Call(SVar("NarrowScope"),[])])]))),SDef("simplify-widen",[],Seq(Call(SVar("downup"),[Call(SVar("repeat"),[Choice(Call(SVar("Optimize"),[]),Call(SVar("WidenScope"),[]))])]),Call(SVar("topdown"),[Call(SVar("try"),[Seq(Call(SVar("CleanupScope"),[]),Call(SVar("try"),[Call(SVar("FuseScope"),[])]))])])))]),Rules([RDef("Comm",[],Rule(Op("Choice",[Var("x"),Var("y")]),Op("Choice",[Var("y"),Var("x")]),Id)),RDef("Ass",[],Rule(Op("Choice",[Op("Choice",[Var("x"),Var("y")]),Var("z")]),Op("Choice",[Var("x"),Op("Choice",[Var("y"),Var("z")])]),Id)),RDef("Ass",[],Rule(Op("Seq",[Op("Seq",[Var("x"),Var("y")]),Var("z")]),Op("Seq",[Var("x"),Op("Seq",[Var("y"),Var("z")])]),Id)),RDef("Ass",[],Rule(Op("LChoice",[Op("LChoice",[Var("x"),Var("y")]),Var("z")]),Op("LChoice",[Var("x"),Op("LChoice",[Var("y"),Var("z")])]),Id)),RDef("LAss",[],Rule(Op("Seq",[Var("s1"),Op("Seq",[Var("s2"),Var("s3")])]),Op("Seq",[Op("Seq",[Var("s1"),Var("s2")]),Var("s3")]),Id)),RDef("P",[],Rule(Op("Choice",[Var("x"),Var("x")]),Var("x"),Id)),RDef("P",[],Rule(Op("LChoice",[Var("x"),Var("x")]),Var("x"),Id)),RDef("P",[],Rule(Op("Where",[Op("Where",[Var("s")])]),Op("Where",[Var("s")]),Id)),RDef("P",[],Rule(Op("Not",[Op("Not",[Var("s")])]),Op("Test",[Var("s")]),Id)),RDef("P",[],Rule(Op("Test",[Op("Test",[Var("s")])]),Op("Test",[Var("s")]),Id)),RDef("P",[],Rule(Op("Where",[Op("Seq",[Op("Where",[Var("s1")]),Op("Seq",[Op("Build",[Var("t")]),Var("s2")])])]),Op("Where",[Op("Seq",[Var("s1"),Op("Seq",[Op("Build",[Var("t")]),Var("s2")])])]),Id))]),Strategies([SDef("equal",[],Call(SVar("for"),[Id,Call(SVar("Nil"),[]),LChoice(Call(SVar("UfIdem"),[]),Call(SVar("UfDecompose"),[]))]))]),Rules([RDef("UfIdem",[],Rule(Op("Cons",[Op("TCons",[Var("x"),Op("TCons",[Var("x"),Op("TNil",[])])]),Var("ps")]),Var("ps"),Id)),RDef("UfDecompose",[],Rule(Op("Cons",[Op("TCons",[Explode(Var("f"),Var("xs")),Op("TCons",[Explode(Var("f"),Var("ys")),Op("TNil",[])])]),Var("ps")]),App(Call(SVar("conc"),[]),Op("TCons",[App(Call(SVar("zip"),[Id]),Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])])),Op("TCons",[Var("ps"),Op("TNil",[])])])),Id))]),Strategies([SDef("diff",[],Call(SVar("for"),[LRule(Rule(Var("ps"),Op("TCons",[Op("Nil",[]),Op("TCons",[Var("ps"),Op("TNil",[])])]),Id)),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TNil"),[])])]),LChoice(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[LChoice(Call(SVar("UfIdem"),[]),Call(SVar("UfDecompose"),[])),Call(SVar("TNil"),[])])]),Call(SVar("UfShift"),[]))]))]),Rules([RDef("UfShift",[],Rule(Op("TCons",[Var("ps1"),Op("TCons",[Op("Cons",[Var("p"),Var("ps2")]),Op("TNil",[])])]),Op("TCons",[Op("Cons",[Var("p"),Var("ps1")]),Op("TCons",[Var("ps2"),Op("TNil",[])])]),Id))]),Strategies([SDef("unify",["isvar"],Call(SVar("for"),[LRule(Rule(Var("pairs"),Op("TCons",[Var("pairs"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),LRule(Rule(Op("TCons",[Op("Nil",[]),Op("TCons",[Var("sbs"),Op("TNil",[])])]),Var("sbs"),Id)),LChoice(Call(SVar("TCons"),[Call(SVar("UfIdem"),[]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Choice(Call(SVar("UfVar"),[Call(SVar("isvar"),[])]),LChoice(Call(SVar("UfSwap"),[Call(SVar("isvar"),[])]),Call(SVar("TCons"),[Call(SVar("UfDecompose"),[]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]))))]))]),Rules([RDef("UfVar",["isvar"],Rule(Op("TCons",[Op("Cons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Var("ps")]),Op("TCons",[Var("sbs"),Op("TNil",[])])]),Op("TCons",[Var("ps'"),Op("TCons",[Op("Cons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Var("sbs''")]),Op("TNil",[])])]),Where(Seq(BA(Call(SVar("isvar"),[]),Var("x")),Seq(BA(Not(Call(SVar("in"),[])),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])),AM(BA(Call(SVar("substitute"),[Call(SVar("isvar"),[])]),Op("TCons",[Op("Cons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("Nil",[])]),Op("TCons",[Op("TCons",[Var("sbs"),Op("TCons",[Var("ps"),Op("TNil",[])])]),Op("TNil",[])])])),Op("TCons",[Var("sbs''"),Op("TCons",[Var("ps'"),Op("TNil",[])])]))))))),RDef("UfSwap",["isvar"],Rule(Op("TCons",[Op("Cons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Var("ps")]),Op("TCons",[Var("sbs"),Op("TNil",[])])]),Op("TCons",[Op("Cons",[Op("TCons",[Var("y"),Op("TCons",[Var("x"),Op("TNil",[])])]),Var("ps")]),Op("TCons",[Var("sbs"),Op("TNil",[])])]),Where(Seq(BA(Not(Call(SVar("isvar"),[])),Var("x")),BA(Call(SVar("isvar"),[]),Var("y"))))))]),Rules([RDef("in",[],Rule(Op("TCons",[Var("a"),Op("TCons",[Var("t"),Op("TNil",[])])]),App(Call(SVar("oncetd"),[AM(Id,Var("a"))]),Var("t")),Id))]),Strategies([SDef("equal",["fltr"],Call(SVar("for"),[Id,Call(SVar("Nil"),[]),LChoice(Call(SVar("UfIdem"),[]),Seq(Call(SVar("try"),[Call(SVar("Cons"),[Call(SVar("TCons"),[Call(SVar("fltr"),[]),Call(SVar("TCons"),[Call(SVar("fltr"),[]),Call(SVar("TNil"),[])])]),Id])]),Call(SVar("UfDecompose"),[])))]))]),Strategies([SDef("create-table",[],Prim("_ST_create_table")),SDef("destroy-table",[],Prim("_ST_destroy_table")),SDef("table-put",[],Prim("_ST_table_put")),SDef("table-get",[],Prim("_ST_table_get")),SDef("table-remove",[],Prim("_ST_table_remove")),SDef("table-keys",[],Prim("_ST_table_keys")),SDef("table-getlist",[],Seq(AM(Id,Var("name")),Seq(Call(SVar("table-keys"),[]),Call(SVar("map"),[LRule(Rule(Var("x"),Op("TCons",[Var("x"),Op("TCons",[App(Call(SVar("table-get"),[]),Op("TCons",[Var("name"),Op("TCons",[Var("x"),Op("TNil",[])])])),Op("TNil",[])])]),Id))])))),SDef("table-putlist",[],Seq(AM(Id,Op("TCons",[Var("name"),Op("TCons",[Var("list"),Op("TNil",[])])])),BA(Call(SVar("map"),[Scope(["x","y"],Seq(AM(Id,Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])),BA(Call(SVar("table-put"),[]),Op("TCons",[Var("name"),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])]))))]),Var("list")))),SDef("set",[],Call(SVar("table-put"),[])),SDef("get",[],Call(SVar("table-get"),[])),SDef("push-set",[],Seq(AM(Id,Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TCons",[Var("val"),Op("TNil",[])])])])),Where(BA(Call(SVar("set"),[]),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TCons",[Op("Cons",[Var("val"),App(LChoice(Call(SVar("get"),[]),Build(Op("Nil",[]))),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TNil",[])])]))]),Op("TNil",[])])])]))))),SDef("pop-get",[],Seq(AM(Id,Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TNil",[])])])),Seq(Where(Seq(AM(BA(Call(SVar("get"),[]),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TNil",[])])])),Op("Cons",[Var("x"),Var("xs")])),BA(Call(SVar("set"),[]),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TCons",[Var("xs"),Op("TNil",[])])])])))),Build(Var("x"))))),SDef("union-set",[],Seq(AM(Id,Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TCons",[Var("val"),Op("TNil",[])])])])),Where(BA(Call(SVar("set"),[]),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("val"),Op("TCons",[App(LChoice(Call(SVar("get"),[]),Build(Op("Nil",[]))),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TNil",[])])])),Op("TNil",[])])])),Op("TNil",[])])])]))))),SDef("diff-set",[],Seq(AM(Id,Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TCons",[Var("val"),Op("TNil",[])])])])),Where(BA(Call(SVar("set"),[]),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TCons",[App(Call(SVar("diff"),[]),Op("TCons",[App(LChoice(Call(SVar("get"),[]),Build(Op("Nil",[]))),Op("TCons",[Var("table"),Op("TCons",[Var("key"),Op("TNil",[])])])),Op("TCons",[Var("val"),Op("TNil",[])])])),Op("TNil",[])])])])))))]),Strategies([SDef("exit",[],Prim("_ST_exit")),SDef("call",[],Prim("_ST_call")),SDef("call-noisy",[],Prim("_ST_call_noisy")),SDef("get-pid",[],Prim("_ST_get_pid")),SDef("rm-files",[],Seq(AM(Id,Var("files")),Where(BA(Call(SVar("call"),[]),Op("TCons",[Str("rm"),Op("TCons",[Op("Cons",[Str("-f"),Var("files")]),Op("TNil",[])])]))))),SDef("pipe",["c","suf2"],Call(SVar("pipe'"),[Call(SVar("c"),[]),Call(SVar("suf2"),[]),Build(Op("Nil",[]))])),SDef("pipe'",["c","suf2","args"],Seq(Where(AM(Call(SVar("conc-strings"),[]),Var("in"))),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("suf2"),[]),Call(SVar("TNil"),[])])]),Seq(Where(AM(Call(SVar("conc-strings"),[]),Var("out"))),Where(BA(Call(SVar("call"),[]),Op("TCons",[App(Call(SVar("c"),[]),Op("TNil",[])),Op("TCons",[App(Call(SVar("conc"),[]),Op("TCons",[App(Call(SVar("args"),[]),Op("TNil",[])),Op("TCons",[Op("Cons",[Str("-i"),Op("Cons",[Var("in"),Op("Cons",[Str("-o"),Op("Cons",[Var("out"),Op("Nil",[])])])])]),Op("TNil",[])])])),Op("TNil",[])])]))))))),SDef("transform-file",["s","suf"],Seq(Where(AM(Call(SVar("conc-strings"),[]),Var("in"))),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("suf"),[]),Call(SVar("TNil"),[])])]),Seq(Where(AM(Call(SVar("conc-strings"),[]),Var("out"))),Where(BA(Call(SVar("apply-to-file"),[Call(SVar("s"),[])]),Op("TCons",[Var("in"),Op("TCons",[Var("out"),Op("TNil",[])])]))))))),SDef("apply-to-file",["s"],Seq(AM(Id,Op("TCons",[Var("in"),Op("TCons",[Var("out"),Op("TNil",[])])])),Seq(Where(AM(BA(Seq(Call(SVar("ReadFromFile"),[]),Call(SVar("s"),[])),Var("in")),Var("trm"))),Where(BA(Call(SVar("WriteToBinaryFile"),[]),Op("TCons",[Var("out"),Op("TCons",[Var("trm"),Op("TNil",[])])])))))),SDef("copy-file",["s","new-base","new-suf"],Seq(AM(Id,Op("TCons",[Var("base"),Op("TCons",[Var("suf"),Op("TNil",[])])])),Seq(Call(SVar("TCons"),[Call(SVar("new-base"),[]),Call(SVar("TCons"),[Call(SVar("new-suf"),[]),Call(SVar("TNil"),[])])]),Seq(AM(Id,Op("TCons",[Var("nbase"),Op("TCons",[Var("nsuf"),Op("TNil",[])])])),Where(BA(Call(SVar("apply-to-file"),[Call(SVar("s"),[])]),Op("TCons",[App(Call(SVar("conc-strings"),[]),Op("TCons",[Var("base"),Op("TCons",[Var("suf"),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("conc-strings"),[]),Op("TCons",[Var("nbase"),Op("TCons",[Var("nsuf"),Op("TNil",[])])])),Op("TNil",[])])])))))))]),Signature([Sorts([Sort("Option",Nokind)]),Operations([OpDecl("Program",FunType([Var("String")],Var("Option"))),OpDecl("Undefined",FunType([Var("String")],Var("Option")))])]),Strategies([SDef("parse-options",["s"],Call(SVar("Cons"),[LRule(Rule(Var("x"),Op("Program",[Var("x")]),Id)),Rec("x",LChoice(Choice(Call(SVar("Nil"),[]),Seq(Call(SVar("s"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])]))),Call(SVar("UndefinedOption"),[])))]))]),Rules([RDef("Option",["is-flag","label"],Rule(Op("Cons",[Var("flag"),Var("rest")]),Op("Cons",[App(Call(SVar("label"),[]),Op("TNil",[])),Var("rest")]),Where(BA(Call(SVar("is-flag"),[]),Var("flag"))))),RDef("ArgOption",["is-flag","label"],Rule(Op("Cons",[Var("flag"),Op("Cons",[Var("arg"),Var("rest")])]),Op("Cons",[App(Call(SVar("label"),[]),Var("arg")),Var("rest")]),Where(BA(Call(SVar("is-flag"),[]),Var("flag"))))),RDef("Arg2Option",["is-flag","label"],Rule(Op("Cons",[Var("flag"),Op("Cons",[Var("arg1"),Op("Cons",[Var("arg2"),Var("rest")])])]),Op("Cons",[App(Call(SVar("label"),[]),Op("TCons",[Var("arg1"),Op("TCons",[Var("arg2"),Op("TNil",[])])])),Var("rest")]),Where(BA(Call(SVar("is-flag"),[]),Var("flag"))))),RDef("UndefinedOption",[],Rule(Op("Cons",[Var("x"),Var("rest")]),Op("Cons",[Op("Undefined",[Var("x")]),Var("rest")]),Id))]),Strategies([SDef("defined-option",["s"],Call(SVar("fetch"),[Call(SVar("s"),[])])),SDef("option-defined",["s"],Call(SVar("fetch"),[Call(SVar("s"),[])])),SDef("arg-option-value",["s"],Call(SVar("fetch"),[Call(SVar("s"),[])]))]),Signature([Operations([OpDecl("Silent",ConstType(Var("Option"))),OpDecl("Verbose",ConstType(Var("Option"))),OpDecl("Version",ConstType(Var("Option"))),OpDecl("Input",FunType([Var("String")],Var("Option"))),OpDecl("Output",FunType([Var("String")],Var("Option"))),OpDecl("Binary",ConstType(Var("Option"))),OpDecl("Statistics",ConstType(Var("Option"))),OpDecl("Help",ConstType(Var("Option"))),OpDecl("Runtime",FunType([Var("Real")],Var("Option"))),OpDecl("DeclVersion",FunType([Var("String")],Var("Option")))])]),Strategies([SDef("iowrap",["strat"],Call(SVar("iowrapO"),[Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("strat"),[]),Call(SVar("TNil"),[])])]),Fail])),SDef("iowrapO",["strat","extra-options"],Seq(Call(SVar("parse-options"),[LChoice(Call(SVar("extra-options"),[]),Call(SVar("io-options"),[]))]),LChoice(Call(SVar("need-help"),[]),LChoice(Seq(Call(SVar("input-file'"),[]),Seq(Call(SVar("apply-strategy"),[Call(SVar("strat"),[])]),Seq(Call(SVar("output-file'"),[]),Call(SVar("report-success"),[])))),Call(SVar("report-failure"),[]))))),SDef("iowrapNoOutput",["strat","extra-options"],Seq(Call(SVar("parse-options"),[LChoice(Call(SVar("extra-options"),[]),Call(SVar("io-options"),[]))]),LChoice(Call(SVar("need-help"),[]),LChoice(Seq(Call(SVar("input-file'"),[]),Seq(Call(SVar("apply-strategy"),[Call(SVar("strat"),[])]),Call(SVar("report-success"),[]))),Call(SVar("report-failure"),[])))))]),Strategies([SDef("io-options",[],Choice(Call(SVar("Option"),[Match(Str("-S")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--silent")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--verbose")),Build(Op("Verbose",[]))]),Choice(Call(SVar("Option"),[Match(Str("-v")),Build(Op("Version",[]))]),Choice(Call(SVar("Option"),[Match(Str("--version")),Build(Op("Version",[]))]),Choice(Call(SVar("ArgOption"),[Match(Str("@version")),LRule(Rule(Var("x"),Op("DeclVersion",[Var("x")]),Id))]),Choice(Call(SVar("ArgOption"),[Match(Str("-i")),LRule(Rule(Var("x"),Op("Input",[Var("x")]),Id))]),Choice(Call(SVar("ArgOption"),[Match(Str("--input")),LRule(Rule(Var("x"),Op("Input",[Var("x")]),Id))]),Choice(Call(SVar("ArgOption"),[Match(Str("-o")),LRule(Rule(Var("x"),Op("Output",[Var("x")]),Id))]),Choice(Call(SVar("ArgOption"),[Match(Str("--output")),LRule(Rule(Var("x"),Op("Output",[Var("x")]),Id))]),Choice(Call(SVar("Option"),[Match(Str("-b")),Build(Op("Binary",[]))]),Choice(Call(SVar("Option"),[Match(Str("-s")),Build(Op("Statistics",[]))]),Choice(Call(SVar("Option"),[Match(Str("--help")),Build(Op("Help",[]))]),Choice(Call(SVar("Option"),[Match(Str("-h")),Build(Op("Help",[]))]),Call(SVar("Option"),[Match(Str("-?")),Build(Op("Help",[]))])))))))))))))))),SDef("usage'",[],Where(Seq(Call(SVar("option-defined"),[AM(Id,Op("Program",[Var("prog")]))]),Seq(BA(Call(SVar("printnl"),[]),Op("TCons",[Var("stderr"),Op("TCons",[Op("Cons",[Str("usage : "),Op("Cons",[Var("prog"),Op("Cons",[Str(" [-S] [-i file] [-o file] [-b] [-s] [--help|-h|-?]"),Op("Nil",[])])])]),Op("TNil",[])])])),BA(Call(SVar("exit"),[]),Int(1)))))),SDef("need-help",[],Seq(Call(SVar("option-defined"),[Choice(Call(SVar("Help"),[]),Call(SVar("Undefined"),[Id]))]),Call(SVar("usage'"),[]))),SDef("need-help",["u"],Seq(Call(SVar("option-defined"),[Choice(Call(SVar("Help"),[]),Choice(Call(SVar("Undefined"),[Id]),Call(SVar("Version"),[])))]),Call(SVar("u"),[]))),SDef("input-file'",[],Seq(Where(LChoice(Call(SVar("option-defined"),[AM(Id,Op("Input",[Var("infile")]))]),AM(Build(Var("stdin")),Var("infile")))),Call(SVar("split"),[Id,BA(Call(SVar("ReadFromFile"),[]),Var("infile"))]))),SDef("apply-strategy",["strat"],Seq(Where(Call(SVar("dtime"),[])),Seq(Call(SVar("strat"),[]),Seq(Where(AM(Call(SVar("dtime"),[]),Var("runtime"))),LRule(Rule(Op("TCons",[Var("options"),Op("TCons",[Var("trm"),Op("TNil",[])])]),Op("TCons",[Op("Cons",[Op("Runtime",[Var("runtime")]),Var("options")]),Op("TCons",[Var("trm"),Op("TNil",[])])]),Id)))))),SDef("output-file'",[],Seq(Where(Call(SVar("TCons"),[LChoice(Call(SVar("option-defined"),[AM(Id,Op("Output",[Var("outfile")]))]),AM(Build(Var("stdout")),Var("outfile"))),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])])),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("split"),[Build(Var("outfile")),Id]),Call(SVar("TNil"),[])])]),LChoice(Call(SVar("TCons"),[Call(SVar("option-defined"),[AM(Id,Op("Binary",[]))]),Call(SVar("TCons"),[Call(SVar("WriteToBinaryFile"),[]),Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("WriteToTextFile"),[]),Call(SVar("TNil"),[])])]))))),SDef("report-success",[],Seq(Where(Call(SVar("try"),[Seq(Call(SVar("TCons"),[Not(Call(SVar("option-defined"),[AM(Id,Op("Silent",[]))])),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[AM(Id,Op("Runtime",[Var("runtime")]))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[AM(Id,Op("Program",[Var("prog")]))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),BA(Call(SVar("printnl"),[]),Op("TCons",[Var("stderr"),Op("TCons",[Op("Cons",[Var("prog"),Op("Cons",[Str(" ("),Op("Cons",[Var("runtime"),Op("Cons",[Str(" secs)"),Op("Nil",[])])])])]),Op("TNil",[])])])))))])),BA(Call(SVar("exit"),[]),Int(0)))),SDef("report-failure",[],Seq(BA(Call(SVar("printnl"),[]),Op("TCons",[Var("stderr"),Op("TCons",[Op("Cons",[Str("rewriting failed"),Op("Nil",[])]),Op("TNil",[])])])),BA(Call(SVar("exit"),[]),Int(1))))]),Strategies([SDef("memo-init",[],Call(SVar("create-table"),[])),SDef("memo-purge",[],Call(SVar("destroy-table"),[]))]),Rules([RDef("memo",["name","s"],Rule(Var("t"),Var("t'"),Where(LChoice(AM(BA(Call(SVar("table-get"),[]),Op("TCons",[App(Call(SVar("name"),[]),Op("TNil",[])),Op("TCons",[Var("t"),Op("TNil",[])])])),Var("t'")),Seq(AM(BA(Call(SVar("s"),[]),Var("t")),Var("t'")),BA(Call(SVar("table-put"),[]),Op("TCons",[App(Call(SVar("name"),[]),Op("TNil",[])),Op("TCons",[Var("t"),Op("TCons",[Var("t'"),Op("TNil",[])])])])))))))]),Rules([RDef("find-in-path",[],Rule(Op("TCons",[Var("file"),Op("TCons",[Var("path"),Op("TNil",[])])]),App(Rec("x",LChoice(LRule(Rule(Op("Cons",[Var("dir"),Wld]),App(Seq(Call(SVar("concat-strings"),[]),Call(SVar("file-exists"),[])),Op("Cons",[Var("dir"),Op("Cons",[Str("/"),Op("Cons",[Var("file"),Op("Nil",[])])])])),Id)),Seq(Call(SVar("Tl"),[]),Call(SVar("x"),[])))),Var("path")),Id))]),Strategies([SDef("find-in-path",["mkpath"],LChoice(Call(SVar("file-exists"),[]),LChoice(Seq(Call(SVar("split"),[Id,Call(SVar("mkpath"),[])]),Call(SVar("find-in-path"),[])),LRule(Rule(Var("x"),App(Call(SVar("fatal-error"),[]),Op("Cons",[Str("no such file: "),Op("Cons",[Var("x"),Op("Nil",[])])])),Id))))),SDef("find-file",["mkpath","ext"],Seq(Call(SVar("guarantee-extension"),[Call(SVar("ext"),[])]),Call(SVar("find-in-path"),[Call(SVar("mkpath"),[])])))]),Strategies([SDef("dtime",[],Prim("_ST_dtime"))]),Signature([Sorts([Sort("File",Nokind)]),Operations([OpDecl("stdin",ConstType(Var("File"))),OpDecl("stdout",ConstType(Var("File"))),OpDecl("stderr",ConstType(Var("File")))])]),Strategies([SDef("print",[],Prim("_ST_print")),SDef("printnl",[],Prim("_ST_printnl")),SDef("printascii",[],Prim("_ST_printascii")),SDef("file-exists",[],Prim("_ST_file_exists")),SDef("open-file",[],Prim("_ST_open_file")),SDef("append-file",[],Prim("_ST_append_file")),SDef("close-file",[],Prim("_ST_close_file")),SDef("ReadFromFile",[],Prim("_ST_ReadFromFile")),SDef("WriteToBinaryFile",[],Prim("_ST_WriteToBinaryFile")),SDef("WriteToTextFile",[],Prim("_ST_WriteToTextFile")),SDef("print-stack",[],Prim("_ST_PrintStack"))]),Strategies([SDef("open",["file"],Seq(Call(SVar("file"),[]),Call(SVar("ReadFromFile"),[]))),SDef("save",["file"],Seq(Call(SVar("split"),[Call(SVar("file"),[]),Id]),Call(SVar("WriteToTextFile"),[]))),SDef("debug",[],Where(Seq(Call(SVar("split"),[Build(Var("stderr")),LRule(Rule(Var("x"),Op("Cons",[Var("x"),Op("Nil",[])]),Id))]),Call(SVar("printnl"),[])))),SDef("debug",["msg"],Where(Seq(Call(SVar("split"),[Build(Var("stderr")),LRule(Rule(Var("x"),Op("Cons",[App(Call(SVar("msg"),[]),Op("TNil",[])),Op("Cons",[Var("x"),Op("Nil",[])])]),Id))]),Call(SVar("printnl"),[])))),SDef("say",["msg"],Where(Seq(Call(SVar("msg"),[]),Call(SVar("debug"),[])))),SDef("debug-stdout",["msg"],Where(Seq(Call(SVar("split"),[Build(Var("stdout")),LRule(Rule(Var("x"),Op("Cons",[App(Call(SVar("msg"),[]),Op("TNil",[])),Op("Cons",[Var("x"),Op("Nil",[])])]),Id))]),Call(SVar("printnl"),[])))),SDef("trace",["msg","s"],Seq(Call(SVar("debug"),[Call(SVar("msg"),[])]),LChoice(Seq(Call(SVar("s"),[]),Call(SVar("debug"),[Build(Str("succeeded: "))])),Call(SVar("debug"),[Build(Str("failed: "))])))),SDef("error",[],Where(Seq(Call(SVar("split"),[Build(Var("stderr")),Id]),Call(SVar("printnl"),[])))),SDef("fatal-error",[],Where(Seq(Call(SVar("error"),[]),BA(Call(SVar("exit"),[]),Int(1))))),SDef("printchar",[],Where(Seq(Call(SVar("split"),[Build(Var("stdout")),LRule(Rule(Var("x"),Op("Cons",[Var("x"),Op("Nil",[])]),Id))]),Call(SVar("printascii"),[])))),SDef("printstring",[],Where(Seq(Call(SVar("split"),[Build(Var("stdout")),LRule(Rule(Var("x"),Op("Cons",[Var("x"),Op("Nil",[])]),Id))]),Call(SVar("print"),[])))),SDef("print-strings-nl",["out"],Where(Seq(Call(SVar("split"),[Call(SVar("out"),[]),Id]),Call(SVar("printnl"),[])))),SDef("obsolete",["msg"],Where(BA(Call(SVar("debug"),[Call(SVar("msg"),[])]),Str(": obsolete library strategy"))))]),Strategies([SDef("stdio",["s"],LChoice(Seq(BA(Call(SVar("ReadFromFile"),[]),Var("stdin")),Seq(Call(SVar("s"),[]),Seq(Call(SVar("split"),[Build(Var("stdout")),Id]),Call(SVar("WriteToTextFile"),[])))),BA(Call(SVar("fatal-error"),[]),Op("Cons",[Str("** rewriting failed"),Op("Nil",[])]))))]),Strategies([SDef("stdioO",["s"],LChoice(Seq(Call(SVar("split"),[Id,BA(Call(SVar("ReadFromFile"),[]),Var("stdin"))]),Seq(Call(SVar("s"),[]),Seq(Call(SVar("split"),[Build(Var("stdout")),Id]),Call(SVar("WriteToTextFile"),[])))),BA(Call(SVar("fatal-error"),[]),Op("Cons",[Str("** rewriting failed"),Op("Nil",[])]))))]),Strategies([SDef("is-real",[],Prim("_ST_is_real")),SDef("cos",[],Prim("_ST_cos")),SDef("sin",[],Prim("_ST_sin")),SDef("sqrt",[],Prim("_ST_sqrt"))]),Strategies([SDef("is-int",[],Prim("_ST_is_int")),SDef("minus",[],Prim("_ST_minus")),SDef("plus",[],Prim("_ST_plus")),SDef("add",[],Prim("_ST_add")),SDef("subt",[],Prim("_ST_subt")),SDef("mul",[],Prim("_ST_mul")),SDef("div",[],Prim("_ST_div")),SDef("mod",[],Prim("_ST_mod")),SDef("geq",[],Prim("_ST_geq")),SDef("gt",[],Prim("_ST_gt")),SDef("lt",[],Not(Call(SVar("geq"),[]))),SDef("leq",[],Not(Call(SVar("gt"),[]))),SDef("max",[],Prim("_ST_max")),SDef("min",[],Prim("_ST_min")),SDef("int",[],Prim("_ST_int"))]),Strategies([SDef("sum",[],Call(SVar("foldr"),[Build(Int(0)),Call(SVar("add"),[])])),SDef("average",[],Seq(Call(SVar("split"),[Call(SVar("sum"),[]),Call(SVar("length"),[])]),Call(SVar("div"),[]))),SDef("list-min",[],Call(SVar("list-accum"),[Call(SVar("min"),[])])),SDef("list-max",[],Call(SVar("list-accum"),[Call(SVar("max"),[])])),SDef("list-accum",["s"],Seq(Call(SVar("split"),[Call(SVar("Tl"),[]),Call(SVar("Hd"),[])]),Call(SVar("foldl"),[Call(SVar("s"),[])]))),SDef("add-lists",[],Call(SVar("list-accum"),[Call(SVar("zip"),[LChoice(Call(SVar("add"),[]),Build(Str("")))])])),SDef("averages",[],Scope(["len"],Seq(Where(AM(Call(SVar("length"),[]),Var("len"))),Seq(Call(SVar("add-lists"),[]),Call(SVar("map"),[Call(SVar("try"),[Call(SVar("sect"),[Call(SVar("div"),[]),Build(Var("len"))])])]))))),SDef("round-list",[],Call(SVar("map"),[LChoice(Test(Call(SVar("sect"),[Call(SVar("leq"),[]),Build(Int(100))])),Call(SVar("int"),[]))]))]),Strategies([SDef("mkterm",[],Prim("_ST_mkterm")),SDef("explode-term",[],Prim("_ST_explode_term")),SDef("address-lt",[],Prim("_ST_address_lt")),SDef("address",[],Prim("_ST_address"))]),Rules([RDef("sect",["op","arg"],Rule(Var("x"),App(Call(SVar("op"),[]),Op("TCons",[Var("x"),Op("TCons",[App(Call(SVar("arg"),[]),Op("TNil",[])),Op("TNil",[])])])),Id))]),Strategies([SDef("new",[],Prim("_ST_new")),SDef("is-string",[],Prim("_ST_is_string")),SDef("implode-string",[],Prim("_ST_implode_string")),SDef("explode-string",[],Prim("_ST_explode_string")),SDef("conc-strings",[],Seq(Call(SVar("TCons"),[Call(SVar("explode-string"),[]),Call(SVar("TCons"),[Call(SVar("explode-string"),[]),Call(SVar("TNil"),[])])]),Seq(Call(SVar("conc"),[]),Call(SVar("implode-string"),[])))),SDef("concat-strings",[],Seq(Call(SVar("map"),[Call(SVar("explode-string"),[])]),Seq(Call(SVar("concat"),[]),Call(SVar("implode-string"),[])))),SDef("int-to-string",[],Seq(Rec("x",Seq(Call(SVar("split"),[Seq(Call(SVar("sect"),[Call(SVar("mod"),[]),Build(Int(10))]),Call(SVar("sect"),[Call(SVar("add"),[]),Build(Int(48))])),Seq(Call(SVar("sect"),[Call(SVar("div"),[]),Build(Int(10))]),Call(SVar("int"),[]))]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[LChoice(Seq(AM(Id,Int(0)),Build(Op("Nil",[]))),Call(SVar("x"),[])),Call(SVar("TNil"),[])])]),Call(SVar("MkCons"),[])))),Seq(Call(SVar("reverse"),[]),Call(SVar("implode-string"),[])))),SDef("string-to-int",[],Seq(Call(SVar("explode-string"),[]),Seq(Call(SVar("split"),[Build(Int(0)),Id]),Seq(Call(SVar("repeat"),[Call(SVar("S2I2"),[])]),Call(SVar("S2I1"),[]))))),SDef("escape",[],Seq(Call(SVar("explode-string"),[]),Seq(Rec("x",LChoice(Seq(Call(SVar("Escape"),[]),Call(SVar("Cons"),[Id,Call(SVar("Cons"),[Id,Call(SVar("x"),[])])])),LChoice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Call(SVar("Nil"),[])))),Call(SVar("implode-string"),[])))),SDef("unescape",[],Seq(Call(SVar("explode-string"),[]),Seq(Rec("x",Seq(Call(SVar("try"),[Call(SVar("UnEscape"),[])]),LChoice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Call(SVar("Nil"),[])))),Call(SVar("implode-string"),[])))),SDef("string-length",[],Seq(Call(SVar("explode-string"),[]),Call(SVar("length"),[])))]),Rules([RDef("Escape",[],Rule(Op("Cons",[Int(34),Var("cs")]),Op("Cons",[Int(92),Op("Cons",[Int(34),Var("cs")])]),Id)),RDef("Escape",[],Rule(Op("Cons",[Int(92),Var("cs")]),Op("Cons",[Int(92),Op("Cons",[Int(92),Var("cs")])]),Id)),RDef("Escape",[],Rule(Op("Cons",[Int(10),Var("cs")]),Op("Cons",[Int(92),Op("Cons",[Int(110),Var("cs")])]),Id)),RDef("UnEscape",[],Rule(Op("Cons",[Int(92),Op("Cons",[Int(34),Var("cs")])]),Op("Cons",[Int(34),Var("cs")]),Id)),RDef("UnEscape",[],Rule(Op("Cons",[Int(92),Op("Cons",[Int(92),Var("cs")])]),Op("Cons",[Int(92),Var("cs")]),Id)),RDef("UnEscape",[],Rule(Op("Cons",[Int(92),Op("Cons",[Int(110),Var("cs")])]),Op("Cons",[Int(10),Var("cs")]),Id)),RDef("S2I1",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Var("n"),Id)),RDef("S2I2",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Op("Cons",[Var("m"),Var("ms")]),Op("TNil",[])])]),Op("TCons",[App(Call(SVar("add"),[]),Op("TCons",[App(Call(SVar("mul"),[]),Op("TCons",[Int(10),Op("TCons",[Var("n"),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("subt"),[]),Op("TCons",[Var("m"),Op("TCons",[Int(48),Op("TNil",[])])])),Op("TNil",[])])])),Op("TCons",[Var("ms"),Op("TNil",[])])]),Where(Seq(BA(Call(SVar("geq"),[]),Op("TCons",[Var("m"),Op("TCons",[Int(48),Op("TNil",[])])])),BA(Call(SVar("leq"),[]),Op("TCons",[Var("m"),Op("TCons",[Int(57),Op("TNil",[])])])))))),RDef("S2D0",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Op("Cons",[Int(46),Var("ys")]),Op("TNil",[])])]),Op("TCons",[Var("n"),Op("TCons",[Int(10),Op("TCons",[Var("ys"),Op("TNil",[])])])]),Id)),RDef("S2D1",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Var("f"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Var("n"),Id)),RDef("S2D2",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Var("f"),Op("TCons",[Op("Cons",[Var("m"),Var("ms")]),Op("TNil",[])])])]),Op("TCons",[App(Call(SVar("add"),[]),Op("TCons",[Var("n"),Op("TCons",[App(Call(SVar("div"),[]),Op("TCons",[App(Call(SVar("subt"),[]),Op("TCons",[Var("m"),Op("TCons",[Int(48),Op("TNil",[])])])),Op("TCons",[Var("f"),Op("TNil",[])])])),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("mul"),[]),Op("TCons",[Var("f"),Op("TCons",[Int(10),Op("TNil",[])])])),Op("TCons",[Var("ms"),Op("TNil",[])])])]),Where(Seq(BA(Call(SVar("geq"),[]),Op("TCons",[Var("m"),Op("TCons",[Int(48),Op("TNil",[])])])),BA(Call(SVar("leq"),[]),Op("TCons",[Var("m"),Op("TCons",[Int(57),Op("TNil",[])])]))))))]),Strategies([SDef("string-to-num",[],Seq(Call(SVar("explode-string"),[]),Seq(Call(SVar("split"),[Build(Int(0)),Id]),Seq(Call(SVar("repeat"),[Call(SVar("S2I2"),[])]),Choice(Call(SVar("S2I1"),[]),Seq(Call(SVar("S2D0"),[]),Seq(Call(SVar("repeat"),[Call(SVar("S2D2"),[])]),Call(SVar("S2D1"),[]))))))))]),Strategies([SDef("lower-case",[],Seq(Call(SVar("explode-string"),[]),Seq(Call(SVar("map"),[Call(SVar("lc"),[])]),Call(SVar("implode-string"),[])))),SDef("lc",[],Call(SVar("try"),[Seq(Where(Call(SVar("sect"),[Call(SVar("geq"),[]),Build(Int(65))])),Seq(Where(Call(SVar("sect"),[Call(SVar("leq"),[]),Build(Int(90))])),Call(SVar("sect"),[Call(SVar("add"),[]),Build(Int(32))])))]))]),Rules([RDef("SplitInit",[],Rule(Var("x"),Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TCons",[Var("x"),Op("TNil",[])])])]),Id)),RDef("SplitExit",[],Rule(Op("TCons",[Var("xs"),Op("TCons",[Var("cs"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),App(Call(SVar("reverse"),[]),Op("Cons",[App(Seq(Call(SVar("reverse"),[]),Call(SVar("implode-string"),[])),Var("cs")),Var("xs")])),Id)),RDef("SplitNext",[],Rule(Op("TCons",[Var("xs"),Op("TCons",[Var("cs"),Op("TCons",[Op("Cons",[Int(32),Var("ys")]),Op("TNil",[])])])]),Op("TCons",[Op("Cons",[App(Seq(Call(SVar("reverse"),[]),Call(SVar("implode-string"),[])),Var("cs")),Var("xs")]),Op("TCons",[Op("Nil",[]),Op("TCons",[Var("ys"),Op("TNil",[])])])]),Id)),RDef("SplitNext",[],Rule(Op("TCons",[Var("xs"),Op("TCons",[Var("cs"),Op("TCons",[Op("Cons",[Var("y"),Var("ys")]),Op("TNil",[])])])]),Op("TCons",[Var("xs"),Op("TCons",[Op("Cons",[Var("y"),Var("cs")]),Op("TCons",[Var("ys"),Op("TNil",[])])])]),Where(BA(Not(Call(SVar("eq"),[])),Op("TCons",[Var("y"),Op("TCons",[Int(32),Op("TNil",[])])])))))]),Strategies([SDef("split-at-space",[],Seq(Call(SVar("explode-string"),[]),Seq(Call(SVar("SplitInit"),[]),Rec("x",LChoice(Call(SVar("SplitExit"),[]),Seq(Call(SVar("SplitNext"),[]),Call(SVar("x"),[]))))))),SDef("basename",[],Seq(Call(SVar("explode-string"),[]),Seq(Call(SVar("try"),[Rec("x",LChoice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Seq(AM(Id,Op("Cons",[Int(46),Wld])),Build(Op("Nil",[])))))]),Call(SVar("implode-string"),[])))),SDef("basename",["ext"],Seq(Call(SVar("explode-string"),[]),Seq(Call(SVar("try"),[Rec("x",LChoice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Seq(Call(SVar("Cons"),[Match(Int(46)),Call(SVar("ext"),[])]),Build(Op("Nil",[])))))]),Call(SVar("implode-string"),[])))),SDef("guarantee-extension",["ext"],Seq(Call(SVar("basename"),[]),Seq(Call(SVar("split"),[Id,BA(Call(SVar("ext"),[]),Op("TNil",[]))]),Call(SVar("add-extension"),[]))))]),Rules([RDef("add-extension",[],Rule(Op("TCons",[Var("name"),Op("TCons",[Var("ext"),Op("TNil",[])])]),App(Call(SVar("concat-strings"),[]),Op("Cons",[Var("name"),Op("Cons",[Str("."),Op("Cons",[Var("ext"),Op("Nil",[])])])])),Id))]),Signature([Sorts([Sort("Option",Kinds([Var("a")]))]),Operations([OpDecl("None",ConstType(Op("Option",[Var("a")]))),OpDecl("Some",FunType([Var("a")],Op("Option",[Var("a")])))])]),Strategies([SDef("option",["s"],Choice(Call(SVar("None"),[]),Call(SVar("Some"),[Call(SVar("s"),[])])))]),Strategies([SDef("reduce",["s"],Call(SVar("repeat"),[Rec("x",Choice(Some(Call(SVar("x"),[])),Call(SVar("s"),[])))])),SDef("outermost",["s"],Call(SVar("repeat"),[Call(SVar("oncetd"),[Call(SVar("s"),[])])])),SDef("innermost'",["s"],Call(SVar("repeat"),[Call(SVar("oncebu"),[Call(SVar("s"),[])])])),SDef("innermost",["s"],Rec("x",Seq(All(Call(SVar("x"),[])),LChoice(Seq(Call(SVar("s"),[]),Call(SVar("x"),[])),Id)))),SDef("innermost''",["s"],Scope(["mark"],Seq(Where(AM(Call(SVar("new"),[]),Var("mark"))),Rec("x",LChoice(AnnMatch(Var("NF"),Var("mark")),Seq(All(Call(SVar("x"),[])),LChoice(Seq(Call(SVar("s"),[]),Call(SVar("x"),[])),AnnBuild(Var("NF"),Var("mark"))))))))),SDef("pseudo-innermost3",["s"],Rec("x",Seq(All(Call(SVar("x"),[])),Rec("y",Call(SVar("try"),[Seq(Call(SVar("s"),[]),Seq(All(Seq(All(Seq(All(Call(SVar("y"),[])),Call(SVar("y"),[]))),Call(SVar("y"),[]))),Call(SVar("y"),[])))])))))]),Signature([Sorts([Sort("Mark",Nokind)]),Operations([OpDecl("NF",ConstType(Var("Mark")))])]),Strategies([SDef("repeat",["s","c"],Rec("x",LChoice(Seq(Call(SVar("s"),[]),Call(SVar("x"),[])),Call(SVar("c"),[])))),SDef("repeat",["s"],Call(SVar("repeat"),[Call(SVar("s"),[]),Id])),SDef("repeat1",["s","c"],Rec("x",Seq(Call(SVar("s"),[]),LChoice(Call(SVar("x"),[]),Call(SVar("c"),[]))))),SDef("repeat1",["s"],Call(SVar("repeat1"),[Call(SVar("s"),[]),Id])),SDef("repeat-until",["s","c"],Rec("x",Seq(Call(SVar("s"),[]),LChoice(Call(SVar("c"),[]),Call(SVar("x"),[]))))),SDef("while",["c","s"],Rec("x",Call(SVar("try"),[Seq(Call(SVar("c"),[]),Seq(Call(SVar("s"),[]),Call(SVar("x"),[])))]))),SDef("do-while",["s","c"],Rec("x",Seq(Call(SVar("s"),[]),Call(SVar("try"),[Seq(Call(SVar("c"),[]),Call(SVar("x"),[]))])))),SDef("while-not",["c","s"],Rec("x",LChoice(Call(SVar("c"),[]),Seq(Call(SVar("s"),[]),Call(SVar("x"),[]))))),SDef("for",["i","c","s"],Seq(Call(SVar("i"),[]),Call(SVar("repeat-until"),[Call(SVar("s"),[]),Call(SVar("c"),[])])))]),Strategies([SDef("use-term",[],Scope(["t"],Seq(AM(Id,Var("t")),Build(Op("Cons",[Op("TCons",[App(Call(SVar("tvars"),[]),Var("t")),Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Op("Nil",[])]))))),SDef("def-term",[],Scope(["t"],Seq(AM(Id,Var("t")),Build(Op("Cons",[Op("TCons",[Op("Nil",[]),Op("TCons",[App(Call(SVar("tvars"),[]),Var("t")),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Op("Nil",[])]))))),SDef("constructs",["x"],Choice(Call(SVar("Build"),[Call(SVar("use-term"),[])]),Choice(Call(SVar("Match"),[Call(SVar("def-term"),[])]),Choice(Call(SVar("MA"),[Call(SVar("def-term"),[]),Call(SVar("x"),[])]),Choice(Call(SVar("AM"),[Call(SVar("x"),[]),Call(SVar("def-term"),[])]),Choice(Call(SVar("BA"),[Call(SVar("x"),[]),Call(SVar("use-term"),[])]),Choice(Call(SVar("BAM"),[Call(SVar("x"),[]),Call(SVar("use-term"),[]),Call(SVar("def-term"),[])]),Choice(Call(SVar("Scope"),[Id,Call(SVar("x"),[])]),Choice(Call(SVar("Rule"),[Call(SVar("def-term"),[]),Call(SVar("use-term"),[]),Call(SVar("x"),[])]),Choice(Call(SVar("Overlay"),[Id,Id,Call(SVar("use-term"),[])]),Call(SVar("Cong"),[Id,Call(SVar("map"),[Call(SVar("x"),[])])])))))))))))]),Rules([RDef("Union",[],Rule(Op("TCons",[Op("TCons",[Var("u1"),Op("TCons",[Var("d1"),Op("TCons",[Var("e1"),Op("TNil",[])])])]),Op("TCons",[Op("TCons",[Var("u2"),Op("TCons",[Var("d2"),Op("TCons",[Var("e2"),Op("TNil",[])])])]),Op("TNil",[])])]),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("u1"),Op("TCons",[Var("u2"),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("d1"),Op("TCons",[Var("d2"),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("e1"),Op("TCons",[Var("e2"),Op("TNil",[])])])),Op("TNil",[])])])]),Id)),RDef("SeqUnion",[],Rule(Op("TCons",[Op("TCons",[Var("u1"),Op("TCons",[Var("d1"),Op("TCons",[Var("e1"),Op("TNil",[])])])]),Op("TCons",[Op("TCons",[Var("u2"),Op("TCons",[Var("d2"),Op("TCons",[Var("e2"),Op("TNil",[])])])]),Op("TNil",[])])]),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("u1"),Op("TCons",[App(Call(SVar("diff"),[]),Op("TCons",[Var("u2"),Op("TCons",[Var("d1"),Op("TNil",[])])])),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("d1"),Op("TCons",[Var("d2"),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("e1"),Op("TCons",[Var("e2"),Op("TNil",[])])])),Op("TNil",[])])])]),Id))]),Strategies([SDef("seq-join",[],Call(SVar("cart"),[Call(SVar("SeqUnion"),[])])),SDef("seqs-join",[],Call(SVar("foldr"),[Build(Op("Cons",[Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Op("Nil",[])])),Call(SVar("cart"),[Call(SVar("SeqUnion"),[])])]))]),Rules([RDef("UDjoin",[],Rule(Op("Seqs",[Var("xs")]),App(Call(SVar("seqs-join"),[]),Var("xs")),Id)),RDef("UDjoin",[],Rule(Op("Seq",[Var("xs"),Var("ys")]),App(Call(SVar("seqs-join"),[]),Op("Cons",[Var("xs"),Op("Cons",[Var("ys"),Op("Nil",[])])])),Id)),RDef("UDjoin",[],Rule(Op("Rule",[Var("l"),Var("r"),Var("c")]),App(Call(SVar("seqs-join"),[]),Op("Cons",[Var("l"),Op("Cons",[Var("c"),Op("Cons",[Var("r"),Op("Nil",[])])])])),Id)),RDef("UDjoin",[],Rule(Op("StratRule",[Var("l"),Var("r"),Var("c")]),App(Call(SVar("seqs-join"),[]),Op("Cons",[Var("l"),Op("Cons",[Var("c"),Op("Cons",[Var("r"),Op("Nil",[])])])])),Id)),RDef("UDjoin",[],Rule(Op("MA",[Var("t"),Var("s")]),App(Call(SVar("seqs-join"),[]),Op("Cons",[Var("t"),Op("Cons",[Var("s"),Op("Nil",[])])])),Id)),RDef("UDjoin",[],Rule(Op("AM",[Var("s"),Var("t")]),App(Call(SVar("seqs-join"),[]),Op("Cons",[Var("s"),Op("Cons",[Var("t"),Op("Nil",[])])])),Id)),RDef("UDjoin",[],Rule(Op("BA",[Var("s"),Var("t")]),App(Call(SVar("seqs-join"),[]),Op("Cons",[Var("t"),Op("Cons",[Var("s"),Op("Nil",[])])])),Id)),RDef("UDjoin",[],Rule(Op("BAM",[Var("s"),Var("t1"),Var("t2")]),App(Call(SVar("seqs-join"),[]),Op("Cons",[Var("t1"),Op("Cons",[Var("s"),Op("Cons",[Var("t2"),Op("Nil",[])])])])),Id)),RDef("UDjoin",[],Rule(Op("Cong",[Var("f"),Var("ss")]),App(Call(SVar("seqs-join"),[]),Var("ss")),Id)),RDef("UDjoin",[],Rule(Op("Scope",[Var("xs"),Var("uds")]),App(Call(SVar("map"),[Call(SVar("JoinScope"),[Build(Var("xs"))])]),Var("uds")),Id)),RDef("UDjoin",[],Rule(Op("Overlay",[Var("f"),Var("xs"),Var("t")]),Op("Overlay",[Var("f"),Var("xs"),App(Call(SVar("seqs-join"),[]),Op("Cons",[Op("TCons",[Op("Nil",[]),Op("TCons",[Var("xs"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Op("Cons",[Var("t"),Op("Nil",[])])]))]),Id)),RDef("JoinScope",["xs"],Rule(Op("TCons",[Var("u"),Op("TCons",[Var("d"),Op("TCons",[Var("e"),Op("TNil",[])])])]),Op("TCons",[Var("u"),Op("TCons",[App(Call(SVar("diff"),[]),Op("TCons",[Var("d"),Op("TCons",[App(Call(SVar("xs"),[]),Op("TNil",[])),Op("TNil",[])])])),Op("TCons",[App(Call(SVar("conc"),[]),Op("TCons",[App(Call(SVar("isect"),[]),Op("TCons",[Var("u"),Op("TCons",[App(Call(SVar("xs"),[]),Op("TNil",[])),Op("TNil",[])])])),Op("TCons",[Var("e"),Op("TNil",[])])])),Op("TNil",[])])])]),Id))]),Strategies([SDef("default-join",[],Seq(Call(SVar("explode-term"),[]),Seq(Call(SVar("Snd"),[]),Call(SVar("foldr"),[Build(Op("Cons",[Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Op("Nil",[])])),Call(SVar("cart"),[Call(SVar("Union"),[])])])))),SDef("use-def",[],Rec("x",Seq(LChoice(Call(SVar("constructs"),[Call(SVar("x"),[])]),All(Call(SVar("x"),[]))),LChoice(Call(SVar("UDjoin"),[]),Call(SVar("default-join"),[])))))]),Strategies([SDef("spec-use-defIO",[],Call(SVar("iowrap"),[Where(Call(SVar("spec-use-def"),[]))])),SDef("spec-use-def",[],Call(SVar("Specification"),[Call(SVar("Cons"),[Call(SVar("Signature"),[Id]),Call(SVar("Cons"),[Call(SVar("Overlays"),[Call(SVar("defs-use-def"),[])]),Call(SVar("Cons"),[Call(SVar("Rules"),[Call(SVar("defs-use-def"),[])]),Call(SVar("Cons"),[Call(SVar("Strategies"),[Call(SVar("defs-use-def"),[])]),Call(SVar("Nil"),[])])])])])])),SDef("defs-use-def",[],Seq(Call(SVar("filter"),[Call(SVar("check"),[])]),AM(Id,Op("Nil",[])))),SDef("check",[],Choice(Seq(Call(SVar("SDef"),[Id,Id,Seq(Call(SVar("use-def"),[]),Not(Call(SVar("Cons"),[Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TNil"),[])])])]),Call(SVar("Nil"),[])])))]),Call(SVar("err-msg"),[])),Choice(Seq(Call(SVar("RDef"),[Id,Id,Seq(Call(SVar("use-def"),[]),Not(Call(SVar("Cons"),[Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TNil"),[])])])]),Call(SVar("Nil"),[])])))]),Call(SVar("err-msg"),[])),Seq(Call(SVar("Overlay"),[Id,Id,Id]),Seq(Call(SVar("use-def"),[]),Seq(Not(Call(SVar("Overlay"),[Id,Id,Call(SVar("Cons"),[Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TNil"),[])])])]),Call(SVar("Nil"),[])])])),Call(SVar("err-msg"),[])))))))]),Rules([RDef("MsgU",[],Rule(Op("Nil",[]),Op("Nil",[]),Id)),RDef("MsgU",[],Rule(Op("Cons",[Var("x"),Op("Nil",[])]),Op("Cons",[Str("variable "),Op("Cons",[Var("x"),Op("Cons",[Str(": used, but not bound"),Op("Nil",[])])])]),Id)),RDef("MsgU",[],Rule(Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("ys")])]),Op("Cons",[Str("variables "),Op("Cons",[Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("ys")])]),Op("Cons",[Str(": used, but not bound"),Op("Nil",[])])])]),Id)),RDef("MsgD",[],Rule(Op("Nil",[]),Op("Nil",[]),Id)),RDef("MsgD",[],Rule(Op("Cons",[Var("x"),Op("Nil",[])]),Op("Cons",[Str("variable "),Op("Cons",[Var("x"),Op("Cons",[Str(": matched, but not declared"),Op("Nil",[])])])]),Id)),RDef("MsgD",[],Rule(Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("ys")])]),Op("Cons",[Str("variables "),Op("Cons",[Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("ys")])]),Op("Cons",[Str(": matched, but not declared"),Op("Nil",[])])])]),Id)),RDef("MsgE",[],Rule(Op("Nil",[]),Op("Nil",[]),Id)),RDef("MsgE",[],Rule(Op("Cons",[Var("x"),Op("Nil",[])]),Op("Cons",[Str("variable "),Op("Cons",[Var("x"),Op("Cons",[Str(": declared, but not bound"),Op("Nil",[])])])]),Id)),RDef("MsgE",[],Rule(Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("ys")])]),Op("Cons",[Str("variables "),Op("Cons",[Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("ys")])]),Op("Cons",[Str(": declared, but not bound"),Op("Nil",[])])])]),Id)),RDef("MsgS",[],Rule(Op("TCons",[Var("u"),Op("TCons",[Var("d"),Op("TCons",[Var("e"),Op("TNil",[])])])]),App(Call(SVar("concat"),[]),Op("Cons",[App(Call(SVar("MsgU"),[]),Var("u")),Op("Cons",[App(Call(SVar("MsgE"),[]),Var("e")),Op("Nil",[])])])),Id)),RDef("MsgR",[],Rule(Op("TCons",[Var("u"),Op("TCons",[Var("d"),Op("TCons",[Var("e"),Op("TNil",[])])])]),App(Call(SVar("concat"),[]),Op("Cons",[App(Call(SVar("MsgU"),[]),Var("u")),Op("Cons",[App(Call(SVar("MsgE"),[]),Var("e")),Op("Nil",[])])])),Id)),RDef("MkMsg",[],Rule(Op("RDef",[Var("l"),Var("xs"),Var("uds")]),Op("Cons",[Str("error in rule "),Op("Cons",[Var("l"),Op("Cons",[Str(" : "),App(Seq(Call(SVar("map"),[Call(SVar("MsgR"),[])]),Call(SVar("concat"),[])),Var("uds"))])])]),Id)),RDef("MkMsg",[],Rule(Op("SDef",[Var("f"),Var("xs"),Var("uds")]),Op("Cons",[Str("error in definition "),Op("Cons",[Var("f"),Op("Cons",[Str(" : "),App(Seq(Call(SVar("map"),[Call(SVar("MsgS"),[])]),Call(SVar("concat"),[])),Var("uds"))])])]),Id)),RDef("MkMsg",[],Rule(Op("Overlay",[Var("f"),Var("xs"),Var("uds")]),Op("Cons",[Str("error in overlay "),Op("Cons",[Var("f"),Op("Cons",[Str(" : "),App(Seq(Call(SVar("map"),[Call(SVar("MsgR"),[])]),Call(SVar("concat"),[])),Var("uds"))])])]),Id))]),Strategies([SDef("err-msg",[],Seq(Call(SVar("MkMsg"),[]),Call(SVar("fatal-error"),[])))]),Rules([RDef("SortL",["s"],Rule(Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("l")])]),Op("Cons",[Var("y"),Op("Cons",[Var("x"),Var("l")])]),Where(BA(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]))))),RDef("LSort",["s"],Rule(Op("Cons",[Var("x"),Var("l")]),Op("Cons",[Var("y"),Op("Cons",[Var("x"),Var("l'")])]),Where(AM(BA(Call(SVar("at-suffix"),[SRule(Rule(Op("Cons",[Var("y"),Var("ys")]),Var("ys"),Where(BA(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])))))]),Var("l")),Var("l'"))))),RDef("Uniq",[],Rule(Op("Cons",[Var("x"),Var("l")]),Var("l"),Where(BA(Call(SVar("fetch"),[AM(Id,Var("x"))]),Var("l"))))),RDef("LMerge",["s"],Rule(Op("Cons",[Var("x"),Var("l")]),Op("Cons",[Var("z"),Var("l'")]),Where(AM(BA(Call(SVar("at-suffix"),[SRule(Rule(Op("Cons",[Var("y"),Var("ys")]),Var("ys"),Where(AM(BA(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])),Var("z")))))]),Var("l")),Var("l'")))))]),Strategies([SDef("sort-list",["s"],Call(SVar("try"),[Rec("x",Seq(LChoice(Call(SVar("s"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])),Call(SVar("try"),[Call(SVar("x"),[])])))])),SDef("isort-list",["s"],Call(SVar("try"),[Rec("x",Seq(LChoice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Call(SVar("s"),[])),Call(SVar("try"),[Call(SVar("x"),[])])))])),SDef("jsort-list",["s"],Call(SVar("try"),[Rec("x",LChoice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Seq(Call(SVar("s"),[]),Call(SVar("try"),[Call(SVar("x"),[])]))))])),SDef("uniq",[],Call(SVar("listbu"),[Call(SVar("repeat"),[Call(SVar("Uniq"),[])])]))]),Strategies([SDef("free-vars",["getvars","boundvars"],Rec("x",LChoice(Call(SVar("getvars"),[]),Seq(Call(SVar("split"),[Call(SVar("collect-kids"),[Call(SVar("x"),[])]),LChoice(Call(SVar("boundvars"),[]),Build(Op("Nil",[])))]),Call(SVar("diff"),[]))))),SDef("free-vars",["getvars","boundvars","boundin"],Rec("x",LChoice(Call(SVar("getvars"),[]),LChoice(Seq(Scope(["vs"],Seq(Where(AM(Call(SVar("boundvars"),[]),Var("vs"))),Call(SVar("boundin"),[Seq(Call(SVar("split"),[Call(SVar("x"),[]),Build(Var("vs"))]),Call(SVar("diff"),[])),Call(SVar("x"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("x"),[])]))))),SDef("free-vars",["getvars","boundvars","boundin","eq"],Rec("x",LChoice(Call(SVar("getvars"),[]),LChoice(Seq(Scope(["vs"],Seq(Where(AM(Call(SVar("boundvars"),[]),Var("vs"))),Call(SVar("boundin"),[Seq(Call(SVar("split"),[Call(SVar("x"),[]),Build(Var("vs"))]),Call(SVar("diff"),[Call(SVar("eq"),[])])),Call(SVar("x"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("x"),[])])))))]),Strategies([SDef("free-vars2",["getvars","boundvars"],Rec("x",Seq(Call(SVar("split"),[LChoice(Call(SVar("getvars"),[]),Build(Op("Nil",[]))),Seq(Call(SVar("split"),[Call(SVar("collect-kids"),[Call(SVar("x"),[])]),LChoice(Call(SVar("boundvars"),[]),Build(Op("Nil",[])))]),Call(SVar("diff"),[]))]),Call(SVar("union"),[])))),SDef("free-vars2",["getvars","boundvars","boundin"],Rec("x",Seq(Call(SVar("split"),[LChoice(Call(SVar("getvars"),[]),Build(Op("Nil",[]))),LChoice(Seq(Scope(["vs"],Seq(Where(AM(Call(SVar("boundvars"),[]),Var("vs"))),Call(SVar("boundin"),[Seq(Call(SVar("split"),[Call(SVar("x"),[]),Build(Var("vs"))]),Call(SVar("diff"),[])),Call(SVar("x"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("x"),[])]))]),Call(SVar("union"),[])))),SDef("free-vars2",["getvars","boundvars","boundin","eq"],Rec("x",Seq(Call(SVar("split"),[LChoice(Call(SVar("getvars"),[]),Build(Op("Nil",[]))),LChoice(Scope(["vs"],Seq(Where(AM(Call(SVar("boundvars"),[]),Var("vs"))),Seq(Call(SVar("boundin"),[Seq(Call(SVar("split"),[Call(SVar("x"),[]),Build(Var("vs"))]),Call(SVar("diff"),[Call(SVar("eq"),[])])),Call(SVar("x"),[]),Build(Op("Nil",[]))]),Call(SVar("collect-kids"),[Id])))),Call(SVar("collect-kids"),[Call(SVar("x"),[])]))]),Call(SVar("union"),[]))))]),Rules([RDef("dist",["s"],Rule(Op("TCons",[Var("t"),Op("TCons",[Var("env"),Op("TNil",[])])]),App(All(LRule(Rule(Var("x"),App(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("env"),Op("TNil",[])])])),Id))),Var("t")),Id)),RDef("d",["s"],Rule(Op("Pair",[Var("t"),Var("env")]),App(Call(SVar("s"),[]),Var("t")),Id)),RDef("t",["s"],Rule(Op("Pair",[Var("t"),Var("env")]),Op("Pair",[App(Call(SVar("s"),[]),Var("t")),Var("env")]),Id)),RDef("coll",["s"],Rule(Explode(Var("f"),Var("xs")),Op("TCons",[Explode(Var("f"),Var("ys")),Op("TCons",[Var("zs"),Op("TNil",[])])]),Where(AM(BA(Call(SVar("unzip"),[Call(SVar("s"),[])]),Var("xs")),Op("TCons",[Var("ys"),Op("TCons",[Var("zs"),Op("TNil",[])])])))))]),Strategies([SDef("env-alltd",["s"],Rec("x",LChoice(Call(SVar("s"),[]),Call(SVar("dist"),[Call(SVar("x"),[])])))),SDef("env-topdown",["s","skip"],Rec("x",Seq(Call(SVar("s"),[]),LChoice(Call(SVar("skip"),[Call(SVar("x"),[])]),Call(SVar("dist"),[Call(SVar("x"),[])]))))),SDef("env-bottomup",["s"],Rec("x",Seq(Call(SVar("split"),[Call(SVar("dist"),[Call(SVar("x"),[])]),Call(SVar("Snd"),[])]),Call(SVar("s"),[])))),SDef("thread-alltd",["s"],Rec("x",LChoice(Call(SVar("s"),[]),Thread(Call(SVar("x"),[])))))]),Rules([RDef("RnVar",["isvar"],Rule(Op("TCons",[Var("t"),Op("TCons",[Var("env"),Op("TNil",[])])]),App(Call(SVar("isvar"),[Seq(Call(SVar("split"),[Id,Build(Var("env"))]),Call(SVar("lookup"),[]))]),Var("t")),Id)),RDef("RnBinding",["bndvrs"],Rule(Op("TCons",[Var("t"),Op("TCons",[Var("env1"),Op("TNil",[])])]),Op("TCons",[Var("t"),Op("TCons",[Var("env1"),Op("TCons",[Var("env2"),Op("TNil",[])])])]),Where(Seq(AM(BA(Call(SVar("bndvrs"),[]),Var("t")),Var("xs")),Seq(AM(Call(SVar("map"),[Call(SVar("new"),[])]),Var("ys")),AM(BA(Call(SVar("conc"),[]),Op("TCons",[App(Call(SVar("zip"),[Id]),Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])])),Op("TCons",[Var("env1"),Op("TNil",[])])])),Var("env2"))))))),RDef("DistBinding",["s"],Rule(Op("TCons",[Var("t"),Op("TCons",[Var("env1"),Op("TCons",[Var("env2"),Op("TNil",[])])])]),App(All(LRule(Rule(Var("x"),App(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("env2"),Op("TNil",[])])])),Id))),Var("t")),Id))]),Strategies([SDef("rename",["isvar","bndvars"],Seq(LRule(Rule(Var("t"),Op("TCons",[Var("t"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),Rec("x",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("isvar"),[])]),Seq(Call(SVar("RnBinding"),[Call(SVar("bndvars"),[])]),Call(SVar("DistBinding"),[Call(SVar("x"),[])])))]))))]),Rules([RDef("DistBinding",["s","boundin"],Rule(Op("TCons",[Var("t"),Op("TCons",[Var("env1"),Op("TCons",[Var("env2"),Op("TNil",[])])])]),App(Call(SVar("boundin"),[LRule(Rule(Var("x"),App(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("env2"),Op("TNil",[])])])),Id)),LRule(Rule(Var("x"),App(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("env1"),Op("TNil",[])])])),Id)),Id]),Var("t")),Id))]),Strategies([SDef("rename",["isvar","bndvars","boundin"],Seq(LRule(Rule(Var("t"),Op("TCons",[Var("t"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),Rec("x",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("isvar"),[])]),Seq(Call(SVar("RnBinding"),[Call(SVar("bndvars"),[])]),Call(SVar("DistBinding"),[Call(SVar("x"),[]),Call(SVar("boundin"),[])])))]))))]),Rules([RDef("RnBinding",["bndvrs","paste"],Rule(Op("TCons",[Var("t"),Op("TCons",[Var("env1"),Op("TNil",[])])]),Op("TCons",[App(Call(SVar("paste"),[Build(Var("ys"))]),Var("t")),Op("TCons",[Var("env1"),Op("TCons",[Var("env2"),Op("TNil",[])])])]),Where(Seq(AM(BA(Call(SVar("bndvrs"),[]),Var("t")),Var("xs")),Seq(AM(Call(SVar("map"),[Call(SVar("new"),[])]),Var("ys")),AM(BA(Call(SVar("conc"),[]),Op("TCons",[App(Call(SVar("zip"),[Id]),Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])])),Op("TCons",[Var("env1"),Op("TNil",[])])])),Var("env2")))))))]),Strategies([SDef("rename",["isvar","bndvars","boundin","paste"],Seq(LRule(Rule(Var("t"),Op("TCons",[Var("t"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),Rec("x",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("isvar"),[])]),Seq(Call(SVar("RnBinding"),[Call(SVar("bndvars"),[]),Call(SVar("paste"),[])]),Call(SVar("DistBinding"),[Call(SVar("x"),[]),Call(SVar("boundin"),[])])))]))))]),Strategies([SDef("filter",["s"],Rec("x",Choice(Call(SVar("Nil"),[]),LChoice(Call(SVar("Cons"),[Call(SVar("s"),[]),Call(SVar("x"),[])]),Seq(Call(SVar("Tl"),[]),Call(SVar("x"),[])))))),SDef("filter-gen",["pred","cont"],Rec("x",Choice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("pred"),[]),Call(SVar("cont"),[Call(SVar("x"),[])])),Seq(Call(SVar("Tl"),[]),Call(SVar("x"),[])))))),SDef("skip1",["s"],Call(SVar("at-tail"),[Call(SVar("s"),[])])),SDef("skip2",["s"],Call(SVar("at-tail"),[Call(SVar("at-tail"),[Call(SVar("s"),[])])])),SDef("filter-option-args",["flag"],Call(SVar("filter-gen"),[Seq(Call(SVar("Cons"),[Call(SVar("flag"),[]),Id]),Call(SVar("Tl"),[])),Call(SVar("skip1"),[])])),SDef("filter-options",["flag"],Call(SVar("filter-gen"),[Call(SVar("Cons"),[Call(SVar("flag"),[]),Id]),Call(SVar("skip2"),[])]))]),Strategies([SDef("member",[],Call(SVar("TCons"),[AM(Id,Var("x")),Call(SVar("TCons"),[Call(SVar("fetch"),[AM(Id,Var("x"))]),Call(SVar("TNil"),[])])]))]),Rules([RDef("FoldR1",[],Rule(Op("Cons",[Var("x"),Op("Cons",[Var("y"),Op("Nil",[])])]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Id)),RDef("FoldR",[],Rule(Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Id)),RDef("TFoldR",[],Rule(Op("TCons",[Var("x"),Var("xs")]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Id)),RDef("FoldL",["s"],Rule(Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Var("xs"),Op("TCons",[App(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])),Op("TNil",[])])]),Id)),RDef("FoldL",["s"],Rule(Op("TCons",[Op("Nil",[]),Op("TCons",[Var("y"),Op("TNil",[])])]),Var("y"),Id)),RDef("lsplit",["f","g"],Rule(Var("x"),Op("Cons",[App(Call(SVar("f"),[]),Var("x")),Op("Cons",[App(Call(SVar("g"),[]),Var("x")),Op("Nil",[])])]),Id))]),Strategies([SDef("foldr1",["s1","s2"],Rec("x",LChoice(Seq(Call(SVar("Cons"),[Id,Call(SVar("Nil"),[])]),Call(SVar("s1"),[])),Seq(Call(SVar("FoldR"),[]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]),Call(SVar("s2"),[])))))),SDef("foldr1",["s"],Rec("x",Seq(LChoice(Call(SVar("FoldR1"),[]),Seq(Call(SVar("FoldR"),[]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]))),Call(SVar("s"),[])))),SDef("foldr",["s1","s2"],Rec("x",Choice(Seq(Call(SVar("Nil"),[]),Call(SVar("s1"),[])),Seq(Call(SVar("FoldR"),[]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]),Call(SVar("s2"),[])))))),SDef("foldr",["s1","s2","f"],Rec("x",Choice(Seq(Call(SVar("Nil"),[]),Call(SVar("s1"),[])),Seq(LRule(Rule(Op("Cons",[Var("y"),Var("ys")]),Op("TCons",[App(Call(SVar("f"),[]),Var("y")),Op("TCons",[App(Call(SVar("x"),[]),Var("ys")),Op("TNil",[])])]),Id)),Call(SVar("s2"),[]))))),SDef("tfoldr",["s1","s2"],Rec("x",Choice(Seq(Call(SVar("TNil"),[]),Call(SVar("s1"),[])),Seq(Call(SVar("TFoldR"),[]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]),Call(SVar("s2"),[])))))),SDef("foldl",["s"],Call(SVar("repeat"),[Call(SVar("FoldL"),[Call(SVar("s"),[])])])),SDef("mapfoldr",["s1","s2","s3"],Rec("x",LChoice(Seq(Call(SVar("Nil"),[]),Call(SVar("s1"),[])),Seq(Call(SVar("Cons"),[Call(SVar("s2"),[]),Call(SVar("x"),[])]),Seq(LRule(Rule(Op("Cons",[Var("a"),Var("b")]),Op("TCons",[Var("a"),Op("TCons",[Var("b"),Op("TNil",[])])]),Id)),Call(SVar("s3"),[])))))),SDef("mapfoldr1",["s1","s2","s3"],Rec("x",LChoice(Seq(Call(SVar("Cons"),[Id,Call(SVar("Nil"),[])]),Call(SVar("s1"),[])),Seq(Call(SVar("Cons"),[Call(SVar("s2"),[]),Call(SVar("x"),[])]),Seq(LRule(Rule(Op("Cons",[Var("a"),Var("b")]),Op("TCons",[Var("a"),Op("TCons",[Var("b"),Op("TNil",[])])]),Id)),Call(SVar("s3"),[])))))),SDef("last",[],Rec("x",LChoice(Call(SVar("Last"),[]),Seq(Call(SVar("Tl"),[]),Call(SVar("x"),[]))))),SDef("init",[],Call(SVar("at-last"),[Call(SVar("Tl"),[])])),SDef("copy",[],Call(SVar("for"),[LRule(Rule(Op("TCons",[Var("n"),Op("TCons",[Var("t"),Op("TNil",[])])]),Op("TCons",[Var("n"),Op("TCons",[Var("t"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Id)),LRule(Rule(Op("TCons",[Int(0),Op("TCons",[Var("t"),Op("TCons",[Var("ts"),Op("TNil",[])])])]),Var("ts"),Id)),LRule(Rule(Op("TCons",[Var("n"),Op("TCons",[Var("t"),Op("TCons",[Var("ts"),Op("TNil",[])])])]),Op("TCons",[App(Call(SVar("subt"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])),Op("TCons",[Var("t"),Op("TCons",[Op("Cons",[Var("t"),Var("ts")]),Op("TNil",[])])])]),Where(BA(Call(SVar("geq"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])))))])),SDef("copy",["s"],Call(SVar("for"),[LRule(Rule(Op("TCons",[Var("n"),Op("TCons",[Var("t"),Op("TNil",[])])]),Op("TCons",[Var("n"),Op("TCons",[Var("t"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])]),Id)),LRule(Rule(Op("TCons",[Int(0),Op("TCons",[Var("t"),Op("TCons",[Var("ts"),Op("TNil",[])])])]),Var("ts"),Id)),LRule(Rule(Op("TCons",[Var("n"),Op("TCons",[Var("t"),Op("TCons",[Var("ts"),Op("TNil",[])])])]),Op("TCons",[App(Call(SVar("subt"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])),Op("TCons",[Var("t"),Op("TCons",[Op("Cons",[App(Call(SVar("s"),[]),Var("t")),Var("ts")]),Op("TNil",[])])])]),Where(BA(Call(SVar("geq"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])))))])),SDef("thread-map",["s"],Rec("x",Choice(Call(SVar(Mod("Cons","T")),[Call(SVar("s"),[]),Call(SVar("x"),[])]),Call(SVar(Mod("Nil","T")),[]))))]),Rules([RDef("Look1",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Op("Cons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Wld]),Op("TNil",[])])]),Var("y"),Id)),RDef("Look2",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Op("Cons",[Wld,Var("xs")]),Op("TNil",[])])]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Id)),RDef("Look1'",["keyeq"],Rule(Op("TCons",[Var("x"),Op("TCons",[Op("Cons",[Var("y"),Wld]),Op("TNil",[])])]),Var("y"),Where(BA(Call(SVar("keyeq"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])))))]),Strategies([SDef("lookup",[],Rec("x",LChoice(Call(SVar("Look1"),[]),Seq(Call(SVar("Look2"),[]),Call(SVar("x"),[]))))),SDef("getfirst",["s"],Rec("x",LChoice(Seq(Call(SVar("Hd"),[]),Call(SVar("s"),[])),Seq(Call(SVar("Tl"),[]),Call(SVar("x"),[]))))),SDef("lookup'",[],Scope(["x","xs"],Seq(AM(Id,Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])])),BA(Call(SVar("getfirst"),[Scope(["y"],SRule(Rule(Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Var("y"),Id)))]),Var("xs"))))),SDef("lookup",["keyeq"],Rec("x",LChoice(Call(SVar("Look1'"),[Call(SVar("keyeq"),[])]),Seq(Call(SVar("Look2"),[]),Call(SVar("x"),[])))))]),Rules([RDef("HdMember",["mklst"],Rule(Op("Cons",[Var("x"),Var("xs")]),Var("xs"),Where(Seq(Call(SVar("mklst"),[]),Call(SVar("fetch"),[AM(Id,Var("x"))]))))),RDef("HdMember'",["eq","mklst"],Rule(Op("Cons",[Var("x"),Var("xs")]),Var("xs"),Where(Seq(Call(SVar("mklst"),[]),Call(SVar("fetch"),[LRule(Rule(Var("y"),App(Call(SVar("eq"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])),Id))])))))]),Rules([RDef("union",[],Rule(Op("TCons",[Var("l1"),Op("TCons",[Var("l2"),Op("TNil",[])])]),App(Rec("x",LChoice(Seq(Call(SVar("Nil"),[]),Build(Var("l2"))),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("l2"))]),Call(SVar("x"),[])),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])))),Var("l1")),Id))]),Strategies([SDef("unions",[],Call(SVar("foldr"),[Build(Op("Nil",[])),Call(SVar("union"),[])]))]),Rules([RDef("diff",[],Rule(Op("TCons",[Var("l1"),Op("TCons",[Var("l2"),Op("TNil",[])])]),App(Rec("x",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("l2"))]),Call(SVar("x"),[])),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])))),Var("l1")),Id))]),Rules([RDef("diff'",["eq"],Rule(Op("TCons",[Var("l1"),Op("TCons",[Var("l2"),Op("TNil",[])])]),App(Rec("x",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember'"),[Call(SVar("eq"),[]),Build(Var("l2"))]),Call(SVar("x"),[])),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])))),Var("l1")),Id))]),Strategies([SDef("diff",["eq"],Call(SVar("diff'"),[Call(SVar("eq"),[])]))]),Rules([RDef("isect",[],Rule(Op("TCons",[Var("l1"),Op("TCons",[Var("l2"),Op("TNil",[])])]),App(Call(SVar("diff"),[]),Op("TCons",[Var("l1"),Op("TCons",[App(Call(SVar("diff"),[]),Op("TCons",[Var("l1"),Op("TCons",[Var("l2"),Op("TNil",[])])])),Op("TNil",[])])])),Id))]),Rules([RDef("foldr-kids",["nul","sum"],Rule(Explode(Wld,Var("xs")),App(Call(SVar("foldr"),[Call(SVar("nul"),[]),Call(SVar("sum"),[])]),Var("xs")),Id)),RDef("foldr-kids",["zero","sum","s"],Rule(Explode(Wld,Var("xs")),App(Call(SVar("foldr"),[Call(SVar("zero"),[]),Call(SVar("sum"),[]),Call(SVar("s"),[])]),Var("xs")),Id))]),Strategies([SDef("collect-kids",["s"],Call(SVar("foldr-kids"),[Build(Op("Nil",[])),Call(SVar("union"),[]),Call(SVar("s"),[])])),SDef("collect",["s"],Rec("x",LChoice(Seq(Call(SVar("s"),[]),LRule(Rule(Var("y"),Op("Cons",[Var("y"),Op("Nil",[])]),Id))),Call(SVar("collect-kids"),[Call(SVar("x"),[])])))),SDef("collect",["s","skip"],Rec("x",LChoice(Seq(Call(SVar("s"),[]),LRule(Rule(Var("y"),Op("Cons",[Var("y"),Op("Nil",[])]),Id))),LChoice(Seq(Call(SVar("skip"),[Call(SVar("x"),[]),Build(Op("Nil",[]))]),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("x"),[])]))))),SDef("bu-collect",["s"],LChoice(Rec("x",LChoice(Seq(Some(Call(SVar("x"),[])),Call(SVar("collect-kids"),[LChoice(Call(SVar("Cons"),[Call(SVar("s"),[]),Id]),Build(Op("Nil",[])))])),Seq(Call(SVar("s"),[]),LRule(Rule(Var("y"),Op("Cons",[Var("y"),Op("Nil",[])]),Id))))),Build(Op("Nil",[])))),SDef("collect-split",["f","g"],Rec("x",LChoice(Seq(Choice(Call(SVar("is-string"),[]),Call(SVar("is-int"),[])),Call(SVar("split"),[Call(SVar("try"),[Call(SVar("f"),[])]),LChoice(Call(SVar("g"),[]),Build(Op("Nil",[])))])),Call(SVar("CollectSplit"),[Call(SVar("x"),[]),Call(SVar("f"),[]),Call(SVar("g"),[])]))))]),Rules([RDef("CollectSplit",["s","f","g"],Rule(Explode(Var("c"),Var("as")),Op("TCons",[Var("t"),Op("TCons",[App(Call(SVar("union"),[]),Op("TCons",[Var("ys"),Op("TCons",[App(Call(SVar("unions"),[]),Var("xs")),Op("TNil",[])])])),Op("TNil",[])])]),Where(Seq(AM(BA(Seq(Call(SVar("list"),[Call(SVar("s"),[])]),Call(SVar("unzip"),[])),Var("as")),Op("TCons",[Var("bs"),Op("TCons",[Var("xs"),Op("TNil",[])])])),AM(BA(Call(SVar("split"),[Call(SVar("try"),[Call(SVar("f"),[])]),LChoice(Call(SVar("g"),[]),Build(Op("Nil",[])))]),Explode(Var("c"),Var("bs"))),Op("TCons",[Var("t"),Op("TCons",[Var("ys"),Op("TNil",[])])]))))))]),Strategies([SDef("nrofoccs",["s"],Rec("count",LChoice(Seq(Call(SVar("s"),[]),Build(Int(1))),Call(SVar("foldr-kids"),[Match(Int(0)),Call(SVar("add"),[]),Call(SVar("count"),[])])))),SDef("twicetd",["s"],Call(SVar("oncetd"),[Seq(Call(SVar("explode-term"),[]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("at_suffix"),[Call(SVar("Cons"),[Call(SVar("oncetd"),[Call(SVar("s"),[])]),Call(SVar("oncetd"),[Call(SVar("s"),[])])])]),Call(SVar("TNil"),[])])]),Call(SVar("mkterm"),[])))])),SDef("atmostonce",["s"],Not(Call(SVar("twicetd"),[Call(SVar("s"),[])]))),SDef("atmostonce'",["s"],Scope(["n"],Seq(AM(Call(SVar("nrofoccs"),[Call(SVar("s"),[])]),Var("n")),BA(Call(SVar("leq"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])))))]),Rules([RDef("Zip1",[],Rule(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Op("Nil",[]),Id)),RDef("Zip1a'",[],Rule(Op("TCons",[Op("Nil",[]),Op("TCons",[Wld,Op("TNil",[])])]),Op("Nil",[]),Id)),RDef("Zip1b'",[],Rule(Op("TCons",[Wld,Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Op("Nil",[]),Id)),RDef("Zip1c",[],Rule(Op("TCons",[Op("Nil",[]),Op("TCons",[Var("x"),Op("TNil",[])])]),Var("x"),Id)),RDef("Zip1c'",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Var("x"),Id)),RDef("Zip1d",[],Rule(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Cons",[Wld,Wld]),Op("TNil",[])])]),Op("Nil",[]),Id)),RDef("Zip2",[],Rule(Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Op("Cons",[Var("y"),Var("ys")]),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TNil",[])])]),Id)),RDef("LZip2",[],Rule(Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("xs"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TNil",[])])]),Id)),RDef("RZip2",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Op("Cons",[Var("y"),Var("ys")]),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("x"),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TNil",[])])]),Id)),RDef("Zip3",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Op("Cons",[Var("x"),Var("xs")]),Id)),RDef("UnZip1",[],Rule(Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),RDef("UnZip2",[],Rule(Op("TCons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TNil",[])])]),Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Op("Cons",[Var("y"),Var("ys")]),Op("TNil",[])])]),Id)),RDef("UnZip3",[],Rule(Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Id)),RDef("NZip00",[],Rule(Var("xs"),Op("TCons",[Int(0),Op("TCons",[Var("xs"),Op("TNil",[])])]),Id)),RDef("NZip01",[],Rule(Var("xs"),Op("TCons",[Int(1),Op("TCons",[Var("xs"),Op("TNil",[])])]),Id)),RDef("NZip1",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Op("Nil",[]),Id)),RDef("NZip2",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Op("Cons",[Var("y"),Var("ys")]),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("n"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[App(Call(SVar("plus"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TNil",[])])]),Id)),RDef("NZip3",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Op("Cons",[Var("x"),Var("xs")]),Id)),RDef("TZip1",[],Rule(Op("TCons",[Var("TNil"),Op("TCons",[Var("TNil"),Op("TNil",[])])]),Var("TNil"),Id)),RDef("TZip2",[],Rule(Op("TCons",[Op("TCons",[Var("x"),Var("xs")]),Op("TCons",[Op("TCons",[Var("y"),Var("ys")]),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TNil",[])])]),Id)),RDef("TZip3",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Op("TCons",[Var("x"),Var("xs")]),Id)),RDef("cart",["s"],Rule(Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])]),App(Seq(Call(SVar("map"),[LRule(Rule(Var("x"),App(Call(SVar("map"),[LRule(Rule(Var("y"),App(Call(SVar("s"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])])),Id))]),Var("ys")),Id))]),Call(SVar("foldr"),[Build(Op("Nil",[])),Call(SVar("union"),[])])),Var("xs")),Id)),RDef("Skip",["s"],Rule(Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TCons",[Var("x"),Op("TCons",[Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TNil",[])])]),Id))]),Strategies([SDef("genzip",["a","b","c","s"],Rec("x",Choice(Call(SVar("a"),[]),Seq(Call(SVar("b"),[]),Seq(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]),Call(SVar("c"),[])))))),SDef("zip",["s"],Call(SVar("genzip"),[Call(SVar("Zip1"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("s"),[])])),SDef("zip'",["s"],Call(SVar("genzip"),[LChoice(Call(SVar("Zip1a'"),[]),Call(SVar("Zip1b'"),[])),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("s"),[])])),SDef("zipl",["s"],Call(SVar("genzip"),[Call(SVar("Zip1a'"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("s"),[])])),SDef("zipr",["s"],Call(SVar("genzip"),[Call(SVar("Zip1b'"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("s"),[])])),SDef("rest-zip",["s"],Seq(Call(SVar("genzip"),[Seq(Choice(AM(Id,Op("TCons",[Op("Nil",[]),Op("TCons",[Wld,Op("TNil",[])])])),AM(Id,Op("TCons",[Wld,Op("TCons",[Op("Nil",[]),Op("TNil",[])])]))),Seq(AM(Id,Op("TCons",[Var("tla"),Op("TCons",[Var("tlb"),Op("TNil",[])])])),Build(Op("Nil",[])))),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("s"),[])]),LRule(Rule(Var("pairs"),Op("TCons",[Var("tla"),Op("TCons",[Var("tlb"),Op("TCons",[Var("pairs"),Op("TNil",[])])])]),Id)))),SDef("unzip",[],Call(SVar("genzip"),[Call(SVar("UnZip1"),[]),Call(SVar("UnZip3"),[]),Call(SVar("UnZip2"),[]),Id])),SDef("unzip",["s"],Call(SVar("genzip"),[Call(SVar("UnZip1"),[]),Call(SVar("UnZip3"),[]),Call(SVar("UnZip2"),[]),Call(SVar("s"),[])])),SDef("nzip0",["s"],Seq(Call(SVar("NZip00"),[]),Call(SVar("genzip"),[Call(SVar("NZip1"),[]),Call(SVar("NZip2"),[]),Call(SVar("NZip3"),[]),Call(SVar("s"),[])]))),SDef("nzip",["s"],Seq(Call(SVar("NZip01"),[]),Call(SVar("genzip"),[Call(SVar("NZip1"),[]),Call(SVar("NZip2"),[]),Call(SVar("NZip3"),[]),Call(SVar("s"),[])]))),SDef("tzip",["s"],Call(SVar("genzip"),[Call(SVar("TZip1"),[]),Call(SVar("TZip2"),[]),Call(SVar("TZip3"),[]),Call(SVar("s"),[])])),SDef("lzip",["s"],Call(SVar("genzip"),[Call(SVar("Zip1a'"),[]),Call(SVar("LZip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("s"),[])])),SDef("rzip",["s"],Call(SVar("genzip"),[Call(SVar("Zip1b'"),[]),Call(SVar("RZip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("s"),[])])),SDef("zipFetch",["s"],Rec("x",Seq(Call(SVar("Zip2"),[]),LChoice(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]))))),SDef("lzipFetch",["s"],Rec("x",Seq(Call(SVar("LZip2"),[]),LChoice(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]))))),SDef("rzipFetch",["s"],Rec("x",Seq(Call(SVar("RZip2"),[]),LChoice(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]))))),SDef("zipPad",["s","padding"],Rec("x",Choice(Call(SVar("Zip1"),[]),Choice(Seq(Call(SVar("Zip2"),[]),Seq(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]),Call(SVar("Zip3"),[]))),Choice(Seq(Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TCons"),[Call(SVar("Cons"),[Id,Id]),Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Build(Op("Cons",[App(Call(SVar("padding"),[]),Op("TNil",[])),Op("Nil",[])])),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Call(SVar("x"),[]))),Seq(Call(SVar("TCons"),[Call(SVar("Cons"),[Id,Id]),Call(SVar("TCons"),[Call(SVar("Nil"),[]),Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Build(Op("Cons",[App(Call(SVar("padding"),[]),Op("TNil",[])),Op("Nil",[])])),Call(SVar("TNil"),[])])]),Call(SVar("x"),[])))))))),SDef("zip-tail",[],Rec("x",Choice(Call(SVar("Zip1c"),[]),Seq(Call(SVar("TCons"),[Call(SVar("Tl"),[]),Call(SVar("TCons"),[Call(SVar("Tl"),[]),Call(SVar("TNil"),[])])]),Call(SVar("x"),[]))))),SDef("zipl-tail-match",["s"],Rec("x",Choice(Call(SVar("Zip1c"),[]),Seq(Call(SVar("Zip2"),[]),Seq(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("Snd"),[]),Call(SVar("x"),[]))))))),SDef("zipr-tail-match",["s"],Rec("x",Choice(Call(SVar("Zip1c'"),[]),Seq(Call(SVar("Zip2"),[]),Seq(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("Snd"),[]),Call(SVar("x"),[]))))))),SDef("zip-skip",["pred","s"],Rec("x",Choice(Call(SVar("Zip1"),[]),Seq(LChoice(Seq(Call(SVar("Skip"),[Call(SVar("pred"),[])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])])),Seq(Call(SVar("Zip2"),[]),Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]))),Call(SVar("Zip3"),[])))))]),Strategies([SDef("tuple-zip",["s"],Rec("x",LChoice(Seq(Call(SVar("split"),[Call(SVar("tmap"),[Call(SVar("Hd"),[])]),Call(SVar("tmap"),[Call(SVar("Tl"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]),Call(SVar("Zip3"),[]))),Seq(Call(SVar("tmap"),[Call(SVar("Nil"),[])]),Build(Op("Nil",[])))))),SDef("tuple-unzip",["s"],Rec("x",LChoice(Seq(Call(SVar("split"),[Call(SVar("map"),[Call(SVar("Thd"),[])]),Call(SVar("map"),[Call(SVar("Ttl"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("TCons"),[Call(SVar("x"),[]),Call(SVar("TNil"),[])])]),LRule(Rule(Op("TCons",[Var("a"),Op("TCons",[Var("b"),Op("TNil",[])])]),Op("TCons",[Var("a"),Var("b")]),Id)))),Seq(Call(SVar("map"),[Call(SVar("TNil"),[])]),Build(Op("TNil",[]))))))]),Rules([RDef("Ind1",[],Rule(Op("TCons",[Int(1),Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TNil",[])])]),Var("x"),Id)),RDef("Ind2",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TNil",[])])]),Op("TCons",[App(Call(SVar("minus"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])),Op("TCons",[Var("xs"),Op("TNil",[])])]),Where(BA(Call(SVar("geq"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(2),Op("TNil",[])])]))))),RDef("Gind0",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TCons",[Int(1),Op("TCons",[Var("x"),Op("TCons",[Var("ys"),Op("TNil",[])])])]),Id)),RDef("Gind1",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Var("x"),Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TNil",[])])])]),Var("n"),Id)),RDef("Gind2",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Var("y"),Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TNil",[])])])]),Op("TCons",[App(Call(SVar("plus"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])),Op("TCons",[Var("y"),Op("TCons",[Var("xs"),Op("TNil",[])])])]),Id))]),Strategies([SDef("index",[],Seq(Call(SVar("repeat"),[Call(SVar("Ind2"),[])]),Call(SVar("Ind1"),[]))),SDef("get_index",[],Seq(Call(SVar("Gind0"),[]),Rec("x",LChoice(Call(SVar("Gind1"),[]),Seq(Call(SVar("Gind2"),[]),Call(SVar("x"),[])))))),SDef("get-index",[],Seq(Call(SVar("Gind0"),[]),Rec("x",LChoice(Call(SVar("Gind1"),[]),Seq(Call(SVar("Gind2"),[]),Call(SVar("x"),[]))))))]),Rules([RDef("Hd",[],Rule(Op("Cons",[Var("x"),Var("l")]),Var("x"),Id)),RDef("Tl",[],Rule(Op("Cons",[Var("x"),Var("l")]),Var("l"),Id)),RDef("Last",[],Rule(Op("Cons",[Var("x"),Op("Nil",[])]),Var("x"),Id)),RDef("MkCons",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Op("Cons",[Var("x"),Op("Nil",[])]),Id)),RDef("MkCons",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Op("Cons",[Var("y"),Var("z")]),Op("TNil",[])])]),Op("Cons",[Var("x"),Op("Cons",[Var("y"),Var("z")])]),Id)),RDef("MkSingleton",[],Rule(Var("x"),Op("Cons",[Var("x"),Op("Nil",[])]),Id))]),Strategies([SDef("is-list",[],Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Id,Id]))),SDef("map",["s"],Rec("x",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("s"),[]),Call(SVar("x"),[])])))),SDef("list",["s"],Rec("x",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("s"),[]),Call(SVar("x"),[])])))),SDef("list-some",["s"],Rec("x",LChoice(Seq(Call(SVar("Cons"),[Call(SVar("s"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("list"),[Call(SVar("try"),[Call(SVar("s"),[])])])])),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])))),SDef("list-some-filter",["s"],Rec("x",LChoice(Seq(Call(SVar("Cons"),[Call(SVar("s"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("filter"),[Call(SVar("s"),[])])])),Seq(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Call(SVar("Tl"),[]))))),SDef("length",[],Rec("x",Choice(Seq(Call(SVar("Nil"),[]),Build(Int(0))),Seq(Call(SVar("Tl"),[]),Seq(Call(SVar("x"),[]),LRule(Rule(Var("n"),App(Call(SVar("add"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])),Id))))))),SDef("fetch",["s"],Rec("x",LChoice(Call(SVar("Cons"),[Call(SVar("s"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])))),SDef("split-fetch",["s"],Seq(Call(SVar("at-suffix"),[Seq(Call(SVar("Cons"),[Call(SVar("s"),[]),Id]),Seq(Call(SVar("Cons"),[Id,AM(Id,Var("tl"))]),Build(Op("Nil",[]))))]),Call(SVar("split"),[Id,Build(Var("tl"))]))),SDef("at-tail",["s"],Call(SVar("Cons"),[Id,Call(SVar("s"),[])])),SDef("at_tail",["s"],Seq(Call(SVar("obsolete"),[Build(Str("at_tail -> at-tail"))]),Call(SVar("Cons"),[Id,Call(SVar("s"),[])]))),SDef("at-end",["s"],Rec("x",Choice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("s"),[]))))),SDef("at_end",["s"],Seq(Call(SVar("obsolete"),[Build(Str("at_end -> at-end"))]),Rec("x",Choice(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("s"),[])))))),SDef("at-suffix",["s"],Rec("x",LChoice(Call(SVar("s"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])))),SDef("at_suffix",["s"],Seq(Call(SVar("obsolete"),[Build(Str("at_suffix -> at-suffix"))]),Rec("x",LChoice(Call(SVar("s"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])]))))),SDef("at_last",["s"],Seq(Call(SVar("obsolete"),[Build(Str("at_last -> at-last"))]),Rec("x",LChoice(Seq(Call(SVar("Cons"),[Id,Call(SVar("Nil"),[])]),Call(SVar("s"),[])),Call(SVar("Cons"),[Id,Call(SVar("x"),[])]))))),SDef("at-last",["s"],Rec("x",LChoice(Seq(Call(SVar("Cons"),[Id,Call(SVar("Nil"),[])]),Call(SVar("s"),[])),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])))),SDef("listbu",["s"],Rec("x",Seq(Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])),Call(SVar("s"),[])))),SDef("listtd",["s"],Rec("x",Seq(Call(SVar("s"),[]),Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])]))))),SDef("listdu",["s"],Rec("x",Seq(Call(SVar("s"),[]),Seq(Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])),Call(SVar("s"),[]))))),SDef("listdu2",["s1","s2"],Rec("x",Seq(Call(SVar("s1"),[]),Seq(Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Id,Call(SVar("x"),[])])),Call(SVar("s2"),[])))))]),Rules([RDef("RevInit",[],Rule(Var("xs"),Op("TCons",[Var("xs"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),RDef("Rev",[],Rule(Op("TCons",[Op("Cons",[Var("x"),Var("xs")]),Op("TCons",[Var("ys"),Op("TNil",[])])]),Op("TCons",[Var("xs"),Op("TCons",[Op("Cons",[Var("x"),Var("ys")]),Op("TNil",[])])]),Id)),RDef("RevExit",[],Rule(Op("TCons",[Op("Nil",[]),Op("TCons",[Var("ys"),Op("TNil",[])])]),Var("ys"),Id))]),Strategies([SDef("reverse",[],Seq(Call(SVar("RevInit"),[]),Seq(Call(SVar("repeat"),[Call(SVar("Rev"),[])]),Call(SVar("RevExit"),[]))))]),Rules([RDef("UptoInit",[],Rule(Var("i"),Op("TCons",[Var("i"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])]),Id)),RDef("UptoExit",[],Rule(Op("TCons",[Var("i"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Var("xs"),Where(BA(Call(SVar("lt"),[]),Op("TCons",[Var("i"),Op("TCons",[Int(0),Op("TNil",[])])]))))),RDef("UptoStep",[],Rule(Op("TCons",[Var("i"),Op("TCons",[Var("xs"),Op("TNil",[])])]),Op("TCons",[App(Call(SVar("minus"),[]),Op("TCons",[Var("i"),Op("TCons",[Int(1),Op("TNil",[])])])),Op("TCons",[Op("Cons",[Var("i"),Var("xs")]),Op("TNil",[])])]),Id))]),Strategies([SDef("upto",[],Seq(Call(SVar("UptoInit"),[]),Rec("x",LChoice(Call(SVar("UptoExit"),[]),Seq(Call(SVar("UptoStep"),[]),Call(SVar("x"),[]))))))]),Rules([RDef("conc",[],Rule(Op("TCons",[Var("l1"),Op("TCons",[Var("l2"),Op("TNil",[])])]),App(Call(SVar("at-end"),[Build(Var("l2"))]),Var("l1")),Id))]),Strategies([SDef("concat",[],Rec("x",Choice(Call(SVar("Nil"),[]),LRule(Rule(Op("Cons",[Var("l"),Var("ls")]),App(Call(SVar("at-end"),[BA(Call(SVar("x"),[]),Var("ls"))]),Var("l")),Id)))))]),Rules([RDef("Sep",["s"],Rule(Op("Cons",[Var("x"),Var("xs")]),Op("Cons",[App(Call(SVar("s"),[]),Op("TNil",[])),Op("Cons",[Var("x"),Var("xs")])]),Id))]),Strategies([SDef("separate-by",["s"],Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Id,Rec("x",Choice(Call(SVar("Nil"),[]),Seq(Call(SVar("Cons"),[Id,Call(SVar("x"),[])]),Call(SVar("Sep"),[Call(SVar("s"),[])]))))])))]),Signature([Sorts([Sort("Prod",Kinds([Var("ListType")]))]),Operations([OpDecl("TNil",ConstType(Op("Prod",[Op("Nil",[])]))),OpDecl("TCons",FunType([Var("a"),Op("Prod",[Var("lt")])],Op("Prod",[Op("Cons",[Var("a"),Var("lt")])]))),OpDecl("Pair",FunType([Var("a"),Var("b")],Op("Prod",[Op("Cons",[Var("a"),Op("Cons",[Var("b"),Op("Nil",[])])])])))])]),Rules([RDef("Fst",[],Rule(Op("TCons",[Var("x"),Var("tp")]),Var("x"),Id)),RDef("Snd",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Var("y"),Var("tp")])]),Var("y"),Id)),RDef("Third",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TCons",[Var("z"),Var("tp")])])]),Var("z"),Id)),RDef("TInd1",[],Rule(Op("TCons",[Int(1),Op("TCons",[Op("TCons",[Var("x"),Var("tp")]),Op("TNil",[])])]),Var("x"),Id)),RDef("TInd2",[],Rule(Op("TCons",[Var("n"),Op("TCons",[Op("TCons",[Var("x"),Var("tp")]),Op("TNil",[])])]),Op("TCons",[App(Call(SVar("minus"),[]),Op("TCons",[Var("n"),Op("TCons",[Int(1),Op("TNil",[])])])),Op("TCons",[Var("tp"),Op("TNil",[])])]),Id)),RDef("Dupl",[],Rule(Var("x"),Op("TCons",[Var("x"),Op("TCons",[Var("x"),Op("TNil",[])])]),Id)),RDef("split",["f","g"],Rule(Var("x"),Op("TCons",[App(Call(SVar("f"),[]),Var("x")),Op("TCons",[App(Call(SVar("g"),[]),Var("x")),Op("TNil",[])])]),Id)),RDef("split3",["f","g","h"],Rule(Var("x"),Op("TCons",[App(Call(SVar("f"),[]),Var("x")),Op("TCons",[App(Call(SVar("g"),[]),Var("x")),Op("TCons",[App(Call(SVar("h"),[]),Var("x")),Op("TNil",[])])])]),Id)),RDef("Swap",[],Rule(Op("TCons",[Var("x"),Op("TCons",[Var("y"),Op("TNil",[])])]),Op("TCons",[Var("y"),Op("TCons",[Var("x"),Op("TNil",[])])]),Id)),RDef("Thd",[],Rule(Op("TCons",[Var("x"),Var("xs")]),Var("x"),Id)),RDef("Ttl",[],Rule(Op("TCons",[Var("x"),Var("xs")]),Var("xs"),Id))]),Strategies([SDef("tindex",[],Rec("x",LChoice(Call(SVar("TInd1"),[]),Seq(Call(SVar("TInd2"),[]),Call(SVar("x"),[]))))),SDef("tmap",["s"],Rec("x",Choice(Call(SVar("TNil"),[]),Call(SVar("TCons"),[Call(SVar("s"),[]),Call(SVar("x"),[])])))),SDef("tconcat",["s"],Rec("y",Choice(SRule(Rule(Var("TNil"),Var("Nil"),Id)),Seq(Scope(["x","xs"],SRule(Rule(Op("TCons",[Var("x"),Var("xs")]),Op("TCons",[Var("x"),Op("TCons",[App(Call(SVar("y"),[]),Var("xs")),Op("TNil",[])])]),Id))),Call(SVar("s"),[]))))),SDef("tconcat'",["s1","s2"],Rec("y",Choice(Seq(Call(SVar("TNil"),[]),Call(SVar("s1"),[])),Seq(Scope(["x","xs"],SRule(Rule(Op("TCons",[Var("x"),Var("xs")]),Op("TCons",[Var("x"),Op("TCons",[App(Call(SVar("y"),[]),Var("xs")),Op("TNil",[])])]),Id))),Call(SVar("s2"),[]))))),SDef("at_tsuffix",["s"],Rec("x",LChoice(Call(SVar("s"),[]),Call(SVar("TCons"),[Id,Call(SVar("x"),[])])))),SDef("tcata",["s1","s2"],Rec("y",LChoice(Seq(Call(SVar("TNil"),[]),Call(SVar("s1"),[])),Seq(Scope(["x","xs"],SRule(Rule(Op("TCons",[Var("x"),Var("xs")]),Op("TCons",[Var("x"),Op("TCons",[App(Call(SVar("y"),[]),Var("xs")),Op("TNil",[])])]),Id))),Call(SVar("s2"),[])))))]),Strategies([SDef("try",["s"],LChoice(Call(SVar("s"),[]),Id)),SDef("if",["c","b"],Call(SVar("try"),[Seq(Call(SVar("c"),[]),Call(SVar("b"),[]))])),SDef("if",["c","b1","b2"],LChoice(Seq(Call(SVar("c"),[]),Call(SVar("b1"),[])),Call(SVar("b2"),[]))),SDef("ior",["a","b"],LChoice(Seq(Call(SVar("a"),[]),Call(SVar("try"),[Call(SVar("b"),[])])),Call(SVar("b"),[]))),SDef("eq",[],Scope(["x"],AM(Id,Op("TCons",[Var("x"),Op("TCons",[Var("x"),Op("TNil",[])])])))),SDef("FAIL",[],Scope(["x"],Seq(AM(Id,Var("x")),AM(Id,Op("TCons",[Var("x"),Op("TCons",[Var("x"),Op("TNil",[])])])))))]),Strategies([SDef("topdown",["s"],Rec("x",Seq(Call(SVar("s"),[]),All(Call(SVar("x"),[]))))),SDef("bottomup",["s"],Rec("x",Seq(All(Call(SVar("x"),[])),Call(SVar("s"),[])))),SDef("downup",["s"],Rec("x",Seq(Call(SVar("s"),[]),Seq(All(Call(SVar("x"),[])),Call(SVar("s"),[]))))),SDef("downup",["s1","s2"],Rec("x",Seq(Call(SVar("s1"),[]),Seq(All(Call(SVar("x"),[])),Call(SVar("s2"),[]))))),SDef("downup2",["s1","s2"],Rec("x",Seq(Call(SVar("s1"),[]),Seq(All(Call(SVar("x"),[])),Call(SVar("s2"),[]))))),SDef("topdown",["s","stop"],Rec("x",Seq(Call(SVar("s"),[]),LChoice(Call(SVar("stop"),[Call(SVar("x"),[])]),All(Call(SVar("x"),[])))))),SDef("bottomup",["s","stop"],Rec("x",Seq(LChoice(Call(SVar("stop"),[Call(SVar("x"),[])]),All(Call(SVar("x"),[]))),Call(SVar("s"),[])))),SDef("downup",["s","stop"],Rec("x",Seq(Call(SVar("s"),[]),Seq(LChoice(Call(SVar("stop"),[Call(SVar("x"),[])]),All(Call(SVar("x"),[]))),Call(SVar("s"),[]))))),SDef("downup2",["s1","s2","stop"],Rec("x",Seq(Call(SVar("s1"),[]),Seq(LChoice(Call(SVar("stop"),[Call(SVar("x"),[])]),All(Call(SVar("x"),[]))),Call(SVar("s2"),[]))))),SDef("don't-stop",["s"],Fail),SDef("spinetd",["s"],Rec("x",Seq(Call(SVar("s"),[]),Call(SVar("try"),[One(Call(SVar("x"),[]))])))),SDef("spinebu",["s"],Rec("x",Seq(Call(SVar("try"),[One(Call(SVar("x"),[]))]),Call(SVar("s"),[])))),SDef("spinetd'",["s"],Rec("x",Seq(Call(SVar("s"),[]),Choice(One(Call(SVar("x"),[])),All(Fail))))),SDef("spinebu'",["s"],Rec("x",Seq(Choice(One(Call(SVar("x"),[])),All(Fail)),Call(SVar("s"),[])))),SDef("somespinetd",["s"],Rec("x",Seq(Call(SVar("s"),[]),Call(SVar("try"),[Some(Call(SVar("x"),[]))])))),SDef("somespinebu",["s"],Rec("x",Seq(Call(SVar("try"),[Some(Call(SVar("x"),[]))]),Call(SVar("s"),[])))),SDef("spinetd'",["s"],Rec("x",Seq(Call(SVar("s"),[]),Choice(One(Call(SVar("x"),[])),All(Fail))))),SDef("spinebu'",["s"],Rec("x",Seq(Choice(One(Call(SVar("x"),[])),All(Fail)),Call(SVar("s"),[])))),SDef("oncetd",["s"],Rec("x",LChoice(Call(SVar("s"),[]),One(Call(SVar("x"),[]))))),SDef("oncebu",["s"],Rec("x",LChoice(One(Call(SVar("x"),[])),Call(SVar("s"),[])))),SDef("oncetd-stop",["s","stop"],Rec("x",LChoice(Call(SVar("s"),[]),Seq(Not(Call(SVar("stop"),[])),One(Call(SVar("x"),[])))))),SDef("sometd",["s"],Rec("x",LChoice(Call(SVar("s"),[]),Some(Call(SVar("x"),[]))))),SDef("somebu",["s"],Rec("x",LChoice(Some(Call(SVar("x"),[])),Call(SVar("s"),[])))),SDef("alltd",["s"],Rec("x",LChoice(Call(SVar("s"),[]),All(Call(SVar("x"),[]))))),SDef("alldownup2",["s1","s2"],Rec("x",Seq(LChoice(Call(SVar("s1"),[]),All(Call(SVar("x"),[]))),Call(SVar("s2"),[])))),SDef("downup2'-obsolete",["s1","s2"],Rec("x",Seq(LChoice(Call(SVar("s1"),[]),All(Call(SVar("x"),[]))),Call(SVar("s2"),[])))),SDef("leaves",["s","is-leaf","skip"],Rec("x",LChoice(Seq(Call(SVar("is-leaf"),[]),Call(SVar("s"),[])),LChoice(Call(SVar("skip"),[Call(SVar("x"),[])]),All(Call(SVar("x"),[])))))),SDef("leaves",["s","is-leaf"],Rec("x",LChoice(Seq(Call(SVar("is-leaf"),[]),Call(SVar("s"),[])),All(Call(SVar("x"),[]))))),SDef("is-leaf",[],Not(One(Id))),SDef("manybu",["s"],Rec("x",LChoice(Seq(Some(Call(SVar("x"),[])),Call(SVar("try"),[Call(SVar("s"),[])])),Call(SVar("s"),[])))),SDef("manytd",["s"],Rec("x",LChoice(Seq(Call(SVar("s"),[]),All(Call(SVar("try"),[Call(SVar("x"),[])]))),Some(Call(SVar("x"),[]))))),SDef("somedownup",["s"],Rec("x",LChoice(Seq(Call(SVar("s"),[]),Seq(All(Call(SVar("x"),[])),Call(SVar("try"),[Call(SVar("s"),[])]))),Seq(Some(Call(SVar("x"),[])),Call(SVar("try"),[Call(SVar("s"),[])]))))),SDef("breadthfirst",["s"],Rec("x",Seq(All(Call(SVar("s"),[])),All(Call(SVar("x"),[])))))]),Strategies([SDef("subs-args",[],LChoice(AM(Id,Op("TCons",[Var("sbs"),Op("TCons",[Var("t"),Op("TNil",[])])])),LRule(Rule(Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TCons",[Var("t"),Op("TNil",[])])])]),Op("TCons",[App(Call(SVar("zip"),[Id]),Op("TCons",[Var("xs"),Op("TCons",[Var("ys"),Op("TNil",[])])])),Op("TCons",[Var("t"),Op("TNil",[])])]),Id))))]),Rules([RDef("SubsVar",["isvar","mksbs"],Rule(Var("t"),App(Call(SVar("lookup"),[]),Op("TCons",[Var("x"),Op("TCons",[Var("sbs"),Op("TNil",[])])])),Where(Seq(AM(BA(Call(SVar("isvar"),[]),Var("t")),Var("x")),AM(Call(SVar("mksbs"),[]),Var("sbs"))))))]),Strategies([SDef("substitute",["isvar","ren"],Seq(AM(Call(SVar("subs-args"),[]),Op("TCons",[Var("sbs"),Op("TCons",[Var("t"),Op("TNil",[])])])),Seq(Build(Var("t")),Call(SVar("alltd"),[Seq(Call(SVar("SubsVar"),[Call(SVar("isvar"),[]),Build(Var("sbs"))]),Call(SVar("ren"),[]))])))),SDef("substitute",["isvar"],Call(SVar("substitute"),[Call(SVar("isvar"),[]),Id])),SDef("substitute",["isvar","varshape","bndvars","boundin","paste","ren"],Seq(AM(Call(SVar("subs-args"),[]),Op("TCons",[Var("sbs"),Op("TCons",[Var("t"),Op("TNil",[])])])),Seq(Build(Op("TCons",[Var("t"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Rec("x",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("varshape"),[])]),LChoice(Seq(Call(SVar("Fst"),[]),Seq(Call(SVar("SubsVar"),[Call(SVar("isvar"),[]),Build(Var("sbs"))]),Call(SVar("ren"),[]))),Seq(Call(SVar("RnBinding"),[Call(SVar("bndvars"),[]),Call(SVar("paste"),[])]),Call(SVar("DistBinding"),[Call(SVar("x"),[]),Call(SVar("boundin"),[])]))))]))))),SDef("substitute",["isvar","varshape","bndvars","boundin","paste"],Call(SVar("substitute"),[Call(SVar("isvar"),[]),Call(SVar("varshape"),[]),Call(SVar("bndvars"),[]),Call(SVar("boundin"),[]),Call(SVar("paste"),[]),Id]))]),Strategies([SDef("subs'",["isvar","mklst"],Seq(Call(SVar("obsolete"),[Build(Str("subs'/2"))]),Call(SVar("subs"),[Call(SVar("isvar"),[]),Call(SVar("mklst"),[])]))),SDef("subs",["isvar"],Seq(Call(SVar("obsolete"),[Build(Str("subs/1"))]),Call(SVar("substitute"),[Call(SVar("isvar"),[])]))),SDef("subs",["isvar","mklst"],Seq(Call(SVar("obsolete"),[Build(Str("subs/2"))]),Seq(Call(SVar("split"),[Call(SVar("mklst"),[]),Id]),Call(SVar("substitute"),[Call(SVar("isvar"),[])])))),SDef("subs_proper",["isvar","ren"],Seq(Call(SVar("obsolete"),[Build(Str("subs_proper/2"))]),Call(SVar("substitute"),[Call(SVar("isvar"),[]),Call(SVar("ren"),[])]))),SDef("subs_proper'",["isvar","ren","mklst"],Seq(Call(SVar("obsolete"),[Build(Str("subs_proper'/2"))]),Seq(Call(SVar("split"),[Call(SVar("mklst"),[]),Id]),Call(SVar("substitute"),[Call(SVar("isvar"),[]),Call(SVar("ren"),[])]))))]),Rules([RDef("Add1",[],Rule(Op("Var",[Var("x")]),Op("Cons",[Var("x"),Op("Nil",[])]),Id)),RDef("Add2",[],Rule(Op("SVar",[Var("x")]),Op("Cons",[Var("x"),Op("Nil",[])]),Id)),RDef("IsVar",[],Rule(Op("Var",[Var("x")]),Var("x"),Id)),RDef("IsSVar",[],Rule(Op("Call",[Op("SVar",[Var("x")]),Op("Nil",[])]),Var("x"),Id)),RDef("MkTVar",[],Rule(Var("x"),Op("Var",[Var("x")]),Id)),RDef("MkSVar",[],Rule(Var("x"),Op("SVar",[Var("x")]),Id)),RDef("MkCall",[],Rule(Var("x"),Op("Call",[Op("SVar",[Var("x")]),Op("Nil",[])]),Id))]),Strategies([SDef("SVarShape",["s"],Call(SVar("Call"),[Call(SVar("SVar"),[Call(SVar("s"),[])]),Call(SVar("Nil"),[])]))]),Rules([RDef("Bind0",[],Rule(Op("Scope",[Var("xs"),Var("s")]),Var("xs"),Id)),RDef("Bind0",[],Rule(Op("LRule",[Op("Rule",[Var("t1"),Var("t2"),Var("s")])]),App(Call(SVar("tvars"),[]),Var("t1")),Id)),RDef("Bind1",[],Rule(Op("Let",[Op("SDef",[Var("f"),Var("xs"),Var("s1")]),Var("s2")]),Op("Cons",[Var("f"),Op("Nil",[])]),Id)),RDef("Bind2",[],Rule(Op("SDef",[Var("f"),Var("xs"),Var("s")]),Var("xs"),Id)),RDef("Bind3",[],Rule(Op("Rec",[Var("x"),Var("s")]),Op("Cons",[Var("x"),Op("Nil",[])]),Id))]),Strategies([SDef("tpaste",["nwvars"],Call(SVar("Scope"),[Call(SVar("nwvars"),[]),Id])),SDef("tboundin",["bnd","ubnd","ignore"],Call(SVar("Scope"),[Call(SVar("ignore"),[]),Call(SVar("bnd"),[])])),SDef("spaste",["nwvars"],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Seq(Call(SVar("nwvars"),[]),Call(SVar("Hd"),[])),Id,Id]),Id]),Choice(Call(SVar("SDef"),[Id,Call(SVar("nwvars"),[]),Id]),Call(SVar("Rec"),[Seq(Call(SVar("nwvars"),[]),Call(SVar("Hd"),[])),Id])))),SDef("sboundin",["bnd","ubnd","ignore"],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Call(SVar("ignore"),[]),Call(SVar("ignore"),[]),Call(SVar("ubnd"),[])]),Call(SVar("bnd"),[])]),Choice(Call(SVar("SDef"),[Call(SVar("ignore"),[]),Call(SVar("ignore"),[]),Call(SVar("bnd"),[])]),Call(SVar("Rec"),[Call(SVar("ignore"),[]),Call(SVar("bnd"),[])]))))]),Strategies([SDef("tvars",[],Call(SVar("free-vars"),[Call(SVar("Add1"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[])])),SDef("svars",[],Call(SVar("free-vars"),[Call(SVar("Add2"),[]),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[])])),SDef("trename",[],Call(SVar("rename"),[Call(SVar("Var"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[]),Call(SVar("tpaste"),[])])),SDef("srename",[],Call(SVar("rename"),[Call(SVar("SVar"),[]),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[]),Call(SVar("spaste"),[])])),SDef("svars-arity",[],Call(SVar("free-vars2"),[LRule(Rule(Op("Call",[Op("SVar",[Var("f")]),Var("as")]),Op("Cons",[Op("TCons",[Var("f"),Op("TCons",[App(Call(SVar("length"),[]),Var("as")),Op("TNil",[])])]),Op("Nil",[])]),Id)),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[]),Scope(["f"],AM(Id,Op("TCons",[Op("TCons",[Var("f"),Op("TCons",[Wld,Op("TNil",[])])]),Op("TCons",[Var("f"),Op("TNil",[])])])))])),SDef("tsubs",[],Call(SVar("substitute"),[Call(SVar("IsVar"),[])])),SDef("ssubs",[],Call(SVar("substitute"),[Call(SVar("IsSVar"),[])])),SDef("tsubstitute",[],Call(SVar("substitute"),[Call(SVar("IsVar"),[]),Call(SVar("Var"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[]),Call(SVar("tpaste"),[])])),SDef("strename",[],Seq(Call(SVar("trename"),[]),Call(SVar("srename"),[]))),SDef("is_var_list",[],Call(SVar("map"),[Call(SVar("Var"),[Id])])),SDef("is_svar_list",[],Call(SVar("map"),[Call(SVar("SVar"),[Id])]))]),Strategies([SDef("conLChoice",["s"],Rec("x",Choice(Call(SVar("s"),[]),Choice(Call(SVar("LChoice"),[Call(SVar("x"),[]),Id]),Call(SVar("LChoice"),[Id,Call(SVar("x"),[])]))))),SDef("conChoice",["s"],Rec("x",Choice(Call(SVar("s"),[]),Choice(Call(SVar("Choice"),[Call(SVar("x"),[]),Id]),Call(SVar("Choice"),[Id,Call(SVar("x"),[])]))))),SDef("conChoiceL",["s"],Choice(Call(SVar("Choice"),[Call(SVar("s"),[]),Id]),Call(SVar("s"),[]))),SDef("choicebu-l'",["s"],Rec("x",Call(SVar("try"),[Seq(Call(SVar("Choice"),[Id,Call(SVar("x"),[])]),Call(SVar("s"),[]))]))),SDef("choicebu-l",["s"],Rec("x",Call(SVar("try"),[Seq(Call(SVar("Choice"),[Call(SVar("x"),[]),Call(SVar("x"),[])]),Call(SVar("s"),[]))]))),SDef("choicetd",["s"],Rec("x",LChoice(Call(SVar("s"),[]),Call(SVar("Choice"),[Call(SVar("x"),[]),Call(SVar("x"),[])])))),SDef("choicemap",["s"],Rec("x",LChoice(Call(SVar("Choice"),[Call(SVar("x"),[]),Call(SVar("x"),[])]),Call(SVar("s"),[])))),SDef("choicebu",["s"],Rec("x",Call(SVar("try"),[Seq(Call(SVar("Choice"),[Call(SVar("x"),[]),Call(SVar("x"),[])]),Call(SVar("s"),[]))]))),SDef("firstInSeq",["s"],LChoice(Call(SVar("s"),[]),Call(SVar("Seq"),[Call(SVar("s"),[]),Id]))),SDef("lastInSeq",["s"],Call(SVar("Seq"),[Id,Rec("x",LChoice(Call(SVar("s"),[]),Call(SVar("Seq"),[Not(Call(SVar("oncetd"),[Call(SVar("s"),[])])),Call(SVar("x"),[])])))]))]),Rules([RDef("HL",[],Rule(Op("Seqs",[Op("Nil",[])]),Var("Id"),Id)),RDef("HL",[],Rule(Op("Seqs",[Op("Cons",[Var("s"),Var("ss")])]),Op("Seq",[Var("s"),Op("Seqs",[Var("ss")])]),Id)),RDef("HL",[],Rule(Op("Choices",[Op("Nil",[])]),Var("Fail"),Id)),RDef("HL",[],Rule(Op("Choices",[Op("Cons",[Var("s"),Var("ss")])]),Op("Choice",[Var("s"),Op("Choices",[Var("ss")])]),Id)),RDef("HL",[],Rule(Op("LChoices",[Op("Nil",[])]),Var("Fail"),Id)),RDef("HL",[],Rule(Op("LChoices",[Op("Cons",[Var("s"),Var("ss")])]),Op("LChoice",[Var("s"),Op("LChoices",[Var("ss")])]),Id)),RDef("HL",[],Rule(Op("Lets",[Op("Nil",[]),Var("s")]),Var("s"),Id)),RDef("HL",[],Rule(Op("Lets",[Op("Cons",[Var("sdef"),Var("sdefs")]),Var("s")]),Op("Let",[Var("sdef"),Op("Lets",[Var("sdefs"),Var("s")])]),Id)),RDef("MkSeq",[],Rule(Op("TCons",[Var("s1"),Op("TCons",[Var("s2"),Op("TNil",[])])]),Op("Seq",[Var("s1"),Var("s2")]),Id))]),Strategies([SDef("seqs",[],Call(SVar("foldr"),[Build(Var("Id")),Call(SVar("MkSeq"),[])]))]),Rules([RDef("HL",[],Rule(Op("BA",[Var("s"),Var("t")]),Op("Seq",[Op("Build",[Var("t")]),Var("s")]),Id)),RDef("HL",[],Rule(Op("MA",[Var("t"),Var("s")]),Op("Seq",[Op("Match",[Var("t")]),Var("s")]),Id)),RDef("HL",[],Rule(Op("AM",[Var("s"),Var("t")]),Op("Seq",[Var("s"),Op("Match",[Var("t")])]),Id)),RDef("HL",[],Rule(Op("BAM",[Var("s"),Var("t1"),Var("t2")]),Op("Seqs",[Op("Cons",[Op("Build",[Var("t1")]),Op("Cons",[Var("s"),Op("Cons",[Op("Match",[Var("t2")]),Op("Nil",[])])])])]),Id))]),Rules([RDef("Bapp0",[],Rule(Op("Build",[Con(Var("t"),Op("App",[Op("Build",[Var("t'")]),Var("t''")]),Call(SVar("oncetd"),[]))]),Op("Build",[Con(Var("t"),Var("t'"),Call(SVar("oncetd"),[]))]),Id)),RDef("Bapp1",[],Rule(Op("Build",[Op("App",[Var("s"),Var("t'")])]),Op("Seq",[Op("Build",[Var("t'")]),Var("s")]),Id)),RDef("Bapp2",[],Rule(Op("Build",[Con(Var("t"),Op("App",[Var("s"),Var("t'")]),Call(SVar("oncetd"),[]))]),Op("Scope",[Op("Cons",[Var("x"),Op("Nil",[])]),Op("Seq",[Op("BAM",[Var("s"),Var("t'"),Op("Var",[Var("x")])]),Op("Build",[Con(Var("t"),Op("Var",[Var("x")]),Call(SVar("oncetd"),[]))])])]),Where(AM(Call(SVar("new"),[]),Var("x")))))]),Rules([RDef("Expl",[],Rule(Op("Match",[Con(Var("t"),Op("Explode",[Var("t1"),Var("t2")]),Call(SVar("oncetd"),[]))]),Op("Scope",[Op("Cons",[Var("x"),Op("Nil",[])]),Op("Seq",[Op("Match",[Con(Var("t"),Op("Var",[Var("x")]),Call(SVar("oncetd"),[]))]),Op("Where",[Op("BAM",[Op("Prim",[Str("_ST_explode_term")]),Op("Var",[Var("x")]),Op("Op",[Str("TCons"),Op("Cons",[Var("t1"),Op("Cons",[Op("Op",[Str("TCons"),Op("Cons",[Var("t2"),Op("Cons",[Op("Op",[Str("TNil"),Op("Nil",[])]),Op("Nil",[])])])]),Op("Nil",[])])])])])])])]),Where(AM(Call(SVar("new"),[]),Var("x"))))),RDef("Expl",[],Rule(Op("Build",[Con(Var("t"),Op("Explode",[Var("t1"),Var("t2")]),Call(SVar("oncetd"),[]))]),Op("Scope",[Op("Cons",[Var("x"),Op("Nil",[])]),Op("Seq",[Op("BAM",[Op("Prim",[Str("_ST_mkterm")]),Op("Op",[Str("TCons"),Op("Cons",[Var("t1"),Op("Cons",[Op("Op",[Str("TCons"),Op("Cons",[Var("t2"),Op("Cons",[Op("Op",[Str("TNil"),Op("Nil",[])]),Op("Nil",[])])])]),Op("Nil",[])])])]),Op("Var",[Var("x")])]),Op("Build",[Con(Var("t"),Op("Var",[Var("x")]),Call(SVar("oncetd"),[]))])])]),Where(AM(Call(SVar("new"),[]),Var("x"))))),RDef("Expl",[],Rule(Op("ExplodeCong",[Var("s1"),Var("s2")]),Op("Seq",[Op("Prim",[Str("_ST_explode_term")]),Op("Seq",[Op("Cong",[Str("TCons"),Op("Cons",[Var("s1"),Op("Cons",[Op("Cong",[Str("TCons"),Op("Cons",[Var("s2"),Op("Cons",[Op("Cong",[Str("TNil"),Op("Nil",[])]),Op("Nil",[])])])]),Op("Nil",[])])])]),Op("Prim",[Str("_ST_mkterm")])])]),Id))]),Strategies([SDef("pureterm",[],Not(Call(SVar("topdown"),[Choice(Call(SVar("Con"),[Id,Id,Id]),Call(SVar("App"),[Id,Id]))]))),SDef("buildterm",[],Not(Call(SVar("topdown"),[Choice(Call(SVar("Con"),[Id,Id,Id]),Call(SVar("Wld"),[]))])))]),Rules([RDef("RtoS",[],Rule(Op("SRule",[Op("Rule",[Var("l"),Var("r"),Var("s")])]),Op("Seqs",[Op("Cons",[Op("Match",[Var("l")]),Op("Cons",[Var("s"),Op("Cons",[Op("Build",[Var("r")]),Op("Nil",[])])])])]),Where(Seq(BA(Call(SVar("pureterm"),[]),Var("l")),BA(Call(SVar("buildterm"),[]),Var("r")))))),RDef("RtoS",[],Rule(Op("SRule",[Op("StratRule",[Var("l"),Var("r"),Var("s")])]),Op("Seqs",[Op("Cons",[Var("l"),Op("Cons",[Var("s"),Op("Cons",[Var("r"),Op("Nil",[])])])])]),Id))]),Rules([RDef("Rcon",[],Rule(Op("SRule",[Op("Rule",[Con(Var("l"),Op("Con",[Op("Var",[Var("c")]),Var("l'"),Var("f")]),Call(SVar("oncetd"),[])),Con(Var("r"),Op("Con",[Op("Var",[Var("c")]),Var("r'"),Op("Call",[Var("f'"),Op("Nil",[])])]),Call(SVar("oncetd"),[])),Var("s")])]),Op("Scope",[Op("Cons",[Var("c'"),Op("Nil",[])]),Op("SRule",[Op("Rule",[Con(Var("l"),Op("Var",[Var("c")]),Call(SVar("oncetd"),[])),Con(Var("r"),Op("Var",[Var("c'")]),Call(SVar("oncetd"),[])),Op("Seq",[Var("s"),Op("BAM",[Op("Call",[Var("f'"),Op("Cons",[Op("SRule",[Op("Rule",[Var("l'"),Var("r'"),Var("Id")])]),Op("Nil",[])])]),Op("Var",[Var("c")]),Op("Var",[Var("c'")])])])])])]),Where(AM(Call(SVar("new"),[]),Var("c'"))))),RDef("Rcon'",[],Rule(Op("SRule",[Op("Rule",[Con(Var("l"),Op("Con",[Op("Var",[Var("c")]),Var("l'"),Var("f")]),Call(SVar("oncetd"),[])),Con(Var("r"),Op("Con",[Op("Var",[Var("c")]),Var("r'"),Op("Call",[Var("f'"),Op("Nil",[])])]),Call(SVar("oncetd"),[])),Var("s")])]),Op("SRule",[Op("Rule",[Con(Var("l"),Op("Var",[Var("c")]),Call(SVar("oncetd"),[])),Con(Var("r"),Op("App",[Op("Call",[Var("f'"),Op("Cons",[Op("SRule",[Op("Rule",[Var("l'"),Var("r'"),Var("Id")])]),Op("Nil",[])])]),Op("Var",[Var("c")])]),Call(SVar("oncetd"),[])),Var("s")])]),Id)),RDef("Rcon''",[],Rule(Op("SRule",[Op("Rule",[Con(Var("l"),Op("Con",[Op("Var",[Var("c")]),Var("l'"),Op("Call",[Var("f"),Op("Nil",[])])]),Call(SVar("oncetd"),[])),Var("r"),Var("s")])]),Op("SRule",[Op("Rule",[Con(Var("l"),Op("Var",[Var("c")]),Call(SVar("oncetd"),[])),Var("r"),Op("Seq",[Var("s"),Op("BA",[Op("Call",[Var("f"),Op("Cons",[Op("Match",[Var("l'")]),Op("Nil",[])])]),Op("Var",[Var("c")])])])])]),Id))]),Strategies([SDef("desugarRule",[],Rec("x",Call(SVar("try"),[Choice(Seq(Call(SVar("Rcon"),[]),Call(SVar("x"),[])),Choice(Call(SVar("Scope"),[Id,Call(SVar("x"),[])]),Call(SVar("RtoS"),[])))])))]),Strategies([SDef("desugar",[],Call(SVar("topdown"),[Seq(Call(SVar("try"),[Call(SVar("desugarRule"),[])]),Call(SVar("repeat"),[Choice(Call(SVar("HL"),[]),Choice(LChoice(Call(SVar("Bapp0"),[]),LChoice(Call(SVar("Bapp1"),[]),Call(SVar("Bapp2"),[]))),Call(SVar("Expl"),[])))]))])),SDef("desugar'",[],Call(SVar("topdown"),[Seq(Call(SVar("try"),[Call(SVar("desugarRule"),[])]),Call(SVar("repeat"),[Call(SVar("HL"),[])]))])),SDef("desugar-spec",[],Call(SVar("map"),[Call(SVar("SDef"),[Id,Id,Call(SVar("desugar"),[])])]))]),Signature([Operations([OpDecl("Final",FunType([Op("List",[Var("Int")])],Var("Automaton"))),OpDecl("Case",FunType([Var("String"),Var("Path"),Op("List",[Var("Alt")]),Var("Automaton")],Var("Automaton"))),OpDecl("Alt",FunType([Var("String"),Op("List",[Var("Path")]),Var("Automaton")],Var("Automaton"))),OpDecl("Continue",FunType([Var("String")],Var("Automaton"))),OpDecl("Assign",FunType([Var("Term"),Var("Term")],Var("Term"))),OpDecl("Assign",FunType([Var("Term")],Var("Term")))])]),Signature([Operations([OpDecl("Row",FunType([Op("List",[Var("Term")]),Var("Strat")],Var("Row"))),OpDecl("Row",FunType([Op("List",[Var("Term")]),Op("List",[Var("Term")]),Var("Strat")],Var("Row"))),OpDecl("Matrix",FunType([Op("List",[Op("List",[Var("Int")])]),Op("List",[Var("Row")])],Var("Matrix"))),OpDecl("Matrix",FunType([Op("List",[Var("Row")])],Var("Matrix"))),OpDecl("Off",FunType([Op("List",[Var("Int")])],Var("Term")))])]),Strategies([SDef("term-to-matrix",[],Seq(LRule(Rule(Var("t"),Op("As",[Op("Off",[Op("Nil",[])]),Op("Cons",[Var("t"),Op("Nil",[])])]),Id)),Seq(Call(SVar("topdown"),[Call(SVar("try"),[Call(SVar("Propagate"),[])])]),Seq(Call(SVar("collect-substitutions"),[]),LRule(Rule(Op("TCons",[Var("ts"),Op("TCons",[Var("s"),Op("TNil",[])])]),Op("Matrix",[App(Call(SVar("collect-offsets"),[]),Var("ts")),Op("Cons",[Op("Row",[Var("ts"),Op("Seqs",[Var("s")])]),Op("Nil",[])])]),Id)))))),SDef("collect-offsets",[],Call(SVar("collect"),[LRule(Rule(Op("Off",[Var("p")]),Var("p"),Id))])),SDef("rename-matrix",[],Seq(Call(SVar("Matrix"),[Call(SVar("map"),[Call(SVar("rename-row"),[])])]),LRule(Rule(Op("Matrix",[Var("rows")]),Op("Matrix",[App(Seq(Call(SVar("map"),[LRule(Rule(Op("Row",[Var("ts"),Var("s")]),Var("ts"),Id))]),Call(SVar("collect-offsets"),[])),Var("rows")),Var("rows")]),Id)))),SDef("rename-row",[],Seq(Call(SVar("RenameRow"),[]),Seq(Call(SVar("Row"),[Call(SVar("topdown"),[Call(SVar("try"),[Call(SVar("Propagate"),[])])]),Id]),Call(SVar("AddRowSubstitutions"),[]))))]),Rules([RDef("RenameRow",[],Rule(Op("Row",[Var("ts"),Var("fin")]),Op("Row",[Op("As",[Op("Off",[Op("Nil",[])]),Var("ts")]),Var("fin")]),Id)),RDef("Propagate",[],Rule(Op("As",[Op("Off",[Var("path")]),Op("Op",[Var("f"),Var("ts")])]),Op("As",[Op("Off",[Var("path")]),Op("Op",[Var("f"),Op("As",[Op("Off",[Var("path")]),Var("ts")])])]),Id)),RDef("Propagate",[],Rule(Op("As",[Op("Off",[Var("path")]),Op("As",[Op("Var",[Var("x")]),Var("t")])]),Op("As",[Op("Var",[Var("x")]),Op("As",[Op("Off",[Var("path")]),Var("t")])]),Id)),RDef("Propagate",[],Rule(Op("As",[Op("Off",[Var("path")]),Op("BuildDefault",[Var("t")])]),Op("As",[Op("Off",[Var("path")]),Var("Wld")]),Id)),RDef("Propagate",[],Rule(Op("As",[Op("Off",[Var("path")]),Var("ts")]),Var("ts'"),Where(AM(BA(Call(SVar("nzip0"),[Call(SVar("Annotate"),[Build(Var("path"))])]),Var("ts")),Var("ts'"))))),RDef("Annotate",["mkpath"],Rule(Op("TCons",[Var("i"),Op("TCons",[Var("t"),Op("TNil",[])])]),Op("As",[Op("Off",[Op("Cons",[Var("i"),Var("path")])]),Var("t")]),Where(AM(Call(SVar("mkpath"),[]),Var("path")))))]),Rules([RDef("AddRowSubstitutions",[],Rule(Op("Row",[Var("ts"),Var("s")]),Op("Row",[Var("ts'"),Op("Seq",[Op("Seqs",[Var("sbs")]),Var("s")])]),Where(AM(BA(Call(SVar("collect-substitutions"),[]),Var("ts")),Op("TCons",[Var("ts'"),Op("TCons",[Var("sbs"),Op("TNil",[])])])))))]),Strategies([SDef("collect-substitutions",[],Call(SVar("collect-split"),[Call(SVar("IgnoreVar"),[]),Call(SVar("CollectSubst"),[])]))]),Rules([RDef("IgnoreVar",[],Rule(Op("As",[Op("Off",[Var("path")]),Op("Var",[Var("x")])]),Op("As",[Op("Off",[Var("path")]),Var("Wld")]),Where(BA(Call(SVar("is-list"),[]),Var("path"))))),RDef("IgnoreVar",[],Rule(Op("As",[Op("Var",[Var("x")]),Op("As",[Op("Off",[Var("path")]),Var("t")])]),Op("As",[Op("Off",[Var("path")]),Var("t")]),Id)),RDef("CollectSubst",[],Rule(Op("As",[Op("Off",[Var("path")]),Op("Var",[Var("x")])]),Op("Cons",[Op("Assign",[Op("Var",[Var("x")]),Op("Var",[Var("path")])]),Op("Nil",[])]),Id)),RDef("CollectSubst",[],Rule(Op("As",[Op("Var",[Var("x")]),Op("As",[Op("Off",[Var("path")]),Var("t")])]),Op("Cons",[Op("Assign",[Op("Var",[Var("x")]),Op("Var",[Var("path")])]),Op("Nil",[])]),Id))]),Signature([Operations([OpDecl("Seqs",FunType([Op("List",[Var("Strat")])],Var("Strat"))),OpDecl("Choices",FunType([Op("List",[Var("Strat")])],Var("Strat"))),OpDecl("LChoices",FunType([Op("List",[Var("Strat")])],Var("Strat"))),OpDecl("Lets",FunType([Op("List",[Var("SDef")]),Var("Strat")],Var("Strat")))])]),Signature([Operations([OpDecl("MA",FunType([Var("Term"),Var("Strat")],Var("Strat"))),OpDecl("AM",FunType([Var("Strat"),Var("Term")],Var("Strat"))),OpDecl("BA",FunType([Var("Strat"),Var("Term")],Var("Strat"))),OpDecl("BAM",FunType([Var("Strat"),Var("Term"),Var("Term")],Var("Strat")))])]),Signature([Operations([OpDecl("Con",FunType([Var("Var"),Var("Term"),Var("SVar")],Var("Term"))),OpDecl("App",FunType([Var("Strat"),Var("Term")],Var("Term"))),OpDecl("Explode",FunType([Var("Term"),Var("Term")],Var("Term"))),OpDecl("ExplodeCong",FunType([Var("Strat"),Var("Strat")],Var("Strat"))),OpDecl("As",FunType([Var("Var"),Var("Term")],Var("Term"))),OpDecl("BuildDefault",FunType([Var("Term")],Var("Term")))])]),Signature([Sorts([Sort("RDef",Nokind),Sort("Rule",Nokind)]),Operations([OpDecl("Rule",FunType([Var("Term"),Var("Term"),Var("Strat")],Var("Rule"))),OpDecl("LRule",FunType([Var("Rule")],Var("Strat"))),OpDecl("SRule",FunType([Var("Rule")],Var("Strat"))),OpDecl("RDef",FunType([Var("String"),Op("List",[Var("String")]),Var("Rule")],Var("RDef")))])]),Signature([Sorts([Sort("Overlay",Nokind)]),Operations([OpDecl("Overlay",FunType([Var("String"),Op("List",[Var("String")]),Var("Term")],Var("Overlay")))])]),Signature([Sorts([Sort("Spec",Nokind),Sort("BSpec",Nokind)]),Operations([OpDecl("Signature",FunType([Op("List",[Var("BSig")])],Var("BSpec"))),OpDecl("Overlays",FunType([Op("List",[Var("Overlay")])],Var("BSpec"))),OpDecl("Rules",FunType([Op("List",[Var("RDef")])],Var("BSpec"))),OpDecl("Strategies",FunType([Op("List",[Var("SDef")])],Var("BSpec"))),OpDecl("Imports",FunType([Op("List",[Var("String")])],Var("BSpec"))),OpDecl("Specification",FunType([Op("List",[Var("BSpec")])],Var("Spec")))])]),Signature([Operations([OpDecl("ConstType",FunType([Var("Term")],Var("Type"))),OpDecl("FunType",FunType([Op("List",[Var("Term")]),Var("Term")],Var("Type")))])]),Signature([Sorts([Sort("BSig",Nokind),Sort("OpDecl",Nokind),Sort("SortDecl",Nokind)]),Operations([OpDecl("Sort",FunType([Var("String"),Op("List",[Var("Kind")])],Var("SortDecl"))),OpDecl("OpDecl",FunType([Var("String"),Var("Type")],Var("OpDecl"))),OpDecl("Sorts",FunType([Op("List",[Var("SortDecl")])],Var("BSig"))),OpDecl("Operations",FunType([Op("List",[Var("OpDecl")])],Var("BSig")))])]),Signature([Sorts([Sort("List",Kinds([Var("Type")]))]),Operations([OpDecl("Nil",ConstType(Op("List",[Var("a")]))),OpDecl("Cons",FunType([Var("a"),Op("List",[Var("a")])],Op("List",[Var("a")])))])]),Signature([Sorts([Sort("Term",Nokind)]),Operations([OpDecl("Wld",ConstType(Var("Term"))),OpDecl("Var",FunType([Var("String")],Var("Term"))),OpDecl("Int",FunType([Var("Int")],Var("Term"))),OpDecl("Real",FunType([Var("Real")],Var("Term"))),OpDecl("Str",FunType([Var("String")],Var("Term"))),OpDecl("Op",FunType([Var("String"),Op("List",[Var("Term")])],Var("Term")))])]),Signature([Sorts([Sort("SDef",Nokind),Sort("Strat",Nokind),Sort("SVar",Nokind)]),Operations([OpDecl("Id",ConstType(Var("Strat"))),OpDecl("Fail",ConstType(Var("Strat"))),OpDecl("Test",FunType([Var("Strat")],Var("Strat"))),OpDecl("Not",FunType([Var("Strat")],Var("Strat"))),OpDecl("Seq",FunType([Var("Strat"),Var("Strat")],Var("Strat"))),OpDecl("Choice",FunType([Var("Strat"),Var("Strat")],Var("Strat"))),OpDecl("LChoice",FunType([Var("Strat"),Var("Strat")],Var("Strat"))),OpDecl("SVar",FunType([Var("String")],Var("SVar"))),OpDecl("Rec",FunType([Var("String"),Var("Strat")],Var("Strat"))),OpDecl("Let",FunType([Var("SDef"),Var("Strat")],Var("Strat"))),OpDecl("SDef",FunType([Var("String"),Op("List",[Var("String")]),Var("Strat")],Var("SDef"))),OpDecl("SDef",FunType([Op("List",[Var("Pragma")]),Var("String"),Op("List",[Var("String")]),Var("Strat")],Var("SDef"))),OpDecl("DontInline",ConstType(Var("Pragma"))),OpDecl("Call",FunType([Var("SVar"),Op("List",[Var("Strat")])],Var("Strat"))),OpDecl("Path",FunType([Var("Int"),Var("Strat")],Var("Strat"))),OpDecl("Cong",FunType([Var("String"),Op("List",[Var("Strat")])],Var("Strat"))),OpDecl("One",FunType([Var("Strat")],Var("Strat"))),OpDecl("Some",FunType([Var("Strat")],Var("Strat"))),OpDecl("All",FunType([Var("Strat")],Var("Strat"))),OpDecl("Thread",FunType([Var("Strat")],Var("Strat")))])]),Signature([Operations([OpDecl("Assign",FunType([Var("Term"),Var("Term")],Var("Strat"))),OpDecl("Match",FunType([Var("Term")],Var("Strat"))),OpDecl("Build",FunType([Var("Term")],Var("Strat"))),OpDecl("MatchVar",FunType([Var("String")],Var("Strat"))),OpDecl("MatchFun",FunType([Var("String")],Var("Strat"))),OpDecl("Scope",FunType([Op("List",[Var("String")]),Var("Strat")],Var("Strat"))),OpDecl("Where",FunType([Var("Strat")],Var("Strat"))),OpDecl("Mark",FunType([Var("Term")],Var("Strat"))),OpDecl("IsMark",FunType([Var("Term")],Var("Strat"))),OpDecl("AnnBuild",FunType([Var("Term"),Var("Term")],Var("Strat"))),OpDecl("AnnMatch",FunType([Var("Term"),Var("Term")],Var("Strat"))),OpDecl("AnnRemove",FunType([Var("Term")],Var("Strat")))])]),Signature([Operations([OpDecl("Prim",FunType([Var("String")],Var("Strat"))),OpDecl("CountRule",FunType([Var("String")],Var("Strat")))])]),Strategies([SDef("match-to-matrix",[],Call(SVar("downup"),[Call(SVar("repeat"),[Choice(Call(SVar("MatchToMatrix"),[]),Choice(Call(SVar("MatrixMerge"),[]),Call(SVar("Simplify"),[])))])]))]),Rules([RDef("MatchToMatrix",[],Rule(Op("Match",[Var("t")]),App(Call(SVar("term-to-matrix"),[]),Var("t")),Id)),RDef("MatrixMerge",[],Rule(Op("Seq",[Op("Matrix",[Var("ps"),Op("Cons",[Op("Row",[Var("ts"),Var("s1")]),Op("Nil",[])])]),Var("s2")]),Op("Matrix",[Var("ps"),Op("Cons",[Op("Row",[Var("ts"),Op("Seq",[Var("s1"),Var("s2")])]),Op("Nil",[])])]),Id)),RDef("MatrixMerge",[],Rule(Op("Scope",[Var("xs"),Op("Matrix",[Var("ps"),Var("rows")])]),Op("Matrix",[Var("ps"),App(Call(SVar("map"),[LRule(Rule(Op("Row",[Var("ts"),Var("s")]),Op("Row",[Var("ts"),Op("Scope",[Var("xs"),Var("s")])]),Id))]),Var("rows"))]),Id)),RDef("MatrixMerge",[],Rule(Op("Choice",[Op("Matrix",[Var("ps1"),Var("rows1")]),Op("Matrix",[Var("ps2"),Var("rows2")])]),Op("Matrix",[App(Call(SVar("union"),[]),Op("TCons",[Var("ps1"),Op("TCons",[Var("ps2"),Op("TNil",[])])])),App(Call(SVar("conc"),[]),Op("TCons",[Var("rows1"),Op("TCons",[Var("rows2"),Op("TNil",[])])]))]),Id)),RDef("MatrixMerge",[],Rule(Op("Choice",[Op("Matrix",[Var("ps1"),Var("rows1")]),Op("Choice",[Op("Matrix",[Var("ps2"),Var("rows2")]),Var("s")])]),Op("Choice",[Op("Matrix",[App(Call(SVar("union"),[]),Op("TCons",[Var("ps1"),Op("TCons",[Var("ps2"),Op("TNil",[])])])),App(Call(SVar("conc"),[]),Op("TCons",[Var("rows1"),Op("TCons",[Var("rows2"),Op("TNil",[])])]))]),Var("s")]),Id)),RDef("MatrixMerge",[],Rule(Op("Choice",[Op("Matrix",[Var("ps1"),Var("rows1")]),Op("LChoice",[Op("Matrix",[Var("ps2"),Var("rows2")]),Var("s")])]),Op("LChoice",[Op("Matrix",[App(Call(SVar("union"),[]),Op("TCons",[Var("ps1"),Op("TCons",[Var("ps2"),Op("TNil",[])])])),App(Call(SVar("conc"),[]),Op("TCons",[Var("rows1"),Op("TCons",[Var("rows2"),Op("TNil",[])])]))]),Var("s")]),Id)),RDef("MatrixMerge",[],Rule(Op("LChoice",[Op("Matrix",[Var("ps1"),Var("rows1")]),Op("Matrix",[Var("ps2"),Var("rows2")])]),Op("Matrix",[App(Call(SVar("union"),[]),Op("TCons",[Var("ps1"),Op("TCons",[Var("ps2"),Op("TNil",[])])])),App(Call(SVar("conc"),[]),Op("TCons",[Var("rows1"),Op("TCons",[Var("rows2"),Op("TNil",[])])]))]),Id)),RDef("MatrixMerge",[],Rule(Op("LChoice",[Op("Matrix",[Var("ps1"),Var("rows1")]),Op("LChoice",[Op("Matrix",[Var("ps2"),Var("rows2")]),Var("s")])]),Op("LChoice",[Op("Matrix",[App(Call(SVar("union"),[]),Op("TCons",[Var("ps1"),Op("TCons",[Var("ps2"),Op("TNil",[])])])),App(Call(SVar("conc"),[]),Op("TCons",[Var("rows1"),Op("TCons",[Var("rows2"),Op("TNil",[])])]))]),Var("s")]),Id)),RDef("MatrixMerge",[],Rule(Op("LChoice",[Op("Matrix",[Var("ps1"),Var("rows1")]),Op("Choice",[Op("Matrix",[Var("ps2"),Var("rows2")]),Var("s")])]),Op("LChoice",[Op("Matrix",[App(Call(SVar("union"),[]),Op("TCons",[Var("ps1"),Op("TCons",[Var("ps2"),Op("TNil",[])])])),App(Call(SVar("conc"),[]),Op("TCons",[Var("rows1"),Op("TCons",[Var("rows2"),Op("TNil",[])])]))]),Var("s")]),Id)),RDef("MatrixMergeNotValid",[],Rule(Op("Seq",[Op("Matrix",[Var("ps"),Var("rows")]),Var("s1")]),Op("Matrix",[Var("ps"),App(Call(SVar("map"),[LRule(Rule(Op("Row",[Var("ts"),Var("s2")]),Op("Row",[Var("ts"),Op("Seq",[Var("s2"),Var("s1")])]),Id))]),Var("rows"))]),Id))]),Strategies([SDef("optimize",[],Call(SVar("apply-to-bodies"),[Seq(Call(SVar("simplify-cong"),[]),Seq(Call(SVar("match-to-dfa"),[]),Seq(Call(SVar("simplify"),[]),Call(SVar("simplify-widen"),[]))))])),SDef("optimize-body",[],Seq(Call(SVar("simplify-cong"),[]),Seq(Call(SVar("match-to-dfa"),[]),Seq(Call(SVar("simplify"),[]),Call(SVar("simplify-widen"),[]))))),SDef("apply-to-bodies",["s"],Call(SVar("map"),[Call(SVar("SDef"),[Id,Id,Call(SVar("s"),[])])])),SDef("optimize1-comp",[],Call(SVar("iowrap"),[Call(SVar("apply-to-bodies"),[Call(SVar("simplify-cong"),[])])])),SDef("compile-match-comp",[],Call(SVar("iowrap"),[Call(SVar("apply-to-bodies"),[Call(SVar("match-to-dfa"),[])])])),SDef("optimize2-comp",[],Call(SVar("iowrap"),[Call(SVar("apply-to-bodies"),[Seq(Call(SVar("simplify"),[]),Call(SVar("simplify-widen"),[]))])])),SDef("match-to-dfa",[],Seq(Call(SVar("match-to-matrix"),[]),Seq(Call(SVar("matrix-to-dfa"),[]),Call(SVar("strename"),[]))))])])
