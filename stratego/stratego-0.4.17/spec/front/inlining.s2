[SDef("IsSVar",[],Scope(["w_11"],Seq(Match(Op("Call",[Op("SVar",[Var("w_11")]),Op("Nil",[])])),Seq(Where(Id),Seq(Build(Var("w_11")),Id))))),SDef("SubsVar",["e_23","f_23"],Scope(["q_11","r_11","s_11"],Seq(Match(Var("q_11")),Seq(Where(Where(Seq(Seq(Seq(Build(Var("q_11")),Call(SVar("e_23"),[])),Match(Var("r_11"))),Seq(Call(SVar("f_23"),[]),Match(Var("s_11")))))),Seq(Seq(Build(Op("TCons",[Var("r_11"),Op("TCons",[Var("s_11"),Op("TNil",[])])])),Call(SVar("lookup"),[])),Id))))),SDef("alltd",["p_35"],Scope([],Rec("q_35",LChoice(Call(SVar("p_35"),[]),All(Call(SVar("q_35"),[])))))),SDef("subs-args",[],Scope(["j_18","k_18"],LChoice(Seq(Id,Match(Op("TCons",[Var("j_18"),Op("TCons",[Var("k_18"),Op("TNil",[])])]))),Scope(["l_18","m_18","n_18"],Seq(Match(Op("TCons",[Var("l_18"),Op("TCons",[Var("m_18"),Op("TCons",[Var("n_18"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Scope(["d_39"],Seq(Seq(Build(Op("TCons",[Var("l_18"),Op("TCons",[Var("m_18"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("d_39")),Id))),Build(Op("TCons",[Var("d_39"),Op("TCons",[Var("n_18"),Op("TNil",[])])])))),Id))))))),SDef("substitute",["m_36","n_36"],Scope(["o_18","p_18"],Seq(Seq(Call(SVar("subs-args"),[]),Match(Op("TCons",[Var("p_18"),Op("TCons",[Var("o_18"),Op("TNil",[])])]))),Seq(Build(Var("o_18")),Call(SVar("alltd"),[Seq(Call(SVar("SubsVar"),[Call(SVar("m_36"),[]),Build(Var("p_18"))]),Call(SVar("n_36"),[]))]))))),SDef("substitute",["o_36"],Scope([],Call(SVar("substitute"),[Call(SVar("o_36"),[]),Id]))),SDef("ssubs",[],Scope([],Call(SVar("substitute"),[Call(SVar("IsSVar"),[])]))),SDef("RenameSDef",["h_23","i_23"],Scope(["t_14","u_14","v_14","w_14"],Seq(Match(Op("SDef",[Var("v_14"),Var("t_14"),Var("u_14")])),Seq(Where(Where(LChoice(Seq(Call(SVar("h_23"),[]),Call(SVar("fetch"),[Seq(Id,Match(Op("TCons",[Var("v_14"),Op("TCons",[Var("w_14"),Op("TNil",[])])])))])),Seq(Build(Var("v_14")),Match(Var("w_14")))))),Seq(Scope(["u_39"],Seq(Seq(Scope(["v_39"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("i_23"),[]),Seq(Match(Var("v_39")),Id))),Build(Op("TCons",[Var("v_39"),Op("TCons",[Var("u_14"),Op("TNil",[])])])))),Seq(Call(SVar("ssubs"),[]),Seq(Match(Var("u_39")),Id))),Build(Op("SDef",[Var("w_14"),Var("t_14"),Var("u_39")])))),Id))))),SDef("MkCall",[],Scope(["z_11"],Seq(Match(Var("z_11")),Seq(Where(Id),Seq(Build(Op("Call",[Op("SVar",[Var("z_11")]),Op("Nil",[])])),Id))))),SDef("NewName",[],Scope(["s_14"],Seq(Match(Op("SDef",[Var("s_14"),Wld,Wld])),Seq(Where(Where(Not(Seq(Build(Var("s_14")),Match(Str("main")))))),Seq(Scope(["n_40"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("new"),[]),Seq(Match(Var("n_40")),Id))),Build(Op("TCons",[Var("s_14"),Op("TCons",[Var("n_40"),Op("TNil",[])])])))),Id))))),SDef("filter",["x_27"],Scope([],Rec("y_27",Choice(Call(SVar("Nil"),[]),LChoice(Call(SVar("Cons"),[Call(SVar("x_27"),[]),Call(SVar("y_27"),[])]),Seq(Call(SVar("Tl"),[]),Call(SVar("y_27"),[]))))))),SDef("rename_sdefs",[],Scope(["o_14","p_14","q_14","r_14"],Seq(Match(Var("q_14")),Seq(Where(Where(Seq(Seq(Seq(Build(Var("q_14")),Call(SVar("filter"),[Call(SVar("NewName"),[])])),Match(Var("o_14"))),Seq(Seq(Seq(Build(Var("o_14")),Call(SVar("map"),[Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("MkCall"),[]),Call(SVar("TNil"),[])])])])),Match(Var("p_14"))),Seq(Seq(Build(Var("q_14")),Call(SVar("map"),[Call(SVar("RenameSDef"),[Build(Var("o_14")),Build(Var("p_14"))])])),Match(Var("r_14"))))))),Seq(Build(Var("r_14")),Id))))),SDef("Fst",[],Scope(["t_10","u_10"],Seq(Match(Op("TCons",[Var("u_10"),Var("t_10")])),Seq(Where(Id),Seq(Build(Var("u_10")),Id))))),SDef("add",[],Scope([],Prim("_ST_add"))),SDef("Tl",[],Scope(["y_9","z_9"],Seq(Match(Op("Cons",[Var("y_9"),Var("z_9")])),Seq(Where(Id),Seq(Build(Var("z_9")),Id))))),SDef("length",[],Scope([],Rec("b_32",Choice(Seq(Call(SVar("Nil"),[]),Build(Int(0))),Seq(Call(SVar("Tl"),[]),Seq(Call(SVar("b_32"),[]),Scope(["x_17"],Seq(Match(Var("x_17")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("x_17"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("add"),[])),Id)))))))))),SDef("MkSDef",[],Scope(["d_13","e_13"],Seq(Match(Op("TCons",[Var("d_13"),Op("TCons",[Var("e_13"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("SDef",[Var("d_13"),Op("Nil",[]),Var("e_13")])),Id))))),SDef("ExtendEnv",[],Scope(["l_14","m_14","n_14"],Seq(Match(Op("TCons",[Var("l_14"),Op("TCons",[Var("m_14"),Op("TCons",[Var("n_14"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Seq(Scope(["e_42"],Seq(Seq(Build(Op("TCons",[Var("l_14"),Op("TCons",[Var("m_14"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Call(SVar("MkSDef"),[])]),Seq(Match(Var("e_42")),Id))),Build(Op("TCons",[Var("e_42"),Op("TCons",[Var("n_14"),Op("TNil",[])])])))),Call(SVar("conc"),[])),Id))))),SDef("Hd",[],Scope(["w_9","x_9"],Seq(Match(Op("Cons",[Var("x_9"),Var("w_9")])),Seq(Where(Id),Seq(Build(Var("x_9")),Id))))),SDef("spaste",["q_37"],Scope([],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Seq(Call(SVar("q_37"),[]),Call(SVar("Hd"),[])),Id,Id]),Id]),Choice(Call(SVar("SDef"),[Id,Call(SVar("q_37"),[]),Id]),Call(SVar("Rec"),[Seq(Call(SVar("q_37"),[]),Call(SVar("Hd"),[])),Id]))))),SDef("Rec",["x_19","y_19"],Cong("Rec",[Call(SVar("x_19"),[]),Call(SVar("y_19"),[])])),SDef("Let",["z_19","a_20"],Cong("Let",[Call(SVar("z_19"),[]),Call(SVar("a_20"),[])])),SDef("sboundin",["r_37","s_37","t_37"],Scope([],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Call(SVar("t_37"),[]),Call(SVar("t_37"),[]),Call(SVar("s_37"),[])]),Call(SVar("r_37"),[])]),Choice(Call(SVar("SDef"),[Call(SVar("t_37"),[]),Call(SVar("t_37"),[]),Call(SVar("r_37"),[])]),Call(SVar("Rec"),[Call(SVar("t_37"),[]),Call(SVar("r_37"),[])]))))),SDef("Bind3",[],Scope(["m_12","n_12"],Seq(Match(Op("Rec",[Var("n_12"),Var("m_12")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("n_12"),Op("Nil",[])])),Id))))),SDef("Bind2",[],Scope(["j_12","k_12","l_12"],Seq(Match(Op("SDef",[Var("j_12"),Var("l_12"),Var("k_12")])),Seq(Where(Id),Seq(Build(Var("l_12")),Id))))),SDef("Bind1",[],Scope(["f_12","g_12","h_12","i_12"],Seq(Match(Op("Let",[Op("SDef",[Var("i_12"),Var("f_12"),Var("g_12")]),Var("h_12")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("i_12"),Op("Nil",[])])),Id))))),SDef("SVar",["w_19"],Cong("SVar",[Call(SVar("w_19"),[])])),SDef("srename",[],Scope([],Call(SVar("rename"),[Call(SVar("SVar"),[]),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[]),Call(SVar("spaste"),[])]))),SDef("tpaste",["m_37"],Scope([],Call(SVar("Scope"),[Call(SVar("m_37"),[]),Id]))),SDef("tboundin",["n_37","o_37","p_37"],Scope([],Call(SVar("Scope"),[Call(SVar("p_37"),[]),Call(SVar("n_37"),[])]))),SDef("Add1",[],Scope(["t_11"],Seq(Match(Op("Var",[Var("t_11")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("t_11"),Op("Nil",[])])),Id))))),SDef("union",[],Scope(["u_6","v_6"],Seq(Match(Op("TCons",[Var("v_6"),Op("TCons",[Var("u_6"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("v_6")),Rec("k_22",LChoice(Seq(Call(SVar("Nil"),[]),Build(Var("u_6"))),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("u_6"))]),Call(SVar("k_22"),[])),Call(SVar("Cons"),[Id,Call(SVar("k_22"),[])]))))),Id))))),SDef("foldr",["o_28","p_28","q_28"],Scope([],Rec("r_28",Choice(Seq(Call(SVar("Nil"),[]),Call(SVar("o_28"),[])),Seq(Scope(["p_16","q_16"],Seq(Match(Op("Cons",[Var("p_16"),Var("q_16")])),Seq(Where(Id),Seq(Scope(["o_43"],Seq(Seq(Build(Var("p_16")),Seq(Call(SVar("q_28"),[]),Seq(Match(Var("o_43")),Id))),Scope(["s_43"],Seq(Seq(Build(Var("q_16")),Seq(Call(SVar("r_28"),[]),Seq(Match(Var("s_43")),Id))),Build(Op("TCons",[Var("o_43"),Op("TCons",[Var("s_43"),Op("TNil",[])])])))))),Id)))),Call(SVar("p_28"),[])))))),SDef("foldr-kids",["q_22","r_22","s_22"],Scope(["d_7"],Seq(Scope(["z_43"],Seq(Match(Var("z_43")),Where(Seq(Build(Var("z_43")),Seq(Prim("_ST_explode_term"),Seq(Match(Op("TCons",[Wld,Op("TCons",[Var("d_7"),Op("TNil",[])])])),Id)))))),Seq(Where(Id),Seq(Seq(Build(Var("d_7")),Call(SVar("foldr"),[Call(SVar("q_22"),[]),Call(SVar("r_22"),[]),Call(SVar("s_22"),[])])),Id))))),SDef("collect-kids",["i_29"],Scope([],Call(SVar("foldr-kids"),[Build(Op("Nil",[])),Call(SVar("union"),[]),Call(SVar("i_29"),[])]))),SDef("HdMember",["h_22"],Scope(["p_6","q_6"],Seq(Match(Op("Cons",[Var("q_6"),Var("p_6")])),Seq(Where(Where(Seq(Call(SVar("h_22"),[]),Call(SVar("fetch"),[Seq(Id,Match(Var("q_6")))])))),Seq(Build(Var("p_6")),Id))))),SDef("diff",[],Scope(["w_6","x_6"],Seq(Match(Op("TCons",[Var("x_6"),Op("TCons",[Var("w_6"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("x_6")),Rec("l_22",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("w_6"))]),Call(SVar("l_22"),[])),Call(SVar("Cons"),[Id,Call(SVar("l_22"),[])]))))),Id))))),SDef("free-vars",["j_26","k_26","l_26"],Scope([],Rec("m_26",LChoice(Call(SVar("j_26"),[]),LChoice(Seq(Scope(["h_16"],Seq(Where(Seq(Call(SVar("k_26"),[]),Match(Var("h_16")))),Call(SVar("l_26"),[Seq(Call(SVar("split"),[Call(SVar("m_26"),[]),Build(Var("h_16"))]),Call(SVar("diff"),[])),Call(SVar("m_26"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("m_26"),[])])))))),SDef("tvars",[],Scope([],Call(SVar("free-vars"),[Call(SVar("Add1"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[])]))),SDef("Bind0",[],Choice(Scope(["a_12","b_12"],Seq(Match(Op("Scope",[Var("b_12"),Var("a_12")])),Seq(Where(Id),Seq(Build(Var("b_12")),Id)))),Choice(Scope(["c_12","d_12","e_12"],Seq(Match(Op("LRule",[Op("Rule",[Var("e_12"),Var("c_12"),Var("d_12")])])),Seq(Where(Id),Seq(Seq(Build(Var("e_12")),Call(SVar("tvars"),[])),Id)))),Fail))),SDef("Var",["i_19"],Cong("Var",[Call(SVar("i_19"),[])])),SDef("DistBinding",["y_21","z_21"],Scope(["o_5","p_5","q_5"],Seq(Match(Op("TCons",[Var("q_5"),Op("TCons",[Var("p_5"),Op("TCons",[Var("o_5"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Seq(Build(Var("q_5")),Call(SVar("z_21"),[Scope(["r_5"],Seq(Match(Var("r_5")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("r_5"),Op("TCons",[Var("o_5"),Op("TNil",[])])])),Call(SVar("y_21"),[])),Id)))),Scope(["s_5"],Seq(Match(Var("s_5")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("s_5"),Op("TCons",[Var("p_5"),Op("TNil",[])])])),Call(SVar("y_21"),[])),Id)))),Id])),Id))))),SDef("Zip3",[],Scope(["g_8","h_8"],Seq(Match(Op("TCons",[Var("g_8"),Op("TCons",[Var("h_8"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("g_8"),Var("h_8")])),Id))))),SDef("Zip2",[],Scope(["w_7","x_7","y_7","z_7"],Seq(Match(Op("TCons",[Op("Cons",[Var("w_7"),Var("y_7")]),Op("TCons",[Op("Cons",[Var("x_7"),Var("z_7")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("TCons",[Var("w_7"),Op("TCons",[Var("x_7"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("y_7"),Op("TCons",[Var("z_7"),Op("TNil",[])])]),Op("TNil",[])])])),Id))))),SDef("Zip1",[],Scope([],Seq(Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Nil",[])),Id))))),SDef("genzip",["h_30","i_30","j_30","k_30"],Scope([],Rec("l_30",Choice(Call(SVar("h_30"),[]),Seq(Call(SVar("i_30"),[]),Seq(Call(SVar("TCons"),[Call(SVar("k_30"),[]),Call(SVar("TCons"),[Call(SVar("l_30"),[]),Call(SVar("TNil"),[])])]),Call(SVar("j_30"),[]))))))),SDef("zip",["m_30"],Scope([],Call(SVar("genzip"),[Call(SVar("Zip1"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("m_30"),[])]))),SDef("at_end",["g_32"],Scope([],Rec("h_32",Choice(Call(SVar("Cons"),[Id,Call(SVar("h_32"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("g_32"),[])))))),SDef("conc",[],Scope(["p_10","q_10"],Seq(Match(Op("TCons",[Var("q_10"),Op("TCons",[Var("p_10"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("q_10")),Call(SVar("at_end"),[Build(Var("p_10"))])),Id))))),SDef("new",[],Scope([],Prim("_ST_new"))),SDef("map",["t_31"],Scope([],Rec("u_31",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("t_31"),[]),Call(SVar("u_31"),[])]))))),SDef("RnBinding",["a_22","b_22"],Scope(["t_5","u_5","v_5","w_5","x_5"],Seq(Match(Op("TCons",[Var("t_5"),Op("TCons",[Var("w_5"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Seq(Build(Var("t_5")),Call(SVar("a_22"),[])),Match(Var("u_5"))),Seq(Seq(Call(SVar("map"),[Call(SVar("new"),[])]),Match(Var("v_5"))),Seq(Seq(Scope(["q_46"],Seq(Seq(Build(Op("TCons",[Var("u_5"),Op("TCons",[Var("v_5"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("q_46")),Id))),Build(Op("TCons",[Var("q_46"),Op("TCons",[Var("w_5"),Op("TNil",[])])])))),Call(SVar("conc"),[])),Match(Var("x_5"))))))),Seq(Scope(["x_46"],Seq(Seq(Build(Var("t_5")),Seq(Call(SVar("b_22"),[Build(Var("v_5"))]),Seq(Match(Var("x_46")),Id))),Build(Op("TCons",[Var("x_46"),Op("TCons",[Var("w_5"),Op("TCons",[Var("x_5"),Op("TNil",[])])])])))),Id))))),SDef("Look2",[],Scope(["l_6","m_6"],Seq(Match(Op("TCons",[Var("l_6"),Op("TCons",[Op("Cons",[Wld,Var("m_6")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("l_6"),Op("TCons",[Var("m_6"),Op("TNil",[])])])),Id))))),SDef("Look1",[],Scope(["j_6","k_6"],Seq(Match(Op("TCons",[Var("j_6"),Op("TCons",[Op("Cons",[Op("TCons",[Var("j_6"),Op("TCons",[Var("k_6"),Op("TNil",[])])]),Wld]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Var("k_6")),Id))))),SDef("lookup",[],Scope([],Rec("c_29",LChoice(Call(SVar("Look1"),[]),Seq(Call(SVar("Look2"),[]),Call(SVar("c_29"),[])))))),SDef("RnVar",["v_21"],Scope(["d_5","e_5"],Seq(Match(Op("TCons",[Var("e_5"),Op("TCons",[Var("d_5"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("e_5")),Call(SVar("v_21"),[Seq(Call(SVar("split"),[Id,Build(Var("d_5"))]),Call(SVar("lookup"),[]))])),Id))))),SDef("dist",["r_21"],Scope(["s_4","t_4"],Seq(Match(Op("TCons",[Var("t_4"),Op("TCons",[Var("s_4"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("t_4")),All(Scope(["u_4"],Seq(Match(Var("u_4")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("u_4"),Op("TCons",[Var("s_4"),Op("TNil",[])])])),Call(SVar("r_21"),[])),Id)))))),Id))))),SDef("env-alltd",["e_27"],Scope([],Rec("f_27",LChoice(Call(SVar("e_27"),[]),Call(SVar("dist"),[Call(SVar("f_27"),[])]))))),SDef("rename",["s_27","t_27","u_27","v_27"],Scope([],Seq(Scope(["n_16"],Seq(Match(Var("n_16")),Seq(Where(Id),Seq(Build(Op("TCons",[Var("n_16"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Id)))),Rec("w_27",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("s_27"),[])]),Seq(Call(SVar("RnBinding"),[Call(SVar("t_27"),[]),Call(SVar("v_27"),[])]),Call(SVar("DistBinding"),[Call(SVar("w_27"),[]),Call(SVar("u_27"),[])])))]))))),SDef("trename",[],Scope([],Call(SVar("rename"),[Call(SVar("Var"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[]),Call(SVar("tpaste"),[])]))),SDef("strename",[],Scope([],Seq(Call(SVar("trename"),[]),Call(SVar("srename"),[])))),SDef("ExpandCall",[],Choice(Scope(["v_13","w_13","x_13","y_13","z_13","a_14"],Seq(Match(Op("TCons",[Op("Call",[Op("SVar",[Var("w_13")]),Var("v_13")]),Op("TCons",[Var("a_14"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Seq(Build(Var("v_13")),Call(SVar("length"),[])),Match(Var("x_13"))),Seq(Build(Var("a_14")),Call(SVar("fetch"),[Call(SVar("SDef"),[Seq(Id,Match(Var("w_13"))),Seq(Where(Seq(Call(SVar("length"),[]),Match(Var("x_13")))),Seq(Id,Match(Var("y_13")))),Seq(Id,Match(Var("z_13")))])]))))),Seq(Scope(["q_48"],Seq(Seq(Build(Var("z_13")),Seq(Call(SVar("strename"),[]),Seq(Match(Var("q_48")),Id))),Scope(["u_48"],Seq(Seq(Build(Op("TCons",[Var("y_13"),Op("TCons",[Var("v_13"),Op("TCons",[Var("a_14"),Op("TNil",[])])])])),Seq(Call(SVar("ExtendEnv"),[]),Seq(Match(Var("u_48")),Id))),Build(Op("TCons",[Var("q_48"),Op("TCons",[Var("u_48"),Op("TNil",[])])])))))),Id)))),Choice(Scope(["b_14","c_14","d_14","e_14"],Seq(Match(Op("TCons",[Op("Call",[Op("SVar",[Var("c_14")]),Var("b_14")]),Op("TCons",[Var("e_14"),Op("TNil",[])])])),Seq(Where(Where(Seq(Build(Var("e_14")),Call(SVar("fetch"),[Seq(Id,Match(Op("SDef",[Var("c_14"),Op("Nil",[]),Op("Call",[Op("SVar",[Var("d_14")]),Op("Nil",[])])])))])))),Seq(Build(Op("TCons",[Op("Call",[Op("SVar",[Var("d_14")]),Var("b_14")]),Op("TCons",[Var("e_14"),Op("TNil",[])])])),Id)))),Fail))),SDef("repeat1",["n_25","o_25"],Scope([],Rec("p_25",Seq(Call(SVar("n_25"),[]),LChoice(Call(SVar("p_25"),[]),Call(SVar("o_25"),[])))))),SDef("repeat1",["q_25"],Scope([],Call(SVar("repeat1"),[Call(SVar("q_25"),[]),Id]))),SDef("Dist",["g_23"],Scope(["i_14","j_14"],Seq(Match(Op("TCons",[Var("i_14"),Op("TCons",[Var("j_14"),Op("TNil",[])])])),Seq(Where(Id),Seq(Scope(["j_49"],Seq(Seq(Build(Var("i_14")),Seq(All(Seq(Scope(["k_14"],Seq(Match(Var("k_14")),Seq(Where(Id),Seq(Build(Op("TCons",[Var("k_14"),Op("TCons",[Var("j_14"),Op("TNil",[])])])),Id)))),Seq(Call(SVar("g_23"),[]),Call(SVar("Fst"),[])))),Seq(Match(Var("j_49")),Id))),Build(Op("TCons",[Var("j_49"),Op("TCons",[Var("j_14"),Op("TNil",[])])])))),Id))))),SDef("expandStrat",[],Scope([],Rec("m_38",Seq(Call(SVar("Dist"),[Call(SVar("m_38"),[])]),Call(SVar("try"),[Seq(Call(SVar("repeat1"),[Call(SVar("ExpandCall"),[])]),Call(SVar("m_38"),[]))]))))),SDef("SplitDefs'",[],Scope(["r_13","s_13","t_13","u_13"],Seq(Match(Op("TCons",[Op("Cons",[Var("s_13"),Var("r_13")]),Op("TCons",[Var("t_13"),Op("TCons",[Var("u_13"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("r_13"),Op("TCons",[Op("Cons",[Var("s_13"),Var("t_13")]),Op("TCons",[Var("u_13"),Op("TNil",[])])])])),Id))))),SDef("Match",["o_20"],Cong("Match",[Call(SVar("o_20"),[])])),SDef("Seq",["q_19","r_19"],Cong("Seq",[Call(SVar("q_19"),[]),Call(SVar("r_19"),[])])),SDef("Scope",["s_20","t_20"],Cong("Scope",[Call(SVar("s_20"),[]),Call(SVar("t_20"),[])])),SDef("SDef",["b_20","c_20","d_20"],Cong("SDef",[Call(SVar("b_20"),[]),Call(SVar("c_20"),[]),Call(SVar("d_20"),[])])),SDef("doInline",[],Scope([],Choice(Call(SVar("SDef"),[Id,Call(SVar("Cons"),[Id,Id]),Id]),Choice(Call(SVar("SDef"),[Not(Match(Str("main"))),Call(SVar("Nil"),[]),Call(SVar("Scope"),[Id,Call(SVar("Seq"),[Call(SVar("Match"),[Id]),Id])])]),Call(SVar("SDef"),[Not(Match(Str("main"))),Call(SVar("Nil"),[]),Call(SVar("Seq"),[Call(SVar("Scope"),[Id,Call(SVar("Seq"),[Call(SVar("Match"),[Id]),Id])]),Id])]))))),SDef("SplitDefs",[],Scope(["n_13","o_13","p_13","q_13"],Seq(Match(Op("TCons",[Op("Cons",[Var("q_13"),Var("n_13")]),Op("TCons",[Var("o_13"),Op("TCons",[Var("p_13"),Op("TNil",[])])])])),Seq(Where(Where(Seq(Build(Var("q_13")),Call(SVar("doInline"),[])))),Seq(Build(Op("TCons",[Var("n_13"),Op("TCons",[Var("o_13"),Op("TCons",[Op("Cons",[Var("q_13"),Var("p_13")]),Op("TNil",[])])])])),Id))))),SDef("repeat",["j_25","k_25"],Scope([],Rec("l_25",LChoice(Seq(Call(SVar("j_25"),[]),Call(SVar("l_25"),[])),Call(SVar("k_25"),[]))))),SDef("repeat",["m_25"],Scope([],Call(SVar("repeat"),[Call(SVar("m_25"),[]),Id]))),SDef("InitExpand",[],Scope(["k_13","l_13","m_13"],Seq(Match(Var("k_13")),Seq(Where(Where(Seq(Seq(Build(Op("TCons",[Var("k_13"),Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])])),Call(SVar("repeat"),[LChoice(Call(SVar("SplitDefs"),[]),Call(SVar("SplitDefs'"),[]))])),Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Var("l_13"),Op("TCons",[Var("m_13"),Op("TNil",[])])])]))))),Seq(Build(Op("TCons",[Var("l_13"),Op("TCons",[Var("m_13"),Op("TNil",[])])])),Id))))),SDef("inline",[],Scope([],Seq(Call(SVar("InitExpand"),[]),Seq(Call(SVar("expandStrat"),[]),Seq(Call(SVar("Fst"),[]),Call(SVar("rename_sdefs"),[])))))),SDef("TNil",[],Cong("TNil",[])),SDef("TCons",["c_19","d_19"],Cong("TCons",[Call(SVar("c_19"),[]),Call(SVar("d_19"),[])])),SDef("report-failure",[],Scope([],Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("rewriting failed"),Op("Nil",[])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))),SDef("try",["m_33"],Scope([],LChoice(Call(SVar("m_33"),[]),Id))),SDef("report-success",[],Scope(["x_15","y_15"],Seq(Where(Call(SVar("try"),[Seq(Call(SVar("TCons"),[Not(Call(SVar("option-defined"),[Seq(Id,Match(Op("Silent",[])))])),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Runtime",[Var("y_15")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("x_15")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Var("x_15"),Op("Cons",[Str(" ("),Op("Cons",[Var("y_15"),Op("Cons",[Str(" secs)"),Op("Nil",[])])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])))))])),Seq(Build(Int(0)),Call(SVar("exit"),[]))))),SDef("WriteToTextFile",[],Scope([],Prim("_ST_WriteToTextFile"))),SDef("WriteToBinaryFile",[],Scope([],Prim("_ST_WriteToBinaryFile"))),SDef("output-file'",[],Scope(["w_15"],Seq(Call(SVar("TCons"),[LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Output",[Var("w_15")])))]),Seq(Build(Op("stdout",[])),Match(Var("w_15")))),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("split"),[Build(Var("w_15")),Id]),Call(SVar("TNil"),[])])]),LChoice(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Binary",[])))]),Call(SVar("TCons"),[Call(SVar("WriteToBinaryFile"),[]),Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("WriteToTextFile"),[]),Call(SVar("TNil"),[])])])))))),SDef("dtime",[],Scope([],Prim("_ST_dtime"))),SDef("apply-strategy",["b_24"],Scope(["t_15"],Seq(Where(Call(SVar("dtime"),[])),Seq(Call(SVar("b_24"),[]),Seq(Where(Seq(Call(SVar("dtime"),[]),Match(Var("t_15")))),Scope(["u_15","v_15"],Seq(Match(Op("TCons",[Var("u_15"),Op("TCons",[Var("v_15"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("Cons",[Op("Runtime",[Var("t_15")]),Var("u_15")]),Op("TCons",[Var("v_15"),Op("TNil",[])])])),Id))))))))),SDef("ReadFromFile",[],Scope([],Prim("_ST_ReadFromFile"))),SDef("split",["z_22","a_23"],Scope(["i_11"],Seq(Match(Var("i_11")),Seq(Where(Id),Seq(Scope(["l_51"],Seq(Seq(Build(Var("i_11")),Seq(Call(SVar("z_22"),[]),Seq(Match(Var("l_51")),Id))),Scope(["p_51"],Seq(Seq(Build(Var("i_11")),Seq(Call(SVar("a_23"),[]),Seq(Match(Var("p_51")),Id))),Build(Op("TCons",[Var("l_51"),Op("TCons",[Var("p_51"),Op("TNil",[])])])))))),Id))))),SDef("input-file'",[],Scope(["s_15"],Seq(LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Input",[Var("s_15")])))]),Seq(Build(Op("stdin",[])),Match(Var("s_15")))),Call(SVar("split"),[Id,Seq(Build(Var("s_15")),Call(SVar("ReadFromFile"),[]))])))),SDef("exit",[],Scope([],Prim("_ST_exit"))),SDef("printnl",[],Scope([],Prim("_ST_printnl"))),SDef("usage'",[],Scope(["r_15"],Where(Seq(Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("r_15")])))]),Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("usage : "),Op("Cons",[Var("r_15"),Op("Cons",[Str(" [-S] [-i file] [-o file] [-b] [-s] [--help|-h|-?]"),Op("Nil",[])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))))),SDef("Undefined",["w_18"],Cong("Undefined",[Call(SVar("w_18"),[])])),SDef("Help",[],Cong("Help",[])),SDef("fetch",["c_32"],Scope([],Rec("d_32",LChoice(Call(SVar("Cons"),[Call(SVar("c_32"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("d_32"),[])]))))),SDef("option-defined",["v_23"],Scope([],Call(SVar("fetch"),[Call(SVar("v_23"),[])]))),SDef("need-help",[],Scope([],Seq(Call(SVar("option-defined"),[Choice(Call(SVar("Help"),[]),Call(SVar("Undefined"),[Id]))]),Call(SVar("usage'"),[])))),SDef("Option",["g_21","h_21"],Scope(["b_3","c_3"],Seq(Match(Op("Cons",[Var("c_3"),Var("b_3")])),Seq(Where(Where(Seq(Build(Var("c_3")),Call(SVar("g_21"),[])))),Seq(Scope(["k_52"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("h_21"),[]),Seq(Match(Var("k_52")),Id))),Build(Op("Cons",[Var("k_52"),Var("b_3")])))),Id))))),SDef("ArgOption",["i_21","j_21"],Scope(["d_3","e_3","f_3"],Seq(Match(Op("Cons",[Var("f_3"),Op("Cons",[Var("d_3"),Var("e_3")])])),Seq(Where(Where(Seq(Build(Var("f_3")),Call(SVar("i_21"),[])))),Seq(Scope(["u_52"],Seq(Seq(Build(Var("d_3")),Seq(Call(SVar("j_21"),[]),Seq(Match(Var("u_52")),Id))),Build(Op("Cons",[Var("u_52"),Var("e_3")])))),Id))))),SDef("io-options",[],Scope([],Choice(Call(SVar("Option"),[Match(Str("-S")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--silent")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--verbose")),Build(Op("Verbose",[]))]),Choice(Call(SVar("Option"),[Match(Str("-v")),Build(Op("Version",[]))]),Choice(Call(SVar("Option"),[Match(Str("--version")),Build(Op("Version",[]))]),Choice(Call(SVar("ArgOption"),[Match(Str("@version")),Scope(["m_15"],Seq(Match(Var("m_15")),Seq(Where(Id),Seq(Build(Op("DeclVersion",[Var("m_15")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-i")),Scope(["n_15"],Seq(Match(Var("n_15")),Seq(Where(Id),Seq(Build(Op("Input",[Var("n_15")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--input")),Scope(["o_15"],Seq(Match(Var("o_15")),Seq(Where(Id),Seq(Build(Op("Input",[Var("o_15")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-o")),Scope(["p_15"],Seq(Match(Var("p_15")),Seq(Where(Id),Seq(Build(Op("Output",[Var("p_15")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--output")),Scope(["q_15"],Seq(Match(Var("q_15")),Seq(Where(Id),Seq(Build(Op("Output",[Var("q_15")])),Id))))]),Choice(Call(SVar("Option"),[Match(Str("-b")),Build(Op("Binary",[]))]),Choice(Call(SVar("Option"),[Match(Str("-s")),Build(Op("Statistics",[]))]),Choice(Call(SVar("Option"),[Match(Str("--help")),Build(Op("Help",[]))]),Choice(Call(SVar("Option"),[Match(Str("-h")),Build(Op("Help",[]))]),Call(SVar("Option"),[Match(Str("-?")),Build(Op("Help",[]))]))))))))))))))))),SDef("UndefinedOption",[],Scope(["k_3","l_3"],Seq(Match(Op("Cons",[Var("k_3"),Var("l_3")])),Seq(Where(Id),Seq(Build(Op("Cons",[Op("Undefined",[Var("k_3")]),Var("l_3")])),Id))))),SDef("Cons",["g_19","h_19"],Cong("Cons",[Call(SVar("g_19"),[]),Call(SVar("h_19"),[])])),SDef("Nil",[],Cong("Nil",[])),SDef("parse-options",["s_23"],Scope([],Call(SVar("Cons"),[Scope(["l_15"],Seq(Match(Var("l_15")),Seq(Where(Id),Seq(Build(Op("Program",[Var("l_15")])),Id)))),Rec("t_23",LChoice(Choice(Call(SVar("Nil"),[]),Seq(Call(SVar("s_23"),[]),Call(SVar("Cons"),[Id,Call(SVar("t_23"),[])]))),Call(SVar("UndefinedOption"),[])))]))),SDef("iowrapO",["y_23","z_23"],Scope([],Seq(Call(SVar("parse-options"),[LChoice(Call(SVar("z_23"),[]),Call(SVar("io-options"),[]))]),LChoice(Call(SVar("need-help"),[]),LChoice(Seq(Call(SVar("input-file'"),[]),Seq(Call(SVar("apply-strategy"),[Call(SVar("y_23"),[])]),Seq(Call(SVar("output-file'"),[]),Call(SVar("report-success"),[])))),Call(SVar("report-failure"),[])))))),SDef("iowrap",["x_23"],Scope([],Call(SVar("iowrapO"),[Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("x_23"),[]),Call(SVar("TNil"),[])])]),Fail]))),SDef("inlineIO",[],Scope([],Call(SVar("iowrap"),[Call(SVar("inline"),[])]))),SDef("main",[],Scope([],Call(SVar("inlineIO"),[])))]
