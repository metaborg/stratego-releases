[SDef("IsVar",[],Scope(["z_14"],Seq(Match(Op("Var",[Var("z_14")])),Seq(Where(Id),Seq(Build(Var("z_14")),Id))))),SDef("alltd",["k_38"],Scope([],Rec("l_38",LChoice(Call(SVar("k_38"),[]),All(Call(SVar("l_38"),[])))))),SDef("subs",["y_39","z_39"],Scope(["n_19"],Seq(Call(SVar("obsolete"),[Build(Str("subs/2"))]),Seq(Call(SVar("debug"),[Build(Str("subs/2 a: "))]),Seq(Where(Seq(Call(SVar("z_39"),[]),Match(Var("n_19")))),Call(SVar("alltd"),[Seq(Call(SVar("y_39"),[]),Scope(["o_19"],Scope(["p_19"],Seq(Match(Var("p_19")),Seq(Where(Where(Seq(Build(Var("n_19")),Call(SVar("fetch"),[Seq(Id,Match(Op("TCons",[Var("p_19"),Op("TCons",[Var("o_19"),Op("TNil",[])])])))])))),Seq(Build(Var("o_19")),Id))))))])))))),SDef("debug",["h_27"],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Scope(["x_16"],Seq(Match(Var("x_16")),Seq(Where(Id),Seq(Scope(["z_41"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("h_27"),[]),Seq(Match(Var("z_41")),Id))),Build(Op("Cons",[Var("z_41"),Op("Cons",[Var("x_16"),Op("Nil",[])])])))),Id))))]),Call(SVar("printnl"),[]))))),SDef("Zip3",[],Scope(["h_11","i_11"],Seq(Match(Op("TCons",[Var("h_11"),Op("TCons",[Var("i_11"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("h_11"),Var("i_11")])),Id))))),SDef("Zip2",[],Scope(["x_10","y_10","z_10","a_11"],Seq(Match(Op("TCons",[Op("Cons",[Var("x_10"),Var("z_10")]),Op("TCons",[Op("Cons",[Var("y_10"),Var("a_11")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("TCons",[Var("x_10"),Op("TCons",[Var("y_10"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("z_10"),Op("TCons",[Var("a_11"),Op("TNil",[])])]),Op("TNil",[])])])),Id))))),SDef("Zip1",[],Scope([],Seq(Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Nil",[])),Id))))),SDef("genzip",["e_33","f_33","g_33","h_33"],Scope([],Rec("i_33",Choice(Call(SVar("e_33"),[]),Seq(Call(SVar("f_33"),[]),Seq(Call(SVar("TCons"),[Call(SVar("h_33"),[]),Call(SVar("TCons"),[Call(SVar("i_33"),[]),Call(SVar("TNil"),[])])]),Call(SVar("g_33"),[]))))))),SDef("zip",["j_33"],Scope([],Call(SVar("genzip"),[Call(SVar("Zip1"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("j_33"),[])]))),SDef("subs-args",[],Choice(Scope(["y_18","z_18"],Seq(Id,Match(Op("TCons",[Var("y_18"),Op("TCons",[Var("z_18"),Op("TNil",[])])])))),Choice(Scope([],Scope(["a_19","b_19","c_19"],Seq(Match(Op("TCons",[Var("a_19"),Op("TCons",[Var("b_19"),Op("TCons",[Var("c_19"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Scope(["u_42"],Seq(Seq(Build(Op("TCons",[Var("a_19"),Op("TCons",[Var("b_19"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("u_42")),Id))),Build(Op("TCons",[Var("u_42"),Op("TCons",[Var("c_19"),Op("TNil",[])])])))),Id))))),Fail))),SDef("obsolete",["k_27"],Scope([],Where(Seq(Build(Str(": obsolete library strategy")),Call(SVar("debug"),[Call(SVar("k_27"),[])]))))),SDef("subs",["x_39"],Scope([],Seq(Call(SVar("obsolete"),[Build(Str("subs/1"))]),Seq(Call(SVar("debug"),[Build(Str("subs/1 a: "))]),Seq(Call(SVar("subs-args"),[]),Seq(Call(SVar("debug"),[Build(Str("subs/1 b: "))]),Scope(["l_19","m_19"],Seq(Match(Op("TCons",[Var("l_19"),Op("TCons",[Var("m_19"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("m_19")),Call(SVar("subs"),[Call(SVar("x_39"),[]),Build(Var("l_19"))])),Id)))))))))),SDef("tsubs",[],Scope([],Call(SVar("subs"),[Call(SVar("IsVar"),[])]))),SDef("debug",[],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Scope(["w_16"],Seq(Match(Var("w_16")),Seq(Where(Id),Seq(Build(Op("Cons",[Var("w_16"),Op("Nil",[])])),Id))))]),Call(SVar("printnl"),[]))))),SDef("map",["p_34"],Scope([],Rec("q_34",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("p_34"),[]),Call(SVar("q_34"),[])]))))),SDef("at_end",["b_35"],Scope([],Rec("c_35",Choice(Call(SVar("Cons"),[Id,Call(SVar("c_35"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("b_35"),[])))))),SDef("Concat",["d_26"],Scope(["s_13","t_13"],Seq(Match(Op("Cons",[Var("t_13"),Var("s_13")])),Seq(Where(Id),Seq(Seq(Build(Var("t_13")),Call(SVar("at_end"),[Seq(Build(Var("s_13")),Call(SVar("d_26"),[]))])),Id))))),SDef("concat",[],Scope([],Rec("r_35",Choice(Call(SVar("Nil"),[]),Call(SVar("Concat"),[Call(SVar("r_35"),[])]))))),SDef("OLName",[],Scope(["e_5","f_5"],Seq(Match(Op("Overlay",[Var("f_5"),Op("Nil",[]),Var("e_5")])),Seq(Where(Id),Seq(Build(Var("f_5")),Id))))),SDef("OpName",[],Scope(["c_5"],Seq(Match(Op("OpDecl",[Var("c_5"),Op("ConstType",[Wld])])),Seq(Where(Id),Seq(Build(Var("c_5")),Id))))),SDef("OpNames",[],Scope(["b_5"],Seq(Match(Op("Operations",[Var("b_5")])),Seq(Where(Id),Seq(Seq(Build(Var("b_5")),Call(SVar("filter"),[Call(SVar("OpName"),[])])),Id))))),SDef("Names",[],Choice(Scope(["a_5"],Seq(Match(Op("Signature",[Var("a_5")])),Seq(Where(Id),Seq(Seq(Build(Var("a_5")),Seq(Call(SVar("filter"),[Call(SVar("OpNames"),[])]),Call(SVar("concat"),[]))),Id)))),Choice(Scope(["d_5"],Seq(Match(Op("Overlays",[Var("d_5")])),Seq(Where(Id),Seq(Seq(Build(Var("d_5")),Call(SVar("filter"),[Call(SVar("OLName"),[])])),Id)))),Fail))),SDef("Tl",[],Scope(["z_12","a_13"],Seq(Match(Op("Cons",[Var("z_12"),Var("a_13")])),Seq(Where(Id),Seq(Build(Var("a_13")),Id))))),SDef("filter",["u_30"],Scope([],Rec("v_30",Choice(Call(SVar("Nil"),[]),LChoice(Call(SVar("Cons"),[Call(SVar("u_30"),[]),Call(SVar("v_30"),[])]),Seq(Call(SVar("Tl"),[]),Call(SVar("v_30"),[]))))))),SDef("const-names",[],Scope([],Seq(Call(SVar("filter"),[Call(SVar("Names"),[])]),Call(SVar("concat"),[])))),SDef("vars-to-consts",[],Scope([],Seq(Call(SVar("split"),[Seq(Call(SVar("const-names"),[]),Call(SVar("map"),[Call(SVar("split"),[Id,Scope(["s_15"],Seq(Match(Var("s_15")),Seq(Where(Id),Seq(Build(Op("Op",[Var("s_15"),Op("Nil",[])])),Id))))])])),Id]),Seq(Call(SVar("debug"),[]),Call(SVar("tsubs"),[]))))),SDef("TNil",[],Cong("TNil",[])),SDef("TCons",["h_22","i_22"],Cong("TCons",[Call(SVar("h_22"),[]),Call(SVar("i_22"),[])])),SDef("report-failure",[],Scope([],Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("rewriting failed"),Op("Nil",[])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))),SDef("try",["h_36"],Scope([],LChoice(Call(SVar("h_36"),[]),Id))),SDef("report-success",[],Scope(["t_16","u_16"],Seq(Where(Call(SVar("try"),[Seq(Call(SVar("TCons"),[Not(Call(SVar("option-defined"),[Seq(Id,Match(Op("Silent",[])))])),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Runtime",[Var("u_16")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("t_16")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Var("t_16"),Op("Cons",[Str(" ("),Op("Cons",[Var("u_16"),Op("Cons",[Str(" secs)"),Op("Nil",[])])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])))))])),Seq(Build(Int(0)),Call(SVar("exit"),[]))))),SDef("WriteToTextFile",[],Scope([],Prim("_ST_WriteToTextFile"))),SDef("WriteToBinaryFile",[],Scope([],Prim("_ST_WriteToBinaryFile"))),SDef("output-file'",[],Scope(["s_16"],Seq(Call(SVar("TCons"),[LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Output",[Var("s_16")])))]),Seq(Build(Op("stdout",[])),Match(Var("s_16")))),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("split"),[Build(Var("s_16")),Id]),Call(SVar("TNil"),[])])]),LChoice(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Binary",[])))]),Call(SVar("TCons"),[Call(SVar("WriteToBinaryFile"),[]),Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("WriteToTextFile"),[]),Call(SVar("TNil"),[])])])))))),SDef("dtime",[],Scope([],Prim("_ST_dtime"))),SDef("apply-strategy",["d_27"],Scope(["p_16"],Seq(Where(Call(SVar("dtime"),[])),Seq(Call(SVar("d_27"),[]),Seq(Where(Seq(Call(SVar("dtime"),[]),Match(Var("p_16")))),Scope(["q_16","r_16"],Seq(Match(Op("TCons",[Var("q_16"),Op("TCons",[Var("r_16"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("Cons",[Op("Runtime",[Var("p_16")]),Var("q_16")]),Op("TCons",[Var("r_16"),Op("TNil",[])])])),Id))))))))),SDef("ReadFromFile",[],Scope([],Prim("_ST_ReadFromFile"))),SDef("split",["f_26","g_26"],Scope(["l_14"],Seq(Match(Var("l_14")),Seq(Where(Id),Seq(Scope(["b_46"],Seq(Seq(Build(Var("l_14")),Seq(Call(SVar("f_26"),[]),Seq(Match(Var("b_46")),Id))),Scope(["f_46"],Seq(Seq(Build(Var("l_14")),Seq(Call(SVar("g_26"),[]),Seq(Match(Var("f_46")),Id))),Build(Op("TCons",[Var("b_46"),Op("TCons",[Var("f_46"),Op("TNil",[])])])))))),Id))))),SDef("input-file'",[],Scope(["o_16"],Seq(LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Input",[Var("o_16")])))]),Seq(Build(Op("stdin",[])),Match(Var("o_16")))),Call(SVar("split"),[Id,Seq(Build(Var("o_16")),Call(SVar("ReadFromFile"),[]))])))),SDef("exit",[],Scope([],Prim("_ST_exit"))),SDef("printnl",[],Scope([],Prim("_ST_printnl"))),SDef("usage'",[],Scope(["n_16"],Where(Seq(Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("n_16")])))]),Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("usage : "),Op("Cons",[Var("n_16"),Op("Cons",[Str(" [-S] [-i file] [-o file] [-b] [-s] [--help|-h|-?]"),Op("Nil",[])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))))),SDef("Undefined",["b_22"],Cong("Undefined",[Call(SVar("b_22"),[])])),SDef("Help",[],Cong("Help",[])),SDef("fetch",["y_34"],Scope([],Rec("z_34",LChoice(Call(SVar("Cons"),[Call(SVar("y_34"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("z_34"),[])]))))),SDef("option-defined",["x_26"],Scope([],Call(SVar("fetch"),[Call(SVar("x_26"),[])]))),SDef("need-help",[],Scope([],Seq(Call(SVar("option-defined"),[Choice(Call(SVar("Help"),[]),Call(SVar("Undefined"),[Id]))]),Call(SVar("usage'"),[])))),SDef("Option",["l_24","m_24"],Scope(["e_6","f_6"],Seq(Match(Op("Cons",[Var("f_6"),Var("e_6")])),Seq(Where(Where(Seq(Build(Var("f_6")),Call(SVar("l_24"),[])))),Seq(Scope(["a_47"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("m_24"),[]),Seq(Match(Var("a_47")),Id))),Build(Op("Cons",[Var("a_47"),Var("e_6")])))),Id))))),SDef("ArgOption",["n_24","o_24"],Scope(["g_6","h_6","i_6"],Seq(Match(Op("Cons",[Var("i_6"),Op("Cons",[Var("g_6"),Var("h_6")])])),Seq(Where(Where(Seq(Build(Var("i_6")),Call(SVar("n_24"),[])))),Seq(Scope(["k_47"],Seq(Seq(Build(Var("g_6")),Seq(Call(SVar("o_24"),[]),Seq(Match(Var("k_47")),Id))),Build(Op("Cons",[Var("k_47"),Var("h_6")])))),Id))))),SDef("io-options",[],Scope([],Choice(Call(SVar("Option"),[Match(Str("-S")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--silent")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--verbose")),Build(Op("Verbose",[]))]),Choice(Call(SVar("Option"),[Match(Str("-v")),Build(Op("Version",[]))]),Choice(Call(SVar("Option"),[Match(Str("--version")),Build(Op("Version",[]))]),Choice(Call(SVar("ArgOption"),[Match(Str("@version")),Scope(["i_16"],Seq(Match(Var("i_16")),Seq(Where(Id),Seq(Build(Op("DeclVersion",[Var("i_16")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-i")),Scope(["j_16"],Seq(Match(Var("j_16")),Seq(Where(Id),Seq(Build(Op("Input",[Var("j_16")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--input")),Scope(["k_16"],Seq(Match(Var("k_16")),Seq(Where(Id),Seq(Build(Op("Input",[Var("k_16")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-o")),Scope(["l_16"],Seq(Match(Var("l_16")),Seq(Where(Id),Seq(Build(Op("Output",[Var("l_16")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--output")),Scope(["m_16"],Seq(Match(Var("m_16")),Seq(Where(Id),Seq(Build(Op("Output",[Var("m_16")])),Id))))]),Choice(Call(SVar("Option"),[Match(Str("-b")),Build(Op("Binary",[]))]),Choice(Call(SVar("Option"),[Match(Str("-s")),Build(Op("Statistics",[]))]),Choice(Call(SVar("Option"),[Match(Str("--help")),Build(Op("Help",[]))]),Choice(Call(SVar("Option"),[Match(Str("-h")),Build(Op("Help",[]))]),Call(SVar("Option"),[Match(Str("-?")),Build(Op("Help",[]))]))))))))))))))))),SDef("UndefinedOption",[],Scope(["n_6","o_6"],Seq(Match(Op("Cons",[Var("n_6"),Var("o_6")])),Seq(Where(Id),Seq(Build(Op("Cons",[Op("Undefined",[Var("n_6")]),Var("o_6")])),Id))))),SDef("Cons",["l_22","m_22"],Cong("Cons",[Call(SVar("l_22"),[]),Call(SVar("m_22"),[])])),SDef("Nil",[],Cong("Nil",[])),SDef("parse-options",["u_26"],Scope([],Call(SVar("Cons"),[Scope(["h_16"],Seq(Match(Var("h_16")),Seq(Where(Id),Seq(Build(Op("Program",[Var("h_16")])),Id)))),Rec("v_26",LChoice(Choice(Call(SVar("Nil"),[]),Seq(Call(SVar("u_26"),[]),Call(SVar("Cons"),[Id,Call(SVar("v_26"),[])]))),Call(SVar("UndefinedOption"),[])))]))),SDef("iowrapO",["a_27","b_27"],Scope([],Seq(Call(SVar("parse-options"),[LChoice(Call(SVar("b_27"),[]),Call(SVar("io-options"),[]))]),LChoice(Call(SVar("need-help"),[]),LChoice(Seq(Call(SVar("input-file'"),[]),Seq(Call(SVar("apply-strategy"),[Call(SVar("a_27"),[])]),Seq(Call(SVar("output-file'"),[]),Call(SVar("report-success"),[])))),Call(SVar("report-failure"),[])))))),SDef("iowrap",["z_26"],Scope([],Call(SVar("iowrapO"),[Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("z_26"),[]),Call(SVar("TNil"),[])])]),Fail]))),SDef("main",[],Scope([],Call(SVar("iowrap"),[Call(SVar("vars-to-consts"),[])])))]
