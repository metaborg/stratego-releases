[SDef("tpaste",["g_31"],Scope([],Call(SVar("Scope"),[Call(SVar("g_31"),[]),Id]))),SDef("Var",["j_14"],Cong("Var",[Call(SVar("j_14"),[])])),SDef("DistBinding",["o_16","p_16"],Scope(["t_3","u_3","v_3"],Seq(Match(Op("TCons",[Var("v_3"),Op("TCons",[Var("u_3"),Op("TCons",[Var("t_3"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Seq(Build(Var("v_3")),Call(SVar("p_16"),[Scope(["w_3"],Seq(Match(Var("w_3")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("w_3"),Op("TCons",[Var("t_3"),Op("TNil",[])])])),Call(SVar("o_16"),[])),Id)))),Scope(["x_3"],Seq(Match(Var("x_3")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("x_3"),Op("TCons",[Var("u_3"),Op("TNil",[])])])),Call(SVar("o_16"),[])),Id)))),Id])),Id))))),SDef("at_end",["d_26"],Scope([],Rec("e_26",Choice(Call(SVar("Cons"),[Id,Call(SVar("e_26"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("d_26"),[])))))),SDef("conc",[],Scope(["y_8","z_8"],Seq(Match(Op("TCons",[Var("z_8"),Op("TCons",[Var("y_8"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("z_8")),Call(SVar("at_end"),[Build(Var("y_8"))])),Id))))),SDef("new",[],Scope([],Prim("_ST_new"))),SDef("map",["r_25"],Scope([],Rec("s_25",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("r_25"),[]),Call(SVar("s_25"),[])]))))),SDef("RnBinding",["m_16","n_16"],Scope(["o_3","p_3","q_3","r_3","s_3"],Seq(Match(Op("TCons",[Var("o_3"),Op("TCons",[Var("r_3"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Seq(Build(Var("o_3")),Call(SVar("m_16"),[])),Match(Var("p_3"))),Seq(Seq(Call(SVar("map"),[Call(SVar("new"),[])]),Match(Var("q_3"))),Seq(Seq(Scope(["e_33"],Seq(Seq(Build(Op("TCons",[Var("p_3"),Op("TCons",[Var("q_3"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("e_33")),Id))),Build(Op("TCons",[Var("e_33"),Op("TCons",[Var("r_3"),Op("TNil",[])])])))),Call(SVar("conc"),[])),Match(Var("s_3"))))))),Seq(Scope(["l_33"],Seq(Seq(Build(Var("o_3")),Seq(Call(SVar("n_16"),[Build(Var("q_3"))]),Seq(Match(Var("l_33")),Id))),Build(Op("TCons",[Var("l_33"),Op("TCons",[Var("r_3"),Op("TCons",[Var("s_3"),Op("TNil",[])])])])))),Id))))),SDef("SubsVar",["v_17","w_17"],Scope(["d_10","e_10"],Seq(Match(Var("d_10")),Seq(Where(Where(Seq(Seq(Build(Var("d_10")),Call(SVar("v_17"),[Id])),Seq(Call(SVar("w_17"),[]),Match(Var("e_10")))))),Seq(Seq(Build(Op("TCons",[Var("d_10"),Op("TCons",[Var("e_10"),Op("TNil",[])])])),Call(SVar("lookup"),[])),Id))))),SDef("Fst",[],Scope(["e_9","f_9"],Seq(Match(Op("TCons",[Var("f_9"),Var("e_9")])),Seq(Where(Id),Seq(Build(Var("f_9")),Id))))),SDef("Look2",[],Scope(["u_4","v_4"],Seq(Match(Op("TCons",[Var("u_4"),Op("TCons",[Op("Cons",[Wld,Var("v_4")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("u_4"),Op("TCons",[Var("v_4"),Op("TNil",[])])])),Id))))),SDef("Look1",[],Scope(["s_4","t_4"],Seq(Match(Op("TCons",[Var("s_4"),Op("TCons",[Op("Cons",[Op("TCons",[Var("s_4"),Op("TCons",[Var("t_4"),Op("TNil",[])])]),Wld]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Var("t_4")),Id))))),SDef("lookup",[],Scope([],Rec("b_23",LChoice(Call(SVar("Look1"),[]),Seq(Call(SVar("Look2"),[]),Call(SVar("b_23"),[])))))),SDef("RnVar",["l_16"],Scope(["m_3","n_3"],Seq(Match(Op("TCons",[Var("n_3"),Op("TCons",[Var("m_3"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("n_3")),Call(SVar("l_16"),[Seq(Call(SVar("split"),[Id,Build(Var("m_3"))]),Call(SVar("lookup"),[]))])),Id))))),SDef("dist",["h_16"],Scope(["b_3","c_3"],Seq(Match(Op("TCons",[Var("c_3"),Op("TCons",[Var("b_3"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("c_3")),All(Scope(["d_3"],Seq(Match(Var("d_3")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("d_3"),Op("TCons",[Var("b_3"),Op("TNil",[])])])),Call(SVar("h_16"),[])),Id)))))),Id))))),SDef("env-alltd",["d_21"],Scope([],Rec("e_21",LChoice(Call(SVar("d_21"),[]),Call(SVar("dist"),[Call(SVar("e_21"),[])]))))),SDef("Zip3",[],Scope(["p_6","q_6"],Seq(Match(Op("TCons",[Var("p_6"),Op("TCons",[Var("q_6"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("p_6"),Var("q_6")])),Id))))),SDef("Zip2",[],Scope(["f_6","g_6","h_6","i_6"],Seq(Match(Op("TCons",[Op("Cons",[Var("f_6"),Var("h_6")]),Op("TCons",[Op("Cons",[Var("g_6"),Var("i_6")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("TCons",[Var("f_6"),Op("TCons",[Var("g_6"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("h_6"),Op("TCons",[Var("i_6"),Op("TNil",[])])]),Op("TNil",[])])])),Id))))),SDef("Zip1",[],Scope([],Seq(Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Nil",[])),Id))))),SDef("genzip",["g_24","h_24","i_24","j_24"],Scope([],Rec("k_24",Choice(Call(SVar("g_24"),[]),Seq(Call(SVar("h_24"),[]),Seq(Call(SVar("TCons"),[Call(SVar("j_24"),[]),Call(SVar("TCons"),[Call(SVar("k_24"),[]),Call(SVar("TNil"),[])])]),Call(SVar("i_24"),[]))))))),SDef("zip",["l_24"],Scope([],Call(SVar("genzip"),[Call(SVar("Zip1"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("l_24"),[])]))),SDef("subs-args",[],Scope(["o_13","p_13","q_13","r_13"],LChoice(Seq(Id,Match(Op("TCons",[Var("o_13"),Op("TCons",[Var("r_13"),Op("TNil",[])])]))),Seq(Seq(Id,Match(Op("TCons",[Var("p_13"),Op("TCons",[Var("q_13"),Op("TCons",[Var("r_13"),Op("TNil",[])])])]))),Scope(["o_35"],Seq(Seq(Build(Op("TCons",[Var("p_13"),Op("TCons",[Var("q_13"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("o_35")),Id))),Build(Op("TCons",[Var("o_35"),Op("TCons",[Var("r_13"),Op("TNil",[])])])))))))),SDef("substitute",["m_30","n_30","o_30","p_30"],Scope(["w_13","x_13"],Seq(Seq(Call(SVar("subs-args"),[]),Match(Op("TCons",[Var("x_13"),Op("TCons",[Var("w_13"),Op("TNil",[])])]))),Seq(Build(Op("TCons",[Var("w_13"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Rec("q_30",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("m_30"),[])]),LChoice(Seq(Call(SVar("Fst"),[]),Call(SVar("SubsVar"),[Call(SVar("m_30"),[]),Build(Var("x_13"))])),Seq(Call(SVar("RnBinding"),[Call(SVar("n_30"),[]),Call(SVar("p_30"),[])]),Call(SVar("DistBinding"),[Call(SVar("q_30"),[]),Call(SVar("o_30"),[])]))))])))))),SDef("tsubstitute",[],Scope([],Call(SVar("substitute"),[Call(SVar("Var"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[]),Call(SVar("tpaste"),[])]))),SDef("tsubstitute-test1",[],Scope([],Call(SVar("apply-test"),[Build(Str("tsubstitute-test1")),Call(SVar("tsubstitute"),[]),Build(Op("TCons",[Op("Cons",[Op("TCons",[Op("Var",[Str("x")]),Op("TCons",[Op("Var",[Str("a")]),Op("TNil",[])])]),Op("Cons",[Op("TCons",[Op("Var",[Str("y")]),Op("TCons",[Op("Op",[Str("Add"),Op("Cons",[Op("Var",[Str("y")]),Op("Cons",[Op("Var",[Str("z")]),Op("Nil",[])])])]),Op("TNil",[])])]),Op("Nil",[])])]),Op("TCons",[Op("Op",[Str("BinExp"),Op("Cons",[Op("Var",[Str("x")]),Op("Cons",[Op("Str",[Str("*")]),Op("Cons",[Op("Var",[Str("y")]),Op("Nil",[])])])])]),Op("TNil",[])])])),Build(Op("Op",[Str("BinExp"),Op("Cons",[Op("Var",[Str("a")]),Op("Cons",[Op("Str",[Str("*")]),Op("Cons",[Op("Op",[Str("Add"),Op("Cons",[Op("Var",[Str("y")]),Op("Cons",[Op("Var",[Str("z")]),Op("Nil",[])])])]),Op("Nil",[])])])])]))]))),SDef("tvars-test2",[],Scope([],Call(SVar("apply-test"),[Build(Str("tvars-test2")),Call(SVar("tvars"),[]),Build(Op("Real",[Real(1.100000)])),Build(Op("Nil",[]))]))),SDef("Scope",["t_15","u_15"],Cong("Scope",[Call(SVar("t_15"),[]),Call(SVar("u_15"),[])])),SDef("tboundin",["h_31","i_31","j_31"],Scope([],Call(SVar("Scope"),[Call(SVar("j_31"),[]),Call(SVar("h_31"),[])]))),SDef("Bind0",[],Choice(Scope(["p_10","q_10"],Seq(Match(Op("Scope",[Var("q_10"),Var("p_10")])),Seq(Where(Id),Seq(Build(Var("q_10")),Id)))),Choice(Scope(["r_10","s_10","t_10"],Seq(Match(Op("LRule",[Op("Rule",[Var("t_10"),Var("r_10"),Var("s_10")])])),Seq(Where(Id),Seq(Seq(Build(Var("t_10")),Call(SVar("tvars"),[])),Id)))),Fail))),SDef("Add1",[],Scope(["i_10"],Seq(Match(Op("Var",[Var("i_10")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("i_10"),Op("Nil",[])])),Id))))),SDef("union",[],Scope(["d_5","e_5"],Seq(Match(Op("TCons",[Var("e_5"),Op("TCons",[Var("d_5"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("e_5")),Rec("a_17",LChoice(Seq(Call(SVar("Nil"),[]),Build(Var("d_5"))),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("d_5"))]),Call(SVar("a_17"),[])),Call(SVar("Cons"),[Id,Call(SVar("a_17"),[])]))))),Id))))),SDef("foldr",["n_22","o_22","p_22"],Scope([],Rec("q_22",Choice(Seq(Call(SVar("Nil"),[]),Call(SVar("n_22"),[])),Seq(Scope(["a_12","b_12"],Seq(Match(Op("Cons",[Var("a_12"),Var("b_12")])),Seq(Where(Id),Seq(Scope(["g_37"],Seq(Seq(Build(Var("a_12")),Seq(Call(SVar("p_22"),[]),Seq(Match(Var("g_37")),Id))),Scope(["k_37"],Seq(Seq(Build(Var("b_12")),Seq(Call(SVar("q_22"),[]),Seq(Match(Var("k_37")),Id))),Build(Op("TCons",[Var("g_37"),Op("TCons",[Var("k_37"),Op("TNil",[])])])))))),Id)))),Call(SVar("o_22"),[])))))),SDef("foldr-kids",["g_17","h_17","i_17"],Scope(["m_5"],Seq(Scope(["r_37"],Seq(Match(Var("r_37")),Where(Seq(Build(Var("r_37")),Seq(Prim("_ST_explode_term"),Seq(Match(Op("TCons",[Wld,Op("TCons",[Var("m_5"),Op("TNil",[])])])),Id)))))),Seq(Where(Id),Seq(Seq(Build(Var("m_5")),Call(SVar("foldr"),[Call(SVar("g_17"),[]),Call(SVar("h_17"),[]),Call(SVar("i_17"),[])])),Id))))),SDef("collect-kids",["h_23"],Scope([],Call(SVar("foldr-kids"),[Build(Op("Nil",[])),Call(SVar("union"),[]),Call(SVar("h_23"),[])]))),SDef("Cons",["h_14","i_14"],Cong("Cons",[Call(SVar("h_14"),[]),Call(SVar("i_14"),[])])),SDef("fetch",["a_26"],Scope([],Rec("b_26",LChoice(Call(SVar("Cons"),[Call(SVar("a_26"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("b_26"),[])]))))),SDef("HdMember",["x_16"],Scope(["y_4","z_4"],Seq(Match(Op("Cons",[Var("z_4"),Var("y_4")])),Seq(Where(Where(Seq(Call(SVar("x_16"),[]),Call(SVar("fetch"),[Seq(Id,Match(Var("z_4")))])))),Seq(Build(Var("y_4")),Id))))),SDef("Nil",[],Cong("Nil",[])),SDef("diff",[],Scope(["f_5","g_5"],Seq(Match(Op("TCons",[Var("g_5"),Op("TCons",[Var("f_5"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("g_5")),Rec("b_17",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("f_5"))]),Call(SVar("b_17"),[])),Call(SVar("Cons"),[Id,Call(SVar("b_17"),[])]))))),Id))))),SDef("free-vars",["i_20","j_20","k_20"],Scope([],Rec("l_20",LChoice(Call(SVar("i_20"),[]),LChoice(Seq(Scope(["s_11"],Seq(Where(Seq(Call(SVar("j_20"),[]),Match(Var("s_11")))),Call(SVar("k_20"),[Seq(Call(SVar("split"),[Call(SVar("l_20"),[]),Build(Var("s_11"))]),Call(SVar("diff"),[])),Call(SVar("l_20"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("l_20"),[])])))))),SDef("tvars",[],Scope([],Call(SVar("free-vars"),[Call(SVar("Add1"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[])]))),SDef("FAIL",[],Scope([],Scope(["n_13"],Seq(Seq(Id,Match(Var("n_13"))),Seq(Id,Match(Op("TCons",[Var("n_13"),Op("TCons",[Var("n_13"),Op("TNil",[])])]))))))),SDef("debug",[],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Scope(["j_11"],Seq(Match(Var("j_11")),Seq(Where(Id),Seq(Build(Op("Cons",[Var("j_11"),Op("Nil",[])])),Id))))]),Call(SVar("printnl"),[]))))),SDef("record-failure",[],Scope([],Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Scope(["o_11"],Seq(Match(Var("o_11")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("o_11"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("add"),[])),Id)))),Call(SVar("TNil"),[])])]))),SDef("add",[],Scope([],Prim("_ST_add"))),SDef("record-success",[],Scope([],Call(SVar("TCons"),[Scope(["n_11"],Seq(Match(Var("n_11")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("n_11"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("add"),[])),Id)))),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]))),SDef("do-test",["q_19","r_19"],Scope([],Seq(Where(Seq(Call(SVar("q_19"),[]),Call(SVar("debug"),[]))),LChoice(Seq(Where(Call(SVar("r_19"),[])),Call(SVar("record-success"),[])),Call(SVar("record-failure"),[]))))),SDef("apply-test",["u_19","v_19","w_19","x_19"],Scope(["p_11","q_11"],Call(SVar("do-test"),[Call(SVar("u_19"),[]),Seq(LChoice(Seq(Call(SVar("w_19"),[]),Seq(Call(SVar("v_19"),[]),Match(Var("p_11")))),Seq(Seq(Build(Str("  failed")),Call(SVar("debug"),[])),Call(SVar("FAIL"),[]))),Seq(Seq(Call(SVar("x_19"),[]),Match(Var("q_11"))),LChoice(Seq(Build(Var("q_11")),Match(Var("p_11"))),Seq(Seq(Seq(Build(Var("p_11")),Call(SVar("debug"),[Build(Str("  result not equal: "))])),Seq(Build(Var("q_11")),Call(SVar("debug"),[Build(Str("  expected: "))]))),Call(SVar("FAIL"),[])))))]))),SDef("tvars-test1",[],Scope([],Call(SVar("apply-test"),[Build(Str("tvars-test1")),Call(SVar("tvars"),[]),Build(Op("Int",[Int(1)])),Build(Op("Nil",[]))]))),SDef("exit",[],Scope([],Prim("_ST_exit"))),SDef("check-for-failures",[],Scope([],LChoice(Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Match(Int(0)),Call(SVar("TNil"),[])])]),Seq(Build(Int(0)),Call(SVar("exit"),[]))),Seq(Build(Int(1)),Call(SVar("exit"),[]))))),SDef("TNil",[],Cong("TNil",[])),SDef("TCons",["d_14","e_14"],Cong("TCons",[Call(SVar("d_14"),[]),Call(SVar("e_14"),[])])),SDef("report-test",[],Scope([],Call(SVar("TCons"),[Call(SVar("debug"),[Build(Str("successes: "))]),Call(SVar("TCons"),[Call(SVar("debug"),[Build(Str("failures: "))]),Call(SVar("TNil"),[])])]))),SDef("init-record",[],Scope([],Build(Op("TCons",[Int(0),Op("TCons",[Int(0),Op("TNil",[])])])))),SDef("printnl",[],Scope([],Prim("_ST_printnl"))),SDef("split",["q_17","r_17"],Scope(["t_9"],Seq(Match(Var("t_9")),Seq(Where(Id),Seq(Scope(["o_40"],Seq(Seq(Build(Var("t_9")),Seq(Call(SVar("q_17"),[]),Seq(Match(Var("o_40")),Id))),Scope(["s_40"],Seq(Seq(Build(Var("t_9")),Seq(Call(SVar("r_17"),[]),Seq(Match(Var("s_40")),Id))),Build(Op("TCons",[Var("o_40"),Op("TCons",[Var("s_40"),Op("TNil",[])])])))))),Id))))),SDef("debug",["i_19"],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Scope(["k_11"],Seq(Match(Var("k_11")),Seq(Where(Id),Seq(Scope(["c_41"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("i_19"),[]),Seq(Match(Var("c_41")),Id))),Build(Op("Cons",[Var("c_41"),Op("Cons",[Var("k_11"),Op("Nil",[])])])))),Id))))]),Call(SVar("printnl"),[]))))),SDef("test-suite",["o_19","p_19"],Scope([],Seq(Call(SVar("o_19"),[]),Seq(Call(SVar("debug"),[Build(Str("test suite: "))]),Seq(Call(SVar("init-record"),[]),Seq(Call(SVar("p_19"),[]),Seq(Call(SVar("report-test"),[]),Call(SVar("check-for-failures"),[])))))))),SDef("main",[],Scope([],Call(SVar("test-suite"),[Build(Str("stratlib-test")),Seq(Call(SVar("tvars-test1"),[]),Seq(Call(SVar("tvars-test2"),[]),Call(SVar("tsubstitute-test1"),[])))])))]
