%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: Compiler.dvi
%%Pages: 153
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips Compiler.dvi -o Compiler.ps
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2001.01.31:2302
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (Compiler.dvi)
@start
%DVIPSBitmapFont: Fa cmbx12 24.88 19
/Fa 19 122 df<BA12F0B33C137DB74D>45 D[<BFFC1EFEF6FFE01FFCF7FF8020F020FC
20FF8DC7000392CA001F15E00B0181776C800C1F807814FF0C03818A78818E79808B8E8B
8E8B8EA27980A4791580AB551500A4555CA26A676A676A555C9CB65AA2545D5492C7FC54
5C5414F80C3F5C545C53B612800B0F4AC8FC0B7F14F80A1FB612E095BBC9FC1FF81F801F
F8F7FF8020F820FE95CBECFFC00C1F14F00C07807814FE0C006E7E798079807980798079
8079808E79158023C08B23E08C23F0A223F88CA223FCA38C23FEAB5614FCA55614F8A39D
B612F0A25515E06723C055158067551500555C555C9CB6FC545D0C075D0C1F15C09BB75A
0B0F93C7FCC212FC6921E021800EFCC8FC20F020800DF0C9FC0CFCCAFC>143
142 120 269 165 66 D[<0803B500C0EE01F00703B600FEEE03F8077FDBFFE015070607
B800FC150F063F05FF151F4DBA00E0143F050F07F8147F053F07FE14FF94BC5B04039326
F8000FECC003040F4BC86CEBF007043F03C0030F6D5A93B648C900036D5A4B03F0933900
7FFF3F030703C0051F90B5FC4B92CB7E033F02FC18034B02F08492B648844A0380193F4A
92CD7E4A4A864A4A864A02F0864A4A864A8991B65A494B874992CF7E4C885B494A885E49
8B494A88A2495C8D90B65A8D5A5E48217FA24892D1FC223FA25A5DA248211FA3485CFA0F
F09FC7FCA25AA45DA3B6FCB27EA381A47EA46C80FA07F0FA0FF87EA2817EA36C6F1D1F23
F07E827E223F6D6E1EE0A26D6E1D7F23C06D6E1DFF7F705213806D806D55130070646D6F
646D6F515A6E6E1B1F6E6E515A6E6E515A6E6E1BFF6E6E505B6E6E505B6E6F4F5B6E03E0
4F90C7FC6F6EF13FFE6F02FC4F5A030F02FF4E485A6F03C005075B030103F0051F5B6F03
FE057F1380043FDAFFE00303B5C8FC040F03FE033F13FC0403DBFFF80107B55A040093B8
12E0053F1A80050F4FC9FC050119F8DD003F18C0060795CAFCDE007F16F0070393CBFCDF
000314C0>141 146 115 271 168 I[<BD12FCF4FFFCF5FFE01EFCF6FFC01FF01FFE797E
20E0C700030380C86C15F80A0181E2003F14FF0B07810B0115E0776C8078807880788078
808A78818E7881A28E8B8EA37980A48EAA6AA3676AA26AA29CB65AA26A545D9FCAFC6654
5C545C545C545C9BB612C0535D0B074ACBFC0B3F5C52B612F00A7F15C095BBCCFC1FF81F
C054CDFC66F6FF801FE00680C7000315F8E1003F14FE0A0F800A0315C07681766C807780
778077808C7781898D898D898DA38A8DAD8DACA1EB1FC0A1EB3FE08D8AA37880A1137FA1
14C078817818FF7C1580785F786F1500BB00FE6F6F5B796E495A7902FEEB1FFC799139FF
C07FF80D0792B55A0D015F796C5E0E1F5E0E034BC7FCD4001F14F8E7003F13C0>163
144 120 269 173 82 D[<93260FFFF8163E4BB600E0153F031F03FE5D037FDBFFC05C02
03B800F05B020F05FC5B4A05FF5B027FF0C00F91B526FE000FECF01F010302C0D9007F6D
5A4991C800076D5A4901FC030090B6FC4901F0163F4949160F4901808290B5170192CBFC
4849844849181F87484984A2484984874886A248498588A24887A388A2B58680A36E85A2
80A26E8580A2818103F0725A6C6E96C7FC15FE8116E06C15FEEEFFE017FF6C17F0F0FF80
6C18F8F1FFC06C19FCF2FF806C1AE01BF86C1AFE6C747E6D1AE0886D866D866D1AFF6D87
6D87010087806E86020F86020386020086153F030F851501DB001F19801601DC000F18C0
EF007F060717E0F0003F070316F0F1003F1A0F080315F81A00871B1F877514FCA287007F
86486C85A288A388A36D86A31EF87FA37F1EF0A26D626D1CE0A27F6D5013C0A26E1B806E
96B5FC6E1B0002F8606E4E5B6E626E6C5F03E04D5B03F84D5B03FE057F5BDBFFC093B55A
04F803035C496CD9FF80021F91C7FCD9FC1F02FF49B55AD9F80792B75A496C19F049C661
49011F18804901074DC8FC90C817F848031F16C048030003FCC9FC007C04011480>102
146 115 271 129 I[<000FC312F8A6488EA304C0C7001F4AC7120103F8C8F0000F03C0
1C0192C9737E02FC1E1F4A1E0702E08A4A8A4A8A4890CA757EA249203F49201FA349200F
A2492007A4492003007F8EA4498CA848487A1380A6CC99C7FCB3B3B3B3AA030FBD12FCA9
>145 140 120 267 162 I<93B512FC037FECFFF00207B8FC023F17E091B912F84918FE
0107727E499126C0007F14E04901E0C7000F80496D020380496D020014FE6F6F7F90B570
806F6F8085486E6F807380A27380A28885886C5CA26D4982886D5B6D5B010713C0010190
CAFC90CCFCA90603B7FC050FB8FC0403B9FC167F0307BAFC153F4AB7EA807F020FEDE000
023F02FCC7FC91B612E0010392C8FC4914FC011F14F04914C0495C90B548C9FC485C485C
485C485C5A5D485CA24891CAFCA3B6FC5CA397B6FCA461806C60F107EF6C6E150F6F16CF
6C183F6FDB7F8F806C6EDBFF0F14E06C02FCDA03FE15FE6C6E91260FFC0791B5FC6C6E6C
D93FF817806C923AF803FFF003013F91B6487E010FEF8000010394C77E010004FC141F02
1F03F0140702010380DA007F1400DA000701F8CDFC695F79DD71>97
D<94387FFFF0041FB612E093B712FE0307707E031F17F092B97E4A18FE020784021F9126
F8000F14804A0280010014C04A49C74814E049B500F85C494A17F0494A5C495C494A4A14
F84991C8FC5D495B90B5FC5D5A485C7314F05A4B6F14E05A7314C0487214804B93383FFE
00F20FF84896C8FCA4485CA5B6FCB07EA281A37EA36C80A37E6F18FE6CF201FFA26C6E5F
1CFE6C801B076C6EEF0FFC6D7F70EE1FF86DF13FF06D6E167F6D6EEEFFE06D02F84B13C0
6D6E5D6D02FF030F13806D03C0023F1300023F02F0903801FFFC6E9126FF801F5B020792
B65A6E18C0020060033F4CC7FC030716F8030016C0041F4AC8FCDC007F13C0585F78DD67
>99 D<94387FFFC0040FB6FC93B712E0030716FC031F16FF037F17C04AB912F00207DAF8
0380021F912680003F13FE4A49C7000F7F4A01F802038049B5486E804902C06E6C7F494A
6F7F4991C9FC49727F4949707F4B84498490B548707F5A4B198048855D481CC086481CE0
5D5A871DF05AA25D5AA21DF887A2B6FCA392BBFCA51DF00380CDFCA77EA4817EA37EA281
7EA26CF307F06FF00FF87E816C1B1F6F19F06C1B3F6D6DF07FE06D7FF4FFC06D6E4C1380
6D6E5E6D02F04C13006D6EEE1FFE6D6E4C5A6D6C01FFEEFFF86E02E002035B6E02FC021F
5B02079126FFC003B55A6E92B7C7FC020060033F17F8030F17E003011780DB003F03FCC8
FC040315C0DC000F01F8C9FC5D5F7ADD6A>101 D[<EC3FC0ECFFF0010313FC497F497F49
8049804980A290B67EA24881A86C5DA26D5CA26D5C6D5C6D91C8FC6D5B6D5B010013F0EC
3FC091CAFCB3A3ED1FF0017FB5FCB7FCA9EA003F1307A27FB3B3B3B0B91280A9>49
144 119 271 65 105 D[<ED1FF0017FB5FCB7FCA9EA003F1307A27FB3B3B3B3B3B3ACB9
12C0A9>50 143 119 270 65 108 D<DB3FE0912601FFFC943801FFFC017FB5031FD9FF
E0041FEBFFE0B792B600FC93B612FC060303FF030315FF060F04C0020F16C0063F04F002
3F16F095B86C91B87E4DD9FC036E49D9FC03804DD9C0006E49D9C000804D48C7003F6D49
48C7003F7FDD0FF86EDB0FF880D8003F4B48714848830107DB3FC06E9126C03FC06E804D
484E5A6D4BC86F48C881DCE1FE6FDAE1FE814D61DCE3F8DEF3F884DCE7F0F0F7F04D6F4B
81DCEFC0F0FFC0A2DCFF804F84A294C993C9FCA24C61A34C61A44C61B3B3AFB900E090B9
00E090B912E0A9B35D77DCC2>I<DB3FE0913803FFFC017FB5033FEBFFE0B792B612F806
0715FE061F6F7E4E16E095B87E4DD9FC03804DD9C000804D48C76C7FDD0FF880D8003FDB
1FE08201074B486E804D5A6D03FEC881DCE1FC815F04E385EEE7F04D81EEEFC0A2DCFF80
84A294C9FCA25EA35EA45EB3B3AFB9D8E001B912C0A9725D77DC81>I<94381FFFF00407
B612C0047F15FC0303B87E030F17E0037F17FC4ABAFC4A9126FC007F80020F02C0010714
E04A49C880027F01F8033F13FC91B5486F7F4902C003077F494A6F804991C96C80494970
804949717F49874949717FA290B548717F48884B83481D80A2481DC04B83481DE0A2481D
F0A3484A7114F8A4481DFCA5B61BFEAF6C1DFCA56C6E4D14F8A36C1DF0A36C1DE06F5F6C
1DC0A26C6E4D1480A26C1D006F5F6C646D6D4D5B6F94B5FC6D636D6D4C5C6D6E4B5C6D6E
4B5C6D02F0031F5C6D6E4B91C7FC6D6C01FE92B512FC6ED9FFC001075C6E02FC017F5C02
0791B812C0020196C8FC6E6C17FC031F17F003031780DB007F03FCC9FC040715C0DC001F
01F0CAFC675F7ADD74>I<DB1FF091381FFFC0017FB50203B6FCB7021F15E095B712FC05
0316FF050F17C0053F17F094B912FC04F1DAC01F8004F79026FC00018093B500E06D6C14
C0D8003F93C86C8001074B030F8005F86F806D03E06F804D6F804D8194CA6C7F4C864C71
805E7680A27680A27680A28B88A28BA288A28BA4882080B0200064A467A26467A3525CA2
6764676467647062704D91C7FC7094B55AA2714B5C714B5C714B5C05F84B5C71033F5C05
FF4B91C8FC06C049B55A04FB01F001075C04F801FF017F14F07190B712C0051F94C9FC71
16FC050316F0DD007F1580060F02F8CAFC060049CBFC96CDFCB3ACB912E0A9718579DC81
>I<92261FFFF814F80203B638C001FC023FEDFC0791B8121F010317FF130F013F9038F8
001F4990C8FCD9FFF8153F4801E0150F484915034849814890CAFC197F4848173F191F48
5AA2007F180FA31907487EA27FA28002E0705A6E93C8FC14FC14FF15F06CECFF8016FCEE
FFF06CEEFF8018F06C17FE727E6C18E0856C18FC6C846C727E6C856D84011F846D841303
010084023F83140F020183EC001FDB007F16801603DC000F15C01700183F060F14E0007F
1703486C82727E857F85857FA2857F1BC07FA27F1B806D5F7F1B006E5E6E5F6E163F6E4C
5A02FC4C5A6E03035B6E6C4A5B03F0023F5B03FF0107B55A01F991B7C7FCD9F07F16FCD9
E01F16F0D9800716C0D9000193C8FC48D9003F14F8007C020349C9FC4B5F78DD5C>115
D[<ED03FEA81507A5150FA4151FA3153FA2157FA215FFA25CA25C5CA25C5C5C5C91B5FC
13035B131F017F91B712F00007BAFCBBFCA7C74AC9FCB3B3AAF101FFB1616E17FE82A219
076E17FC836EEE0FF871131F6E6EEB3FF071137F6E6EEBFFE06EDAFF0313C06E92B51280
6E1700033F5D6F5D03075D030015E0041F1480040001FCC7FC>72
132 124 258 90 I<DB0FF8F01FF0017FB594B6FCB74BB7FCA9D8003F94C77E0107190F
A26D85B3B3B063A463A263A27F6398B6FCA26DF001FB7015036EEF07F3E00FE3806E6D15
1FE07FC314FF6E6D6CDAFF83EDFFC06E6E010313036E02FCEB3FFE6E91B612FC020017F8
6F16E0031F16800303EDFE00DB007F14F8040102C093C8FC725E77DC81>I<007FB800C0
4AB71280A9D800034ACA000791C7FC6D080013F0775A6D6E4E5AA26E6E6064836E4F90C8
FC836E4F5A836E4F5AA26E6E4C5AA26E6E5F1C3F6E6E5F1C7F836E4F5A846F4D5B846F4D
90C9FCA26F6E4A5AA26F6E5D1B0F846F4D5A846F4D5A846F4D5AA26F6E4A5AA2706E5C62
7002C091CAFC6219E0704B5A19F0704B5AA2706E485AA2706E485AA27002FE5B1A7F19FF
704B5AA2715DA27192CBFCA2715CA2715CA3715CA2715CA2715CA2715CA2725BA27290CC
FCA3725AA2725AA24E5AA24E5AA261187FA24E5AA24D5B13FE2603FF804A90CDFC000F13
E0486D4A5A487F486D4A5AA260B56C141F4D5AA24D5A17FF604C5B4A4990CEFC6C5D4C5A
6C49EB3FFC4A495A6C4948485A9026FE80075B270FFFC03F5B6C90B6CFFC6C5D6C15F86C
6C5C011F14C0010749D0FC9038007FE071857CDB7B>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fb cmbx12 20.74 5
/Fb 5 117 df<BA12F8A8C7001F02C0C7FCB3B3B3B3B3ACBA12F8A83D767BF548>73
D<BC12FCF3FFF01CFF1DE01DFC1DFF1EC08AC7003F91C8000115F8E0000F80090180756C
6D7E76801C0F76808B7680888B7680A28BA2892080A420C0AB2080A49AB61200A267A267
6467525C64670A1F5C525C5291C7FC51B55A090F14F850B65A94BA12C09BC8FC1DFC1DF0
9AC9FC1CF809FCCAFC0580CEFCB3B3A8BA12E0A872767AF584>80
D<92383FFFF80207B612E0027F15FC49B87E010717E0011F83499026F0007F13FC4948C7
000F7F90B502036D7E486E6D806F6D80727F486E6E7F8486727FA28684A26C5C72806C5C
6D90C8FC6D5AEB0FF8EB03E090CAFCA70507B6FC041FB7FC0303B8FC157F0203B9FC021F
ECFE0391B612800103ECF800010F14C04991C7FC017F13FC90B512F04814C0485C4891C8
FC485B5A485B5C5A5CA2B5FC5CA360A36E5DA26C5F6E5D187E6C6D846E4A48806C6D4A48
14FC6C6ED90FF0ECFFFC6C02E090263FE07F14FE00019139FC03FFC06C91B6487E013F4B
487E010F4B1307010303F01301D9003F0280D9003F13FC020101F8CBFC57507ACE5E>97
D<902601FFF8EB07FEB691383FFFC094B512F00403804C14FE4C8093261FFC3F13809326
3FE07F13C0DC7F80B5FCC66C5D011FDAFE0114E06DEBF9FC16F815FB16F016E015FF16C0
7114C05E72138095381FFE0093C76C5AF001E095C8FCA25DA65DB3B3A2B812F8A8434E7A
CD4F>114 D<15FFA75CA55CA45CA25CA25CA25CA25C91B5FCA25B5B5B131F5B90B9FC12
0FBAFCA6D8000791C9FCB3B3A3F01FE0AE183F7014C07F187F7014806D16FF826D4B1300
6E6D485AEEFE0F6E90B55A020F5D6E5D020115C06E6C5C031F49C7FC030113F03B6E7CEC
4B>116 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fc cmr9 9 37
/Fc 37 123 df<EC1FE0ECFFFC903803F01E90390FC00780EB1F8090393F000FC0017E13
1F5BA2485AED0F8092C7FCA9ED0FC0B7FCA33901F8001F150FB3A6486CEB1FE0267FFFC1
B5FCA328357FB42B>12 D<14C01301EB0380EB0F00130E5B133C5B5BA2485A485AA21207
5B120F90C7FC5AA2121E123EA3123C127CA55AB0127CA5123C123EA3121E121FA27E7F12
077F1203A26C7E6C7EA213787F131C7F130FEB0380EB01C01300124A79B71E>40
D<12C07E1270123C121C7E120F6C7E6C7EA26C7E6C7EA27F1378137C133C133EA2131E13
1FA37F1480A5EB07C0B0EB0F80A514005BA3131E133EA2133C137C137813F85BA2485A48
5AA2485A48C7FC120E5A123C12705A5A124A7CB71E>I<B512F0A514057F921A>45
D<123C127E12FFA4127E123C08087A8715>I<1530157815F8A215F01401A215E01403A2
15C01407A21580140FA215005CA2143EA2143C147CA2147814F8A25C1301A25C1303A25C
1307A2495AA291C7FC5BA2131E133EA2133C137CA2137813F8A25B1201A25B1203A2485A
A25B120FA290C8FC5AA2121E123EA2123C127CA2127812F8A25A12601D4B7CB726>I<00
7FB812C0B912E0A26C17C0CCFCAC007FB812C0B912E0A26C17C033147C9C3C>61
D<15E0A34A7EA24A7EA34A7EA3EC0DFE140CA2EC187FA34A6C7EA202707FEC601FA202E0
7FECC00FA2D901807F1507A249486C7EA301066D7EA2010E80010FB5FCA249800118C77E
A24981163FA2496E7EA3496E7EA20001821607487ED81FF04A7ED8FFFE49B512E0A33336
7DB53A>65 D<DA03FE130C91393FFF801C91B512E0903A03FE01F83C903A0FF0003C7CD9
1FC0EB0EFCD97F80130701FEC7120348481401000315005B4848157C485A173C485A171C
123F5B007F160CA390C9FC481600AB7E6D150CA3123F7F001F161C17186C7E17386C6C15
306C6C15706D15E012016C6CEC01C0D97F80EB0380D91FC0EB0F00D90FF0131ED903FE13
FC0100B512F0023F13C0DA03FEC7FC2E377CB437>67 D<B812C0A3D803FCC7127F000115
0FEE03E01601A21600A21760A403061330A41700150EA2151E157E90B512FEA39038FC00
7E151E150EA21506170CA3171892C7FCA41738A21770A217F01601160316070003157FB8
12E0A32E337DB234>69 D<B512FEA3000113006C5AB3B3A7487EB512FEA317337EB21C>
73 D<B512FEA3D803FEC9FC6C5AB3A9EE0180A416031700A45EA25E5E5E5E16FE000314
07B7FCA329337DB230>76 D<D8FFFC923801FFF86D5DA20003EFFE00D801BFED06FCA3D9
9F80140CA2D98FC01418A3D987E01430A2D983F01460A3D981F814C0A3D980FCEB0180A2
027EEB0300A36E1306A26E6C5AA36E6C5AA36E6C5AA26E6C5AA36E6C5AA3913800FD80A2
037FC7FCA3486C133ED80FF04B7EB5011C90387FFFF8A33D337CB246>I<90381FE00390
387FFC0748B5FC3907F01FCF390F8003FF48C7FC003E80814880A200788000F880A46C80
A27E92C7FC127F13C0EA3FF013FF6C13F06C13FF6C14C06C14F0C680013F7F01037F9038
003FFF140302001380157F153FED1FC0150F12C0A21507A37EA26CEC0F80A26C15006C5C
6C143E6C147E01C05B39F1FC03F800E0B512E0011F138026C003FEC7FC22377CB42B>83
D<007FB712FEA390398007F001D87C00EC003E0078161E0070160EA20060160600E01607
A3481603A6C71500B3AB4A7E011FB512FCA330337DB237>I<267FFFFC90B512C0A30001
01E090381FF80026007F80EB0FC0013F6E5A6E91C7FC6D6C130E010F140C6E5B6D6C1338
01035C6E13606D6C13E06D6C485A5EDA7F83C8FCEC3FC715C6EC1FECEC0FFC5D14076E7E
A26E7E815C6F7E9138063FC0140E4A6C7E9138180FF0EC380702707F91386003FCECC001
0101804A6C7E49C77E4981010E6E7E010C6E7E131C496E7E01786E7E13FCD807FEEC1FFE
B56C90B512F8A335337EB23A>88 D<B500F8ECFFFEA300030180EC3FE06C90C8EA1F806C
EE0E006D6C5C6D6C141817386D6C14305F6D6C14E06D6C5C16016D6C5C6D6C49C7FC5E6D
6C13065E91387F801C91383FC018163891381FE0306E6C5A16E06E6C5AEDF980EC03FF6E
90C8FC5D1400B14A7E91B512FCA337337FB23A>I<EB7F803803FFF0380F80FC381C003E
003F133F6D6C7E6E7EA26E7EEA1F00C7FCA4EB01FF131FEBFF873803FC07EA0FF0EA1FC0
EA3F80127F13004815C05AA3140FA26C131F6C133B3A3F8071F180391FC1E1FF2607FFC0
13003900FE003C22237DA126>97 D<EA03F012FFA312071203AEEC3F80ECFFE09038F3C0
F89038F7007E01FE7F49EB1F8049EB0FC05BED07E016F0A2150316F8AA16F0150716E0A2
ED0FC07F6DEB1F8001ECEB3F0001CF137C90388381F8903801FFE0C76CC7FC25357EB32B
>I<EB07F8EB3FFF9038FC07C03901F000E03903E003F03807C007120FEA1F80123F9038
0003E04890C7FCA2127E12FEAA127FA26C14187F001F14386D1330000F14706C6C13E039
03F001C03900FC0F8090383FFE00EB07F01D237EA122>I<153FEC0FFFA3EC007F81AEEB
07F0EB3FFCEBFC0F3901F003BF3907E001FF48487E48487F8148C7FCA25A127E12FEAA12
7E127FA27E6C6C5BA26C6C5B6C6C4813803A03F007BFFC3900F81E3FEB3FFCD90FE01300
26357DB32B>I<EB0FE0EB7FFCEBF83F3903F00F80D807E013C0390FC007E0381F800315
F0EA3F0014014814F8127EA212FEA2B6FCA248C8FCA5127E127FA26C1418A26C6C133800
0F14306D13706C6C13E03901F003C03900FC0F00EB3FFEEB07F01D237EA122>I<EB01FC
EB07FF90381F078090383E0FC0EB7C1F13FCEA01F8A20003EB070049C7FCACB512F0A3D8
03F0C7FCB3A7487E387FFFE0A31A357FB417>I<151F90391FC07F809039FFF8E3C03901
F07FC73907E03F033A0FC01F83809039800F8000001F80EB00074880A66C5CEB800F000F
5CEBC01F6C6C48C7FCEBF07C380EFFF8380C1FC0001CC9FCA3121EA2121F380FFFFEECFF
C06C14F06C14FC4880381F0001003EEB007F4880ED1F8048140FA56C141F007C15006C14
3E6C5C390FC001F83903F007E0C6B51280D91FFCC7FC22337EA126>I<EA03F012FFA312
071203AEEC1FC0EC7FF09038F1E0FC9038F3807C9038F7007E13FE497FA25BA25BB3486C
EB7F80B538C7FFFCA326347EB32B>I<EA0780EA0FC0EA1FE0A4EA0FC0EA0780C7FCAAEA
07E012FFA3120F1207B3A6EA0FF0B5FCA310337EB215>I<EA03F012FFA312071203AF91
3803FFE0A36E1300EC00F8EC01E05D4A5A020FC7FC141C5C5C14F0EBF3F8EBF7FC13FEEB
FC7EEBF87F496C7E141F6E7E8114076E7E8114016E7E81486CEBFF80B500C313F0A32434
7EB329>107 D<EA07E012FFA3120F1207B3B3A7EA0FF0B5FCA310347EB315>I<2703F01F
E013FF00FF90267FF80313C0903BF1E07C0F03E0903BF3803E1C01F02807F7003F387FD8
03FE1470496D486C7EA2495CA2495CB3486C496C487EB53BC7FFFE3FFFF0A33C217EA041
>I<3903F01FC000FFEB7FF09038F1E0FC9038F3807C3907F7007EEA03FE497FA25BA25B
B3486CEB7F80B538C7FFFCA326217EA02B>I<EB07F0EB3FFE9038FC1F803901F007C039
03C001E000078048486C7E48C7127CA248147E003E143E007E143FA300FE1580A8007E15
00A36C147EA26C147C6D13FC6C6C485A00075C3903F007E03900FC1F80D93FFEC7FCEB07
F021237EA126>I<3903F03F8000FFEBFFE09038F3C0F89038F7007ED807FE7F6C48EB1F
804914C049130F16E0ED07F0A3ED03F8A9150716F0A216E0150F16C06D131F6DEB3F8016
0001FF13FC9038F381F89038F1FFE0D9F07FC7FC91C8FCAA487EB512C0A325307EA02B>
I<3803E07C38FFE1FF9038E38F809038E71FC0EA07EEEA03ECA29038FC0F8049C7FCA35B
B2487EB512E0A31A217FA01E>114 D<EBFF06000713CE381F00FE003C133E48131E140E
5A1406A27EA200FE90C7FC6C7EEA7FFC383FFFC014F0000F7F6C7FC67FEB0FFF1300EC3F
8000C0131F140F6C1307A37E15006C5B6C130E6C5B38F7807838E1FFE038C07F8019237E
A11E>I<1330A51370A313F0A21201A212031207381FFFFEB5FCA23803F000AF1403A814
073801F806A23800FC0EEB7E1CEB1FF8EB07E0182F7FAD1E>I<D803F0133F00FFEB0FFF
A30007EB007F000380B35DA35D12016D4813800000903803BFFC90387E073FEB1FFED907
F8130026227EA02B>I<003FB512F0A2EB000F003C14E00038EB1FC00030EB3F80007013
7F1500006013FE495A13035CC6485A495AA2495A495A49C7FC153013FE485A12035B4848
1370485A001F14604913E0485A387F000348130F90B5FCA21C207E9F22>122
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fd cmti10 10 50
/Fd 50 122 df<EE3FFC4BB51280923907E007C092391F8001E0DB3F0013F0037E13034B
1307A24A5A18E04A48EB038094C7FCA314075DA4140F5DA3010FB7FCA25F903A001F8000
7EA217FE023F5C92C7FCA216015F5C147E16035FA214FE4A13075FA30101140F5F4AECC1
C0A2161F1783010316805CA2EF870013074A5CEE0F8EEE079EEE03FC010FEC00F04A91C7
FCA35C131FA2001C90CAFC127E5BEAFE3E133C137CEAF878EA78F0EA3FE0EA0F80344C82
BA2F>12 D<EA01E0EA07F0120F13F8121FA3120FEA07B0EA0030A21370136013E013C012
0113801203EA0700120E5A5A5A5A5A0D196EB919>39 D<150C151C153815F0EC01E0EC03
C0EC0780EC0F00141E5C147C5C5C495A1303495A5C130F49C7FCA2133EA25BA25BA2485A
A212035B12075BA2120F5BA2121FA290C8FCA25AA2123EA2127EA2127CA412FC5AAD1278
A57EA3121C121EA2120E7EA26C7E6C7EA212001E5274BD22>I<140C140E80EC0380A2EC
01C015E0A2140015F0A21578A4157C153CAB157CA715FCA215F8A21401A215F0A21403A2
15E0A21407A215C0140F1580A2141F1500A2143EA25CA25CA2495AA2495A5C1307495A91
C7FC5B133E133C5B5B485A12035B48C8FC120E5A12785A12C01E527FBD22>I<4B7E4B7E
A21507A25EA2150FA293C8FCA25DA2151EA2153EA2153CA2157CA21578A2007FB812E0B9
FCA27EC7D801F0C8FCA25DA21403A25DA21407A25DA2140FA292C9FCA25CA2141EA2143E
A2141C333275AD40>43 D<387FFFF8A2B5FCA214F0150579941E>45
D<120EEA3F80127F12FFA31300127E123C0909778819>I<EC03F8EC0FFE91383C0F8091
38F007C0903901E003E0D903C013F09038078001020013F8130E131E90391C6000FCEB38
70EC30011370A213F013E0EC70030001016013F813C014E0ECC00701C114F0903881800F
018314E09039C7001FC001FEEB3F80D80078140090C7127E5D4A5A4A5AEC07C0EC1F8002
3EC7FC14FCEB01F0EB07C0495A011EC8FC137C4914C0484813015B485A4848130348C713
80000E1407001E140F48EC1F00D83FF85B397FFFC07E39783FFFFCEA700FD8F0075BD8E0
015B6D13C0021FC7FC263A79B72A>50 D<D9707C130ED9F3FE131E496C133C48B5133816
784815F0EC0F019039FC0703E03A07F00307C001E0138F3A0FC001FF80497E48C7EA0F00
001E5C48141E153E48143C157C485C5A4A5AC7FC4A5AA24A5A140FA24A5AA24AC7FCA25C
147E14FE5C1301A25C1303A2495AA3130F5CA2131F5CA2133FA25C137FA391C8FC137E13
3C273A74B72A>55 D<EC01FCEC0FFF023F138091387E07C0903901F803E0EB03F0903907
E001F0EB0FC0EB1F80013F14F814005B137E13FEA2485AA2150312035BA2ED07F012075B
150FA216E00003141FA2153FED7FC0120115FF6C6C5A90397803BF8090383C0F3FD91FFC
1300903807F07F90C7FC157E15FE5D14015D4A5AA2003E495A007F495A5D4AC7FC00FE5B
48137E007013F8387803F0387C0FE0383FFF806C48C8FCEA03F8253A78B72A>57
D<EE01C01603A21607160FA2161F83163FA2167F16FF16EF150116CFED038FA2ED070FA2
150E151E151C1538A203707FA2EDE007A2EC01C014031580EC0700A2140EA25CA25C027F
B5FCA291B6FC9139E00007F849481303A2495A130791C7FC5B130E5BA25B1378137013F0
EA03F8486C4A7EB56C48B512F0A3343C7BBB3E>65 D<DB03FE130E92393FFF801E92B5EA
E03C913903FE01F0913A0FF000787CDA3FC0EB3CFC4AC7EA1FF802FE140FEB03FC494814
07494815F049481403495A5C49C813E05B485A5B000317C0485AA2485A1880485A94C7FC
A2485AA3127F5BA312FF90CBFCA41738A217784816707E17F06C5E16015F16036C6C4A5A
94C7FC001F150E6D141E000F5D6D5C6C6C495A6C6CEB03C0D801FEEB0F8027007F807EC8
FC6DB45A010F13E0010090C9FC373D74BA3B>67 D<0103B612FEEFFFC018F0903B0007F8
000FF84BEB03FCEF00FE020F157FF03F804B141F19C0021F150F19E05D1807143F19F05D
A2147FA292C8FCA25C180F5CA2130119E04A151FA2130319C04A153FA201071780187F4A
1600A2010F16FEA24A4A5A60011F15034D5A4A5D4D5A013F4B5A173F4A4AC7FC17FC017F
EC03F84C5A91C7EA1FC04949B45A007F90B548C8FCB712F016803C397CB83F>I<0107B8
FCA3903A000FF000034BEB007F183E141F181E5DA2143FA25D181C147FA29238000380A2
4A130718004A91C7FC5E13015E4A133E167E49B512FEA25EECF8000107147C163C4A1338
A2010F147818E04A13701701011F16C016004A14031880013F150718004A5CA2017F151E
173E91C8123C177C4915FC4C5A4914070001ED7FF0B8FCA25F38397BB838>I<0107B712
FEA3903A000FF000074B1300187C021F153CA25DA2143FA25D1838147FA292C8FCEE0380
4A130718004A91C7FCA201015CA24A131E163E010314FE91B5FC5EA2903807F800167C4A
1378A2130FA24A1370A2011F14F0A24A90C8FCA2133FA25CA2137FA291CAFCA25BA25B48
7EB6FCA337397BB836>I<DB03FE130E92393FFF801E92B5EAE03C913903FE01F0913A0F
F000787CDA3FC0EB3CFC4AC7EA1FF802FE140FEB03FC49481407494815F049481403495A
5C49C813E05B485A5B000317C0485AA2485A1880485A94C7FCA2485AA3127F5BA312FF90
CBFC0307B512E0A392390007FC00705A16075FA36C150F5FA36C6C141FA2001F5E6D143F
6C7E167F6C6C4A5A6C6CEB03EFD801FEEB07C73A007FC03F0790273FFFFC03C7FC010F01
F0C8FC01001380373D74BA40>I<0103B512F8A390390007F8005DA2140FA25DA2141FA2
5DA2143FA25DA2147FA292C7FCA25CA25CA21301A25CA21303A25CA21307A25CA2130FA2
5CA2131FA25CA2133FA25CA2137FA291C8FC497EB6FCA25C25397CB820>73
D<0107B512FCA25E9026000FF8C7FC5D5D141FA25DA2143FA25DA2147FA292C8FCA25CA2
5CA21301A25CA21303A25CA21307A25CA2130F170C4A141CA2011F153C17384A1478A201
3F157017F04A14E01601017F140317C091C71207160F49EC1F80163F4914FF0001020713
00B8FCA25E2E397BB834>76 D<902607FFF8923807FFF0614F13E0D9000FEFF0004F5AA2
021F167FF1EFC0141DDA1CFCEC01CF023C16DF9538039F800238ED071FA20278ED0E3F97
C7FC0270151CA202F04B5AF0707E14E0037E14E0010117FE4D485A02C0EC0380A20103ED
0701610280140EA20107ED1C0305385B14006F137049160705E05B010EEC01C0A2011E91
3803800F61011CEC0700A2013C020E131F4C5C1338ED1FB80178163F04F091C8FC01705C
A201F04A5B187E00015DD807F816FEB500C09039007FFFFC151E150E4C397AB84A>I<90
2603FFF891B512E0A281D90007923807F8006F6E5A61020F5E81DA0E7F5DA2021E6D1307
033F92C7FC141C82DA3C1F5C70130EEC380FA202786D131E0307141C147082DAF003143C
70133814E0150101016E1378030014705C8201036E13F0604A1480163F010715C1041F5B
91C7FC17E149EC0FE360010E15F31607011E15FF95C8FC011C80A2013C805F1338160013
785F01F8157CEA03FC267FFFE0143CB51538A243397CB83E>I<0107B612F817FF188090
3B000FF0003FE04BEB0FF0EF03F8141FEF01FC5DA2023F15FEA25DA2147FEF03FC92C7FC
A24A15F817074A15F0EF0FE01301EF1FC04AEC3F80EFFE0001034A5AEE0FF091B612C04C
C7FCD907F8C9FCA25CA2130FA25CA2131FA25CA2133FA25CA2137FA291CAFCA25BA25B12
01B512FCA337397BB838>80 D<0103B612F017FEEFFF80903B0007F8003FC04BEB0FF017
07020FEC03F8EF01FC5DA2021F15FEA25DA2143FEF03FC5DA2027FEC07F818F092C7120F
18E04AEC1FC0EF3F004A14FEEE01F80101EC0FE091B6128004FCC7FC9138FC003F0103EC
0F80834A6D7E8301071403A25C83010F14075F5CA2011F140FA25CA2133F161F4AECE007
A2017F160F180E91C7FC49020F131C007F01FE153CB5913807F078040313F0CAEAFFE0EF
3F80383B7CB83D>82 D<92383FC00E913901FFF01C020713FC91391FC07E3C91393F001F
7C027CEB0FF84A130749481303495A4948EB01F0A2495AA2011F15E091C7FCA34915C0A3
6E90C7FCA2806D7E14FCECFF806D13F015FE6D6D7E6D14E0010080023F7F14079138007F
FC150F15031501A21500A2167C120EA3001E15FC5EA3003E4A5AA24B5AA2007F4A5A4B5A
6D49C7FC6D133ED8F9F013FC39F8FC03F839F07FFFE0D8E01F138026C003FCC8FC2F3D7A
BA2F>I<0007B812E0A25AD9F800EB001F01C049EB07C0485AD900011403121E001C5C00
3C17801403123800785C00701607140700F01700485CA2140FC792C7FC5DA2141FA25DA2
143FA25DA2147FA292C9FCA25CA25CA21301A25CA21303A25CA21307A25CA2130FA25CEB
3FF0007FB512F8B6FCA2333971B83B>I<B5D8F80FB590381FFFF06102F018E0D807FEC7
D87FE0903803FE00D803F8DA3F806D5AF100F0A24F5A621903621907047F92C7FC190E16
FF4B5DA2DB03BF5C7F0001DA073F5CA2030E5D83DB1C1F495A180303385D4EC8FC157003
F0140E15E0DA01C05CA2DA03805CA2DA07005CA2020E5D17C14A5DEFC3805C027802C7C9
FC14704A14CE13FE6C6C4814DCA24A14F8A291C75B160F495D5F5B5F5B4992CAFCA24914
0E4C3B6FB853>87 D<14F8EB07FE90381F871C90383E03FE137CEBF801120148486C5A48
5A120FEBC001001F5CA2EA3F801403007F5C1300A21407485C5AA2140F5D48ECC1C0A214
1F15831680143F1587007C017F1300ECFF076C485B9038038F8E391F0F079E3907FE03FC
3901F000F0222677A42A>97 D<133FEA1FFFA3C67E137EA313FE5BA312015BA312035BA3
1207EBE0F8EBE7FE9038EF0F80390FFC07C013F89038F003E013E0D81FC013F0A21380A2
123F1300A214075A127EA2140F12FE4814E0A2141F15C05AEC3F80A215005C147E5C3878
01F8007C5B383C03E0383E07C0381E1F80D80FFEC7FCEA01F01C3B77B926>I<147F9038
03FFC090380FC1E090381F0070017E13784913383901F801F83803F003120713E0120FD8
1FC013F091C7FC485AA2127F90C8FCA35A5AA45AA3153015381578007C14F0007EEB01E0
003EEB03C0EC0F806CEB3E00380F81F83803FFE0C690C7FC1D2677A426>I<ED01F815FF
A3150316F0A21507A216E0A2150FA216C0A2151FA21680A2153FA202F81300EB07FE9038
1F877F90383E03FF017C5BEBF80112013803F00048485B120FEBC001121F5DEA3F801403
127F01005BA214075A485CA2140FA248ECC1C0A2141F15C3ED8380143F1587007C017F13
00ECFF076C485B9038038F8E391F0F079E3907FE03FC3901F000F0253B77B92A>I<147F
903803FFC090380FC1E090383F00F0017E13785B485A485A485A120F4913F8001F14F038
3F8001EC07E0EC1F80397F81FF00EBFFF891C7FC90C8FC5A5AA55AA21530007C14381578
007E14F0003EEB01E0EC03C06CEB0F806CEB3E00380781F83803FFE0C690C7FC1D2677A4
26>I<ED07C0ED1FF0ED3E38ED7C3CEDF8FC15F9140115F1020313F8EDF0F0160014075D
A4140F5DA4141F5D010FB512C05B16809039003F800092C7FCA45C147EA414FE5CA41301
5CA413035CA413075CA4130F5CA3131F5CA391C8FC5B121CEA7E3EA2EAFE3C137C1378EA
F8F01278EA3FC0EA0F80264C82BA19>I<EC07C0EC3FF09138FC38E0903901F01FF0EB03
E0903807C00FEB0F80011F1307D93F0013E05B017E130F13FE4914C01201151F12034914
80A2153F1207491400A25DA249137EA215FEA25D00031301140314076C6C485A0000131F
EB787BEB3FF390380FC3F0EB00031407A25DA2140F5D121C007E131F5D00FE49C7FC147E
5C387801F8387C07E0381FFF80D803FEC8FC24367CA426>I<EB03F0EA01FFA3EA00075C
A3130F5CA3131F5CA3133F91C8FCA35B90387E07F0EC1FFCEC783E9038FFE01F02C01380
EC800F1400485A16C05B49EB1F8012035BA2153F000715005BA25D000F147E5B15FE5D12
1FD98001131C15F8163C003F01031338010013F0A216704814E0007E15F016E0EDE1C000
FE903801E38048903800FF000038143C263B7BB92A>I<EB01C0EB07E014F0130F14E013
07EB038090C7FCAB13F0EA03FCEA071EEA0E1F121CA212385B1270A25BEAF07E12E013FE
C65AA212015B1203A25B12075BA2000F13E013C013C1001F13C01381A2EB83801303EB07
00A2130E6C5AEA07F8EA01E0143879B619>I<150E153F157FA3157E151C1500ABEC1F80
EC7FC0ECF1F0EB01C090380380F813071401130F130E131EEB1C03133C013813F0A2EB00
07A215E0A2140FA215C0A2141FA21580A2143FA21500A25CA2147EA214FEA25CA21301A2
5CA213035C121C387E07E0A238FE0FC05C49C7FCEAF83EEA787CEA3FF0EA0FC0204883B6
19>I<EB03F0EA01FFA3EA00075CA3130F5CA3131F5CA3133F91C8FCA35B017EEB0F80ED
3FE015F09039FE01C1F09038FC0387EC0707140E0001011C13E0EBF83891383003800270
C7FC00035BEBF1C0EBF38001FFC8FCEA07FC7FEBFFC0EBE7F8380FE1FCEBC07E147F8000
1F809039801F81C0A21583003F013F138001001303A21507481500007E133EEC1E0E151E
00FE6D5A48EB07F80038EB01E0243B7BB926>I<EB0FC0EA07FFA3EA001F1480A2133FA2
1400A25BA2137EA213FEA25BA21201A25BA21203A25BA21207A25BA2120FA25BA2121FA2
5BA2123FA290C7FCA25AA2EA7E0EA212FE131EEAFC1CA2133C133812F81378EA7870EA7C
E0121FEA0F80123B79B915>I<D801E001FEEB07F03C07F803FF801FFC3C0E3C0F07C078
3E3C1E3E3C03E1E01F261C1F78D9F3C013803C383FF001F7800F02E01400007801C013FE
007018C002805B4A4848EB1F80EAF07FD8E07E5CA200000207143F01FE1700495CA2030F
5C0001177E495C18FE031F5C120349DA8001131C18F8033F153C00070403133849020013
F0A24B1570000F17E049017E15F019E003FEECE1C0001FEE01E34949903800FF000007C7
0038143C3E2679A444>I<D801E013FE3A07F803FF803A0E3C0F07C03A1E3E3C03E0261C
1F787F39383FF00114E0007813C000708114804A485AEAF07FEAE07EA20000140701FE5C
5BA2150F00015D5B151F5E12034990383F8380160316070007027F130049137EA2160E00
0F147C49141E161C5E001FEC3C7849EB1FE00007C7EA0780292679A42F>I<147F903803
FFC090380FC1F090381F00F8017E137C5B4848137E4848133E0007143F5B120F485AA248
5A157F127F90C7FCA215FF5A4814FEA2140115FC5AEC03F8A2EC07F015E0140F007C14C0
007EEB1F80003EEB3F00147E6C13F8380F83F03803FFC0C648C7FC202677A42A>I<9039
078007C090391FE03FF090393CF0787C903938F8E03E9038787FC00170497EECFF00D9F0
FE148013E05CEA01E113C15CA2D80003143FA25CA20107147FA24A1400A2010F5C5E5C4B
5A131F5EEC80035E013F495A6E485A5E6E48C7FC017F133EEC70FC90387E3FF0EC0F8001
FEC9FCA25BA21201A25BA21203A25B1207B512C0A3293580A42A>I<ECF803903807FE07
90381F871F90383E03BF017C13FEEBF80112013803F000484813FC120F5B001F130115F8
EA3F80A2007F1303010013F0A34813074814E0A3140F4814C0A3141F1580143FA2007C13
7FECFF006C5AEB03BF381F0F7F3807FE7EEA01F0C7FC14FE5CA313015CA313035C130748
B512C0A3203577A426>I<3903C003F0390FF01FFC391E783C0F381C7C703A3C3EE03F80
38383FC0EB7F800078150000701300151CD8F07E90C7FCEAE0FE5BA2120012015BA31203
5BA312075BA3120F5BA3121F5BA3123F90C9FC120E212679A423>I<14FE903807FF8090
380F83C090383E00E04913F00178137001F813F00001130313F0A215E00003EB01C06DC7
FC7FEBFFC06C13F814FE6C7F6D13807F010F13C01300143F141F140F123E127E00FE1480
A348EB1F0012E06C133E00705B6C5B381E03E06CB45AD801FEC7FC1C267AA422>I<EB03
80EB07C0130FA4131F1480A3133F1400A35B137E007FB5FCA2B6FC3800FC00A312015BA3
12035BA312075BA3120F5BA3121FEB801CA2143C003F1338EB0078147014F014E0EB01C0
EA3E03381F0780380F0F00EA07FCEA01F0183579B31C>I<13F8D803FEEB01C0D8078FEB
03E0390E0F8007121E121C0038140F131F007815C01270013F131F00F0130000E015805B
D8007E133FA201FE14005B5D120149137EA215FE120349EBFC0EA20201131E161C15F813
E0163CD9F003133814070001ECF07091381EF8F03A00F83C78E090393FF03FC090390FC0
0F00272679A42D>I<01F0130ED803FC133FD8071EEB7F80EA0E1F121C123C0038143F49
131F0070140FA25BD8F07E140000E08013FEC6485B150E12015B151E0003141C5BA2153C
000714385B5DA35DA24A5A140300035C6D48C7FC0001130E3800F83CEB7FF8EB0FC02126
79A426>I<01F01507D803FC903903801F80D8071E903907C03FC0D80E1F130F121C123C
0038021F131F49EC800F00701607A249133FD8F07E168000E0ED000313FEC64849130718
000001147E5B03FE5B0003160E495BA2171E00070101141C01E05B173C1738A217781770
020314F05F0003010713016D486C485A000190391E7C07802800FC3C3E0FC7FC90393FF8
1FFE90390FE003F0322679A437>I<903907E007C090391FF81FF89039787C383C9038F0
3E703A01E01EE0FE3803C01F018013C0D8070014FC481480000E1570023F1300001E91C7
FC121CA2C75AA2147EA214FEA25CA21301A24A1370A2010314F016E0001C5B007E140101
0714C000FEEC0380010F1307010EEB0F0039781CF81E9038387C3C393FF03FF03907C00F
C027267CA427>I<13F0D803FCEB01C0D8071EEB03E0D80E1F1307121C123C0038140F49
14C01270A249131FD8F07E148012E013FEC648133F160012015B5D0003147E5BA215FE00
075C5BA214015DA314035D14070003130FEBF01F3901F87FE038007FF7EB1FC7EB000F5D
A2141F003F5C48133F92C7FC147E147C007E13FC387001F8EB03E06C485A383C1F80D80F
FEC8FCEA03F0233679A428>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fe cmtt9 9 60
/Fe 60 126 df<123C127E12FFAF127EAE123C1200A7123C127E12FFA4127E123C082F71
AE27>33 D<00101320007C13F838FE01FCAAEAFC00007C13F8A900381370161778AE27>
I<EB01C0EB03E0130F131FEB3FC0EB7F80EBFE00485A5B1203485A5B485AA2485AA248C7
FCA3127EA45AAC127EA47EA36C7EA26C7EA26C7E7F6C7E12017F6C7EEB7F80EB3FC0EB1F
E0130F1303EB01C0133A73B327>40 D<127012F812FE7E6C7E6C7EEA0FE06C7E12037F6C
7E1200137EA27FA2EB1F80A3EB0FC0A4EB07E0ACEB0FC0A4EB1F80A3EB3F00A2137EA25B
1201485A5B1207485AEA3FC0485A48C7FC5A12F81270133A7AB327>I<130F497EA60078
EB81E000FEEB87F000FF138FEBDFBF6CB512E06C14C0000F1400000313FCC613F0A20003
13FC000F13FF003F14C04814E039FFDFBFF0EB1F8F00FE13870078EB81E00000EB8000A6
6DC7FC1C207BA627>I<EB03C0497EAD007FB512FEB7FCA46C14FE390007E000AD6D5A20
227DA727>I<120FEA3FC013E0EA7FF0A213F8A2123FA2120F120113F01203EA07E0121F
EA7FC0EAFF8013005A12700D14738927>I<007FB512F8B612FCA46C14F81E067C9927>I<
121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A0A728927>I<EB07E0EB3FFC497E90B5FC48
14803903FC3FC03907F00FE0390FE007F0EBC003391F8001F8A248C712FCA2003E147C00
7E147EA3007C143E00FC143FAC007E147EA46C14FCA2EB8001001F14F8EBC003000F14F0
EBE0073907F00FE03903FC3FC06CB512806C14006D5A6D5AEB07E020307DAE27>48
D<130E131FA25B5BA25B5A5A127FB5FCA213BFEA7E3F1200B3AA003FB512805A15C01580
A21A2F79AE27>I<EB3FE03801FFF84813FE000FEBFF804814C0393FE07FE0EB800F397F
0007F0007EEB03F800FE13015A6C14FC1400A3127CC8FCA2140115F8A2140315F01407EC
0FE0EC1FC0143FEC7F80ECFF00495A495A495A495A495A495A495A01FEC7FC485AD807F8
1378484813FC485A485A48B5FCB6FCA36C14F81E2F7CAE27>I<121EEA7F80A2EAFFC0A4
EA7F80A2EA1E00C7FCAC121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A20729F27>58
D<120FEA3FC0A2EA7FE0A4EA3FC0A2EA0F00C7FCAC120FEA3F8013C0127F13E0A3123FA2
120F120713C0120FA2EA3F80EA7F005A5A12F812700B2A739F27>I<153815FC14011407
140FEC3FF8EC7FE0ECFFC001031300495AEB1FF8495A495A3801FF804890C7FCEA0FFC48
5AEA7FF0EAFFC05BA27FEA7FF0EA1FF86C7EEA03FF6C7F38007FE06D7E6D7EEB07FE6D7E
010013C0EC7FE0EC3FF8EC0FFC14071401140015381E287CAA27>I<007FB512FEB7FCA4
003F14FEC9FCA6003FB512FEB7FCA46C14FE20127D9F27>I<127012FC7E6C7E7FEA7FF0
EA1FF86C7EEA03FF6C7F38007FE06D7E6D7EEB07FE6D7E010013C0EC7FE0EC3FF8EC0FFC
1407A2140FEC3FF8EC7FE0ECFFC001031300495AEB1FF8495A495A3801FF804890C7FCEA
0FFC485AEA7FF0EAFFC05B48C8FC5A12701E287CAA27>I<EBFFF8000313FF000F14C000
3F14E04814F09038C01FF839FF0003FC4813011400A21401007C1303C7EA0FF8EC1FF0EC
7FE0ECFFC0491300EB03FC495A5C495A5C131F5CA76DC7FC90C8FCA7130F497E497EA46D
5A6DC7FC1E2E7CAD27>I<EB03F0497EA2497EA4143CEB1F3EA5EB3F3FA3EB3E1FA2017E
7FA4496C7EA548486C7EA390B5FCA24880A3EBF003A248486C7EA4000F803A7FFC0FFF80
00FF15C06D5A497E007F1580222F7EAE27>65 D<007FB5FCB612C08115F87E3907E003FC
EC00FE157E157F81A6157EA25D1403EC0FF890B55A15C015F081819038E000FE157FED3F
80151FA2ED0FC0A6151F1680153FED7F004A5A007FB55AB65A5D15E06C1480222E7FAD27
>I<903803F80E90381FFE1F90383FFFBF90B6FC5A3803FE0F3807F803497E48487E485A
49137FA248C7123FA25A127E151E150012FE5AAA7E127EA2151E007F143F7EA26C7E157F
6D137E6C6C13FE3907F001FCEBF8033903FE0FF86CB512F06C14E0013F13C06D1300EB03
F820307DAE27>I<387FFFFC14FFB612C06C80813907E00FF81407EC01FC6E7EA2157E15
7F811680151FA316C0150FABED1F80A3153F1600A25D15FEA24A5A4A5A140F007FB55A5D
B65A6C91C7FC14FC222E7FAD27>I<007FB61280B712C0A37E3907E0000FA6ED078092C7
FCA4EC07804A7EA390B5FCA5EBE00FA36E5A91C8FCAC387FFF80B57EA36C5B222E7EAD27
>70 D<007FB512E0B612F0A36C14E039001F8000B3B2007FB512E0B612F0A36C14E01C2E
7BAD27>73 D<387FFFC080B5FC7E5CD803F0C8FCB3AAED0780ED0FC0A7007FB6FCA2B7FC
7E1680222E7FAD27>76 D<D87FE0EB7FE0486CEBFFF0A26D5A007F15E0000F150001B813
DFEBBC03A3EBBE07019E139FA3EB9F0FA2018F131FA2149FA2EB879EA4EB839C14FCA3EB
81F8A2EB80F01400AAD87FF0EBFFE0486C4813F0A36C486C13E0242E7FAD27>I<3A7FF0
03FFE0486C4813F0A213FC007F6D13E000079038003E0013DEA313CFA3148013C714C0A2
13C314E0A213C114F0A3EBC0F8A31478147CA2143C143EA2141E141F140FA3EC07BEA3EC
03FEEA7FFCEAFFFE1401A26C486C5A242E7FAD27>I<EBFFFC0007EBFF80001F14E0A248
14F0EBC00F397F8007F8EB0003007E1301A348EB00FCB3A76C1301007E14F8A3007F1303
EB8007393FE01FF090B5FC6C14E0A200071480C6EBFC001E307CAE27>I<007FB5FCB612
E081816C803907E003FEEC00FF81ED3F80151F16C0150FA6151F1680153FED7F005DEC03
FE90B55A5D5D5D92C7FC01E0C8FCADEA7FFEB5FCA36C5A222E7FAD27>I<387FFFF0B512
FE6E7E816C803907E01FF014076E7E1401811400A514015D14034A5A141F90B55A5D5DA2
81EBE01F6E7E14076E7EA816F0EDF1F8A4397FFE01FBB5EBFFF08016E06C48EB7FC0C8EA
1F00252F7FAD27>82 D<90387FC0E03901FFF1F0000713FF5A5AEA3FE0EB801F387F000F
007E130712FE5A1403A3EC01E06C90C7FC127E127FEA3FC013F86CB47E6C13F86C13FE6C
EBFF80C614C0010F13E0010013F0140FEC07F81403140115FC1400127812FCA46CEB01F8
A26C130390388007F09038F01FE090B5FC15C0150000F85B38701FF81E307CAE27>I<00
7FB61280B712C0A439FC03F00FA60078EC0780000091C7FCB3AB90B512C04880A36C5C22
2E7EAD27>I<3A7FFC03FFE06D5A00FF15F0007F15E0497E3A07E0007E00A46C6C5BA4EB
F80100015CA46C6C485AA490387E07E0A56D485AA4011F5B149FA3010F90C7FCA5EB07FE
A46D5AA26D5A242F7FAD27>86 D<D87FE0EB7FE0486CEBFFF0A36C48EB7FE0001FC7EA0F
80A76C6CEB1F00A614F0EB81F83907C3FC3EA4149CEBC79EA30003143CA301E7137CEBEF
9FA2140FA200011478A49038FE07F8A300005CA2EBFC0390387801E0242F7FAD27>I<00
7FB512F8B612FCA46C14F81E067C7E27>95 D<3803FFC0000F13F04813FC4813FF811380
EC1FC0381F000F000480C71207A2EB0FFF137F0003B5FC120F5A383FFC07EA7FC0130012
FE5AA46C130F007F131FEBC0FF6CB612806C15C07E000313F1C69038807F8022207C9F27
>97 D<EA7FE0487EA3127F1203A914FF01F313C090B512F08181EC81FE49C67E49EB3F80
49131F16C049130FA216E01507A6150F16C07F151F6DEB3F80157F6DEBFF009038FF83FE
ECFFFC5D5D01F313C02601E0FEC7FC232E7FAD27>I<EB0FFF017F13C048B512E04814F0
5A380FF807EA1FE0393FC003E0903880008048C8FC127EA212FE5AA67E127EA2007F14F0
393F8001F813C0381FE003390FF80FF06CB5FC6C14E06C14C06C6C1300EB0FF81D207B9F
27>I<EC3FF04A7EA3143F1401A9EB0FE1EB7FFD48B5FC5A5A380FF83F381FE00F383FC0
07EB8003EA7F00007E1301A212FE5AA67E007E1303A2127F6C1307EB800F381FE01F380F
F03F6CB612C06C15E06C13FD38007FF9D91FE013C0232E7EAD27>I<EB0FF8EB3FFE90B5
1280000314C04814E0390FFC0FF0391FE003F8EBC001D83F8013FC48C7FC127E157E12FE
B612FEA415FC00FCC8FC7E127E127F6C143C6D137E6C7E01F013FE390FFC07FC6CB5FC00
0114F86C14F0013F13C0903807FE001F207D9F27>I<EC1FF0ECFFF84913FC4913FE5BEB
0FF014C0011F137CEC8000A6007FB512F0B612F8A36C14F039001F8000B3A4003FB512C0
4814E0A36C14C01F2E7EAD27>I<153F90391FC0FF80D97FF313C048B612E05A4814EF39
0FF07F873A1FC01FC3C0EDC000EB800F48486C7EA66C6C485AEBC01FA2390FF07F8090B5
C7FC5C485BEB7FF0EB1FC090C9FCA27F6CB5FC15E015F84814FE4880EB8001007EC7EA3F
80007C140F00FC15C0481407A46C140F007C1580007F143F6C6CEB7F009038F807FF6CB5
5A000714F86C5CC614C0D90FFCC7FC23337EA027>I<EA7FE0487EA3127F1203A9147F90
38F1FFC001F713F090B5FC8114C1EC01FCEBFE005B5BA25BB03A7FFF83FFE0B500C713F0
A36C018313E0242E7FAD27>I<130F497E497EA46D5A6DC7FC90C8FCA7383FFF80487FA3
7EEA000FB3A4007FB512F0B6FC15F815F07E1D2F7BAE27>I<387FFF80B57EA37EEA000F
B3B2007FB512F8B612FCA36C14F81E2E7CAD27>108 D<397F07C01F3AFF9FF07FC09039
FFF9FFE091B57E7E3A0FFC7FF1F89038F03FC001E0138001C01300A3EB803EB03A7FF0FF
C3FF486C01E3138001F913E701F813E36C4801C313002920819F27>I<387FE07F39FFF1
FFC001F713F090B5FC6C80000313C1EC01FCEBFE005B5BA25BB03A7FFF83FFE0B500C713
F0A36C018313E024207F9F27>I<EB1FE0EB7FF83801FFFE487F481480390FF03FC0391F
C00FE0393F8007F0EB00034814F8007E1301A248EB00FCA76C1301007E14F8A2007F1303
393F8007F0A2391FE01FE0390FF03FC06CB512806C14006C5B38007FF8EB1FE01E207C9F
27>I<387FE0FFD8FFF313C090B512F0816C800003EB81FE49C67E49EB3F8049131F16C0
49130FA216E01507A6150F16C07F151F6DEB3F80157F6DEBFF009038FF83FEECFFFC5D5D
01F313C0D9F0FEC7FC91C8FCAC387FFF80B57EA36C5B23317F9F27>I<90380FF03C9038
3FFE7E90B5FC000314FE5A380FFC1F381FE007EBC003383F800148C7FC127EA200FE147E
5AA67E007E14FEA2007F1301EA3F80EBC003381FE007380FF81F6CB5FC7E6C147E38007F
FCEB0FF090C7FCAC91381FFFF8A24A13FC6E13F8A226317E9F27>I<397FFC03FC39FFFE
0FFF023F13804A13C0007F90B5FC39007FFE1F14F89138F00F809138E002004AC7FC5CA2
91C8FCA2137EAD007FB57EB67EA36C5C22207E9F27>I<9038FFF3800007EBFFC0121F5A
5AEB803F38FC000F5AA2EC07806C90C7FCEA7F8013FC383FFFF06C13FC000713FF000114
80D8000F13C09038003FE014070078EB03F000FC1301A27E14036CEB07E0EBE01F90B512
C01580150000FB13FC38707FF01C207B9F27>I<133C137EA8007FB512F0B612F8A36C14
F0D8007EC7FCAE1518157EA415FE6D13FC1483ECFFF86D13F06D13E0010313C001001300
1F297EA827>I<397FE01FF8486C487EA3007F131F00031300B21401A21403EBFC0F6CB6
12E016F07EEB3FFE90390FF87FE024207F9F27>I<3A7FFC0FFF80486C4813C0A36C486C
13803A07C000F800EBE00100035CA2EBF00300015CA2EBF80700005CA390387C0F80A36D
48C7FCA3EB3F3FEB1F3EA214FE6D5AA36D5AA26D5A22207E9F27>I<3A7FFE07FFE000FF
15F06D5A497E007F15E03A0F80001F00A36D5B0007143EA414F0EBC1F83903E3FC7CA4EB
E79EA200011478A301F713F8A2EBFF0F6C5CA3EBFE0790387C03E024207F9F27>I<393F
FC1FFF486C5A168016006C487E3901F807E06C6C485A4A5A017E90C7FC6D5AEB1F7E5C6D
5A13076D5A5C80497E130F497E143EEB3E3FEB7E1F90387C0F8001F87F00016D7E3803F0
033A7FFE1FFF80A2B54813C06C486C1380A222207E9F27>I<3A7FFC0FFF80486C4813C0
A36C486C13803A07E000F800000313015D13F00001130301F85B1200A26D485A137CA290
387E0F80133EA2011F90C7FC5CA2130F149E14BE130714FC1303A25C1301A25CA213035C
A213075C1208EA3E0F007F5B131FD87E7FC8FCEA7FFE6C5A5B6C5AEA07C022317E9F27>
I<EC07F8EC3FFC14FF130315F8903807FE00EB0FF05C5CB0131FEB7F80EA3FFFB5C7FC5B
A27F003F7FEA007FEB1FC0130FB08080EB07FE903803FFF815FC1300143FEC07F81E3A7C
B327>123 D<EA7F80EAFFF013FC13FF7E00017F38003FC0131F130FB080EB07F8ECFFF0
6D13FC7FA25B4913F0ECF800EB0FE05CB0131F133F48B45A007F90C7FCB5FC13FC13F0EA
7F801E3A7CB327>125 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Ff cmtt10 10 93
/Ff 93 126 df<121C127FEAFF80B1EA7F00AF123EC7FCA8121C127FA2EAFF80A3EA7F00
A2121C09346FB32C>33 D<003C131E007F137F481480A66C1400A6007E7FA6003E133EA3
003C131E001C131C191977B32C>I<010F133C90381F807EA8013F13FE4A5AA4007FB612
F0B712F8A4003F15F03A007E01F800A5EBFE0301FC5BA6003FB612F0B712F8A46C15F03A
01F807E000A30003130F01F05BA86C486C5A25337DB22C>I<EB01C0497EA6EB0FFC9038
7FFF8048B512E00007804880391FFBEFFC393FC3E1FE903803E07F007E80127C00FC1580
12F8157FA300FCEC3F00A2007E91C7FC127FEA3FC313FBEA1FFF6C13FC6C13FF000114C0
6C6C7F011F13F801037F14E7ECE1FEECE07F81001880007E1580150F12FFA312FE151F16
00007E5C007F143ED83F8313FE9038C3E1FC391FFBEFF86CB55A6C5C6C5CC691C7FCEB1F
F8EB03E0A66D5A21417BB92C>I<D807801307D81FE0EB0F80151F487E486C133F160000
7C5CD8FCFC137EEAF87C15FE5D14015DA21403D8FCFC5BEA7CF8007F13075D383FF00FD8
1FE05BA23807801FC75B143F92C7FCA25C147E14FE5CA213015CA213035C13075CA2130F
5C131FEC800FED3FC0013FEB7FE0140049EBFFF0017E13F9A2D9FE0113F801FC13F0A212
0113F8120313F015F90007010013F05B000F14FF49EB7FE0A20007EC3FC06C48EB0F0025
417DB92C>I<EB0FC0EB3FE0497E497E80EA01F8EBF07C147E0003133E13E0A5147E147C
9138FC3FF89039F0F87FFCEA01F1EBF3F001F7EB3FF89138E01F009038FFC03F6CEB803E
A2EC007E49137C485A486C13FC00075CEBFF01D80FDF5B381F9F81383F8F8390380FC3E0
387E07E75D38FC03F7EB01FF5D6D1410ED007C80A26CEBFF80D87E0113C0D87F03EBE0FC
3A3F87F7F1F89038FFE3FF6C01C113F06C13806C9038007FC0D801FCEB1F8026357EB32C
>I<EA0F80EA1FC0EA3FE013F0A213F8A2121F120F1200A4120113F0A2120313E01207EA
0FC0121FEA3F80EA7F0012FE5A5A12700D1B71B22C>I<143814FC13011303EB07F8EB0F
F0EB1FC0EB3F80EB7F0013FE485A485A5B12075B120F5B485AA2123F90C7FCA25A127EA3
12FE5AAC7E127EA3127F7EA27F121FA26C7E7F12077F12037F6C7E6C7E137FEB3F80EB1F
C0EB0FF0EB07F8EB03FC130113001438164272B92C>I<127012FC7E7E6C7E6C7EEA0FE0
6C7E6C7E6C7E6C7E137F7F1480131F14C0130FEB07E0A214F01303A214F81301A314FC13
00AC130114F8A3130314F0A2130714E0A2EB0FC0131F1480133F14005B13FE485A485A48
5A485AEA3FC0485A48C7FC5A5A1270164279B92C>I<EB0380497EA60020140800F8143E
00FE14FE00FF13C1EBC7C7EBE7CF003FB512F8000F14E0000314806C140038007FFCA248
B5FC481480000F14E0003F14F839FFE7CFFEEBC7C7EB07C100FE13C000F8143E00201408
00001400A66D5A1F247AAA2C>I<147814FCAF007FB612F0B712F8A46C15F0C700FCC7FC
AF147825267DAB2C>I<EA0F80EA1FE0EA3FF0EA7FF8A213FCA3123F121F120F120013F8
A21201EA03F01207EA1FE0EA7FC0EAFF80130012FC12700E17718A2C>I<007FB6FCB712
80A46C150021067B9B2C>I<121FEA3F80EA7FC0EAFFE0A5EA7FC0EA3F80EA1F000B0B70
8A2C>I<1507ED0F80151FA2153F16005D157E15FE5D14015D14035DA214075D140F5D14
1F5D143F92C7FC5C147E14FE5CA213015C13035C13075C130F5C131F5CA2133F91C8FC5B
137E13FE5B12015B12035B12075BA2120F5B121F5B123F90C9FC5A127E12FE5AA25A1278
21417BB92C>I<EB03F8EB0FFE90383FFF80497F90B57E3901FE0FF03903F803F848486C
7EEBE0004848137EA248487FA248C7EA1F80A2003E140F007E15C0A3007C140700FC15E0
AC6C140F007E15C0A46CEC1F80A36C6CEB3F00A26C6C137E6D13FE00075CEBF0016C6C48
5A3901FE0FF06CB55A6D5B6D5BD90FFEC7FCEB03F823357CB32C>I<1307497EA2131FA2
133F137F13FF5A1207127FB5FC13DF139FEA7C1F1200B3AE007FB512E0B612F0A36C14E0
1C3477B32C>I<EB0FF890387FFF8048B512E00007804814FC391FF80FFE393FE001FF90
3880007F48C7EA3F80007E141F00FE15C0150F6C15E01507A3127E123CC8FCA2150F16C0
151F1680153F16005D15FE4A5A14034A5A4A5A4A5A4A5AECFF804948C7FC495A495A495A
EB3FE0EB7F8049C8FC485A4848EB03C04848EB07E0EA1FE0485A48B6FCB7FCA36C15C023
347CB32C>I<EB0FFC90387FFF8048B512E0000714F84880391FF807FEEBC0004848137F
6D7F1680151FA26C5A6CC7FCC8FC153F16005D15FE14014A5AEC1FF890381FFFF0495BA2
15F86D7F90380007FEEC00FF81ED3F80ED1FC0150FA216E01507A2123C127EB4FC150F16
C0A248141F007FEC3F806DEB7F006C6C5B391FF807FE6CB55A6C5C6C14E0C66C1380D90F
FCC7FC23357CB32C>I<EC07F04A7E141F143FA2147EA214FCEB01F8A2EB03F0EB07E0A2
EB0FC0EB1F80A2EB3F00137EA25B485AA2485A5B1207485AA2485A48C7FCA2127E5AB712
FC16FEA36C15FCC8EAF800AA91387FFFF091B512F8A36E13F027347EB32C>I<000FB512
FE4880A35D0180C8FCADEB83FE90389FFF8090B512E015F8819038FE03FE9038F000FF01
C07F49EB3F8090C7121F6C15C0C8120FA2ED07E0A4123C127EB4FC150F16C0A248141F00
7EEC3F80007FEC7F006C6C5B6D485A391FF80FFC6CB55A6C5C000114C06C6C90C7FCEB0F
F823347CB22C>I<EC3FC0903801FFF801077F011F7F497F90387FE07F9039FF003F8048
48137FEA03F8485A5B000FEC3F004848131E4990C7FC123F90C9FCA25A127EEB03FE9038
1FFF80D8FC7F13E000FDB57EB67E9038FE07FC9038F001FE9038C0007F49EB3F8090C712
1F16C048140F16E01507A3127EA47E150F6D14C0001F141F6D1480000F143F6DEB7F0039
07F801FE3903FE07FC6CB55A6C5C6D5B011F1380D907FCC7FC23357CB32C>I<1278B712
C016E0A316C000FCC7EA3F80ED7F0015FE00785CC712014A5A4A5A5D140F5D4A5A143F92
C7FC5C147E14FE5C13015CA2495AA213075CA3495AA4495AA5133F91C8FCAA131E23357C
B32C>I<EB07FC90383FFF8090B512E0000314F84880390FFC07FE391FF001FF9038C000
7F4848EB3F8090C7121F4815C0007E140FA56CEC1F80A26C6CEB3F006D5B390FF001FE39
03FC07F86CB55A6C6C13C0D907FCC7FC90387FFFC048B512F03903FC07F8390FF001FE39
1FC0007F497F48C7EA1F80007EEC0FC0A248EC07E0A7007EEC0FC0A2007F141F6C6CEB3F
806C6CEB7F009038F001FF390FFC07FE6CB55A6C5CC614E0013F1380D907FCC7FC23357C
B32C>I<EB07FCEB3FFF90B512C0488048803907FC07F8390FF001FC48486C7ED83F8013
7E157F48C77E007EEC1F8012FE5AED0FC0A416E0A37E127E007F141F7E6D133F6C6C137F
390FF001FF3807FC0F6CB6FC6C14F76C14C7013F130FD90FF813C090C7FCA2151F168015
3F1600000F5C486C137E486C13FE4A5A4A5A14079038801FF0391FE07FE090B55A6C91C7
FC6C5B000113F838007FC023357CB32C>I<121FEA3F80EA7FC0EAFFE0A5EA7FC0EA3F80
EA1F00C7FCAE121FEA3F80EA7FC0EAFFE0A5EA7FC0EA3F80EA1F000B2470A32C>I<EA0F
80EA1FC0EA3FE0EA7FF0A5EA3FE0EA1FC0EA0F80C7FCAEEA0F80EA1FC0EA3FE0127F13F0
A4123F121F120F1201120313E01207EA0FC0A2EA3F80EA7F005A5A12F812700C3071A32C
>I<1507ED1F80153F15FF14034A1300EC1FFC4A5AECFFE0491380010790C7FCEB0FFCEB
3FF8EB7FE048485A4890C8FCEA0FFEEA1FF8EA7FF0EAFFC05BA27FEA7FF0EA1FF8EA0FFE
EA03FF6C13C06C6C7EEB3FF8EB0FFC6DB4FC01017F6D13E0EC3FF86E7EEC07FF6E138014
00153F151FED0700212A7BAD2C>I<007FB612F0B712F8A4003F15F0CAFCA8003FB612F0
B712F8A46C15F025147DA22C>I<127012FC7E6C7E13E06C7EEA1FFC6C7E3803FF80C67F
EB7FF0EB1FF8EB0FFEEB03FF6D13C06D6C7EEC3FF8EC0FFC6EB4FC0201138080A25C0207
1300EC0FFCEC3FF8EC7FE049485A4990C7FCEB0FFEEB1FF8EB7FF0EBFFC000035BD80FFE
C8FC485AEA7FF0485A138048C9FC5A1270212A7BAD2C>I<EB3FFE0003B512C0000F14F0
4814FC4880397FE007FF90C7FC00FEEC3F806C141FA3153F007EEC7F00003C5CC7EA03FE
EC0FFC4A5AEC3FE04A5A4AC7FC495A495A5C13075C130F5CA76D5A90C9FCA8EB0380EB0F
E0A2497EA36D5AA2EB038021337BB22C>I<EC7F80903803FFE0010F7F013F7F497F9038
FFC0FE3901FE007FD803F87F4848EB1F809038E00FCF390FC03FFF48484813C091B5FCEA
3F01393E03F87F903907F03FE0007EEBE01F397C0FC00FEC8007A2EAFC1F00F8EB0003A9
00FCEB8007D87C0F14C0A2ECC00F3A7E07E01F80003EEBF03F903903F87F00393F01FFFE
D81F805B6E5A6C6C6C5A3907E00FC09039F00007C06C6CEB0FE0D801FE131F3900FFC0FF
6DB512C06D1480010FEBFE00010313F89038007FC023337CB22C>I<14FE497EA4497FA2
14EFA2130781A214C7A2010F7FA314C390381F83F0A590383F01F8A490387E00FCA54913
7E90B512FEA34880A29038F8003FA34848EB1F80A4000715C049130FD87FFEEBFFFC6D5A
B514FE6C15FC497E27347EB32C>I<007FB512E015F8B612FE6C8016C03903F0003FED0F
E0ED07F01503A2ED01F8A6ED03F0A21507ED0FE0ED1FC0EDFF8090B612005D5D15FF16C0
9039F0001FE0ED07F0ED03F81501ED00FCA216FE167EA616FE16FC1501ED03F8150FED3F
F0007FB612E016C0B712806CECFE0015F027337FB22C>I<02FF13700107EBE0F84913F9
013F13FD4913FFEBFF813901FE007F4848131FD807F0130F1507485A491303485A150148
C7FCA25A007EEC00F01600A212FE5AAB7E127EA3007F15F06CEC01F8A26C7EA26C6C1303
6D14F06C6C130716E0D803FC131F6C6CEB3FC03A00FF81FF806DB512006D5B010F5B6D13
F00100138025357DB32C>I<007FB5FCB612C015F0816C803907E003FEEC00FFED7F8015
3FED1FC0ED0FE0A2150716F0150316F81501A4ED00FCACED01F8A3150316F0A2150716E0
150FED1FC0153FED7F80EDFF00EC03FE007FB55AB65A5D15C06C91C7FC26337EB22C>I<
007FB612F0B712F8A37E3903F00001A7ED00F01600A4EC01E04A7EA490B5FCA5EBF003A4
6E5A91C8FCA5163C167EA8007FB612FEB7FCA36C15FC27337EB22C>I<007FB612F8B712
FCA37ED803F0C7FCA716781600A515F04A7EA490B5FCA5EBF001A46E5A92C7FCAD387FFF
E0B5FC805C7E26337EB22C>I<903901FC038090390FFF87C04913EF017F13FF90B6FC48
13073803FC01497E4848137F4848133F49131F121F5B003F140F90C7FCA2127EED078092
C7FCA212FE5AA8913803FFF84A13FCA27E007E6D13F89138000FC0A36C141FA27F121F6D
133F120F6D137F6C7E6C6C13FF6D5A3801FF076C90B5FC6D13EF011F13CF6DEB0780D901
FCC7FC26357DB32C>I<D87FFEEBFFFCB54813FEA36C486C13FCD807E0EB0FC0B190B6FC
A59038E0000FB3D87FFEEBFFFCB54813FEA36C486C13FC27337EB22C>I<007FB512F8B6
12FCA36C14F839000FC000B3B3A5007FB512F8B612FCA36C14F81E3379B22C>I<0107B5
12804914C0A36D148090390003F000B3AF1218127EA2B4FCA24A5A48130F007F131F9038
C07FC06CB55A6C91C7FC6C5B000313F838007FC022347BB22C>I<D87FFCEB7FF8486CEB
FFFCA36C48EB7FF8D807C0EB1F80153FED7F00157E5D4A5A14034A5A5D4A5A4A5A143F4A
C7FC147E5CEBC1F813C3EBC7FCA2EBCFFEEBDFBEEBFFBF141F01FE7F496C7E13F86E7EEB
F00301E07FEBC001816E7EA2157E153E153F811680ED0FC0A2ED07E0D87FFCEB1FFC486C
EB3FFEA36C48EB1FFC27337EB22C>I<387FFFE0B57EA36C5BD803F0C8FCB3AE16F0ED01
F8A8007FB6FCB7FCA36C15F025337DB22C>I<D87FE0EB0FFC486CEB1FFEA26D133F007F
15FC000F15E001BC137BA4019E13F3A3EB9F01A2018F13E3A21483A2018713C314C7A201
831383A214EFA201811303A214FFEB80FEA3147C14381400ACD87FF0EB1FFC486CEB3FFE
A36C48EB1FFC27337EB22C>I<D87FF0EB7FFC486CEBFFFEA27F007FEC7FFCD807FEEB07
C013DEA213DF13CFA2148013C714C0A213C314E0A213C114F0A213C014F8A2147CA3143E
A2141E141FA2140F1587A2140715C7A2140315E71401A215F71400A215FFD87FFC137F48
7E153FA26C48EB1F8027337EB22C>I<EB7FFF0003B512E0000F14F848804880EBE003EB
800048C7127FA2007E80A300FE158048141FB3A86C143FA2007E1500A3007F5CA26C6C13
FEEBF00790B5FC6C5C6C5C000314E0C66C90C7FC21357BB32C>I<007FB512C0B612F881
15FF6C15802603F00013C0153FED0FE0ED07F0A2150316F81501A6150316F01507A2ED0F
E0ED3FC015FF90B61280160015FC5D15C001F0C8FCB0387FFF80B57EA36C5B25337EB22C
>I<EB7FFF0003B512E0000F14F848804880EBF007EB800048C7127FA2007E80A300FE15
8048141FB3A7EB01F0EB03F800FE143F267E01FC1300A2EB00FE007F5C147FD83F8013FE
EBF03F90B5FC6C5C6C5C000314E0C67E90380007F0A26E7EA26E7EA26E7EA2157FA2153E
21407BB32C>I<387FFFFCB67E15E015F86C803907E007FE1401EC007F6F7E151FA26F7E
A64B5AA2153F4BC7FCEC01FE140790B55A5D15E081819038E007FCEC01FE1400157F81A8
160FEE1F80A5D87FFEEB1FBFB5ECFF00815E6C486D5AC8EA01F029347EB22C>I<90381F
F80790B5EA0F804814CF000714FF5A381FF01F383FC003497E48C7FC007E147F00FE143F
5A151FA46CEC0F00007E91C7FC127F7FEA3FE0EA1FFCEBFFC06C13FC0003EBFFC06C14F0
6C6C7F01077F9038007FFEEC07FF02001380153FED1FC0A2ED0FE0A20078140712FCA56C
EC0FC0A26CEC1F806D133F01E0EB7F009038FE01FF90B55A5D00F914F0D8F83F13C0D870
0790C7FC23357CB32C>I<007FB612FCB712FEA43AFC007E007EA70078153CC71400B3AF
90383FFFFCA2497F6D5BA227337EB22C>I<3B7FFF803FFFC0B56C4813E0A36C496C13C0
3B03F00001F800B3AF6D130300015DA26D130700005D6D130F017F495A6D6C485AECE0FF
6DB5C7FC6D5B010313F86D5B9038003F802B3480B22C>I<D87FFCEB7FFC486CEBFFFEA3
6C48EB7FFCD80FC0EB07E06D130F000715C0A36D131F00031580A36D133F00011500A36D
5B0000147EA4017E5BA46D485AA490381F83F0A4010F5B14C7A301075BA214EFA201035B
A214FFA26D90C7FCA46D5A27347EB22C>I<D87FF0EB07FF486C491380A36C486D130000
1FC8127CA46C6C5CA76C6C495AA4143E147FA33A03E0FF83E0A214F7A201E113C3A30001
01E35BA201F113C701F313E7A314C1A200005DA201F713F71480A301FF13FF017F91C7FC
4A7EA4013E133E29347FB22C>I<3A3FFF03FFE0484913F0148714076C6D13E03A01F800
FE007F0000495A13FE017E5BEB7F03013F5B1487011F5B14CF010F5B14FF6D5BA26D90C7
FCA26D5AA26D5AA2497EA2497EA2497F81EB0FCF81EB1FC7EC87F0EB3F83EC03F8EB7F01
017E7FEBFE00497F0001147E49137F000380491480151FD87FFEEBFFFC6D5AB514FE6C15
FC497E27337EB22C>I<D87FFCEB7FFC486CEBFFFEA36C48EB7FFCD807F0EB0FC0151F00
0315806D133F12016DEB7F0012006D137E017E13FE017F5BEB3F01EC81F8131FEC83F0EB
0FC314C7903807E7E0A201035B14EF6DB45AA292C7FC7F5C147EB0903807FFE0497FA36D
5B27337EB22C>I<003FB612C04815E0A4007EC7EA1FC0ED3F80A2ED7F00157E15FE4A5A
003C5CC712034A5AA24A5A4A5AA24A5A4AC7FCA214FE495AA2495A495AA2495A495AA249
5A49C8FCA213FE485AA24848EB03C049EB07E01207485A5B121F485AA248C7FCB7FCA46C
15C023337CB22C>I<387FFFFCB512FEA314FC00FCC7FCB3B3B3B512FC14FEA36C13FC17
416FB92C>I<127812F87EA27E127E127F7E7F121F7F120F7F1207A27F12037F12017F12
007F137E137F7F80131FA280130F801307801303801301801300A280147E147F8081141F
81140F811407811403A281140181140081157E157F811680151FA2150FED070021417BB9
2C>I<387FFFFCB512FEA37EC7127EB3B3B3387FFFFEB5FCA36C13FC17417DB92C>I<130E
EB3F80EBFFE0000313F8000F13FE487FD87FF113C0D8FFE013E0EB803F38FE000F007CEB
07C00030EB01801B0C78B22C>I<007FB6FCB71280A46C150021067B7D2C>I<137013F812
011203EA07F0EA0FE0EA1FC01380EA3F00123E127E127CA212FC5AA4EAFF8013C013E0A2
127FA2123FEA1FC0EA0F800D1B71B82C>I<3801FFF0000713FE001F6D7E15E048809038
C01FF81407EC01FC381F80000006C77EC8127EA3ECFFFE131F90B5FC1203120F48EB807E
383FF800EA7FC090C7FC12FE5AA47E007F14FEEB8003383FE01F6CB612FC6C15FE6C14BF
0001EBFE1F3A003FF007FC27247CA32C>I<EA7FF0487EA3127F1201AAEC1FE0ECFFF801
FB13FE90B6FC16809138F07FC09138801FE091380007F049EB03F85BED01FC491300A216
FE167EA816FE6D14FCA2ED01F86D13036DEB07F0150F9138801FE09138E07FC091B51280
160001FB5B01F813F83900F03FC027337FB22C>I<903803FFE0011F13F8017F13FE48B5
FC48804848C6FCEA0FF0485A49137E4848131890C9FC5A127EA25AA8127EA2127F6C140F
6DEB1F806C7E6D133F6C6CEB7F003907FE03FF6CB55A6C5C6C6C5B011F13E0010390C7FC
21247AA32C>I<EC0FFE4A7EA380EC003FAAEB07F8EB3FFE90B512BF4814FF5A3807FC0F
380FF00348487E497E48487F90C7FC007E80A212FE5AA87E007E5CA2007F5C6C7E5C6C6C
5A380FF0073807FC1F6CB612FC6CECBFFE6C143FEB3FFC90390FF01FFC27337DB22C>I<
EB03FE90381FFFC0017F13F048B57E48803907FE03FE390FF800FFD81FE0EB3F805B4848
EB1FC090C7120F5A007E15E015075AB7FCA416C000FCC9FC7E127EA2127F6CEC03C06DEB
07E06C7ED80FF0130F6C6CEB3FC001FF13FF000190B512806C1500013F13FC010F13F001
01138023247CA32C>I<EC0FF8EC3FFE91B5FC4914805B903807FC7F14F090390FE03F00
14C092C7FCA6007FB512FEB7FCA36C5C26000FC0C7FCB3A8003FB512F04880A36C5C2133
7DB22C>I<ED03F8903907F80FFC90391FFE3FFE017FB6FC48B7FC48ECFE7F9038FC0FF8
2607F003133E3A0FE001FC1CD9C0001300001F8049137EA66D13FE000F5CEBE0016C6C48
5A3903FC0FF048B5FC5D481480D99FFEC7FCEB87F80180C8FCA37F6C7E90B512F06C14FE
48ECFF804815E04815F03A3FC0001FF848C7EA03FC007E1400007C157C00FC157E48153E
A46C157E007E15FCD87F801303D83FE0EB0FF8D81FFCEB7FF06CB612E0000315806C1500
D8003F13F8010713C028387EA42C>I<EA7FF0487EA3127F1201AAEC1FE0EC7FFC9038F9
FFFE01FB7F90B6FC9138F03F80ECC01F02807FEC000F5B5BA25BB3267FFFE0B5FCB500F1
1480A36C01E0140029337FB22C>I<1307EB1FC0A2497EA36D5AA20107C7FC90C8FCA738
7FFFC080B5FC7EA2EA0007B3A8007FB512FCB612FEA36C14FC1F3479B32C>I<140EEC3F
80A2EC7FC0A3EC3F80A2EC0E0091C7FCA748B512804814C0A37EC7120FB3B3A2141F003C
1480007E133FB414005CEB01FEEBFFFC6C5B5C001F5B000790C7FC1A467CB32C>I<EA7F
E0487EA3127F1201AA91381FFFF04A13F8A36E13F0913800FE004A5A4A5A4A5A4A5A4A5A
4A5A4AC7FC14FEEBF1FC13F3EBF7FE90B5FCA2EC9F80EC0FC001FE7FEBFC07496C7E496C
7E811400157E811680151F3A7FFFC0FFFCB500E113FEA36C01C013FC27337EB22C>I<38
7FFFE0B57EA37EEA0003B3B3A5007FB61280B712C0A36C158022337BB22C>I<3A7F83F0
07E09039CFFC1FF83AFFDFFE3FFCD87FFF13FF91B57E3A07FE1FFC3E01FCEBF83F496C48
7E01F013E001E013C0A301C01380B33B7FFC3FF87FF0027F13FFD8FFFE6D13F8D87FFC49
13F0023F137F2D2481A32C>I<397FF01FE039FFF87FFC9038F9FFFE01FB7F6CB6FC0001
9038F03F80ECC01F02807FEC000F5B5BA25BB3267FFFE0B5FCB500F11480A36C01E01400
29247FA32C>I<EB07FCEB1FFF017F13C048B512F048803907FC07FC390FF001FE48486C
7E0180133F003F158090C7121F007EEC0FC0A348EC07E0A76C140F007E15C0A2007F141F
6C15806D133F6C6CEB7F006D5B6C6C485A3907FC07FC6CB55A6C5C6C6C13C0011F90C7FC
EB07FC23247CA32C>I<397FF01FE039FFF8FFF801FB13FE90B6FC6C158000019038F07F
C09138801FE091380007F049EB03F85BED01FC491300A216FE167EA816FE6D14FCA2ED01
F86D13036DEB07F0150F9138801FE09138E07FC091B51280160001FB5B01F813F8EC3FC0
91C8FCAD387FFFE0B57EA36C5B27367FA32C>I<903903FC078090391FFF0FC0017F13CF
48B512EF4814FF3807FE07380FF00148487E49137F4848133F90C7FC48141F127E150F5A
A87E007E141FA26C143F7F6C6C137F6D13FF380FF0033807FC0F6CB6FC6C14EF6C6C138F
6D130FEB07F890C7FCAD0203B5FC4A1480A36E140029367DA32C>I<D87FFEEB3FC0B538
01FFF0020713F8021F13FC6C5B39003F7FE1ECFF019138FC00F84A13704A13005CA25C5C
A391C8FCAF007FB512E0B67EA36C5C26247EA32C>I<90387FF8700003B512F8120F5A5A
387FC00F387E00034813015AA36CEB00F0007F140013F0383FFFC06C13FE6CEBFF800003
14E0C66C13F8010113FCEB0007EC00FE0078147F00FC143F151F7EA26C143F6D133E6D13
FE9038F007FC90B5FC15F815E000F8148039701FFC0020247AA32C>I<131E133FA9007F
B6FCB71280A36C1500D8003FC8FCB1ED03C0ED07E0A5EC800F011FEB1FC0ECE07F6DB512
80160001035B6D13F89038003FE0232E7EAD2C>I<3A7FF003FF80486C487FA3007F7F00
01EB000FB3A3151FA2153F6D137F3900FE03FF90B7FC6D15807F6D13CF902603FE071300
29247FA32C>I<3A7FFF01FFFCB514FE148314016C15FC3A03E0000F80A26D131F000115
00A26D5B0000143EA26D137E017C137CA2017E13FC013E5BA2EB3F01011F5BA21483010F
5BA214C701075BA214EF01035BA214FF6D90C7FCA26D5A147C27247EA32C>I<D87FFFEB
7FFF6EB5FCB515806C16004A7ED807C0EB01F0A66C6C495AA3143E147FA2D801F0495AEC
FF87A214F7A201F113C700005D9038F9E3CFA201FB13EFA3D97BC190C7FC017F13FFA214
80A2013F5B90381F007C29247FA32C>I<3A3FFF03FFF048018713F8A36C010313F03A00
FC007E005D90387E01F8013F5BEB1F83EC87E090380FCFC0903807EF80EB03FF6D90C7FC
5C6D5A147C14FE130180903803EF80903807CFC0EB0FC7EC83E090381F01F0013F7FEB7E
00017C137C49137E0001803A7FFF01FFFC1483B514FE6C15FC140127247EA32C>I<3A7F
FF01FFFCB5008113FE148314816C010113FC3A03E0000F806C7E151F6D140012005D6D13
3E137C017E137E013E137CA2013F13FC6D5BA2EB0F815DA2EB07C1ECC3E0A2EB03E3ECE7
C0130114F75DEB00FFA292C7FC80A2143EA2147E147CA214FC5CA2EA0C01003F5BEA7F83
EB87E0EA7E0F495A387FFF806C90C8FC6C5A6C5AEA07E027367EA32C>I<003FB612E048
15F0A4007EC7EA1FE0ED3FC0ED7F80EDFF004A5A003C495AC7485A4A5A4A5A4A5A4A5A4A
C7FCEB01FC495AEB0FF0495A495A495A49C8FC4848EB01E04848EB03F0485A485A485A48
5A485AB7FCA46C15E024247DA32C>I<15FF02071380141F147F91B512004913C04AC7FC
EB03F85CB31307EB1FE013FF007F5BB55A49C8FC6D7E6C7FC67F131FEB07F01303B380EB
01FEECFFC06D13FF6E1380141F14070200130021417BB92C>I<127812FCB3B3B3A91278
06416DB92C>I<EA7FC0EAFFF813FE6D7E6C7FC67F131FEB07F01303B380EB01FEECFFC0
6D13FF6E1380141F147F91B512004913C04AC7FCEB03F85CB31307EB1FE013FF007F5BB5
5A49C8FC13F8EA7FC021417BB92C>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fg cmbx12 12 25
/Fg 25 122 df<B612F8A91D097F9A25>45 D<EC3FF849B5FC010F14E0013F14F890397F
F01FFC9039FFC007FE4890380001FF48486D1380000716C049147F000F16E049143F001F
16F0A2003F16F8A249141F007F16FCA600FF16FEB3A3007F16FCA56C6CEC3FF8A3001F16
F0A2000F16E06D147F000716C06D14FF6C6C4913806C6D4813006C6D485A90397FF01FFC
6DB55A010F14E0010314809026003FF8C7FC2F427CC038>48 D<EC03C01407141F147FEB
03FF133FB6FCA413C3EA0003B3B3ADB712FCA5264177C038>I<ECFFE0010F13FE013F6D
7E90B612E0000315F82607FC0313FE3A0FE0007FFFD81F806D138048C7000F13C0488001
C015E001F07F00FF6E13F07F17F881A46C5A6C5A6C5AC9FC17F05DA217E05D17C04B1380
4B1300A2ED1FFC4B5A5E4B5A4B5A4A90C7FC4A5A4A5AEC0FF04A5AEC3F804AC7127814FE
495A494814F8D907E014F0495A495A49C8FC017C140149140348B7FC4816E05A5A5A5A5A
B8FC17C0A42D417BC038>I<ECFFF0010713FF011F14C0017F14F049C66C7ED803F8EB3F
FED807E06D7E81D80FF86D138013FE001F16C07FA66C5A6C4815806C485BC814005D5E4B
5A4B5A4B5A4A5B020F1380902607FFFEC7FC15F815FF16C090C713F0ED3FFCED0FFEEEFF
80816F13C017E0A26F13F0A217F8A3EA0FC0EA3FF0487EA2487EA217F0A25D17E06C5A49
4913C05BD83F80491380D81FF0491300D80FFEEBFFFE6CB612F800015D6C6C14C0011F49
C7FC010113E02D427BC038>I<0007150301E0143F01FFEB07FF91B6FC5E5E5E5E5E1680
4BC7FC5D15E092C8FC01C0C9FCAAEC3FF001C1B5FC01C714C001DF14F09039FFE03FFC91
38000FFE01FC6D7E01F06D13804915C0497F6C4815E0C8FC6F13F0A317F8A4EA0F80EA3F
E0487E12FF7FA317F05B5D6C4815E05B007EC74813C0123E003F4A1380D81FC0491300D8
0FF0495AD807FEEBFFFC6CB612F0C65D013F1480010F01FCC7FC010113C02D427BC038>
53 D<B9FC18F018FE727E19E026003FFCC700077F05017F716C7E727E727EA2721380A3
7213C0A74E1380A24E1300A24E5A4E5A4E5A4D5B05075B94B5128091B700FCC7FC18F018
FF19E002FCC7000113F8716C7EF01FFE727E7213801AC07213E0A27213F0A31AF8A71AF0
A2601AE0604E13C0604E138095B5120005075BBA12F86119C04EC7FC18E045447CC350>
66 D<DCFFF01470031F01FF14F04AB6EAE0010207EDF803023FEDFE0791B539E001FF0F
4949C7EA3F9F010701F0EC0FFF4901C0804990C87E4948814948814948167F4849163F48
49161F5A4A160F485B19074890CAFC19035A5BA2007F1801A34994C7FC12FFAE127F7F1A
F0A2123FA27F6C18011AE06C7F19036C6D17C06E16077E6C6DEE0F806C6DEE1F006D6C5E
6D6C167E6D6C6C5D6D6D4A5A6D01F0EC07F0010101FEEC1FE06D903AFFF001FF80023F90
B6C7FC020715FC020115F0DA001F1480030001F8C8FC44467AC451>I<B712E0A5D8001F
90C7FCB3B3B3A4B712E0A523447DC32A>73 D<B812F8EFFFC018F818FE727ED8001F90C7
003F13E005037F05007F727E727E727EA28684A286A762A24E90C7FCA24E5A61187F9438
01FFF005075B053F138092B7C8FC18F818E018F892C77FEF3FFF050F7F717F717FA2717F
A2717FA785A61B0F85A2187F73131F72141EB700E06DEB803E72EBE0FC72EBFFF8060114
F0726C13E0CC0007138050457DC354>82 D<DAFFE0131C010701FE133C013F9038FF807C
90B6EAE0FC4815F9489038801FFF3907FC00014848EB007F4848143F4848140F49140700
7F15035B1601160012FF177CA27FA26D153C7F7F6D92C7FC6C7EEBFFE014FE6CEBFFF015
FF6C15E016FC6C816C6F7E6C826C826C6C81011F810107811300020F80140003077FED00
7F82040F1380828212F082A282A27EA218007EA26C5D6C5E6D14036D5D6D140701F84A5A
01FFEC3FF002F8EBFFE0486CB65AD8FC1F92C7FCD8F80714FC48C614F048010713803146
7AC43E>I<003FBA12E0A59026FE000FEB8003D87FE09338003FF049171F90C71607A200
7E1803007C1801A300781800A400F819F8481978A5C81700B3B3A20107B8FCA545437CC2
4E>I<903801FFE0011F13FE017F6D7E48B612E03A03FE007FF84848EB1FFC6D6D7E486C
6D7EA26F7FA36F7F6C5A6C5AEA00F090C7FCA40203B5FC91B6FC1307013F13F19038FFFC
01000313E0000F1380381FFE00485A5B127F5B12FF5BA35DA26D5B6C6C5B4B13F0D83FFE
013EEBFFC03A1FFF80FC7F0007EBFFF86CECE01FC66CEB8007D90FFCC9FC322F7DAD36>
97 D<EC3FFC49B512C0010F14F0013F14FC90397FF003FE9039FFC001FF0003495A4849
4813805B120F485AA2485A6F1300007F6E5AED00784991C7FCA212FFAC6C7EA3123F6DEC
03C0A26C6C1407000F16806D140F6C6DEB1F006C6D133E6C01F05B3A007FFC03F86DB55A
010F14C0010391C7FC9038003FF82A2F7CAD32>99 D<EC3FF80103B57E010F14E0013F80
90397FF83FF89039FFC007FC48496C7E48496C7E48486D1380485A001FED7FC05B003FED
3FE0A2127F5B17F0161F12FFA290B7FCA401F0C9FCA5127FA27FA2123F17F06C7E16016C
6C15E06C6C14036C6DEB07C06C6DEB0F806C01F0EB3F0090397FFE01FE011FB55A010714
F0010114C09026001FFEC7FC2C2F7DAD33>101 D<137C48B4FC4813804813C0A24813E0
A56C13C0A26C13806C1300EA007C90C7FCAAEB7FC0EA7FFFA512037EB3AFB6FCA518467C
C520>105 D<EB7FC0B5FCA512037EB3B3B3A3B61280A519457CC420>108
D<90277F8007FEEC0FFCB590263FFFC090387FFF8092B5D8F001B512E002816E4880913D
87F01FFC0FE03FF8913D8FC00FFE1F801FFC0003D99F009026FF3E007F6C019E6D013C13
0F02BC5D02F86D496D7EA24A5D4A5DA34A5DB3A7B60081B60003B512FEA5572D7CAC5E>
I<90397F8007FEB590383FFF8092B512E0028114F8913987F03FFC91388F801F00039039
9F000FFE6C139E14BC02F86D7E5CA25CA35CB3A7B60083B512FEA5372D7CAC3E>I<EC1F
FC49B512C0010714F0011F14FC90397FF80FFF9026FFC0017F48496C7F4848C7EA3FE000
078248486E7E49140F001F82A2003F82491407007F82A400FF1780AA007F1700A46C6C4A
5AA2001F5E6D141F000F5E6C6C4A5AA26C6C6CEBFFE06C6D485B27007FF80F90C7FC6DB5
5A010F14F8010114C09026001FFCC8FC312F7DAD38>I<90397FC00FF8B590B57E02C314
E002CF14F89139DFC03FFC9139FF001FFE000301FCEB07FF6C496D13804A15C04A6D13E0
5C7013F0A2EF7FF8A4EF3FFCACEF7FF8A318F017FFA24C13E06E15C06E5B6E4913806E49
13006E495A9139DFC07FFC02CFB512F002C314C002C091C7FCED1FF092C9FCADB67EA536
407DAC3E>I<90391FFC038090B51287000314FF120F381FF003383FC00049133F48C712
1F127E00FE140FA215077EA27F01E090C7FC13FE387FFFF014FF6C14C015F06C14FC6C80
0003806C15806C7E010F14C0EB003F020313E0140000F0143FA26C141F150FA27EA26C15
C06C141FA26DEB3F8001E0EB7F009038F803FE90B55A00FC5CD8F03F13E026E007FEC7FC
232F7CAD2C>115 D<EB01E0A51303A41307A2130FA2131FA2133F137F13FF1203000F90
B51280B7FCA4C601E0C7FCB3A3ED01E0A9150302F013C0137F150790393FF80F8090391F
FC1F006DB5FC6D13FC01015B9038003FE023407EBE2C>I<D97FC049B4FCB50103B5FCA5
0003EC000F6C81B3A85EA25EA25E7E6E491380017FD901F713FE9138F807E76DB512C701
0F1407010313FE9026007FF0EBFC00372E7CAC3E>I<B6903803FFFCA5000101E0903800
3E006C163C80017F5D8017F8013F5D6E1301011F5D6E1303010F5D6E13076D5DED800F6D
92C7FC15C05E6DEBE01E163E6D143CEDF07C027F1378EDF8F8023F5B15FD021F5B15FF6E
5BA36E5BA26E90C8FCA26E5AA26E5AA21578A215F85D14015D001F1303D83F805B387FC0
07D8FFE05B140F92C9FC5C143E495A387FC1F8EB07F06CB45A6C5B000790CAFCEA01FC36
407EAB3B>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fh cmcsc10 10 33
/Fh 33 123 df<141FEC7FC0903801F0E0903803C0600107137090380F8030EC00384913
18A25BA2133EA2133F153815301570156015E04A5A90381F818014830287CAFC148E02DC
91387FFFE0EB0FF85C4A91380FFE000107ED03F06E5D6060496C92C7FCD91DFC5C013915
0ED970FE140C01E0151C2601C07F5CD803806D13300007013F1470D80F006D1360486D6C
13E048010F495A007E6E485AEC07F800FE010349C8FC913801FC0E6F5AEC00FFED7FB86C
DA3FF014C06F5A150F6C6C6D6CEB0180826C6CD91FFC1303001FDA3CFFEB07006C6C9039
F87F800E3C07F80FE01FE07E6CB5398007FFF8C69026FE00015BD91FF09038003FC03B3E
7BBB46>38 D<121C127FEAFF80A213C0A3127F121C1200A412011380A2120313005A1206
120E5A5A5A12600A1977881B>44 D<B512FCA516057E941F>I<EB01C013031307131F13
FFB5FCA2131F1200B3B3A8EB7FF0B612F8A31D3877B72E>49 D<EB0FF8EB3FFF90B512C0
3903E01FF039078007FC390E0001FE486D7E5A0030EC7F800070EC3FC0126012FCB4EC1F
E07FA56CC7FC121CC8FCED3FC0A3ED7F8016005D5D4A5A4A5A4A5A5D4A5A4A5A4AC7FC14
7E14F8495A495A495A495A91C71260131E13384914E04914C0485A485A48C7120148B6FC
5A5A481580B7FCA323387BB72E>I<EB07F890383FFF8090B512E03903F00FF039078003
FC48486C7E001E130081EA3FC06DEB7F80A56C5A6C5AC8EAFF00A34A5A5D4A5A5D4A5A4A
5A027FC7FCEB3FF814FF9038000FE06E7EEC03FC6E7E6E7E1680157F16C0A2153F16E0A2
121EEA7F80487EA4ED7FC05B007F1580007EC712FF007015006C495A001E495A6C6C485A
3907F00FF00001B512C06C6C90C7FCEB0FF8233A7BB72E>I<121C127FEAFF80A5EA7F00
121CC7FCB2121C127FEAFF80A5EA7F00121C092477A31B>58 D<1407A24A7EA34A7EA3EC
37E0A2EC77F01463A2ECC1F8A201017F1480A2903803007EA301067FA2010E80010C131F
A2496D7EA2013FB57EA29038300007496D7EA3496D7EA200018149130012036D801207D8
1FE0903801FF80D8FFF8010F13F8A22D2C7DAB33>97 D<B612F015FE3A07F8003F806C48
EB0FC0ED07E0ED03F016F8150116FCA516F8A2ED03F01507ED0FE0ED3F80913801FF0090
B512F815FF9039F0001FC0ED07E0ED03F0ED01F816FC150016FEA616FC1501A2ED03F8ED
07F0ED0FE0486CEB3FC0B7120015F8272B7CAA30>I<91383FC006903901FFF80E90390F
E03E1E90381F0007017EEB03BE01F8EB01FE484813004848147E0007153E485A001F151E
5B003F150E90C8FC5A1606A212FE1600AA007F1506A37E6D140E001F150C7F000F151C6C
6C1418000315386C6C14706C6C14E0017EEB01C0011FEB078090390FE03E00903801FFF8
9038003FC0272D7BAB31>I<B612F015FE3907F8007F6C48EB0FC0ED03E06F7E6F7E167C
167E82A2EE1F80A217C0160FA317E0AA17C0A3EE1F80A217005E163E5E16FC4B5A4B5AED
0FC0486CEB7F80B600FEC7FC15F02B2B7CAA34>I<B712E0A23907F8000F6C481303ED00
F01670A21630A41618A215C01600A31401A2140790B5FCA2EBF0071401A21400A21606A2
1500A2160CA4161CA2163C167C16F8486C1307B7FCA2272B7CAA2E>I<B712C0A23907F8
001F6C481303ED01E01500A21660A41630A215C01600A31401A2140790B5FCA2EBF00714
01A21400A492C7FCAB487EB512E0A2242B7CAA2C>I<91383FE003903901FFF807903907
E01E0F90391F00078F017EEB01DF496DB4FC484880484880484880485A001F815B003F81
90C8FC5A82A212FE93C7FCA892383FFFF8A2007F02001380EE3F00A27E7F121F7F120F6C
7E6C7E6C6C5C6C7E017E5C011FEB01CF903907E00F87903901FFFE039026003FF0C7FC2D
2D7BAB35>I<B539C07FFFE0A23B07F80003FC006C486D5AB190B6FCA29038F00001B248
6C497EB539C07FFFE0A22B2B7CAA33>I<B512C0A23807F8006C5AB3B3487EB512C0A212
2B7CAA19>I<90B512C0A2903801FE006D5AB3AB1210127C12FEA3495A12FC387003F06C
485A381E0FC06CB4C7FCEA01FC1A2C7CAA23>I<B500C0EBFFF8A2D807F8C7EA7FC06C48
1500167C167816E04B5A4B5A4BC7FC150E5D5D15F0EC01C04A5A4AC8FC5C4A7E4A7E4A7E
EBF1E79038F387F09038F703F89038FE01FC13FC496C7E49137F6F7EA26F7E6F7E150782
6F7E6F7EA26F7E82EE7F80486CECFFC0B5D8C00313FCA22E2B7CAA35>I<B512E0A2D807
F8C8FC6C5AB3A61660A416C0A31501A21503A21507ED1F80486C13FFB7FCA2232B7CAA2B
>I<D8FFF0ED3FFC6D157F0007178000031700017C15DFA26DEC019FA36DEC031FA26D6C
1306A36D6C130CA26D6C1318A26D6C1330A36D6C1360A2027C13C0A391383E0180A29138
1F0300A3EC0F86A2EC07CCA3EC03F8A2486C6C5AA2D81FE0ED3F803CFFFC00E007FFFCA2
362B7CAA3E>I<D8FFF0903807FFE07F0007020013006C6C143C7F017F14187F806D7E13
0F806D7E6D7EA26D7E6D7E147E147FEC3F80141F15C0EC0FE0EC07F0140315F8EC01FC14
0015FE157FED3F98151F16D8ED0FF81507A215031501A2486C13001678D81FE01438EAFF
FC16182B2B7CAA33>I<EC7FC0903803FFF890380FC07E90393F001F80017CEB07C04848
EB03F048486D7E4913004848147C000F157E484880A248C8EA1F80A24816C0A2007E150F
A200FE16E0AA007FED1FC0A36C16806D143F001F1600A26C6C147E6C6C5CA26C6C495A6C
6C495AD8007CEB07C0013FEB1F8090260FC07EC7FC903803FFF89038007FC02B2D7BAB35
>I<B612E015FC3907F800FE6C48EB1F80ED0FC0ED07E016F01503A216F8A516F0A21507
16E0ED0FC0ED1F80EDFE0090B55A15E001F0C8FCB1487EB512C0A2252B7CAA2E>I<EC7F
C0903803FFF890380FC07E90393F001F80017CEB07C04848EB03F048486D7E4913004848
147C000F157E484880A2003F168090C8121F4816C0A2007E150FA200FE16E0AA007E16C0
007F151FA26C1680A26C6CEC3F00141F3A0FC03FC07E0007903870E07C9039E0E060FC3A
03F0C071F8D801F8EB3BF0D8007CEB3FC090393FE01F8090260FF07EC7FC902603FFFC13
609038007FDEEC001E6F13E016011683EEFFC0A28117806F13006F5AED00782B387BAB35
>I<B67E15F03907F800FE6C48133FED0FC06F7EA26F7E82A65E4B5AA24B5A033FC7FC15
FE90B512F05D9038F001F8EC007E816F7EA26F7EA582A4171816F015071738486C903803
F830B5D8C00113709238007FE0C9EA1F802D2C7CAA32>I<017F13603901FFE0E0380780
F9380E001F48130748130312780070130100F01300A315607EA26C14007E127F13C0EA3F
FEEBFFE06C13F8000713FE6C7FC61480010F13C01300EC0FE01407EC03F01401A212C014
00A37E15E06C1301A26CEB03C06CEB0780B4EB0F0038F3E01E38E0FFF838C01FE01C2D7B
AB26>I<007FB712C0A23A7E003FC00F007890381F8003007015011600126000E016E0A2
481660A5C71500B3A8EC7FE0011FB57EA22B2B7DAA31>I<B539C007FFE0A2D807F8C713
006C48143CA21618B3A916386C6C1430A2000015706D5C017C5C6D13016D495A90260F80
0FC7FC903803E03C903800FFF8EC3FC02B2C7CAA33>I<B56CEB3FFEA2D80FFCC7EA0FF0
6C48EC07E00003ED03C01780000116006D5C00001506A2017E5CA2017F141C6D14188001
1F5CA26D6C5BA28001075CA26D6C485AA2ECF803010191C7FCA2903800FC06A2ECFE0EEC
7E0C147F6E5AA2EC1FB0A215F06E5AA26E5AA36E5AA22F2C7EAA33>I<B5903B7FFF800F
FF80A2D80FF8903B07FC0003FC006C486D486D5A725A000302015DA26C6C8061A26C6C49
6C495A167EA2017ED9077F49C7FCED063FA26D010EEB8006ED0C1FA26D6C486C6C5AA36D
6C486C6C5AA36D6C486C6C5AA21870903B03F0C001F860A202F815E0903B01F98000FCC0
A202FD14FD6DB4C7EA7F80A3027E6EC8FCA3023C141EA30218140C412C7EAA45>I<3B7F
FF800FFFC0A2000790390003FE006C48EB01F800015D000015C0017F13036D5C6E48C7FC
90381FC0066D6C5A151C6D6C5A903803F83001015BECFCE06D6C5AEC7F80A2143F6E7E14
0F4A7E4A7E1433EC63F8ECE1FCECC0FE903801807E0103137F49486C7E0106131F498001
1C6D7E496D7E0130130301708001F06D7E000181000781D81FF8491380B46C4913F8A22D
2B7DAA33>I<B56CEB1FFEA2D80FFCC7EA0FF00003ED07C01780000116006C6C1406017F
140E160C6D6C5B6D6C133816306D6C5B6D6C13E05E6D6C485A903801FC0393C7FC903800
FE06EC7F0E150CEC3F9CEC1FF85D140F6E5AAF4A7E49B57EA22F2B7EAA33>I<003FB6FC
A29038E0007F90C712FE003E495A123C0038495A48495AA24A5A00605C141F4A5AA2C748
C7FC14FEA2495A495AA2495A5C130F495AA2495A49C8FCED018013FE485AA2485A491303
1207485AED0700485A48485B5D48C75A00FE49B4FCB7FCA2212B7BAA2A>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fi cmbx10 10 50
/Fi 50 123 df<B61280A819087F9620>45 D<EA0F80EA3FE0EA7FF0A2EAFFF8A5EA7FF0
A2EA3FE0EA0F800D0D798C1B>I<141E143E14FE1307133FB5FCA313CFEA000FB3B3A600
7FB61280A4213779B630>49 D<EB0FFC90387FFFC048B512F0000714FC390FF03FFF261F
800F1380263F000313C05AD9C00113E0486C6C13F07FA2ED7FF8A46C5A6C5A000FC7FCC8
FCEDFFF0A216E05C16C04A138016004A5A5D4A5A4A5A4A5AEC7F8092C7FC14FEEB01F849
481378495A495A495A013EC712F84914F05B4848130148B6FCA25A5A5A5A4815E0B7FCA4
25377BB630>I<EB03FF011F13F0017F13FC3901FC07FF2603F003138048486C13C0496C
13E0EA0FF001FC14F0121F7FA56C4814E0A23803F001C714C04A138016004A5A4A5AEC3F
F090380FFFC092C7FC15F090380007FE913801FF806E13C016E0ED7FF016F816FC153FA2
16FEEA1FC0487E487E487EA416FCA249EB7FF8127F01C0EBFFF06C4814E06C6C4813C026
0FFC0713806CB61200000114FC6C6C13F0010790C7FC27387CB630>I<EA0F80EA3FE0EA
7FF0A2EAFFF8A5EA7FF0A2EA3FE0EA0F80C7FCABEA0F80EA3FE0EA7FF0A2EAFFF8A5EA7F
F0A2EA3FE0EA0F800D2579A41B>58 D<EB1FFE48B512E0000714F8390FE00FFE393F0003
FF4815806D7ED8FFC014C013E0A5EA7FC06C48481380EA1F00C7481300EC0FFC4A5AEC3F
E04A5A92C7FC14FE5C495AA25C495AA25CA990C9FCA7EB07C0EB1FF0497EA2497EA56D5A
A26D5AEB07C0223A7BB92D>63 D<ED03E04B7EA24B7EA34B7EA24B7EA34B7EA292B57EA3
4A8015F302038015E1A202078015C0020F80ED807FA2021F80ED003F4A80023E131FA202
7E80027C7F02FC814A7FA20101824A7F49B77EA3498202C0C7FC010F824A147FA2011F82
91C8123F4982013E151FA2017E82017C8101FE83B500F80107B61280A4413A7DB948>65
D<B812C017FC17FF18C028007FF000037F04007F717E717E171F84A2717EA74D5AA26017
3F4D5A4D5A4C13C0040F5B91B600FCC7FCA2EFFF8002F0C713F0EF3FF8717E717E717E19
807113C0A319E0A719C0A25F4D138019005FEF7FFE4C485AB912F018C095C7FC17F03B39
7DB844>I<DB3FFCEB01C00203B5EAC003021FECF00791B6EAFC0F01039039FC00FF3F49
01C0EB1FFFD91FFEC77E49481403D97FF080494880485B48177F4849153F4890C9FC181F
485A180F123F5B1807127FA24993C7FC12FFAD127F7FF003C0123FA27F001F1707A26C6C
1780180F6C6D16006C6D5D6C173E6C6D157ED97FF85D6D6C4A5A6DB44A5A010701C0EB0F
E06D01FCEBFF80010090B548C7FC021F14F8020314E09126003FFEC8FC3A3B7BB945>I<
B87E17F817FF18C028007FF8000713F09338007FF8EF1FFE717E050313807113C0A27113
E0F07FF0A2F03FF8A219FC181FA219FEA419FFAC19FEA419FC183FA219F8187F19F0F0FF
E0A24D13C04D13804D1300EF1FFEEF7FFC933807FFF0B912C095C7FC17FC178040397DB8
49>I<B912F0A426007FF8C7FCEF1FF8170717031701A21700A21878A3043C137C183CA4
1800167CA216FC150391B5FCA4ECF8031500167CA2163C180FA3181EA293C7FCA2183EA2
183C187CA218FCA2EF01F81703170F173FEE01FFB9FC18F0A338397DB83F>I<B912C0A4
3A007FF800039338007FE0171F170F1707A21703A21701A318F0EE7800A41800A216F8A2
1501150791B5FCA4ECF80715011500A21678A693C8FCADB7FCA434397DB83C>I<DB3FFC
EB01C00203B5EAC003021FECF00791B6EAFC0F01039039FC00FF3F4901C0EB1FFFD91FFE
C77E49481403D97FF080494880485B48177F4849153F4890C9FC181F485A180F123F5B18
07127FA24993C8FC12FFAB043FB61280A2127F7FDC0003EBC000123FA27F121FA26C7EA2
6C7F6C7F6C7F7ED97FF85C6D7E6DB45C010701C05B6D01FCEBFF3F010090B5EAFE0F021F
ECF8030203ECE0009126003FFEC9FC413B7BB94B>I<B6D8FC03B612F0A426007FF8C700
01EBE000B3A391B8FCA402F8C71201B3A6B6D8FC03B612F0A444397DB84B>I<B612FCA4
39007FF800B3B3ADB612FCA41E397DB824>I<B600FC0103B512C0A426007FF8C8381FE0
0019804EC7FC18FEEF01F84D5A4D5A4D5AEF3F80057EC8FC5F4C5A4C5AEE0FE0EE1F804C
C9FC167E5EED03F84B7E4B7E4B7E4B7F5D02F9B57EDAFBF77FDAFFE37F15C103807F4A48
7F4A6D7E4A133F707E707F8482707F707F8482717E717E8483717F717F858385B600FC01
7FEBFFE0A443397DB84B>75 D<B7FCA426007FF8C9FCB3ACEF0780A5170F1800A35FA25F
A25F5F5E5EEE0FFE167FB8FCA431397DB839>I<B500F80403B512F06E5EA26E5ED8007F
F1E000A2D97BFF161EA201796D5DA201786D5DA26E6C5DA36E6C4A5AA26E6C4A5AA26E6C
4A5AA26E6C4A5AA26E6C141EA36E6D5BA26E6D5BA26F6C5BA26F6C485AA36F6C485AA26F
6C485AA26F6C48C7FCA2923803FF1EA36F13BCA26F13F8A2705AA2705AA213FCB500FC6D
4848B612F0A2EE0F80EE070054397DB85B>I<B500FC0203B512F0A28080C66C6D903900
03F0006F6E5A81017B7F13798101787F6E7E6E7E6E7F6E7FA26E7F6E7F6E7F6E7F6F7E15
3F826F13806F13C06F13E06F13F06F13F88117FCEE7FFEEE3FFF7013817013C17013E182
18F17013F97013FDEF7FFF8383A28383838383187FA2183F181F01FC160FB500FC150718
031801A244397DB84B>I<EDFFF8020FEBFF80027F14F0903A01FFC01FFC010790380007
FFD91FFC010113C0D93FF06D6C7E49486E7E49486E7E48496E7E48834890C86C7EA24848
6F1380A248486F13C0A2003F18E0A348486F13F0A400FF18F8AC007F18F06D5DA3003F18
E0A26D5D001F18C0A26C6C4B13806C18006E5C6C6D4A5A6C5F6C6D4A5A6D6C4A5AD93FFC
49485A6DB401075B0107D9C01F90C7FC010190B512FC6D6C14F0020F1480020001F8C8FC
3D3B7BB948>I<B8FC17F017FEEFFF8028007FF8000F13C0040113E07013F0EF7FF8EF3F
FCA2EF1FFEA218FFA818FEA2EF3FFCA2EF7FF8EFFFF04C13E0040F13C091B7120017FC17
E002F8C9FCB3A4B612FCA438397DB841>I<B712FCEEFFE017FC17FF28007FF8000F13C0
04017F707F717E717EA2717EA284A760A24D5A604D5A4D5A04035B041F90C8FC91B612FC
17E0839139F8003FFCEE0FFF707F707F8284A2707FA584A51A601AF084177F1901DD3FFE
13E0B600FC011F130394390FFF87C071EBFF8005011400CBEA1FFC443A7DB848>82
D<D907FF130E013FEBE01E90B5EAF83E0003ECFE7E3A07FC01FFFE390FF0001F4848130F
48481303491301007F140090C8FC167E5A163EA27F161E7F7F6D91C7FC13FC387FFFE014
FEECFFF06C14FE6F7E6C816C15F06C816C81C681133F010F801301D9000F1480EC007F03
0F13C01503818100F0157FA3163FA27E17807E167F6C16007E6D14FE01E0495A01F81303
9039FF801FF800FC90B512E0D8F83F5CD8F00749C7FC39E0007FF02A3B7BB935>I<003F
B91280A4D9F800EBF003D87FC09238007FC049161F007EC7150FA2007C1707A200781703
A400F818E0481701A4C892C7FCB3AE010FB7FCA43B387DB742>I<B600FC011FB512C0A4
26007FF8C8381FC000725AB3B3181F013F94C7FC8060011F163E6D6C157E187C6D6C15FC
6D6D495A6D6DEB07F06D01F0EB1FE0DA7FFEEBFFC0021FB6C8FC02075C020014F0030F13
80423A7DB849>I<007FB5D8F803B512F8A4C66C48C7D80FF0C7FC6D6C5D6D5E6F495A6D
6D49C8FC7F6D6D137E6F5B6DEBF8016D5D6F485A6E6C485A023F130FDA1FFF5BEE9F806E
01FFC9FC805E6E5B6E5B80826F7E153F826F7F5D4B7F92B57EA2DA01F97FDA03F17F03F0
7F913807E07FDA0FC07F021F6D7E4B7E4A486C7F027E8102FE6D7F4A7F49488149486D7F
0107804A6E7E49488149486E7E013F81017F83B60107B61280A441397DB848>88
D<B600F049B512E0A4C601FCC8380FF000017F705A6E4B5A6D6C4B5A6D7F4EC7FC6D6D14
7E6D7F606D6D495A6D7F4D5A6D6D495A6E7E4D5A6E6C495A6E13804DC8FC6EEBC07E6E13
E05F6EEBF1F86E13F9EEFBF06EEBFFE0815F6F5B816F90C9FCB3A2021FB6FCA443397EB8
48>I<003FB712FEA4913980007FFC01FCC7EAFFF801F05B01C015F0494913E090C75A48
16C0007E4A13805D007C16004B5A157F00785D4B5A5C5EC7485B5C5E5C4A5B93C7FC5C4A
5A5D14FF495B5D5B495B4B131E5B5D4990C7FC5B5C4948143E13FF5C485B48167E4A147C
484914FC5A4A13014890C7120348150F49143F4848EB01FFB8FCA42F397BB83A>I<EB3F
FE0003B512E0000F14F8391FF00FFE003FEB03FF6D6C7F6E7FA26F7EA26C5A6C5AEA0380
C8FCA2EC3FFF010FB5FC137F3901FFF87F00071380380FFE00EA3FF85B485A12FF5BA415
FF6D5A127F263FF00713F83B1FFC1FBFFFC0390FFFFE1F0003EBF80F39003FE0032A257D
A42E>97 D<13FFB5FCA412077EAF4AB47E020F13F0023F13FC9138FE03FFDAF00013804A
EB7FC00280EB3FE091C713F0EE1FF8A217FC160FA217FEAA17FCA3EE1FF8A217F06E133F
6EEB7FE06E14C0903AFDF001FF80903AF8FC07FE009039F03FFFF8D9E00F13E0D9C00390
C7FC2F3A7EB935>I<903801FFC0010F13FC017F13FFD9FF8013802603FE0013C048485A
EA0FF8121F13F0123F6E13804848EB7F00151C92C7FC12FFA9127FA27F123FED01E06C7E
15036C6CEB07C06C6C14806C6C131FC69038C07E006DB45A010F13F00101138023257DA4
2A>I<EE7F80ED7FFFA4150381AF903801FF81010F13F1013F13FD9038FFC07F0003EB00
1FD807FC1307000F8048487F5B123FA2485AA312FFAA127FA27F123FA26C6C5B000F5C6C
6C5B6C6C4913C02701FF80FD13FE39007FFFF9011F13E1010313012F3A7DB935>I<9038
03FF80011F13F0017F13FC3901FF83FE3A03FE007F804848133F484814C0001FEC1FE05B
003FEC0FF0A2485A16F8150712FFA290B6FCA301E0C8FCA4127FA36C7E1678121F6C6C14
F86D14F000071403D801FFEB0FE06C9038C07FC06DB51200010F13FC010113E025257DA4
2C>I<161FD907FEEBFFC090387FFFE348B6EAEFE02607FE07138F260FF801131F48486C
138F003F15CF4990387FC7C0EEC000007F81A6003F5DA26D13FF001F5D6C6C4890C7FC39
07FE07FE48B512F86D13E0261E07FEC8FC90CAFCA2123E123F7F6C7E90B512F8EDFF8016
E06C15F86C816C815A001F81393FC0000F48C8138048157F5A163FA36C157F6C16006D5C
6C6C495AD81FF0EB07FCD807FEEB3FF00001B612C06C6C91C7FC010713F02B377DA530>
103 D<13FFB5FCA412077EAFED7FC0913803FFF8020F13FE91381F03FFDA3C0113801478
4A7E4A14C05CA25CA291C7FCB3A3B5D8FC3F13FFA4303A7DB935>I<EA01F0EA07FC487E
A2487EA56C5AA26C5AEA01F0C8FCA913FF127FA412077EB3A9B512F8A4153B7DBA1B>I<
13FFB5FCA412077EB3B3ACB512FCA4163A7DB91B>108 D<01FED97FE0EB0FFC00FF9026
01FFFC90383FFF80020701FF90B512E0DA1F81903983F03FF0DA3C00903887801F000749
DACF007F00034914DE6D48D97FFC6D7E4A5CA24A5CA291C75BB3A3B5D8FC1FB50083B512
F0A44C257DA451>I<01FEEB7FC000FF903803FFF8020F13FE91381F03FFDA3C01138000
0713780003497E6D4814C05CA25CA291C7FCB3A3B5D8FC3F13FFA430257DA435>I<9038
01FFC0010F13F8017F13FFD9FF807F3A03FE003FE048486D7E48486D7E48486D7EA2003F
81491303007F81A300FF1680A9007F1600A3003F5D6D1307001F5DA26C6C495A6C6C495A
6C6C495A6C6C6CB45A6C6CB5C7FC011F13FC010113C029257DA430>I<9039FF01FF80B5
000F13F0023F13FC9138FE07FFDAF00113800007496C13C06C0180EB7FE091C713F0EE3F
F8A2EE1FFCA3EE0FFEAA17FC161FA217F8163F17F06E137F6E14E06EEBFFC0DAF0031380
9139FC07FE0091383FFFF8020F13E0020390C7FC91C9FCACB512FCA42F357EA435>I<90
38FE03F000FFEB0FFEEC3FFF91387C7F809138F8FFC000075B6C6C5A5CA29138807F80ED
3F00150C92C7FC91C8FCB3A2B512FEA422257EA427>114 D<90383FF0383903FFFEF800
0F13FF381FC00F383F0003007E1301007C130012FC15787E7E6D130013FCEBFFE06C13FC
ECFF806C14C06C14F06C14F81203C614FC131F9038007FFE140700F0130114007E157E7E
157C6C14FC6C14F8EB80019038F007F090B512C000F8140038E01FF81F257DA426>I<13
0FA55BA45BA25B5BA25A1207001FEBFFE0B6FCA3000390C7FCB21578A815F86CEB80F014
816CEBC3E090383FFFC06D1380903803FE001D357EB425>I<01FFEC3FC0B5EB3FFFA400
0714016C80B3A35DA25DA26C5C6E4813E06CD9C03E13FF90387FFFFC011F13F001031380
30257DA435>I<B539F001FFF8A4000390C7EA3F00161E6E133E6C153C6E137C6C15786E
13F8017F5CECF001013F5C14F8011F495AA2ECFC07010F5CECFE0F010791C7FC6E5A6D13
1E15BE6D13BC15FC6D5BA36E5AA26E5AA26E5AA26E5AA22D257EA432>I<B539F01FFFF0
A4000390398003F8006C01C013E06C1407D97FE05B6D6C485A6E48C7FC90381FFC3E010F
5B903807FEFC6D6C5A5D6D5B6D5B6E7E6E7E814A7EA24A7E903801F3FFD903E37FD907C1
7FEB0FC049486C7E4A6C7E013E80496D7E49130F00016E7EB590383FFFF8A42D257EA432
>120 D<B539F001FFF8A4000390C7EA3F00161E6E133E6C153C6E137C6C15786E13F801
7F5CECF001013F5C14F8011F495AA2ECFC07010F5CECFE0F010791C7FC6E5A6D131E15BE
6D13BC15FC6D5BA36E5AA26E5AA26E5AA26E5AA292C8FCA25C141E003F133E387F803C38
FFC07C147814F8EBC1F0EBC3E06C485A387D1F80D83FFFC9FCEA1FFCEA07F02D357EA432
>I<003FB612C0A3D9F0031380EB800749481300003E5C003C495A007C133F5D0078495A
14FF5D495B5BC6485B92C7FC495A131F5C495A017FEB03C0EBFFF014E04813C05AEC8007
4813005A49EB0F80485A003F141F4848133F9038F001FFB7FCA322257DA42A>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fj cmr12 14.4 9
/Fj 9 116 df<BB1280A426007FFCC8123F6D48030313C0011F1600193F191F190F1907
A21903A2F101E0A31900A6050E1470A41A00A3171EA3173E177E17FE160791B6FCA49138
F800071600177E173E171EA3170EA31A0EA31A1C94C8FCA41A3C1A38A31A78A31AF0A219
01A21903A21907F10FE0193F19FF013F1603496C153FBBFC1AC0A347527BD150>69
D<B600FC030FB512E0A4C691CAEBFC00D97FFCEF3FF06D48EF1FC0011F616E71C7FC130F
1A0E6E171E0107181CA26E173C6D1838816D60A26F16F06D6081027F4C5AA281023F4C5A
A26F1507021F94C8FC81020F160EA26F151E0207161CA26F153C6E1638826E5EA27014F0
6E5E821801037F5D82033F4A5AA2701307031F92C9FC82030F140EA270131E0307141CA2
70133C6F143817806F5CA2EFC0F06F5C17E017E1047F5B17F193383FF380A217FF7090CA
FCA2705AA3705AA3705AA2705AA3705A53547ED158>86 D<EC0FFE91387FFFE049B512F8
903907F801FE90391FE0001FD93F80EB078049C7EA0FC001FE143F484815E00003157F48
5A485AA2485AEE3FC0003FED0F004991C7FCA2127FA35B12FFAB127F7FA3123F6D157012
1F6D15F0000F16E06D140112076C6CEC03C06D15806C6C14076C6DEB0F00D93FC0131E6D
6C137C903907FC03F06DB55AD9007F1380DA0FF8C7FC2C367CB434>99
D<EC0FF891B5FC010314C090390FF80FF090391FC003FC90397F8001FE49C77E4848EC7F
804848143F49EC1FC0485A000FED0FE05B001F16F01607485AA2007F16F8A25B160312FF
90B7FCA30180C9FCA8127F7FA2123FA26D1538121F17786C6C1570000716F06D15E06C6C
14016C6CEC03C06C6C15806D6C130F6D6CEB1F00D90FF0133C903907FE01F80101B512E0
6D6C1380DA07FCC7FC2D367DB434>101 D<1378EA01FE487E487FA66C90C7FC6C5AEA00
7890C8FCB0EB7F80B5FCA41203C6FC137FB3B3A43801FFE0B61280A419507CCF21>105
D<EB7F80B5FCA41203C6FC137FB3B3B3B13801FFE0B612C0A41A537CD221>108
D<EC0FFC91387FFF8049B512E0903907F807F890391FE001FE90393F80007F017EC7EA1F
80496E7E48486E7E00038248486E7EA248486E7EA248486E7EA2003F82A24848ED7F80A4
00FF17C0AB007F1780A26D15FFA2003F1700A2001F5E6D1401000F5E6D140300075E6C6C
4A5A6C6C4A5AA2D8007FEC3F806D6C49C7FC90391FE001FE903907F807F86DB55AD9007F
1380DA0FFCC8FC32367CB43B>111 D<01FFEB1F80B5EB7FF0913801FFF8913803E1FC91
380783FE0003EB0F07C6131EEB7F1C1438143091387003FC91386000F0160014E05CA45C
B3AA8048487EB612F0A427347DB32E>114 D<D907FE13C090387FFF8148B512E33907F8
03FF390FC0007F4848133F48C7121F003E140F007E1407127C00FC1403A315017EA27E7F
6C6C90C7FC13F013FF6C13F86CEBFF806C14E06C14F86C14FEC680013F1480010714C0D9
003F13E014039138007FF0151F00E0140FED07F8A26C1403A215017EA36C15F0A26C1403
6C15E015076DEB0FC06DEB1F80D8FDF0EB3F0039F8FC01FE39F07FFFF8D8E01F13E0D8C0
0390C7FC25367CB42E>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fk cmsy10 10 3
/Fk 3 25 df<923803FFC0033F13FC4AB67E020715E0913A1FFE007FF8DA7FE0EB07FE4A
C87ED903FCED3FC0D907F0ED0FE0D90FC0ED03F049486F7E49CA7E017E177E4983498348
48EF0F80000319C04917074848EF03E0000F19F049170148CC12F8A2001E1978003E197C
A2003C193C007C193EA20078191EA300F8191FA248190FAA6C191FA20078191EA3007C19
3EA2003C193C003E197CA2001E1978001F19F8A26C6CEF01F06D1703000719E06C6CEF07
C06D170F000119806C6CEF1F006D5F017E177E6D5F6D6C4B5A6D6C4B5AD907F0ED0FE0D9
03FCED3FC0D900FF03FFC7FCDA7FE0EB07FEDA1FFEEB7FF80207B612E002011580DA003F
01FCC8FC030313C0484E7BBB53>13 D<EB1FF0EBFFFE487F000714C04814E04814F04814
F8A24814FCA3B612FEA96C14FCA36C14F8A26C14F06C14E06C14C0000114006C5BEB1FF0
1F1F7BA42A>15 D<D93F801508D9FFF0151C00037F4813FE487F4814C09026C07FE0143C
273F000FF01438003CD907FC147848EB01FE6E6C6C13F0007091383FC00300F091391FF8
0FE0486EB5FC030314C06F14806F6C1300EE3FFC0040ED07F036137B9D41>24
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fl cmr12 12 32
/Fl 32 122 df<121EEA7F8012FF13C0A213E0A3127FEA1E601200A413E013C0A3120113
80120313005A1206120E5A5A5A12600B1D78891B>44 D<B612C0A61A067F9721>I<121E
EA7F80A2EAFFC0A4EA7F80A2EA1E000A0A78891B>I<14FF010713E090381F81F890383E
007C01FC133F4848EB1F8049130F4848EB07C04848EB03E0A2000F15F0491301001F15F8
A2003F15FCA390C8FC4815FEA54815FFB3A46C15FEA56D1301003F15FCA3001F15F8A26C
6CEB03F0A36C6CEB07E0000315C06D130F6C6CEB1F806C6CEB3F00013E137C90381F81F8
903807FFE0010090C7FC28447CC131>48 D<143014F013011303131F13FFB5FC13E71307
1200B3B3B0497E497E007FB6FCA3204278C131>I<EB03FE90381FFFC0017F13F03901F8
0FFC3903C001FE48486C7E000EC7EA7F8048EC3FC0ED1FE04815F00030140F007015F800
601407126CB415FC7F7F1503A46C4813076CC7FCC8FC16F8A2150F16F0151F16E0A2ED3F
C0ED7F8016005D5D4A5A4A5A4A5A5D4A5A4A5A4AC7FC147C5C5C495A495A495A49C7120C
131E5B013814185B5B485A4848143848C81230000E1570001FB612F0A25A5AB712E0A326
427BC131>I<49B4FC010F13E0013F13FC9038FE01FE3A01F0007F80D803C0EB3FC048C7
EA1FE0120EED0FF0EA0FE0486C14F8A215077F5BA26C48130FEA03C0C813F0A3ED1FE0A2
ED3FC01680ED7F0015FE4A5AEC03F0EC1FC0D90FFFC7FC15F090380001FCEC007FED3F80
ED1FC0ED0FE016F0ED07F816FC150316FEA2150116FFA3121EEA7F80487EA416FE491303
A2007EC713FC00701407003015F80038140F6C15F06CEC1FE06C6CEB3FC0D803E0EB7F80
3A01FE01FE0039007FFFF8010F13E0010190C7FC28447CC131>I<DB0FFE146092B500C0
13E0020314F0913A0FFC01FC0191393FC0003E02FFC7EA0F83D903FCEC03C74948EC01E7
4948EC00FF4948157F4948153F4948151F49C9120F485A491607120348481603A2484816
01A248481600A2123FA2491760127FA31900485AAE6C7EA21960A2123F7FA2001F18E07F
000F18C0A26C6C160119806C6C160312016DEE07006C6C16066D6C150E6D6C5D6D6C5D6D
6C15786D6C5D6D6C4A5AD900FFEC0780DA3FC0011FC7FCDA0FFC13FC0203B512F0020014
C0DB0FFEC8FC3B487BC546>67 D<B612F0A3C6EBF0006D5A6D5AB3B3B3A4497E497EB612
F0A31C447DC323>73 D<010FB512FEA3D9000313806E130080B3B3AB123F487E487EA44A
5A13801300006C495A00705C6C13076C5C6C495A6CEB1F802603E07FC7FC3800FFFCEB1F
E027467BC332>I<49B41303010FEBE007013F13F89039FE00FE0FD801F8131FD807E0EB
079F49EB03DF48486DB4FC48C8FC4881003E81127E82127C00FC81A282A37E82A27EA26C
6C91C7FC7F7FEA3FF813FE381FFFE06C13FE6CEBFFE06C14FC6C14FF6C15C0013F14F001
0F80010180D9001F7F14019138001FFF03031380816F13C0167F163F161F17E000C0150F
A31607A37EA36C16C0160F7E17806C151F6C16006C5D6D147ED8FBC05CD8F9F0495AD8F0
7C495A90393FC00FE0D8E00FB51280010149C7FC39C0003FF02B487BC536>83
D<B600C0010FB5FCA3000101E0C813F026007F80ED1F80F00F00A21806B3B3A7180E6D6C
150CA2181C131F6E1518010F163818306D6C1570606D6C14016D6C5D6D6CEC0780027F4A
C7FC6E6C131EDA1FE0137C913907FC03F00201B55A6E6C1380DB07FCC8FC40467CC349>
85 D<EB07FC90383FFF809038F80FE03903C003F048C66C7E000E6D7ED80FC0137E486C
137F6D6D7EA36F7EA26C5AEA0380C8FCA4EC0FFF49B5FC90380FFE1FEB3FC0EBFF00EA03
FC485A485A485A485A127F5B176048C7FCA3153FA36D137F007F14EF6D9038C7E0C0003F
13013A1FE00783F13B07F81E03FF802701FFFC0113003A001FE0007C2B2E7CAC31>97
D<EC7F80903803FFF090380FC07C90383F000F01FCEB03804848EB01C00003140F4848EB
1FE049133F120F485AA2485AED1FC0007FEC070092C7FCA290C9FC5AAB7E7FA2123F1630
7F001F15706C6C146016E06C6C14C06C6C13010001EC03806C6CEB0700013F131E90381F
C078903807FFF001001380242E7DAC2B>99 D<167FED3FFFA315018182B3EC7F80903803
FFF090380FC07C90383F000E017E1307496D5AD803F87F48487F5B000F81485AA2485AA2
127FA290C8FC5AAB7E7FA2123FA26C7EA2000F5D7F6C6C5B00035C6C6C9038077F806C6C
010E13C0013F011C13FE90380FC0F8903803FFE09026007F0013002F467DC436>I<EB01
FE903807FFC090381F03F090387E00FC49137E48487F485A4848EB1F80000F15C049130F
121F484814E01507A2007F15F090C7FCA25AA390B6FCA290C9FCA67EA27FA2123F16306C
7E1670000F15606D14E06C6C14C0000314016C6CEB03806C6CEB0700013E131E90381F80
F8903803FFE0010090C7FC242E7DAC2B>I<EC0FE0EC7FF8903801F81E903803F03F9039
0FE07F8090381FC0FF5C133F495AA2ED7F0001FE131C92C7FCAFB67EA3C648C8FCB3B248
6C7E007F13FFA321467EC51E>I<EE0F80D901FCEB7FE0903A0FFF81F0F090393F07E381
9039FC01FF033A01F800FE014848017E13E00007027FC7FC497F000F8149131F001F81A9
000F5D6D133F000792C7FC6D5B0003147E6C6C5B6D485A3903BF07E090380FFF80260701
FCC8FC90CAFCA25AA37F6C7E7F90B512F86C14FF16E06C15F86C6C8048B67E3A07C0000F
FF48481300003FC8EA3F80003E151F48ED0FC0A2481507A56C150F007C1680007E151F00
3E16006C153E6C6C5CD807E0495AD801F8EB07E0D8007FEB3F8090261FFFFEC7FC010113
E02C427DAC31>I<EA01FC12FFA3120712031201B3EC01FE913807FFC091381E07F09138
3801F802707FECE000D9FDC07F5C01FF147F91C7FCA25BA35BB3A8486CECFF80B5D8F83F
13FEA32F457DC436>I<EA01E0EA07F8A2487EA46C5AA2EA01E0C8FCADEA01FC12FFA312
0712031201B3B0487EB512F8A315437DC21C>I<EA01FC12FFA3120712031201B3B3B3A5
487EB512F8A315457DC41C>108 D<D801FC01FFEC1FE000FF010701E0EBFFFC913B0F03
F801E07F913C3C01FC07803F800007903C7000FE0E001FC0000349D97E1C130F2601FDC0
D97F38804A143001FFDA3FF06D7E91C75BA2495DA3495DB3A8486C4A6C497EB5D8F81FB5
0003B512E0A34B2C7DAB52>I<3901FC01FE00FF903807FFC091381E07F091383801F800
0701707F0003EBE0002601FDC07F5C01FF147F91C7FCA25BA35BB3A8486CECFF80B5D8F8
3F13FEA32F2C7DAB36>I<EC7F80903803FFF090380FC0FC90383E001F496D7E496D7E48
486D7E48486D7E48486D7E000F81A24848147E003F157FA290C87E481680A44816C0AA6C
1680A26D147F003F1600A2001F157E6D14FE000F5D6D130100075D6C6C495A6C6C495A6C
6C495A013E49C7FC90381FC0FE903807FFF89038007F802A2E7DAC31>I<3901FC03FC00
FF90380FFF8091383C07E091387001F83A07FDE000FE00030180137FD801FFEC3F8091C7
EA1FC04915E049140F17F0160717F8160317FCA3EE01FEABEE03FCA3EE07F8A217F0160F
6D15E0EE1FC06D143F17806EEB7E00D9FDC05B9039FCF003F891383C0FE091381FFF80DA
03FCC7FC91C9FCAE487EB512F8A32F3F7DAB36>I<3903F803F000FFEB1FFCEC3C3EEC70
7F0007EBE0FF3803F9C000015B13FBEC007E153C01FF13005BA45BB3A748B4FCB512FEA3
202C7DAB26>114 D<90383FE0183901FFFC383907E01F78390F0003F8001E1301481300
007C1478127800F81438A21518A27EA27E6C6C13006C7E13FC383FFFE06C13FC6C13FF6C
14C06C14E0C614F0011F13F81300EC0FFC140300C0EB01FE1400157E7E153EA27EA36C14
3C6C147C15786C14F86CEB01F039F38003E039F1F00F8039E07FFE0038C00FF01F2E7DAC
26>I<1306A5130EA4131EA3133E137EA213FE12011207001FB512F0B6FCA2C648C7FCB3
A4150CAA017E131C017F1318A26D133890381F8030ECC070903807E0E0903801FFC09038
007F001E3E7EBC26>I<D801FC147F00FFEC3FFFA300071401000380000181B3A85EA35D
A212006D5B017E9038077F80017F010E13C06D011C13FE90380FC078903803FFF0902600
7F8013002F2D7DAB36>I<B539F001FFFCA3000790C7EA7FE06C48EC1F8000011600160E
1200160C017F5CA280013F5CA26E1370011F146080010F5CA2ECF00101075CA26D6C48C7
FCA26E5A01011306A26D6C5AA214FF6E5AA215B8EC3FB015F06E5AA36E5AA26E5AA36EC8
FC2E2C7EAA33>I<B500E0B539E03FFF80A30007903C000FFE000FFC00D803FCD903F8EB
03F8F001E0120103015D6D80000060A26D6E13036DD9037E91C7FCA20280017F5B013FD9
063F1306A2D91FC06E5AED0C1FA2D90FE06E5AED180FA2D907F06E5AED3007A2D903F86E
5AED6003A2902601FCE06D5AEDC00117FCD900FFECFD80ED800017FF027F92C8FC92C77E
A26E147E023E143EA2021E143C021C141CA2412C7EAA46>I<B539F001FFFCA3000790C7
EA7FE06C48EC1F8000011600160E0000150C6D141C6D1418A26E1338013F1430A26D6C5B
A26E13E0010F5CA26D6C485AA2ECF803010391C7FCA2903801FC06A2ECFE0E0100130CA2
EC7F18A215B8EC3FB0A2EC1FE0A36E5AA26E5AA36EC8FCA21406A35CA25CA2123C007E5B
B4FC5CA25CEAFE01387C0380D87007C9FCEA3C1EEA0FFCEA03F02E3F7EAA33>121
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fm cmr10 10 84
/Fm 84 125 df<DA0FF813FC91397FFF07FF903B01F807DF83C0903A07E001FF0F903B1F
8007FE1FE090393F000FFC137E16F85B9338F007804848010790C7FC1503ACB812F8A328
01F80003F0C7FCB3AB486C497E267FFFE0B512F0A3333B7FBA30>11
D<EC0FF8EC7FFE903901F80780903907E001C090391F8000E090383F0007017E497EA25B
A2485A6F5AED018092C8FCA9ED03F0B7FCA33901F8000F1503B3AA486C497E267FFFE0B5
12C0A32A3B7FBA2E>I<EC0FFC91387FFF70903901F803F0903807E00790381F800FEB3F
00137EA25B150748481303ADB7FCA33901F80003B3AB486C497E267FFFE0B512C0A32A3B
7FBA2E>I<DA0FF0EB1FF0DA7FFEEBFFFC903B01F80F83F00F903C07E001CFC00380903C
1F8000FF0001C090273F0007FE130F017E4948497EA2495CA248485C03076E5A03030203
C7FC95C8FCA9F007E0BAFCA33C01F80003F0001F1807B3AA486C496C497E267FFFE0B500
C1B51280A3413B7FBA45>I<127812FCA27E7EEA7F80121FEA0FC0EA07E0EA03F0120013
78133C131E13060F0F77B92A>18 D<133C137EA213FE1201EA03FC13F0EA07E0EA0FC0EA
1F80EA1E005A5A5A12C00F0F6FB92A>I<121C127FEAFF80A213C0A3127F121C1200A412
011380A2120313005A1206120E5A5A5A12600A1979B917>39 D<146014E0EB01C0EB0380
EB0700130E131E5B5BA25B485AA2485AA212075B120F90C7FCA25A121EA2123EA35AA65A
B2127CA67EA3121EA2121F7EA27F12077F1203A26C7EA26C7E1378A27F7F130E7FEB0380
EB01C0EB00E01460135278BD20>I<12C07E12707E7E7E120F6C7E6C7EA26C7E6C7EA213
78A2137C133C133E131EA2131F7FA21480A3EB07C0A6EB03E0B2EB07C0A6EB0F80A31400
A25B131EA2133E133C137C1378A25BA2485A485AA2485A48C7FC120E5A5A5A5A5A13527C
BD20>I<EB0380497EA7397803803C00FC147E00FE14FE397F8383FC393FC387F8390FE3
8FE03903FBBF803900FFFE00EB3FF8EB0FE0A2EB3FF8EBFFFE3903FBBF80390FE38FE039
3FC387F8397F8383FC39FE0380FE00FC147E0078143C390007C000A76D5A1F247BBD2A>
I<15301578B3A6007FB812F8B912FCA26C17F8C80078C8FCB3A6153036367BAF41>I<12
1C127FEAFF80A213C0A3127F121C1200A412011380A2120313005A1206120E5A5A5A1260
0A19798817>I<B512FCA516057F941C>I<121C127FEAFF80A5EA7F00121C0909798817>
I<150C151E153EA2153C157CA2157815F8A215F01401A215E01403A215C01407A2158014
0FA215005CA2141E143EA2143C147CA2147814F8A25C1301A25C1303A2495AA25C130FA2
91C7FC5BA2131E133EA2133C137CA2137813F8A25B1201A25B1203A25B1207A25B120FA2
90C8FC5AA2121E123EA2123C127CA2127812F8A25A12601F537BBD2A>I<EB03F8EB1FFF
90387E0FC09038F803E03901E000F0484813780007147C48487FA248C77EA2481580A300
7EEC0FC0A600FE15E0B3007E15C0A4007F141F6C1580A36C15006D5B000F143EA26C6C5B
6C6C5B6C6C485A6C6C485A90387E0FC0D91FFFC7FCEB03F8233A7DB72A>I<EB01C01303
1307131F13FFB5FCA2131F1200B3B3A8497E007FB512F0A31C3879B72A>I<EB0FF0EB7F
FE48B57E3903E03FE0390F000FF0000E6D7E486D7E486D7E123000706D7E126012FCB4EC
7F807FA56CC7FC121CC8FCEDFF00A34A5A5D14035D4A5A5D140F4A5A4A5A92C7FC147C5C
495A495A495A495A91C8FC011EEB01805B5B49130348481400485A485A000EC75A000FB6
FC5A5A485CB6FCA321387CB72A>I<EB07F8EB3FFF4913C03901F80FF03903C007F84848
6C7E380E0001000F80381FE0006D7FA56C5A6C5AC85A1401A25D4A5AA24A5A5DEC0F8002
7EC7FCEB1FFCECFF809038000FE06E7EEC01FC816E7EED7F80A216C0A2153F16E0A2121E
EA7F80487EA416C049137F007F1580007EC7FC0070ECFF006C495A121E390F8003F83907
F00FF00001B512C06C6C90C7FCEB0FF8233A7DB72A>I<1538A2157815F8A21401140314
07A2140F141F141B14331473146314C313011483EB030313071306130C131C1318133013
70136013C01201EA038013005A120E120C5A123812305A12E0B712F8A3C73803F800AB4A
7E0103B512F8A325397EB82A>I<0006140CD80780133C9038F003F890B5FC5D5D158092
C7FC14FC38067FE090C9FCABEB07F8EB3FFE9038780F803907E007E090388003F0496C7E
12066E7EC87EA28181A21680A4123E127F487EA490C71300485C12E000605C1270003049
5A00385C6C1303001E495A6C6C485A3907E03F800001B5C7FC38007FFCEB1FE0213A7CB7
2A>I<EC3FC0903801FFF0010713FC90380FE03E90383F800790387E001F49EB3F804848
137F485AA2485A000FEC3F0049131E001F91C7FCA2485AA3127F90C9FCEB01FC903807FF
8039FF1E07E090383801F0496C7E01607F01E0137E497FA249148016C0151FA290C713E0
A57EA56C7E16C0A2121FED3F807F000F15006C6C5B15FE6C6C5B6C6C485A3900FE07F090
383FFFC06D90C7FCEB03FC233A7DB72A>I<12301238123E003FB612E0A316C05A168016
000070C712060060140E5D151800E01438485C5D5DC712014A5A92C7FC5C140E140C141C
5CA25CA214F0495AA21303A25C1307A2130FA3495AA3133FA5137FA96DC8FC131E233B7B
B82A>I<EB03F8EB1FFF017F13C09038FC07F03901E001F848486C7E4848137C90C77E48
141E000E141F001E80A3121FA27F5D01E0131E6C6C133E01FC133C6D5B6C6C6C5AECC1E0
6CEBF3C06C01FFC7FC6C5BEB3FFF6D13C081017F13F801F07F3903E07FFE3907801FFF48
486C1380481303003E6D13C0003CEB007F007C143F0078EC0FE000F814075A1503A21501
A36C15C012781503007C15806CEC07006C5C6C6C131ED807E0137C3903F803F0C6B55A01
3F1380D907FCC7FC233A7DB72A>I<EB03F8EB1FFF017F13C09038FC07E03903F803F048
486C7E48486C7E49137E121F48487FA2007F158090C7FCA248EC1FC0A616E0A56C143FA2
7F123F001F147FA26C6C13FF3907E001DF0003149F3801F0033900FC0F1FD93FFC13C0EB
07F090C7FC153F1680A316005D000F147E487E486C5BA24A5A4A5A49485A6C48485A001C
495A260F807FC7FC3807FFFC000113F038003FC0233A7DB72A>I<121C127FEAFF80A5EA
7F00121CC7FCB2121C127FEAFF80A5EA7F00121C092479A317>I<121C127FEAFF80A5EA
7F00121CC7FCB2121C127F5A1380A4127F121D1201A412031300A25A1206A2120E5A1218
12385A1260093479A317>I<EB3FE03801FFFE3907C03F80390E000FC0003CEB07F00030
1303007014F8007C130100FE14FC7EA4127E003CEB03F8C7FCEC07F0A2EC0FE0EC1F80EC
3F00147E147C5C495A5C495A5CA249C7FCA31306AA90C8FCA8130EEB3F80497EA56D5A01
0EC7FC1E3B7CBA27>63 D<EC03FF021F13E09138FC00FCD901E0131ED90780EB0780011E
C7EA01E00138EC00704981498148488148488190C97E48D901FC1480000ED907FFEB01C0
000C90391F03C000001C90267E00E013E000184901701360263801F86D13700030496D13
300103EC0FE0267007E00107133800601718495AA200E0171C484848150CAA6C6C7E1260
A26D6C151C00701718263003F0130F0101141F00386D013F1338261800FC01771330001C
017E9038E3F070000C90261F03C113E0000E903A07FF00FFC06CD901FCEB3F006C90CAFC
7F6C7E6C7E13706D167C011EED03FCD90780EC1FF0D901E0ECFF80D900FC90383FFC0002
1FB51280020301E0C7FC363C7BBA41>I<1538A3157CA315FEA34A7EA34A6C7EA202077F
EC063FA2020E7FEC0C1FA2021C7FEC180FA202387FEC3007A202707FEC6003A202C07F15
01A2D901807F81A249C77F167FA20106810107B6FCA24981010CC7121FA2496E7EA3496E
7EA3496E7EA213E0707E1201486C81D80FFC02071380B56C90B512FEA3373C7DBB3E>I<
B712E016FC16FF0001903980007FC06C90C7EA1FE0707E707E707EA2707EA283A75F1603
5F4C5A4C5A4C5A4C5AEEFF8091B500FCC7FCA291C7EA7F80EE1FE0EE07F0707E707E8370
7EA21880177F18C0A7188017FFA24C13005F16034C5AEE1FF8486DEB7FF0B812C094C7FC
16F832397DB83B>I<913A01FF800180020FEBE003027F13F8903A01FF807E07903A03FC
000F0FD90FF0EB039F4948EB01DFD93F80EB00FF49C8127F01FE153F12014848151F4848
150FA248481507A2485A1703123F5B007F1601A35B00FF93C7FCAD127F6DED0180A3123F
7F001F160318006C7E5F6C7E17066C6C150E6C6C5D00001618017F15386D6C5CD91FE05C
6D6CEB03C0D903FCEB0F80902701FF803FC7FC9039007FFFFC020F13F002011380313D7B
BA3C>I<B712C016F816FE000190398001FF806C90C7EA3FE0EE0FF0EE03F8707E707E17
7FA2EF3F8018C0171F18E0170F18F0A3EF07F8A418FCAC18F8A4EF0FF0A218E0A2171F18
C0EF3F80A2EF7F0017FE4C5A4C5AEE0FF0EE3FE0486DEBFF80B8C7FC16F816C036397DB8
3F>I<B812FCA30001903880000F6C90C71201EE007E173E171E170EA31706A317078316
C0A394C7FCA31501A21503150F91B5FCA3EC000F15031501A21500A21860A318E093C712
C0A41701A3EF0380A21707A2170F173F177F486D903807FF00B9FCA333397DB839>I<B8
12F8A30001903880001F6C90C71201EE00FC177C173C171CA2170CA4170E1706A2ED0180
A21700A41503A21507151F91B5FCA3EC001F15071503A21501A692C8FCAD4813C0B612C0
A32F397DB836>I<DBFF8013C0020FEBF001023F13FC9139FF803F03903A03FC000787D9
0FF0EB03CF4948EB00EF4948147F4948143F49C8121F485A4848150F48481507A2484815
03A2485A1701123F5B007F1600A448481600AB93B6FCA26C7E9338007FE0EF3FC0A2123F
7F121FA26C7EA26C7EA26C7E6C7E6C6C157F6D7E6D6C14FF6D6C14EFD90FF8EB03C7D903
FEEB0783903A00FFC03F0191393FFFFC00020F01F0130002001380383D7CBA41>I<B648
B512FEA30001902680000313006C90C76C5AB3A491B6FCA391C71201B3A6486D497EB648
B512FEA337397DB83E>I<B612C0A3C6EBC0006D5AB3B3AD497EB612C0A31A397EB81E>I<
013FB512E0A39039001FFC00EC07F8B3B3A3123FEA7F80EAFFC0A44A5A1380D87F005B00
70131F6C5C6C495A6C49C7FC380781FC3801FFF038007F80233B7DB82B>I<B649B5FCA3
000101809038007FF06C90C8EA3F80053EC7FC173C17385F5F4C5A4C5A4CC8FC160E5E5E
5E5E4B5AED0780030EC9FC5D153E157E15FF5C4A7F4A6C7E140E4A6C7E4A6C7E14704A6C
7E4A6C7E14804A6C7E6F7EA26F7F707EA2707E707EA2707EA2707E707EA2707E707F8484
486D497FB6011FEBFF80A339397DB841>I<B612E0A3000101C0C8FC6C90C9FCB3AD1718
A517381730A31770A317F0A216011603160FEE1FE0486D13FFB8FCA32D397DB834>I<B5
933807FFF86E5DA20001F0FC002600DFC0ED1BF8A2D9CFE01533A3D9C7F01563A3D9C3F8
15C3A2D9C1FCEC0183A3D9C0FEEC0303A2027F1406A36E6C130CA36E6C1318A26E6C1330
A36E6C1360A26E6C13C0A3913901FC0180A3913900FE0300A2ED7F06A3ED3F8CA2ED1FD8
A3ED0FF0A3486C6D5A487ED80FFC6D48497EB500C00203B512F8A2ED018045397DB84C>
I<B5913807FFFE8080C69238007FE06EEC1F80D9DFF0EC0F001706EBCFF8EBC7FCA2EBC3
FEEBC1FFA201C07F6E7EA26E7E6E7E81140F6E7E8114036E7E168080ED7FC016E0153FED
1FF0ED0FF8A2ED07FCED03FEA2ED01FF6F1386A2EE7FC6EE3FE6A2EE1FF6EE0FFEA21607
1603A216011600A2177E486C153E487ED80FFC151EB500C0140EA2170637397DB83E>I<
EC03FF021F13E09138FE01FC903901F8007ED907E0EB1F8049486D7ED93F80EB07F049C7
6C7E01FE6E7E48486E7E49157E0003167F4848ED3F80A24848ED1FC0A2001F17E049150F
003F17F0A3007F17F8491507A300FF17FCAC007F17F86D150FA3003F17F0A26C6CED1FE0
A36C6CED3FC0000717806D157F000317006C6C15FEA26C6C4A5A017F4A5A6D6C495A6D6C
495AD907E0EB1F80D903F8017FC7FC903900FE01FC91381FFFE0020390C8FC363D7BBA41
>I<B712C016F816FE000190398001FF806C90C7EA3FC0EE0FE0EE07F0EE03F817FC17FE
1601A217FFA717FEA2EE03FCA2EE07F817F0EE0FE0EE3FC0923801FF0091B512FC16F091
C9FCB3A5487FB6FCA330397DB839>I<B612FEEDFFE016F8000190388007FE6C90C76C7E
EE3FC0707E707E707EA2707EA283A65FA24C5AA24C5A4C5AEE3F8004FFC8FCED07FC91B5
12E05E9138000FF0ED03F8ED00FE82707E707EA2161F83A583A6F00180A217F8160F1803
486D01071400B66D6C5A04011306933800FE0ECAEA3FFCEF07F0393B7DB83D>82
D<D90FF813C090383FFE0190B512813903F807E33907E000F74848137F4848133F48C712
1F003E140F007E1407A2007C140312FC1501A36C1400A37E6D14006C7E7F13F86CB47E6C
13F8ECFF806C14E06C14F86C14FEC680013F1480010714C0EB007F020713E0EC007FED3F
F0151F150FED07F8A200C01403A21501A37EA216F07E15036C15E06C14076C15C06C140F
6DEB1F80D8FBF0EB3F00D8F0FE13FE39E03FFFF8010F13E0D8C00190C7FC253D7CBA2E>
I<003FB812E0A3D9C003EB001F273E0001FE130348EE01F00078160000701770A3006017
30A400E01738481718A4C71600B3B0913807FF80011FB612E0A335397DB83C>I<B69038
07FFFEA3000101809038007FE06C90C8EA1F80EF0F001706B3B2170E6D150C80171C133F
17186D6C14385F6D6C14F06D6C5C6D6C495A6D6CEB07806D6C49C7FC91387F807E91381F
FFF8020713E09138007F80373B7DB83E>I<B500FC91387FFF80A30003018091380FFC00
6C90C8EA07E0715A6C705A6E1403017F93C7FCA280013F1506A26E140E011F150C80010F
5DA28001075DA26E147001031560A26D6C5CA2806D4A5AA2ED8003027F91C8FCA291383F
C006A215E0021F5BA2EDF01C020F1318A26E6C5AA215FC02035BA2EDFEE002015BA26E6C
5AA36FC9FCA3153EA2151CA3393B7EB83E>I<B5D8FC07B5D8F001B5FCA3000790278000
1FFEC7EA1FF86C48C7D80FF8EC07E000010307ED03C01B807F6C6F6C1500A26E5F017F6E
6C1406A280013F4A6C5CA280011F4A6D5BEE067FA26D6C010E6D5BEE0C3FA26D6C011C6D
5BEE181FA26D6C6F5BEE300FA26D6C6F485AEE6007A26D6C4CC7FC9338C003FCA203805D
913B7F818001FE06A203C1150EDA3FC3C7EAFF0CA203E3151CDA1FE6EC7F98A215F6DA0F
FCEC3FF0A302075E4B141FA202035E4B140FA202015E4B1407A2020093C8FC4B80503B7E
B855>I<007FB590383FFFFCA3C601F801071380D97FE0D903FCC7FC013FEC01F06D6C5C
5F6D6C5C6D6C13034CC8FC6D6C1306160E6D6C5B6DEB8018163891387FC0306E6C5A16E0
6E6C5A91380FF18015FB6EB4C9FC5D14036E7EA26E7F6F7EA24B7E15DF9138019FF09138
038FF8150F91380607FC91380E03FE140C4A6C7EEC38000230804A6D7E14E04A6D7E4948
6D7E130391C76C7E01066E7E130E010C6E7E011C1401013C8101FE822607FF80010713E0
B500E0013FEBFF80A339397EB83E>I<003FB7FCA39039FC0001FE01C0130349495A003E
C7FC003C4A5A5E0038141F00784A5A12704B5A5E006014FF4A90C7FCA24A5A5DC712074A
5AA24A5A5D143F4A5AA24A5A92C8FC5B495AA2495A5C130F4948EB0180A2495A5C137F49
5A16034890C7FC5B1203485AEE0700485A495C001F5D48485C5E4848495A49130FB8FCA3
29397BB833>90 D<EAFFF8A4EAF000B3B3B3B3A3EAFFF8A40D5378BD17>I<EAFFF8A4EA
0078B3B3B3B3A3EAFFF8A40D537FBD17>93 D<EA01801203EA0700120E5A121812381230
12701260A212E05AA412CEEAFF8013C0A3127FA2EA3F80EA0E000A197AB917>96
D<EB1FE0EBFFFC3803E03F3907000F80390F8007E0486C6C7E13E06E7EA26E7E6C5A6C5A
C8FCA4147FEB07FFEB3FE0EBFE00EA03F8EA0FF0EA1FC0123F485A90C7FC160C12FEA314
01A26C13036CEB077C903980063E18383FC01E3A0FE0781FF03A03FFF00FE03A007F8007
C026277DA52A>I<EA03F012FFA3120F1203B0EC1FE0EC7FF89038F1E03E9039F3801F80
9039F7000FC001FEEB07E049EB03F049EB01F85BED00FCA216FEA2167E167FAA167E16FE
A216FC15016D14F8ED03F07F01EEEB07E001C6EB0FC09039C7801F00903881E07E903800
FFF8C7EA1FC0283B7EB92E>I<EB03FC90381FFF8090387E03E03901F80070484813F839
07E001FC380FC003A2EA1F80123F90380001F848EB00F01500A2127E12FEAA127E127FA2
6C14067F001F140E6D130C000F141C6C6C13386C6C13706C6C13E039007C07C090381FFF
00EB07F81F277DA525>I<ED0FC0EC03FFA3EC003F150FB0EB03F8EB1FFF90387E078F90
38F801EF3903F0007F4848133F4848131FA24848130F123F90C7FC5AA2127E12FEAA127E
127FA27EA26C6C131FA26C6C133F6C6C137F6C6CEBEFF03A01F801CFFF39007C078F9038
1FFE0FD907F813C0283B7DB92E>I<EB07F8EB1FFF90387C0FC03901F803E03903F001F0
D807E013F8380FC0004848137CA248C7127E153E5A153F127E12FEA3B7FCA248C8FCA512
7EA2127FA26C14037F001F14076C6C13060007140E6D131CD801F013386C6C137090387E
03E090381FFF80903803FC0020277EA525>I<147E903803FF8090380FC1E0EB1F879038
3F0FF0137EA213FCA23901F803C091C7FCADB512FCA3D801F8C7FCB3AB487E387FFFF8A3
1C3B7FBA19>I<ED03F090390FF00FF890393FFC3C3C9039F81F707C3901F00FE03903E0
07C03A07C003E010000FECF000A248486C7EA86C6C485AA200075C6C6C485A6D485A6D48
C7FC38073FFC38060FF0000EC9FCA4120FA213C06CB512C015F86C14FE6CECFF804815C0
3A0F80007FE048C7EA0FF0003E140348140116F8481400A56C1401007C15F06CEC03E000
3F1407D80F80EB0F80D807E0EB3F003901FC01FC39007FFFF0010790C7FC26387EA52A>
I<EA03F012FFA3120F1203B0EC0FF0EC3FFCECF03F9039F1C01F809039F3800FC0EBF700
13FE496D7EA25BA35BB3A3486C497EB500C1B51280A3293A7EB92E>I<EA0380EA0FE048
7EA56C5AEA0380C8FCAAEA03F012FFA312071203B3AA487EB512C0A312387EB717>I<EB
01C0EB07F0EB0FF8A5EB07F0EB01C090C7FCAAEB01F813FFA313071301B3B3A2123C127E
00FF13F01303A214E038FE07C0127C383C0F00EA0FFEEA03F8154984B719>I<EA03F012
FFA3120F1203B1913801FFFCA39138007FC01600157C15705D4A5A4A5A4AC7FC141E1438
147814FC13F1EBF3FEEBF73F01FE7FEBF81F496C7E8114076E7E6E7E811400157E157F81
1680ED1FC0486CEB3FF0B500C0B5FCA3283A7EB92C>I<EA03F012FFA3120F1203B3B3AD
487EB512C0A3123A7EB917>I<2703F00FF0EB1FE000FFD93FFCEB7FF8913AF03F01E07E
903BF1C01F83803F3D0FF3800FC7001F802603F70013CE01FE14DC49D907F8EB0FC0A249
5CA3495CB3A3486C496CEB1FE0B500C1B50083B5FCA340257EA445>I<3903F00FF000FF
EB3FFCECF03F9039F1C01F803A0FF3800FC03803F70013FE496D7EA25BA35BB3A3486C49
7EB500C1B51280A329257EA42E>I<EB03FE90380FFF8090383E03E09038F800F8484813
7C48487F48487F4848EB0F80001F15C090C712074815E0A2007EEC03F0A400FE15F8A900
7E15F0A2007F14076C15E0A26C6CEB0FC0000F15806D131F6C6CEB3F006C6C137EC66C13
F890387E03F090381FFFC0D903FEC7FC25277EA52A>I<3903F01FE000FFEB7FF89038F1
E07E9039F3801F803A0FF7000FC0D803FEEB07E049EB03F04914F849130116FC150016FE
A3167FAA16FEA3ED01FCA26DEB03F816F06D13076DEB0FE001F614C09039F7803F009038
F1E07E9038F0FFF8EC1FC091C8FCAB487EB512C0A328357EA42E>I<D903F813C090381F
FE0190387E07819038FC01C33903F000E3000714774848133749133F001F141F485A150F
48C7FCA312FEAA127FA37E6D131F121F6D133F120F6C6C137F6C6C13EF3901F801CF3900
7E078F90381FFE0FEB07F890C7FCABED1FE00203B5FCA328357DA42C>I<3807E01F00FF
EB7FC09038E1E3E09038E387F0380FE707EA03E613EE9038EC03E09038FC0080491300A4
5BB3A2487EB512F0A31C257EA421>I<EBFF03000313E7380F80FF381E003F487F487F00
707F12F0A2807EA27EB490C7FCEA7FE013FF6C13E06C13F86C7F00037FC67F01071380EB
007F141F00C0EB0FC01407A26C1303A37E15806C13077EEC0F00B4131E38F3C07C38E1FF
F038C03F801A277DA521>I<1318A51338A31378A313F8120112031207001FB5FCB6FCA2
D801F8C7FCB215C0A93800FC011580EB7C03017E13006D5AEB0FFEEB01F81A347FB220>
I<D803F0EB07E000FFEB01FFA3000FEB001F00031407B3A4150FA3151F12016D133F0000
EC77F86D9038E7FF8090383F03C790381FFF87903A03FC07E00029267EA42E>I<B53880
3FFEA33A0FF8000FF06C48EB07E00003EC03C06D148000011500A26C6C1306A26D130E01
7E130CA26D5BA2EC8038011F1330A26D6C5AA214E001075BA2903803F180A3D901FBC7FC
A214FF6D5AA2147CA31438A227257EA32C>I<B53A1FFFE03FFEA3260FF8009038000FF8
6C48017EEB03E018C00003023EEB0180A26C6C013FEB0300A36C6CEC8006156FA2017E90
38EFC00C15C7A2D93F016D5A15830281EBF038D91F831430150102C3EBF87090260FC600
1360A2D907E66D5A02EC137CA2D903FCEB7F804A133FA2010192C7FC4A7FA20100141E4A
130E0260130C37257EA33C>I<B538807FFFA33A03FE003FF00001EC1F80000092C7FC01
7E131C6D13186D6C5AECC070010F5B6D6C5AECF180EB03FB6DB4C8FC6D5AA2147F804A7E
8114CF903801C7E090380383F090380703F8EB0601496C7E011C137E49137F01787F496D
7E486C80000FEC3FF0D8FFFE90B51280A329247FA32C>I<B538803FFEA33A0FF8000FF0
6C48EB07C00003EC03806C7E16007F00001406A2017E5BA2137F6D5BA26D6C5AA2ECC070
010F1360A26D6C5AA214F101035BA2D901FBC7FCA214FF6D5AA2147CA31438A21430A214
701460A25CA2EA7C0100FE5B130391C8FC1306EAFC0EEA701C6C5AEA1FF0EA0FC027357E
A32C>I<003FB512FCA2EB8003D83E0013F8003CEB07F00038EB0FE012300070EB1FC0EC
3F800060137F150014FE495AA2C6485A495AA2495A495A495AA290387F000613FEA2485A
485A0007140E5B4848130C4848131CA24848133C48C7127C48EB03FC90B5FCA21F247EA3
25>I<B81280A2290280962A>I<BD12C0A25202809653>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fn cmss17 20.74 7
/Fn 7 85 df<EF7FFFA294B57EA34C80A24C80A34C80A34C487FA25F041F80A2187FDC3F
F87FA3047F6D7E17F0A204FF6D7FA217E04B828417C04B82844B018080A2844B010080A3
4B6E7F5EA2033F6E7F5EA2037F6F7E5EA203FF6F7F5EA24A707F5EA24A707F5EA24A707F
5E4A848593C8FC4A84855D023F84855D027F84865D02FF85865D498692BAFCA24986A349
86A24986A34990CA00037FA286494885A286494885A287494886A287484986A24A844888
875C4888875C4888874890CC80A287484887A287484887A28848481C80A28861787BF76C
>65 D<BC1280AB49CDFCB3B3A590BA12F8AB49CDFCB3B3A990BB12E0AC4B7872F761>69
D<943803FFFC057FEBFFF00403B7FC041F16E0047F16F84BB812FE0307EFFFC0031F18F0
4B18F85D4ABAFC4A9126FE000F14F04A02E0EB007F4A0280140F4A49C812014A01F8ED00
7F4A01E0163F91B548EE0FE0494A16034949CA1201494917004B1860494918005B495B5D
495BA290B5CDFC5C5A5C5A5C5A5C5A5CA25A5CA25A5CA35A91CEFCA6485AB06C7E060FB6
12FCA5807EA3807E95C8127F807EA2807E807E807E807E806D7FA26D7F816D7F7F6D7F81
6D7F6D6D7E6D806E7F6E13F86E13FE6E6D6CEC03FF6E02E0143F6E02FE010FB5FC6E91B8
FC6E7E816F18F8030718C0030118006F6C16FC041F16E004034BC7FCDC007F14E0050301
F8C8FC567A76F86C>71 D<EF0FFF4CB512F8040F14FF043F15C093B712F0030316FC030F
16FF033F17C04B8392B97E020318FC4ADAF801804A912680001F7F4A49C70007804A01F8
0201804A01E06E6C7F91B5486F7F4991C9000F7F4B824949707F4949707F4949707F4B83
4949717F49874B834990CB6C7FA24948727F4A8448884A8448884A8448884A197FA24888
4A85A2481D804A85A2481DC0A291CD7EA3481DE0A44986A200FF1DF0B16D626C1DE0A56E
61A26C1DC0A36E616C1D80A26E61A26C1D006E96B5FC6C64A26E606C646E606C646E606C
646E606D636F5F6D6D4D5B6F5F6D636D6D94B5C7FC6F5E6D6D4C5B6D6D4C5B6D6D4C5B70
5D6D6E4B5B6E01F092B55A6E6D4A5C6E01FE02075C6ED9FFC0013F91C8FC6EDAF801B55A
6E91B75A020018F06F5F6F5F030F94C9FC030316FC6F5EDB003F15C0040F92CAFC040114
F8DC000F90CBFC647E77FA77>79 D<B812FEEFFFF018FEF0FFC019F019FC19FF1AC08686
49C8000F80DD007F13FE060F7F0603801800737F071F7F737F85737FA2737FA2737FA21A
7FA28786A86263A21AFFA24F5BA24F5BA24F5B614F5B197F96B55A06035C060F91C7FC06
7F5B050FB55A90BA5A62621A8097C8FC19FC19F019C04EC9FC18F88449C8FC717E848385
83858385717FA2717F83858385187F85727FA2727F848684868486727FA2727F197F8685
87737FA2737FA2737FA2737F8587737FA2747EA2741380A27413C0861CE07413F0A27413
F8557872F768>82 D<923801FFFC031FEBFFF092B612FE0203EDFFC0020F16F8023F16FE
4A707E49B912E049845B5B496049EC80074901F8C7123F90B500E01407038014014891C9
127F4849EE1FC002F8160F4818034A16014849160097C7FC5C5A5CA34890CDFCA880A36C
7FA280A26C7F80A26C13FE806C8015E06C14F86C14FF16F06D14FF6D15F06D15FE6DEDFF
C06D16F06D16FC6D16FF6D6C16C06E82020F82020382020082031F81030181DB003F8104
0381DC003F801707050180717E727F180F727F848684848685A2851B80A385A94F1300A4
00304E5A1238003C18FF003E61003F5FD87FC05E6D6001F84C5B01FE5E6D6C4B5B02E015
7FB500FC4AB55ADAFF8001075C03FC013F91C7FC6C91B75A001F606C60000360C660013F
5F010F94C8FC01035ED9007F15F8020F15C0020092C9FC030313E0497E79FA5A>I<BF12
80ABCA6C90CBFCB3B3B3B3B3B261777AF66E>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fo cmr17 17.28 18
/Fo 18 117 df<DD7FF81560040FB56C14E0047F14E00303B600FC1301030F9038E003FE
DB3FFEC7383F8003DBFFF0EC07C04A01C0913803F007020790C9EAF80FDA0FFC167C4A48
EE1E1FDA7FE0160F4A48EE07BF4949EE03FF4990CAFC4948834948834A187F495A013F19
3F4948181F5C01FF190F485BA24890CC1207A248481903A2485A1B01121FA25B123F1B00
5BA2127F1C00A4485AB06C7EA5123F1CE07FA2121F7FA2000F1A011CC06C7EA26C7E1B03
6C6D19801B076C7F017F1A006E606D6C181E131F6D6C606E18386D6C18786D6C606D6D4C
5A6D6D4C5A6E6C1607DA1FF84C5A6E6C4CC7FC6EB4167C020101C04A5A6E01F0EC07F0DB
3FFEEC1FC092280FFFE001FFC8FC030390B512FCDB007F14F0040F14809326007FF8C9FC
53667AE360>67 D<BC1280A4C601FCC81201D93FF8DB001F13C0011F170319001A7F1A3F
1A1F1A0F1A07A21A03A21BE01A01A41A00A61B701870A41B00A418F0A417011703170717
0F177F91B7FCA402F8C7127F170F1707170317011700A41870A31B0EA41B1C95C8FCA51B
3C1B38A31B78A41BF0A31A01A21A031A07A2F20FE01A1F1A7F1AFF1903013F171FD9FFFC
0303B5FCBC12C0A44F6279E15A>69 D<DA07FF1403023F01F05B49B512FC010702FF5B90
260FFC0013C0D93FE090380FF01FD97F80EB03F801FEC86C5A4848157E4848ED1F7F4848
6F5A4848815B001F824981003F8290CAFC4883A2007E83A212FE84A384A27EA36D82A26C
7EA26D93C7FC6C7E7F7F6C7E6D7E6C13E06C13FCECFFC06C14F86CECFF806C15F86DECFF
80011F15E06D15F8010315FE01006F7E021F81020181DA003F80030380DB003F7F04037F
EE007FEF1FFF71138017037113C083A2F07FE0183FA2181F00E018F0180FA41807A27EA4
7E19E0180F7E19C07E6C171F19806D163F6D17006D5E6D16FE486C5E6D4B5AD8FC7F1503
D91F80EC0FF026F80FE04A5AD907FCEC7F8029F001FFE003FFC7FC6D6CB512FC48011F14
F0020314C0489026001FFEC8FC3C667AE349>83 D<003FBC12F8A49126C000039038C000
0301FCC76C49EB007F01F0190F01C019074848F103FC90C81701007E1A00007C1B7CA300
781B3CA400701B1CA600F01B1E481B0EA7C91800B3B3B3A54C7FA2041F13F84AB87EA457
627CE160>I<B600FC057FB5FCA4C60280050F13F0D93FFECB000313804A953801FE0001
1F62755A130F6E61010762806D4F5AA2816D4F5AA26F17076D97C7FC81027F180EA26F17
1E023F181C811B3C021F183881020F60A26F17F0020760811A016E60826E4D5AA2701507
6E95C8FC82037F160EA282033F5E821A3C031F163882030F5EA27015F003075E8219016F
5E836F4B5AA27113076F93C9FC83047F140EA283043F5CA271133C041F143883040F5CA2
7113F004075C831801705C188170EB8380A218C77091CAFC18E7EF7FEEA218FE715AA371
5AA2715AA3715AA3715AA260647FE163>86 D<EC3FF0903803FFFE010F6D7E90393FC03F
E090397E0007F801F86D7ED801E06D7E48486D7E48486E7E48C86C7E7F01F06E7E487E6D
6E7EA3707EA36C5AEA03E0C9FCA6167FED7FFF020FB5FC91387FF807903801FF80903807
FC00EB1FF0EB7FC0495AD803FEC7FC485A120F5B485A485AA2484817E0A312FF5BA2160F
A3161F6D141B007F153B16736D913971FC01C06C6C14E1001FEC01C1D80FFC903A0780FE
03806C6C903A0F00FF07002701FF807E6DB4FC27007FFFF86D5A011F01E0EB1FF8010190
C7EA07E03B417ABF42>97 D<4AB47E020F13F8023F13FE9139FF007F80D903FCEB07E0D9
07F0EB01F0D91FE0EB007849488049488049C87E48485D4915FF00034B138048485CA248
5AA2485AA2003F6F130049EC007C94C7FC127FA35B12FFAD127F7FA4123F7FA2001FEE01
C07F000F16036D168012076C6C15076D160000015E6C6C151E6D6C5C6D6C5C6D6C5CD90F
F8495AD903FCEB07C0903A00FF803F8091263FFFFEC7FC020F13F80201138032417CBF3A
>99 D<EC03FE91381FFFE091B512F8903901FE03FE903A07F0007F8049486D7ED93FC06D
7E49C76C7E496E7E49140348488148481401000782491400000F8283485A1880123F4915
3FA2007F17C0A35BA212FF90B8FCA30180CAFCA9127F7FA3123FA27F121FEF01C06C7E17
036C6C1680A26C6C15070001EE0F006D150E6C6C151E6D6C5C6D6C5C6D6C5CD907F0EB03
E0D903FC495A902700FF803FC7FC91383FFFFC020F13F00201138032417CBF3A>101
D<F03F80DA03FC903801FFE091273FFFC00713F091B539F01FC1F8903B03FC03FC3E0390
3A07F000FE784948EB7FE04948EB3FC04948011FEB01F049C76C6CC7FC01FE6E7EA24848
6E7EA2000382A2491401000782AA00035E6D1403A200015EA26C6C4A5AA2017F4A5A6D6C
495A6D6C495A496C49C8FCD937F013FE903973FC03FC0160B512F0D9E03F13C0DA03FCC9
FC4848CBFCA57FA27FA27F6C7E13FF91B512FE6DECFFF06D15FE6D6F7E6D16E084013F16
FC01FEC700017FD803F8EC001FD807E0ED03FF4848030013804848167F003FEF3FC090CA
121F127EF00FE012FE481707A66C170F007E18C0A2007F171F6C6CEE3F806C6CEE7F0000
0F177ED807F04B5A6C6C4B5A6C6C4B5AD8007FED1FC0D93FE0ECFF80D90FFED90FFEC7FC
0101B612F0D9003F1480020101F0C8FC3D5E7DBF42>103 D<EB03C0EA07FFB5FCA41201
EA007FA2133FB3AAEE7FE0923803FFFC030F13FFDB3F0013C00378EB1FE04B6D7EDAC1C0
6D7EDAC3808002C7C7120302CE81170114DC14D802F86E7E5CA35CA35CB3B3496C4A7F49
6C4A7FB6D8F003B612C0A442647DE349>I<133C13FF487F487FA66C5B6C90C7FC133C90
C8FCB3A2EB03C0EA07FF127FA41201EA007FA2133FB3B3AC497E497EB612E0A41B5F7DDE
23>I<EB03C0EA07FFB5FCA41201EA007FA2133FB3B3B3B3AD497E497EB612F0A41C647D
E323>108 D<D903C0D9FFC0EC07FED807FF010301F891381FFFC0B5010F01FE027F13F0
923D3F00FF8001F807FC0378903B3FC003C001FEDAC1E090261FE00FC77E0001D9C3C090
260FF01E6E7ED8007F49902607F81C6E7E02C7C75CD93FCE6E6C486E7E02CC166002DC16
E002D85E02F8DA01FF6F7E4A5EA24A93C8FCA44A5DB3B3496C4A6C4B7E496C4A6D4A7EB6
D8F007B6D8803FB512FCA4663F7CBE6F>I<EDFF80020F13F8023F13FE9139FF007F80D9
03FCEB1FE0D907F0EB07F0D90FC0EB01F8D93F80EB00FE49C8127F017E81496F7E48486F
7E00038349150700078348486F7EA2001F83491501A2003F83A348486F7EA400FF1880AC
007F1800A26D5DA2003F5FA36C6C4B5AA36C6C4B5A00075FA26C6C4B5A6C6C4B5AA26C6C
4B5A017F4BC7FC6D6C14FE6D6C495AD90FF0EB07F8D903FCEB1FE0D900FFEB7F806EB5C8
FC020F13F8020113C039417CBF42>111 D<D903C0EB7FC0D807FF903807FFFCB5011F13
FFDB7F0013C003F8EB1FF0DAC3E0EB07F80001D9C7806D7E26007FCFC76C7E02DE6E7ED9
3FFC6F7E4A6F7E4A82181F4A82727E5C727EA2727EA3727EA41A8084AC4E1300A54E5AA2
611807A24E5A6E5E181F6E4B5A6E5E187F6E4B5A02DE4A90C7FC02CF4A5ADAC780495ADA
C3C0EB0FF0DAC1F0EB3FE0913AC07E01FF806FB448C8FC030F13F80300138093CAFCB3A3
497E497EB612F0A4415B7DBE49>I<9039078003F8D807FFEB0FFFB5013F13C092387C0F
E0913881F01F9238E03FF00001EB838039007F8700148FEB3F8E029CEB1FE0EE0FC00298
EB030002B890C7FCA214B014F0A25CA55CB3B0497EEBFFF8B612FCA42C3F7CBE33>114
D<9139FFE00180010FEBFC03017FEBFF073A01FF001FCFD803F8EB03EFD807E0EB01FF48
487F4848147F48C8123F003E151F007E150F127CA200FC1507A316037EA27E7F6C7E6D91
C7FC13F8EA3FFE381FFFF06CEBFF806C14F86C14FF6C15C06C6C14F0011F80010714FED9
007F7F02031480DA003F13C01503030013E0167F00E0ED1FF0160F17F86C15071603A36C
1501A37EA26C16F016037E17E06D14076DEC0FC06D1580D8FDF0141FD8F8F8EC7F00013E
14FC3AF01FC00FF80107B512E0D8E001148027C0003FF8C7FC2D417DBF34>I<1438A714
78A414F8A31301A31303A21307130F131FA2137F13FF1203000F90B6FCB8FCA3260007F8
C8FCB3AE17E0AE6D6CEB01C0A316036D6C148016076D6C14006E6C5A91383FC01E91381F
F07C6EB45A020313E09138007F802B597FD733>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fp cmr17 20.74 14
/Fp 14 117 df<DE7FFCED01C0050FB512C094B600F81403040315FE041F6F6C1307047F
D9F00013E04B4848C7D80FF0130F030701F0EC03FC4B0180DA00FE131FDB3FFEC9123FDB
7FF893381F803F4A4848EE07E04A01C0933803F07F4A4916014A90CBEAF8FFDA1FFC187C
4A48183F4A48844A5A498649498449498492CCFC494885131F4A85495A017F1B7F5C01FF
1B3F5C5A4A1A1F5AA248491A0FA25A91CE1207A25A5BA2003F1C03A25BA2127F9AC7FCA4
5B12FFB2127F7FA5123FF501C07FA2121FA27F7E1D036E1B807EA26C7F1D076C1D00806C
6480017F1B0E6E1A1E013F1B1C6D6C1A3C6E1A38010F1B786D6C1A706F19F06D6D4E5A6D
7F6D505A6E6C4E5A6E6C180FDA1FFE4EC7FC6E6C183E6E6D5F6E6D5F6E01F04C5A6E6C6C
EE07E0DB3FFE4C5A92260FFF80ED3F806F01F003FEC8FC030101FEEC07FC9227007FFFF0
EBFFF0041F90B612C0040393C9FC040015FC050F14E09426007FFCCAFC627C78F873>67
D<DB3FF815E00203B512C0021F02F81301027F14FE49B7128049D9C007EBC003D90FFEC7
EA3FF0D91FF8913807F807D93FE0EC01FC4948913800FE0F4948153F4890C9EA1F9F4848
EE0FDF49EE07FF484882000F834982121F49177F003F183F5B191F127F190F5B190712FF
A21903A31901A27FA36D1700A2127F7F7F1A006C7E7F7F6C7F806C7F14F86C7F6CEBFF80
15F86CECFF806C15F86DECFF806D15F06D15FF6D16E0010316F86D16FE6D6C81021F16C0
020382DA003F81030781DB007F80040780DC007F7F050F14801700063F13C07213E01807
7213F084841AF8197F193F1AFC191FA2190F00E019FE1907A41903A27EA57E1AFCA27E19
077E1AF86C180FA26D18F0191F6D18E06D173F6D18C06DEF7F806D17FF017E4C13006D6C
5E486C6C4B5AD90FF0ED0FF826FC07FC4B5AD901FF4B5A486C01F0ECFFC091273FFF800F
5B48010F90B548C7FC020315F8020015E048020F14809226007FF8C8FC477C78F858>83
D<001FBE12F8A502F8C7000F01F0C7121F4801806E49020113FC01FCC86C49EC003F491B
1F01E01B07491B03491B0190C91800A2003E1D7CA2003C1D3CA3481D1EA500701D0EA848
1D07A6CA1900B3B3B3B14D7F4D7F057F13FE031FB812F8A568757BF473>I<913803FF80
021F13F891B512FE903A03FC01FF80903A07E0003FE0D91F80EB0FF8013EC76C7E496E7E
01F06E7E48486E7F717E4848153F4982D807A06F7E13FC487E6D6F7E80A2717EA46C90C8
FC6C5A6C5ACAFCA6EE07FF0303B5FC157F913903FFFE07021F138091387FF800903801FF
C0010790C7FCEB1FFCEB3FF0EBFFE0485B485B4890C8FC5B485A485AA2485A1A0E485AA3
12FF5B170FA4171FA26D153F007F163B177B6DDBF1FE131C003F16E16C6C14016C6C9126
03C0FF13386C6CEC0F806C6C6C903A1F007F80706C6D017CECE1E028007FF803F8EB3FFF
011FB500E06D1380010391C7000713009026003FF8EC01FC474D79CB4F>97
D<ED1FFC4AB512C0020714F091391FF00FFC91397F8001FFD901FEC7EA7FC049486E7E49
486E7E49486E7E49486E7E49486E7E4948140101FF824890C91380A24848EE7FC0A2485A
000FEF3FE05BA2001F18F0181F485AA3007F18F8A349160FA212FF90B9FCA301E0CBFCAB
127F7FA3123FA36C7EA219386C7E1978000718707F000318F06C6C17E018016C6DED03C0
6D6C1680013F16076D6CED0F006D6C151E6D6C5D6D6C5D6DB44A5A6D6C6C495ADA3FE0EB
1F80DA0FFE01FEC7FC0203B512F8DA007F13E0DB07FEC8FC3D4D7BCB46>101
D<F103F8F13FFEDB1FF891B5FC92B5903903FC078002079139E007E01F913D1FF00FF81F
803FC0913B3FC003FC3E0002FFC7B45A49486E5A49486E5A49486E48EB1F8049486E6CEB
060097C7FC49486E7E013F82A249486E7EA201FF82A24A80A24884AA6C95C8FCA26E5CA2
017F5EA26D6C4A5AA2011F5E6D6C4A5AA26D6C4A5A6D6C4A5A496C4A5A6E4AC9FC903A0F
3FC003FC903A1E1FF00FF80207B512E0D91C0091CAFC013CEB1FF892CCFCA25BA3137CA4
137EA27F8080EB1FF091B612FE6DEDFFF818FF6D17E06D17F8010017FE010383010F84D9
3FE0C7000114E001FFC9120FD801FC04017F48489338003FF84848171F4848717E484817
07003F727E49170148CBFC737EA200FE85A76C616C616D1701003F616D17036C6C4D5A6C
6C4D5A6C6C4D5A6C6C4D5A6C6C4D5A26007F80DB01FEC7FCD93FE0ED07FCD90FF8ED1FF0
D903FFEDFFC0010001F8011F90C8FC021FB612F802011580DA000F01F0C9FC4A707DCC4F
>103 D<14F8EA03FFB5FCA5C6FC133F131FA2130FB3B0933803FF80041F13F8047F13FE
923A01FC03FF80923A03E0007FE0DB0F80EB1FF0031EC76C7E5D4B6E7E4B6E7E5D14F9DA
FBC06E7E5D14FF92C9FC865CA35CA45CB3B3A8496C4B7FD97FFF030713F0B7D8800FB612
F8A54D787AF758>I<131EEB7F80497E487F487FA66C5B6C5B6D5A011EC7FC90C8FCB3A7
EB01F0EA07FFB5FCA51201EA007F133FA2131FB3B3B3A3497EEBFFFEB612FCA51E727AF1
2A>I<EB01F0EA07FFB5FCA51201EA007F133FA2131FB3B3B3B3B3AC497EEBFFFEB612FE
A51F787AF72A>108 D<D901F0902601FFC0ED0FFED807FF021F01FC92B512E0B5027F01
FF020314F8922601FC0101C090390FE00FFE922803E0003FE090391F0001FFDB0F80D91F
F8017C6D13C04BC7000F4A147FC6023C912707FC01E06E7E013F496E6C48486E7E011F01
70DA01FF496E7E03F0160790260FF1E04CC8FCDAF3C06E019E6F7E4B169C02F717BC92C9
13B802FFDC7FF86F7E4A5FA34A5FA44A5FB3B3A8496C4C6C4B7ED97FFF030301F8031F13
C0B7D88007B600FC013FB612E0A57B4B7ACA86>I<ED07FE92387FFFE00203B512FC9139
0FFC03FF913A3FC0003FC04AC7EA0FE0D901FEEC07F8D903F8EC01FC49486E7E4948157F
49486F7E49486F7E017F8349C96C7E4916070001844848707EA2000784491601000F84A2
4848701380A2003F19C0A349177F007F19E0A412FF1AF0AD007F19E0A26D17FFA2003F19
C0A46C6C4C1380A2000F1900A26C6C4C5AA26C6C4C5A0001606D160F6C606D6C4B5A6D6C
4B5AA26D6C4B5AD907F003FEC7FCD903FCEC03FC6D6C4A5A6D6C6CEB1FF0DA3FE0EB7FC0
91270FFC03FFC8FC0203B512FCDA007F13E0DB07FEC9FC444D7BCB4F>111
D<02F849B47ED803FF021F13F8B5027F13FE923A01FC01FF80923A07E0003FE0031FC76C
7E033EEC0FFCC60278EC03FE013F496E7E90261FF9E06E7FDAFBC0826DB4486F7E92C96C
7E737E5C4A707E864A160786851B80A2851BC0A2851BE0A5F27FF0AEF2FFE0A54F13C0A3
4F1380A21B0061626E160F626E161F626E4C5A4F5A6F5EDAFBC015FFDAF9E04A5BDAF8F0
4A48C7FC03784A5A6F4A5A031FEC3FF06F6CEBFFC0922603F80790C8FC0300B512FC043F
13E0DC07FEC9FC93CBFCB3A7497EEB7FFFB77EA54C6C7BCA58>I<D903E0EB1FE0D80FFF
ECFFFCB501037F923907E01F8092391F807FC092383E00FF4B4813E000011478D8007F13
F090383FE1E015C0EB1FE39126E7800013C0EF7F8092C7EA3F0002EF91C7FC14EE14FE5C
A45CA55CB3B3A480133F90B5FCB712C0A5334B7ACA3D>114 D<1407A85CA65CA35CA35C
A25CA25BA25B5B5B5B5B5B48B712FE120FB8FCA3D8000190C9FCB3B3A2EF01C0B0EF0380
6D7FA3027FEC0700815F6E6C130E021F141E6F131C6E6C5B6E6C13F8913901FF01F09139
007FFFC0031F5BDB03FCC7FC326B7EE93D>116 D E
%EndDVIPSBitmapFont
end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 1718 1281 a Fp(The)52 b(Stratego)g(Compiler)2605
2172 y Fo(Eelco)45 b(Visser)p 4 setlinewidth np 2854
3000 a 2444 3709 li st np 2854 3000 a 3263 3709 li st
np 3263 3709 a 2444 3709 li st np 2854 3000 a 2854 3473
li st 0.000 setgray np 2884 3432 a 2854 3473 li 2823
3432 li closepath fil 0 setgray np 2884 3432 a 2854 3473
li 2823 3432 li closepath st np 2854 3473 a 2717 3709
li st np 2854 3473 a 2990 3709 li st np 2717 3709 a 2581
3473 li st np 2854 3000 a 2581 3473 li st 0.000 setgray
np 2628 3453 a 2581 3473 li 2575 3422 li closepath fil
0 setgray np 2628 3453 a 2581 3473 li 2575 3422 li closepath
st np 2990 3709 a 3127 3473 li st np 2854 3000 a 3127
3473 li st 0.000 setgray np 3133 3422 a 3127 3473 li
3079 3453 li closepath fil 0 setgray np 3133 3422 a 3127
3473 li 3079 3453 li closepath st 2438 3850 a Fn(STRA)-13
b(TEGO)p np 2404 3893 a 3304 3893 li 3304 2960 li 2404
2960 li closepath st 2393 4195 a Fm(F)-7 b(or)27 b(Stratego)g(v)n
(ersion)f(0.5a)2155 4998 y Fl(www.stratego-language.org)1211
5231 y(Institute)33 b(of)f(Information)f(and)h(Computing)g(Sciences)
2453 5347 y(Univ)m(ersiteit)g(Utrec)m(h)m(t)2577 5463
y(Jan)m(uary)h(31,)f(2001)p eop
%%Page: 1 2
1 1 bop 440 1604 a Fm(Cop)n(yrigh)n(t)853 1601 y(c)830
1604 y Fk(\015)28 b Fm(1998,)d(1999,)h(2000)g(Eelco)h(Visser)440
1773 y(P)n(ermission)f(is)h(gran)n(ted)g(to)g(mak)n(e)g(and)g
(distribute)h(v)n(erbatim)f(copies)g(of)g(this)h(man)n(ual)440
1873 y(pro)n(vided)f(the)h(cop)n(yrigh)n(t)d(notice)j(and)f(this)h(p)r
(ermission)f(notice)h(are)e(preserv)n(ed)g(on)h(all)440
1972 y(copies.)440 2142 y(P)n(ermission)f(is)h(gran)n(ted)g(to)g(cop)n
(y)g(and)g(distribute)h(mo)r(di\014ed)g(v)n(ersions)e(of)h(this)h(man)n
(ual)440 2241 y(under)f(the)h(conditions)g(for)f(v)n(erbatim)f(cop)n
(ying,)h(pro)n(vided)f(that)i(they)g(are)f(mark)n(ed)440
2341 y(clearly)f(as)h(mo)r(di\014ed)h(v)n(ersions,)e(that)i(the)g
(author's)f(names)g(and)g(title)i(are)d(unc)n(hanged)440
2441 y(\(though)i(subtitles)g(and)f(additional)g(authors')g(names)g(ma)
n(y)g(b)r(e)h(added\),)g(and)f(that)440 2540 y(other)g(clearly)f(mark)n
(ed)h(sections)g(held)h(under)f(separate)f(cop)n(yrigh)n(t)g(are)h
(repro)r(duced)440 2640 y(under)g(the)h(conditions)g(giv)n(en)e(within)
j(them,)f(and)f(that)h(the)g(en)n(tire)f(resulting)g(deriv)n(ed)440
2740 y(w)n(ork)d(is)i(distributed)g(under)g(the)g(terms)f(of)h(a)f(p)r
(ermission)g(notice)h(iden)n(tical)f(to)h(this)g(one.)440
2909 y(P)n(ermission)g(is)h(gran)n(ted)g(to)g(cop)n(y)g(and)g
(distribute)h(translations)e(of)i(this)g(man)n(ual)f(in)n(to)440
3009 y(another)g(language,)f(under)h(the)h(ab)r(o)n(v)n(e)e(conditions)
h(for)h(mo)r(di\014ed)g(v)n(ersions,)d(except)440 3108
y(that)j(this)g(p)r(ermission)f(notice)g(ma)n(y)g(b)r(e)h(stated)g(in)f
(a)h(translation)e(appro)n(v)n(ed)g(b)n(y)h(the)440 3208
y(F)-7 b(ree)27 b(Soft)n(w)n(are)g(F)-7 b(oundation.)440
3613 y(Address:)440 3713 y(Institute)28 b(of)g(Information)f(and)g
(Computing)h(Sciences)440 3813 y(Univ)n(ersiteit)f(Utrec)n(h)n(t)440
3912 y(P)-7 b(.O.Bo)n(x)26 b(80089)440 4012 y(3508)g(TB)h(Utrec)n(h)n
(t)440 4112 y(email:)37 b(visser@acm.org)440 4211 y(h)n
(ttp://www.cs.uu.nl/)p Fk(\030)p Fm(visser/)p eop
%%Page: 1 3
1 2 bop 1211 1318 a Fo(The)44 b(Stratego)f(Compiler)1560
1704 y Fj(Eelco)38 b(Visser)1562 2039 y Fm(Jan)n(uary)26
b(31,)h(2001)1671 2374 y Fi(Summary)648 2627 y Fm(This)20
b(rep)r(ort)g(do)r(cumen)n(ts)h(the)g(sp)r(eci\014cation)g(of)g(the)g
(compiler)f(for)g(the)i(strat-)648 2726 y(egy)k(language)g(Stratego.)36
b(The)28 b(compiler)f(is)g(sp)r(eci\014ed)h(in)g(Stratego)e(itself.)p
eop
%%Page: 1 4
1 3 bop 440 531 a Fi(CONTENTS)440 686 y Fm(A)28 b(BOOTSTRAPPED)e
(COMPILER)g(F)n(OR)h(STRA)-7 b(TEGIES)769 b(3)523 815
y Fi(In)m(tro)s(duction)2214 b Fm(4)523 945 y Fi(The)32
b(Language)2150 b Fm(6)631 1074 y Fh(system)32 b(s)2278
b Fm(7)631 1204 y Fh(stra)-6 b(tego)2249 b Fm(9)631 1333
y Fh(librar)-6 b(y)2278 b Fm(11)535 1463 y Fi(The)33
b(Compiler)2102 b Fm(12)631 1592 y Fh(ar)n(chitecture)2026
b Fm(13)631 1722 y Fh(r)n(un-time)32 b(system)1911 b
Fm(15)535 1851 y Fi(Examples)2284 b Fm(16)631 1981 y
Fh(example)32 b(1:)40 b(pipelines)1734 b Fm(17)631 2110
y Fh(example)32 b(2:)40 b(desugaring)1630 b Fm(18)631
2240 y Fh(example)32 b(3:)40 b(compila)-6 b(tion)1599
b Fm(19)440 2584 y Fg(I)112 b(Basics)2294 b(20)440 2714
y Fi(ABSTRA)m(CT)33 b(SYNT)-8 b(AX)1811 b Fm(21)631 2843
y Fh(terms)2345 b Fm(21)631 2973 y Fh(stra)-6 b(tegies)2151
b Fm(22)631 3102 y Fh(signa)-6 b(tures)2144 b Fm(24)631
3232 y Fh(synt)-6 b(a)n(ctic)32 b(sugar)1911 b Fm(25)631
3361 y Ff(stratego-normal-)o(for)o(ma)o(t)1625 b Fm(27)631
3491 y Ff(stratego-optimiz)o(ed-)o(fo)o(rm)o(at)1494
b Fm(29)440 3620 y Fi(P)-8 b(ARSER)2392 b Fm(31)535 3750
y Fi(Lexical)33 b(Analyzer)1987 b Fm(31)535 3879 y Fi(P)m(arser)2418
b Fm(38)535 4009 y Fi(Mo)s(dule)31 b(Flattening)1904
b Fm(47)631 4138 y Ff(pack-stratego)2018 b Fm(47)440
4268 y Fi(LIBRAR)-8 b(Y)2340 b Fm(49)631 4397 y Fh(librar)-6
b(y)31 b(f)n(or)h(stra)-6 b(tegies)1631 b Fm(50)440 4742
y Fg(I)s(I)112 b(Compilation)1948 b(53)440 4871 y Fi(FR)m(ONTEND)2228
b Fm(54)631 5001 y Ff(frontend)2238 b Fm(55)631 5130
y Ff(normalize-spec)1974 b Fm(56)631 5260 y Ff(use-def)2282
b Fm(58)631 5389 y Fh(specifica)-6 b(tion)33 b(to)e(list)g(of)h
(definitions)1105 b Fm(61)1851 5662 y(1)p eop
%%Page: 2 5
2 4 bop 631 531 a Fh(desugaring)2120 b Fm(65)631 661
y Fh(needed)32 b(definitions)1806 b Fm(69)631 790 y Fh(inlining)2266
b Fm(72)440 920 y Fi(OPTIMIZER)2222 b Fm(74)440 1049
y Fi(MA)-8 b(TCHING)32 b(A)m(UTOMA)-8 b(T)g(A)1633 b
Fm(80)440 1179 y Fi(BA)m(CKEND)2289 b Fm(89)535 1308
y Fi(Abstract)34 b(Mac)m(hine)1935 b Fm(89)631 1438 y
Fh(instr)n(uction)31 b(simplifica)-6 b(tion)1490 b Fm(90)535
1567 y Fi(Compilation)2170 b Fm(94)631 1697 y Fh(ba)n(ckend)2242
b Fm(95)631 1826 y Fh(compiler)2216 b Fm(97)631 1956
y Fh(special)32 b(p)-6 b(a)g(tterns)1851 b Fm(106)535
2086 y Fi(P)m(ostpro)s(ccesing)2023 b Fm(110)631 2215
y Fh(postpr)n(ocess)2045 b Fm(111)440 2345 y Fi(OTHER)31
b(OPERA)-8 b(TIONS)1723 b Fm(112)535 2474 y Fi(Exp)s(erimen)m(ts)2116
b Fm(112)440 2604 y Fi(COMPILER)2215 b Fm(113)535 2733
y Fi(Glue)2446 b Fm(114)631 2863 y Ff(sc)p Fh(:)40 b(stra)-6
b(tego)32 b(compiler)1605 b Fm(114)440 3207 y Fg(I)s(I)s(I)112
b(Run-Time)36 b(System)1562 b(120)440 3336 y Fi(R)m(UN-TIME)32
b(SYSTEM)1805 b Fm(121)535 3466 y Fi(stratego.h)2228
b Fm(122)535 3595 y Fi(aterm-extension.h)1892 b Fm(123)535
3725 y Fi(debug.h)2314 b Fm(125)535 3855 y Fi(util.h)2421
b Fm(126)535 3984 y Fi(options.h)2261 b Fm(128)535 4114
y Fi(svm.h)2396 b Fm(129)535 4243 y Fi(stratego.c)2239
b Fm(140)631 4373 y Fh(bibliography)2005 b Fm(149)1851
5662 y(2)p eop
%%Page: 3 6
3 5 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)p 440 531 2865 4 v 440 758
a(Stratego)d(is)i(a)f(language)f(for)h(the)h(sp)r(eci\014cation)f(of)h
(program)e(transformation)g(based)h(on)440 858 y(rewriting)34
b(strategies.)57 b(The)36 b(Stratego)d(compiler)h(is)h(based)g(on)f
(program)f(transforma-)440 958 y(tion;)k(it)e(transforms)e(a)g
(high-lev)n(el)g(Stratego)g(sp)r(eci\014cation)h(via)f(sev)n(eral)g(in)
n(termediate)440 1057 y(represen)n(tations)28 b(to)j(C.)f(Sev)n(eral)f
(optimizations)h(are)f(p)r(erformed)h(on)g(the)h(in)n(termediate)440
1157 y(represen)n(tations.)52 b(The)34 b(compiler)e(is)i(b)r(o)r
(otstrapp)r(ed,)g(i.e.,)h(it)f(is)f(sp)r(eci\014ed)h(in)g(Stratego)440
1256 y(itself.)j(In)27 b(this)g(pap)r(er)f(w)n(e)g(giv)n(e)f(an)i(o)n
(v)n(erview)d(of)j(the)g(Stratego)e(compiler:)35 b(arc)n(hitecture;)440
1356 y(issues)24 b(in)h(the)g(compilation)f(of)g(strategies;)g(some)g
(high-ligh)n(ts)g(of)g(the)h(sp)r(eci\014cation;)h(and)440
1456 y(exp)r(erience)h(with)h(using)f(strategies)g(for)g(writing)g
(program)e(transformations.)p 440 1575 V 1851 5662 a(3)p
eop
%%Page: 4 7
4 6 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 299 y(Section:)37 b(In)n(tro)r
(duction)440 531 y(One)31 b(of)h(the)g(shortcomings)e(of)i(implemen)n
(ting)g(algebraic)e(sp)r(eci\014cations)h(b)n(y)g(means)g(of)440
631 y(term)i(rewriting)e(is)i(the)g(necessit)n(y)f(to)h(enco)r(de)f
(the)h(strategy)f(to)g(apply)h(`equations')f(b)n(y)440
731 y(means)g(of)g(functions.)52 b(This)33 b(obscures)e(the)i
(equational)e(nature)h(of)h(sp)r(eci\014cations)f(and)440
830 y(hamp)r(ers)25 b(their)h(mo)r(dularit)n(y)f(b)r(ecause)g(rules)g
(b)r(ecome)g(part)g(of)h(one)f(particular)g(strategy)-7
b(.)440 930 y(This)34 b(observ)-5 b(ation)32 b(w)n(as)h(done)g(in)h
(sev)n(eral)e(pro)5 b(jects)33 b(that)h(used)g(ASF+SDF)g([4])g(to)g
(de-)440 1029 y(\014ne)d(language)d(pro)r(cessors,)h(in)i(particular)e
(program)f(transformations.)44 b(F)-7 b(or)30 b(example:)440
1129 y(normalization)22 b(of)h(b)r(o)n(x)g(expressions)e(for)i(prett)n
(y-prin)n(ting)f([3];)i(normalization)e(of)h(syn)n(tax)440
1229 y(de\014nitions)28 b([8)o(];)g(transformation)e(of)i(C++)e
(programs)g([5)o(].)440 1398 y(Stratego)38 b(is)g(a)h(language)e(for)h
(the)h(sp)r(eci\014cation)g(of)f(program)f(transformations)g(that)440
1498 y(o)n(v)n(ercomes)26 b(this)i(shortcoming)f(b)n(y)g(pro)n(viding)g
(user-de\014nable)g(rewriting)g(strategies.)37 b(A)440
1597 y(rewriting)i(strategy)g(is)i(an)f(expression)f(in)i(a)e(language)
g(of)i(strategy)e(op)r(erators)f(that)440 1697 y(com)n(bine)27
b(rules)g(\(usually)g(via)g(their)h(lab)r(els\))f(in)h(a)f(program)e
(that)j(tra)n(v)n(erses)d(a)i(term)h(and)440 1797 y(applies)f(the)h
(rules.)440 1966 y(The)35 b(preliminary)f(ideas)h(for)f(the)i(strategy)
d(op)r(erators)g(in)j(Stratego,)f(inspired)g(b)n(y)g(the)440
2066 y(sp)r(eci\014cation)18 b(formalism)g(ELAN)g([2],)i(include)f(op)r
(erators)d(for)i(sequen)n(tial)g(non-deterministic)440
2165 y(programming,)i(data-t)n(yp)r(e)g(sp)r(eci\014c)h(and)g(generic)e
(term)i(tra)n(v)n(ersal.)32 b(In)21 b([6])g(an)f(implemen-)440
2265 y(tation)33 b(of)g(these)g(op)r(erators)f(in)h(ASF+SDF)h(is)f
(describ)r(ed.)54 b(That)33 b(in)n(terpretiv)n(e)f(imple-)440
2364 y(men)n(tation)22 b(st)n(yle)f(can)h(b)r(e)h(used)f(to)g(write)f
(strategies)g(for)h(ASF+SDF)h(equations)e(and)h(can)440
2464 y(b)r(e)32 b(applied)g(in)g(other)f(settings)g(as)g(w)n(ell;)j
(the)e(traditional)f(w)n(a)n(y)f(of)i(de\014ning)f(a)h(strategy)440
2564 y(with)c(functions)h(is)f(replaced)f(b)n(y)g(a)h(st)n(yle)f(in)i
(whic)n(h)f(an)f(ev)-5 b(aluation)28 b(function)g(in)n(terprets)440
2663 y(a)e(strategy)e(expression.)35 b(This)26 b(allo)n(ws)f(the)h
(concise)f(sp)r(eci\014cation)h(of)g(v)-5 b(arious)25
b(strategies)440 2763 y(and)i(the)h(use)g(of)f(one)h(rule)f(with)h(man)
n(y)f(di\013eren)n(t)h(strategies.)440 2932 y(These)g(preliminary)g
(ideas)f(are)h(further)g(dev)n(elop)r(ed)g(in)h([10)o(,)g(11)o(].)39
b(Rewrite)28 b(rules)g(are)g(no)440 3032 y(longer)i(primitiv)n(es,)i
(but)h(are)d(brok)n(en)g(do)n(wn)h(in)n(to)h(op)r(erations)e(for)h
(matc)n(hing,)h(building)440 3132 y(and)e(v)-5 b(ariable)28
b(scop)r(e.)43 b(System)30 b(S,)g(the)g(resulting)f(set)h(of)f
(strategy)g(op)r(erators,)f(pro)n(vides)440 3231 y(the)g(primitiv)n(e)g
(op)r(erations)e(for)h(de\014nining)h(b)r(oth)g(rewrite)f(rules)g(and)h
(strategies)e(for)h(ap-)440 3331 y(plying)36 b(them.)62
b(A)36 b(Stratego)f(sp)r(eci\014cation)h(pro)n(vides)e(syn)n(tactic)h
(abstractions)g(on)g(top)440 3430 y(of)i(System)f(S.)h(F)-7
b(or)36 b(example,)j(a)d(rewrite)g(rule)h(is)f(an)g(abstraction)g(for)g
(a)g(sequence)g(of)440 3530 y(op)r(erations)g(that)h(\014rst)f(matc)n
(hes)h(the)g(sub)5 b(ject)37 b(term)g(against)e(a)i(pattern,)i(then)e
(satis-)440 3630 y(\014es)i(a)g(condition)h(and)f(\014nally)g(builds)h
(the)g(instan)n(tiation)f(of)g(a)g(term)h(pattern.)72
b(The)440 3729 y(iden)n(ti\014cation)31 b(of)g(this)h(in)n(termediate)f
(lev)n(el)g(allo)n(ws)e(the)j(de\014nition)g(of)f(v)n(ery)f(expressiv)n
(e)440 3829 y(abstractions)c(suc)n(h)h(as)g(con)n(textual)g(rules)g
(and)h(o)n(v)n(erla)n(ys)c([9].)440 3998 y(The)36 b(Stratego)e
(compiler)i(\014rst)f(translates)g(a)g(high-lev)n(el)g(Stratego)g(sp)r
(eci\014cation)g(to)h(a)440 4098 y(System)h(S)h(expresssion,)g(whic)n
(h)f(is)g(then)h(translated)e(to)h(a)g(list)g(of)h(abstract)e(mac)n
(hine)440 4198 y(instructions)25 b(that)g(are)f(implemen)n(ted)i(in)f
(C.)h(The)f(\014rst)g(compiler)f(w)n(as)g(written)i(in)f(SML.)440
4297 y(Based)39 b(on)g(the)h(\014rst)g(exp)r(erience)f(with)h(that)g
(compiler)f(an)g(impro)n(v)n(ed)f(compiler)h(w)n(as)440
4397 y(sp)r(eci\014ed)21 b(in)h(Stratego)e(itself)h(and)g(b)r(o)r
(otstrapp)r(ed.)35 b(Bo)r(otstrapping)19 b(pro)n(v)n(es)h(to)h(b)r(e)g
(a)g(go)r(o)r(d)440 4496 y(approac)n(h)33 b(for)h(dev)n(eloping)g(the)h
(compiler)f(and)h(the)g(language)e(b)r(ecause)h(it)h(pro)n(vides)f(a)
440 4596 y(realistic)23 b(case)g(study)i(and)e(a)h(go)r(o)r(d)f(test)i
(case)e(for)g(the)i(compiler.)35 b(The)24 b(compiler)f(is)h(b)r(eing)
440 4696 y(used)38 b(in)g(sev)n(eral)d(program)h(transformation)g(case)
h(studies,)j(suc)n(h)d(as)g(a)h(sp)r(eci\014ciation)440
4795 y(of)33 b(an)f(optimizer)g(for)g(a)g(functional)h(language)e([11)o
(],)j(a)e(deforestation)f(algorithm)h(for)g(a)440 4895
y(functional)f(language)f([)p Fi(?)p Fm(])i(and)f(a)f(transformation)g
(to)r(ol)h(to)g(sp)r(eed)h(up)f(C++)g(programs)440 4995
y(for)c(high-p)r(erformance)f(computing.)440 5164 y(In)39
b(this)g(abstract)f(w)n(e)g(giv)n(e)g(an)g(o)n(v)n(erview)f(of)h
(System)h(S)g(and)g(Stratego,)h(presen)n(t)e(the)440
5264 y(arc)n(hitecture)33 b(of)h(the)h(compiler)e(and)h(sho)n(w)g(some)
f(examples)h(of)g(the)h(use)f(of)g(strategies)440 5363
y(in)f(the)f(compiler.)51 b(In)32 b(the)h(full)g(pap)r(er)e(w)n(e)h
(will)h(further)f(elab)r(orate)f(the)i(application)e(of)1851
5662 y(4)p eop
%%Page: 5 8
5 7 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 299 y(Section:)37 b(In)n(tro)r
(duction)440 531 y(strategies)28 b(in)i(the)h(compiler)e(and)g(giv)n(e)
g(a)h(\014rst)f(ev)-5 b(aluation)29 b(of)h(the)g(use)g(of)g(strategies)
e(in)440 631 y(program)e(transformation.)1851 5662 y(5)p
eop
%%Page: 6 9
6 8 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y(This)h(section)f(in)n(tro)r(duces)g(System)h(S,)g
(a)g(calculus)f(for)g(the)i(de\014nition)f(of)g(tree)f(transfor-)440
631 y(mations,)23 b(and)g(Stratego,)f(a)g(sp)r(eci\014cation)h
(language)e(pro)n(viding)g(syn)n(tactic)h(abstractions)440
731 y(for)27 b(System)h(S)g(expressions.)35 b(F)-7 b(or)27
b(an)g(op)r(erational)f(seman)n(tics)h(see)g([10)o(,)h(11)o(].)1851
5662 y(6)p eop
%%Page: 7 10
7 9 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)p 440 452 2865 4 v 440 1386 4 934 v 468 522
a Fe(module)41 b(traversals)468 614 y(imports)g(lists)468
705 y(strategies)547 796 y(try\(s\))158 b(=)39 b(s)h(<+)g(id)549
b(map\(s\))158 b(=)40 b(rec)g(x\(Nil)g(+)g(Cons\(s,)g(x\)\))547
888 y(repeat\(s\))h(=)e(rec)h(x\(try\(s;)h(x\)\))197
b(list\(s\))119 b(=)40 b(rec)g(x\(Nil)g(+)g(Cons\(s,)g(x\)\))547
979 y(topdown)119 b(=)39 b(rec)h(x\(s;)g(all\(x\)\))198
b(alltd\(s\))80 b(=)40 b(rec)g(x\(s)g(<+)f(all\(x\)\))547
1070 y(bottomup)80 b(=)39 b(rec)h(x\(all\(x\);)i(s\))196
b(oncetd\(s\))41 b(=)f(rec)g(x\(s)g(<+)f(one\(x\)\))547
1161 y(downup\(s\))i(=)e(rec)h(x\(s;)g(all\(x\);)h(s\))79
b(sometd\(s\))41 b(=)f(rec)g(x\(s)g(<+)f(some\(x\)\))547
1253 y(onebu\(s\))80 b(=)39 b(rec)h(x\(one\(x\))h(<+)f(s\))118
b(somebu\(s\))41 b(=)f(rec)g(x\(some\(x\))h(<+)f(s\))547
1344 y(downup2\(s1,)h(s2\))f(=)g(rec)g(x\(s1;)g(all\(x\);)h(s2\))p
3301 1386 V 440 1389 2865 4 v 671 1538 a Fm(Figure)27
b(1:)36 b(Sp)r(eci\014cation)28 b(of)f(sev)n(eral)f(generic)h(term)g
(tra)n(v)n(ersal)e(strategies.)440 1637 y Fi(SYSTEM)32
b(S)440 1828 y Fm(System)e(S)f(is)h(a)f(hierarc)n(h)n(y)e(of)j(op)r
(erators)d(for)i(expressing)f(term)i(transformations.)40
b(The)440 1928 y(\014rst)26 b(lev)n(el)g(pro)n(vides)f(con)n(trol)g
(constructs)h(for)g(sequen)n(tial)g(non-deterministic)g(program-)440
2027 y(ming,)j(the)g(second)f(lev)n(el)g(in)n(tro)r(duces)h(com)n
(binators)e(for)h(term)g(tra)n(v)n(ersal)e(and)j(the)g(third)440
2127 y(lev)n(el)18 b(de\014nes)h(op)r(erators)e(for)h(binding)h(v)-5
b(ariables)17 b(and)i(for)f(matc)n(hing)g(and)h(building)g(terms.)440
2296 y(First-order)26 b(terms)h(are)g(expressions)f(o)n(v)n(er)f(the)j
(grammar)789 2520 y Ff(t)43 b(:=)g(x)g(|)g(C\(t1,...,tn\))c(|)k
([t1,...,tn])c(|)k(\(t1,...,tn\))440 2743 y Fm(where)30
b Ff(x)g Fm(ranges)e(o)n(v)n(er)h(v)-5 b(ariables)29
b(and)h Ff(C)g Fm(o)n(v)n(er)e(constructors.)43 b(The)31
b(arit)n(y)e(and)h(t)n(yp)r(es)g(of)440 2843 y(constructors)23
b(are)h(declared)g(in)h(signatures.)35 b(The)25 b(notation)f
Ff([t1,...,tn])d Fm(abbreviates)440 2942 y(the)h(list)f
Ff(Cons\(t1,...,Cons)o(\(t)o(n,N)o(il)o(\)\))p Fm(.)28
b(T)-7 b(ransformations)19 b(in)j(System)f(S)g(are)f(applied)440
3042 y(to)27 b(ground)g(terms,)g(i.e.,)h(terms)g(withouth)g(v)-5
b(ariables.)440 3211 y Fh(level)31 b(1:)41 b(sequential)31
b(non-deterministic)h(pr)n(ogramming)440 3381 y Fm(Strategies)h(are)f
(programs)g(that)i(attempt)g(to)f(transform)g(ground)g(terms)g(in)n(to)
g(ground)440 3480 y(terms,)24 b(at)e(whic)n(h)h(they)g(ma)n(y)f
(succeed)h(or)f(fail.)35 b(In)23 b(case)g(of)f(success)g(the)i(result)e
(of)h(suc)n(h)g(an)440 3580 y(attempt)31 b(is)f(a)g(transformed)e
(term.)45 b(In)30 b(case)f(of)i(failure)e(the)i(result)f(is)g(an)f
(indication)h(of)440 3680 y(the)c(failure.)36 b(Strategies)25
b(can)h(b)r(e)g(com)n(bined)f(in)n(to)h(new)g(strategies)e(b)n(y)i
(means)g(of)f(the)i(fol-)440 3779 y(lo)n(wing)j(op)r(erators:)41
b(The)31 b Fd(identity)39 b Fm(strategy)29 b Ff(id)h
Fm(lea)n(v)n(es)f(the)j(sub)5 b(ject)30 b(term)h(unc)n(hanged)440
3879 y(and)36 b(alw)n(a)n(ys)f(succeeds.)62 b(The)36
b Fd(failur)l(e)44 b Fm(strategy)35 b Ff(fail)g Fm(alw)n(a)n(ys)f
(fails.)63 b(The)36 b Fd(se)l(quential)440 3978 y(c)l(omp)l(osition)g
Ff(s1;)42 b(s2)27 b Fm(\014rst)h(attempts)g(to)g(apply)f
Ff(s1)g Fm(to)h(the)g(sub)5 b(ject)28 b(term)g(and,)g(if)g(that)440
4078 y(succeeds,)35 b(applies)f Ff(s2)g Fm(to)g(the)h(result.)56
b(The)35 b Fd(non-deterministic)h(choic)l(e)42 b Ff(s1)h(+)g(s2)34
b Fm(at-)440 4178 y(tempts)24 b(to)e(apply)h(either)g
Ff(s1)f Fm(or)g Ff(s2)p Fm(.)35 b(It)23 b(succeeds)f(if)i(either)e
(succeeds)h(and)f(it)i(fails)e(if)i(b)r(oth)440 4277
y(fail;)37 b(the)d(order)e(in)i(whic)n(h)f Ff(s1)g Fm(and)g
Ff(s2)g Fm(are)f(tried)i(is)f(unsp)r(eci\014ed.)56 b(The)33
b Fd(deterministic)440 4377 y(choic)l(e)e Ff(s1)43 b(<+)g(s2)22
b Fm(attempts)i(to)f(apply)g(either)g Ff(s1)g Fm(or)f
Ff(s2)p Fm(,)i(in)f(that)h(order.)34 b(The)23 b Fd(r)l(e)l(cursive)440
4477 y(closur)l(e)29 b Ff(rec)42 b(x\(s\))20 b Fm(attempts)j(to)e
(apply)h Ff(s)p Fm(,)h(where)e(at)h(eac)n(h)f(o)r(ccurence)h(of)f(the)i
(v)-5 b(ariable)21 b Ff(x)440 4576 y Fm(in)j Ff(s)p Fm(,)g(the)g
(strategy)e Ff(rec)43 b(x\(s\))22 b Fm(is)h(applied.)36
b(The)23 b Fd(test)31 b Fm(strategy)22 b Ff(test\(s\))f
Fm(tries)i(to)h(apply)440 4676 y Ff(s)p Fm(.)35 b(It)23
b(succeeds)f(if)h Ff(s)f Fm(succeeds,)h(and)f(rev)n(erts)f(the)i(sub)5
b(ject)23 b(term)g(to)f(the)h(original)e(term.)35 b(It)440
4775 y(fails)24 b(if)h Ff(s)f Fm(fails.)35 b(The)25 b
Fd(ne)l(gation)31 b Ff(not\(s\))22 b Fm(succeeds)i(\(with)h(the)f(iden)
n(tit)n(y)h(transformation\))440 4875 y(if)30 b Ff(s)f
Fm(fails)g(and)g(fails)g(if)h Ff(s)f Fm(succeeds.)41
b(Tw)n(o)28 b(examples)h(of)g(strategies)f(de\014ned)i(with)f(these)440
4975 y(op)r(erators)d(are)g Ff(try)h Fm(and)g Ff(repeat)e
Fm(in)j(Figure)f(1.)440 5144 y Fh(level)k(2:)41 b(term)31
b(tra)-7 b(versal)440 5313 y Fm(The)25 b(Lev)n(el)g(1)g(constructs)g
(apply)g(transformations)e(to)i(the)h(ro)r(ot)f(of)g(a)g(term.)36
b(In)25 b(order)f(to)440 5413 y(apply)i(transformations)f(throughout)h
(a)g(term)h(it)g(is)f(necessary)f(to)i(tra)n(v)n(erse)d(it.)37
b(F)-7 b(or)26 b(this)1851 5662 y(7)p eop
%%Page: 8 11
8 10 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y(purp)r(ose,)d(System)h(S)g(pro)n(vides)e(the)i
(follo)n(wing)f(op)r(erators:)33 b(F)-7 b(or)25 b(eac)n(h)g
Ff(n)p Fm(-ary)f(constructor)440 631 y Ff(C)29 b Fm(the)g
Fd(c)l(ongruenc)l(e)36 b Fm(op)r(erator)27 b Ff(C\(s1,...,sn\))d
Fm(is)29 b(de\014ned.)42 b(It)29 b(applies)g(to)g(terms)g(of)g(the)440
731 y(form)f Ff(C\(t1,...,tn\))23 b Fm(and)29 b(applies)e
Ff(si)h Fm(to)g Ff(ti)g Fm(for)g Ff(1)43 b(<=)f(i)i(<=)e(n)p
Fm(.)d(An)29 b(example)f(of)g(the)440 830 y(use)34 b(of)h(congruences)e
(is)h(the)h(op)r(erator)e Ff(map\(s\))f Fm(in)j(Figure)f(1)g(that)g
(applies)h Ff(s)f Fm(to)g(eac)n(h)440 930 y(elemen)n(t)28
b(of)f(a)g(list.)440 1099 y(Congruences)20 b(can)h(b)r(e)h(used)g(to)f
(de\014ne)h(tra)n(v)n(ersals)d(o)n(v)n(er)g(sp)r(eci\014c)j(data)f
(structures.)34 b(Sp)r(ec-)440 1199 y(i\014cation)26
b(of)h(generic)f(tra)n(v)n(ersals)e(\(e.g.,)j(pre-)f(or)g(p)r
(ost-order)f(o)n(v)n(er)g(arbitrary)g(structures\))440
1298 y(requires)i(more)h(generic)g(op)r(erators.)38 b(The)29
b(op)r(erator)e Ff(all\(s\))f Fm(applies)i Ff(s)h Fm(to)f(all)h(c)n
(hildren)440 1398 y(of)22 b(a)f(constructor)f(application)h
Ff(C\(t1,...,tn\))p Fm(.)30 b(In)21 b(particular,)h Ff(all\(s\))d
Fm(is)i(the)h(iden)n(tit)n(y)440 1498 y(on)28 b(constan)n(ts)f
(\(constructor)g(applications)g(without)i(c)n(hildren\).)38
b(The)28 b(strategy)f Ff(one\(s\))440 1597 y Fm(applies)e
Ff(s)h Fm(to)f(one)g(c)n(hild)h(of)g(a)f(constructor)f(application)h
Ff(C\(t1,...,tn\))p Fm(;)d(it)k(is)f(precisely)440 1697
y(the)34 b(failure)f(strategy)e(on)i(constan)n(ts.)53
b(The)34 b(strategy)d Ff(some\(s\))g Fm(applies)i Ff(s)g
Fm(to)g(some)f(of)440 1797 y(the)25 b(c)n(hildren)e(of)h(a)g
(constructor)f(application)g Ff(C\(t1,...,tn\))p Fm(,)d(i.e.,)25
b(to)f(at)g(least)g(one)g(and)440 1896 y(as)j(man)n(y)g(as)g(p)r
(ossible.)36 b(Lik)n(e)27 b Ff(one\(s\))p Fm(,)f Ff(some\(s\))e
Fm(fails)k(on)f(constan)n(ts.)440 2066 y(Figure)42 b(1)g(de\014nes)g(v)
-5 b(arious)41 b(tra)n(v)n(ersals)e(based)j(on)g(these)h(op)r(erators.)
79 b(F)-7 b(or)42 b(instance,)440 2165 y Ff(oncetd\(s\))32
b Fm(tries)j(to)g(\014nd)h Fd(one)42 b Fm(application)35
b(of)h Ff(s)f Fm(somewhere)f(in)i(the)g(term)f(starting)440
2265 y(at)g(the)g(ro)r(ot)f(w)n(orking)f(its)i(w)n(a)n(y)f(do)n(wn;)k
Ff(s)43 b(<+)g(one\(x\))32 b Fm(\014rst)j(attempts)g(to)g(apply)f
Ff(s)p Fm(,)j(if)440 2364 y(that)25 b(fails)g(an)g(application)f(of)h
Ff(s)g Fm(is)g(\(recursiv)n(ely\))e(attempted)j(at)f(one)f(of)h(the)h
(c)n(hildren)e(of)440 2464 y(the)i(sub)5 b(ject)26 b(term.)36
b(If)26 b(no)g(application)f(is)h(found)g(the)g(tra)n(v)n(ersal)d
(fails.)36 b(Compare)24 b(this)i(to)440 2564 y(the)32
b(tra)n(v)n(ersal)d Ff(alltd\(s\))p Fm(,)g(whic)n(h)j(\014nds)f
Fd(al)t(l)42 b Fm(outermost)31 b(applications)f(of)i
Ff(s)f Fm(and)g(nev)n(er)440 2663 y(fails.)440 2833 y
Fh(level)g(3:)41 b(ma)-6 b(tch,)31 b(build)g(and)g(v)-7
b(ariable)31 b(binding)440 3002 y Fm(The)h(op)r(erators)d(in)n(tro)r
(duced)j(th)n(us)f(far)g(are)g(useful)h(for)f(rep)r(eatedly)g(applying)
g(transfor-)440 3102 y(mation)h(rules)h(throughout)f(a)g(term.)52
b(Actual)33 b(transformation)e(rules)h(are)g(constructed)440
3201 y(b)n(y)27 b(means)g(of)h(pattern)f(matc)n(hing)h(and)f(building)h
(of)f(pattern)h(instan)n(tiations.)440 3371 y(A)c(matc)n(h)g
Ff(?t)f Fm(succeeds)h(if)g(the)h(pattern)f(term)g Ff(t)f
Fm(matc)n(hes)h(the)g(sub)5 b(ject)24 b(term.)36 b(As)24
b(a)g(side-)440 3470 y(e\013ect,)f(an)n(y)e(v)-5 b(ariables)21
b(in)h Ff(t)f Fm(are)g(b)r(ound)h(to)g(the)g(corresp)r(onding)e
(subterms)h(of)h(the)g(sub)5 b(ject)440 3570 y(term.)38
b(If)29 b(a)f(v)-5 b(ariable)27 b(w)n(as)g(already)f(b)r(ound)j(b)r
(efore)f(the)g(matc)n(h,)g(then)h(the)f(binding)h(only)440
3670 y(succeeds)h(if)g(the)h(terms)f(are)f(the)h(same.)44
b(This)30 b(enables)g(non-linear)f(pattern)h(matc)n(hing,)440
3769 y(so)22 b(that)h(a)g(matc)n(h)f(suc)n(h)h(as)f Ff(?F\(x,)41
b(x\))22 b Fm(succeeds)g(only)h(if)g(the)g(t)n(w)n(o)f(argumen)n(ts)g
(of)g Ff(F)h Fm(in)g(the)440 3869 y(sub)5 b(ject)30 b(term)h(are)e
(equal.)44 b(This)31 b(non-linear)e(b)r(eha)n(viour)g(can)g(also)h
(arise)f(accross)f(other)440 3968 y(op)r(erations.)64
b(F)-7 b(or)36 b(example,)j(the)e(t)n(w)n(o)f(consecutiv)n(e)g(matc)n
(hes)h Ff(?F\(x,)k(y\);)i(?F\(y,)e(x\))440 4068 y Fm(succeed)c(exactly)
h(when)g(the)g(t)n(w)n(o)f(argumen)n(ts)f(of)i Ff(F)f
Fm(are)g(equal.)67 b(Once)37 b(a)h(v)-5 b(ariable)36
b(is)440 4168 y(b)r(ound)28 b(it)g(cannot)f(b)r(e)h(un)n(b)r(ound.)440
4337 y(A)36 b(build)h Ff(!t)e Fm(replaces)f(the)i(sub)5
b(ject)36 b(term)g(with)h(the)f(instan)n(tiation)f(of)h(the)g(pattern)g
Ff(t)440 4437 y Fm(using)26 b(the)h(curren)n(t)e(bindings)i(of)f(terms)
g(to)g(v)-5 b(ariables)26 b(in)g Ff(t)p Fm(.)36 b(A)27
b(scop)r(e)f Ff({x1,...,xn:)39 b(s})440 4536 y Fm(mak)n(es)34
b(the)i(v)-5 b(ariables)34 b Ff(xi)h Fm(lo)r(cal)g(to)g(the)h(strategy)
e Ff(s)p Fm(.)60 b(This)35 b(means)g(that)h(bindings)f(to)440
4636 y(these)d(v)-5 b(ariables)30 b(outside)h(the)h(scop)r(e)f(are)g
(undone)g(when)h(en)n(tering)f(the)h(scop)r(e)f(and)g(are)440
4736 y(restored)26 b(after)i(lea)n(ving)f(it.)38 b(The)28
b(op)r(eration)f Ff(where\(s\))d Fm(applies)k(the)g(strategy)f
Ff(s)g Fm(to)h(the)440 4835 y(sub)5 b(ject)33 b(term.)51
b(If)33 b(successful,)g(it)g(restores)d(the)j(original)e(sub)5
b(ject)33 b(term,)g(k)n(eeping)f(only)440 4935 y(the)c(newly)g
(obtained)f(bindings)g(to)h(v)-5 b(ariables.)1851 5662
y(8)p eop
%%Page: 9 12
9 11 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y Fi(STRA)-8 b(TEGO)440 726 y Fm(The)20
b(sp)r(eci\014cation)g(language)f(Stratego)g(pro)n(vides)g(syn)n
(tactic)g(abstractions)g(for)h(System)g(S)440 825 y(expressions.)43
b(A)30 b(sp)r(eci\014cation)g(consists)f(of)h(a)g(collection)f(of)h(mo)
r(dules)h(that)f(de\014ne)g(sig-)440 925 y(natures,)d(transformation)f
(rules)h(and)g(strategy)g(de\014nitions.)440 1094 y(A)j(signature)f
(declares)f(the)i(sorts)f(and)g(op)r(erations)g(\(constructors\))f
(that)i(mak)n(e)f(up)h(the)440 1194 y(structure)e(of)g(the)g
(language\(s\))f(b)r(eing)h(transformed.)38 b(Example)27
b(signatures)g(are)g(sho)n(wn)440 1293 y(in)c(the)h(mo)r(dules)f(in)h
(Figure)e(2.)35 b(A)24 b(strategy)e(de\014nition)h Ff(f\(x1,...,xn\))39
b(=)k(s)23 b Fm(in)n(tro)r(duces)440 1393 y(a)e(new)h(strategy)f(op)r
(erator)f Ff(f)i Fm(parameterized)e(with)i(strategies)f
Ff(x1)g Fm(through)g Ff(xn)g Fm(and)h(with)440 1493 y(b)r(o)r(dy)34
b Ff(s)p Fm(.)54 b(Suc)n(h)33 b(de\014nitions)h(cannot)f(b)r(e)h
(recursiv)n(e,)f(i.e.,)i(they)f(cannot)f(refer)f(\(directly)440
1592 y(or)h(indirectly\))h(to)g(the)g(op)r(erator)e(b)r(eing)i
(de\014ned.)56 b(All)35 b(recursion)d(m)n(ust)i(b)r(e)h(expressed)440
1692 y(explicitly)24 b(b)n(y)g(means)f(of)h(the)h(recursion)d(op)r
(erator)g Ff(rec)p Fm(.)35 b(Lab)r(eled)24 b(transformation)e(rules)440
1792 y(are)h(abbreviations)f(of)i(a)f(particular)f(form)i(of)f
(strategy)g(de\014nitions.)36 b(A)24 b(conditional)f(rule)440
1891 y Ff(L)43 b(:)g(l)h(->)e(r)h(where)f(s)25 b Fm(with)g(lab)r(el)g
Ff(L)p Fm(,)g(left-hand)g(side)f Ff(l)p Fm(,)i(righ)n(t-hand)d(side)i
Ff(r)p Fm(,)g(and)g(con-)440 1991 y(dition)33 b Ff(s)g
Fm(denotes)f(a)h(strategy)f(de\014nition)h Ff(L)43 b(=)g({x1,...,xn:)c
(?l;)k(where\(s\);)c(!r})p Fm(.)440 2090 y(Here,)31 b(the)f(b)r(o)r(dy)
h(of)f(the)h(rule)f(\014rst)g(matc)n(hes)g(the)g(left-hand)h(side,)g
(and)f(then)h(attempts)440 2190 y(to)25 b(satisfy)g(the)h(condition)g
Ff(s)p Fm(.)35 b(If)26 b(that)g(succeeds,)f(then)h(it)g(builds)g(the)g
(righ)n(t-hand)e(side)i Ff(r)p Fm(.)440 2290 y(The)h(rule)g(is)g
(enclosed)f(in)i(a)e(scop)r(e)h(that)h(mak)n(es)e(all)g(term)h(v)-5
b(ariables)26 b Ff(xi)h Fm(o)r(ccurring)e(in)j Ff(l)p
Fm(,)440 2389 y Ff(s)e Fm(and)g Ff(r)g Fm(lo)r(cal)f(to)h(the)h(rule.)
36 b(If)27 b(more)e(than)h(one)g(de\014nition)h(is)f(pro)n(vided)f
(with)h(the)h(same)440 2489 y(name,)d(e.g.,)f Ff(f\(xs\))42
b(=)h(s1)22 b Fm(and)g Ff(f\(xs\))42 b(=)h(s2)p Fm(,)23
b(this)g(is)g(equiv)-5 b(alen)n(t)23 b(to)f(a)h(single)f(de\014nition)
440 2589 y(with)28 b(the)g(sum)g(of)f(the)h(original)e(b)r(o)r(dies)i
(as)f(b)r(o)r(dy)-7 b(,)28 b(i.e.,)g Ff(f\(xs\))41 b(=)j(s1)e(+)i(s2)p
Fm(.)440 2758 y(The)32 b(follo)n(wing)f(de\014nitions)i(pro)n(vide)e(a)
g(useful)i(shorthand.)50 b(The)32 b(notation)f Ff(<s>)43
b(t)32 b Fm(de-)440 2858 y(notes)37 b Ff(!t;)43 b(s)p
Fm(,)d(i.e.,)g(the)e(strategy)f(that)h(builds)g(the)g(term)g
Ff(t)f Fm(and)h(then)g(applies)f Ff(s)g Fm(to)440 2957
y(it.)42 b(The)29 b(notation)f Ff(s)43 b(=>)g(t)29 b
Fm(denotes)f Ff(s;)43 b(?t)p Fm(,)29 b(i.e.,)g(the)h(strategy)d(that)j
(applies)e Ff(s)h Fm(to)g(the)440 3057 y(curren)n(t)20
b(sub)5 b(ject)21 b(term)f(and)h(then)g(matc)n(hes)f(the)h(result)f
(against)g Ff(t)p Fm(.)34 b(The)21 b(com)n(bined)f(nota-)440
3156 y(tion)k Ff(<s>)43 b(t)g(=>)g(t')23 b Fm(th)n(us)h(denotes)g
Ff(\(!t;)42 b(s\);)g(?t')p Fm(.)35 b(The)24 b Ff(<s>)43
b(t)23 b Fm(notation)h(can)g(also)f(b)r(e)440 3256 y(used)e(in)f(a)h
(build)g(expression.)33 b(F)-7 b(or)20 b(example,)h(the)g(strategy)f
(expression)f Ff(!F\(<s>)41 b(t,)i(t'\))440 3356 y Fm(corresp)r(onds)26
b(to)h Ff({x:)43 b(<s>)f(t)h(=>)g(x;)g(!F\(x,t'\)})p
Fm(,)24 b(where)j Ff(x)g Fm(is)g(a)h(new)f(v)-5 b(ariable.)1851
5662 y(9)p eop
%%Page: 10 13
10 12 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)p 440 787 2865 4 v 440 4909 4 4123 v 468 858
a Fe(module)41 b(terms)468 949 y(imports)g(list-cons)468
1040 y(signature)547 1132 y(sorts)f(Term)547 1223 y(operations)625
1314 y(Wld)g(:)942 b(Term)40 b(\(*)g(_)f(*\))625 1406
y(Var)h(:)g(String)550 b(->)40 b(Term)g(\(*)g(x)f(*\))625
1497 y(Int)h(:)g(Int)667 b(->)40 b(Term)g(\(*)g(0,)f(1,)h(2)f(...)h
(*\))625 1588 y(Str)g(:)g(String)550 b(->)40 b(Term)g(\(*)g("",)f("a",)
i(...)f(*\))625 1680 y(Op)79 b(:)40 b(String)g(*)g(List\(Term\))h(->)f
(Term)g(\(*)g(f\(t1,...,tn\))i(*\))468 1854 y(module)f(strategy)468
1945 y(imports)g(terms)468 2037 y(signature)547 2128
y(sorts)f(SVar)g(Strat)h(SDef)547 2219 y(operations)625
2311 y(Id)236 b(:)1334 b(Strat)40 b(\(*)g(id)g(*\))625
2402 y(Fail)158 b(:)1334 b(Strat)40 b(\(*)g(fail)g(*\))625
2585 y(Test)158 b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(test)g(s)g
(*\))625 2676 y(Not)197 b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(not)
g(s)f(*\))625 2858 y(Seq)197 b(:)39 b(Strat)i(*)e(Strat)668
b(->)40 b(Strat)g(\(*)g(s1)g(;)78 b(s2)40 b(*\))625 2950
y(Choice)80 b(:)39 b(Strat)i(*)e(Strat)668 b(->)40 b(Strat)g(\(*)g(s1)g
(+)78 b(s2)40 b(*\))625 3041 y(LChoice)h(:)e(Strat)i(*)e(Strat)668
b(->)40 b(Strat)g(\(*)g(s1)g(<+)f(s2)h(*\))625 3224 y(SVar)158
b(:)39 b(String)943 b(->)40 b(SVar)625 3315 y(Rec)197
b(:)39 b(String)i(*)e(Strat)629 b(->)40 b(Strat)g(\(*)g(rec)g(x)f
(\(s\))h(*\))625 3406 y(Let)197 b(:)39 b(SDef)i(*)e(Strat)707
b(->)40 b(Strat)g(\(*)g(let)g(sdef)g(in)g(s2*\))625 3498
y(SDef)158 b(:)39 b(String)i(*)e(List\(String\))j(*)e(Strat)g(->)g
(SDef)79 b(\(*)40 b(f\(xs\))g(=)g(s)f(*\))625 3589 y(Call)158
b(:)39 b(SVar)i(*)e(List\(Strat\))473 b(->)40 b(Strat)g(\(*)g(f\(ss\))g
(*\))625 3772 y(Path)158 b(:)39 b(Int)h(*)g(Strat)746
b(->)40 b(Strat)g(\(*)g(i\(s\))g(*\))625 3863 y(Cong)158
b(:)39 b(String)i(*)e(List\(Strat\))395 b(->)40 b(Strat)g(\(*)g
(f\(s1,...,sn\))i(*\))625 3954 y(One)197 b(:)39 b(Strat)982
b(->)40 b(Strat)g(\(*)g(one\(s\))h(*\))625 4046 y(Some)158
b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(some\(s\))h(*\))625
4137 y(All)197 b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(all\(s\))h
(*\))625 4320 y(Match)158 b(:)40 b(Term)981 b(->)40 b(Strat)g(\(*)g(?t)
g(*\))625 4411 y(Build)158 b(:)40 b(Term)981 b(->)40
b(Strat)g(\(*)g(!t)g(*\))625 4594 y(Scope)119 b(:)39
b(List\(String\))j(*)e(Strat)393 b(->)40 b(Strat)g(\(*)g({xs:)g(s})g
(*\))625 4685 y(Where)119 b(:)39 b(Strat)982 b(->)40
b(Strat)g(\(*)g(where)g(s)g(*\))625 4868 y(Prim)158 b(:)39
b(String)i(->)f(Strat)p 3301 4909 V 440 4912 2865 4 v
746 5061 a Fm(Figure)27 b(2:)37 b(Abstract)27 b(syn)n(tax)g(of)g(terms)
h(and)f(System)h(S)g(expressions.)1831 5662 y(10)p eop
%%Page: 11 14
11 13 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y Fi(LIBRAR)-8 b(Y)440 726 y Fm(The)24
b(language)f(comes)h(with)h(a)f(gro)n(wing)e(library)h(of)i(strategy)e
(op)r(erators)f(with)j(function-)440 825 y(alit)n(y)i(for)565
1061 y Fk(\017)41 b Fm(Simple)28 b(tra)n(v)n(ersals)c(\(suc)n(h)k(as)f
(in)h(Figure)f(1\))565 1227 y Fk(\017)41 b Fm(Fixed-p)r(oin)n(t)27
b(tra)n(v)n(ersals)565 1393 y Fk(\017)41 b Fm(List)27
b(op)r(erations)565 1559 y Fk(\017)41 b Fm(T)-7 b(uple)27
b(op)r(erations)565 1725 y Fk(\017)41 b Fm(Manipulation)31
b(of)h(expressions)e(with)j(\(b)r(ound\))g(v)-5 b(ariables,)31
b(suc)n(h)h(as)f(v)-5 b(ariable)31 b(re-)648 1825 y(naming,)c
(substitution,)h(collection)e(of)i(the)f(set)h(of)f(free)g(v)-5
b(ariables)26 b(etc.)37 b(These)27 b(op-)648 1924 y(erations)21
b(are)g(language)g(indep)r(enden)n(t)i(and)g(can)f(b)r(e)g(sp)r
(ecialized)h(to)f(a)g(language)f(b)n(y)648 2024 y(instan)n(tiation)33
b(of)h(generic)f(op)r(erations.)56 b(Note)34 b(that)g(this)h(concerns)d
Fd(obje)l(ct)43 b Fm(v)-5 b(ari-)648 2124 y(ables)38
b(in)i(the)g(language)e(b)r(eing)h(manipulated,)k(whic)n(h)c(are)f
(di\013eren)n(t)i(from)f(the)648 2223 y(meta-v)-5 b(ariable)26
b(used)h(in)h(rules.)1831 5662 y(11)p eop
%%Page: 12 15
12 14 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)440 531 y(A)g(Stratego)f(sp)r(eci\014cation)g(de\014nes)h(a)
g(transformation)e(on)i(terms.)37 b(The)28 b(Stratego)f(com-)440
631 y(piler)k(translates)e(a)h(sp)r(eci\014cation)h(to)g(an)f
(executable)g(program)f(that)i(reads)f(in)h(a)f(term,)440
731 y(transforms)37 b(it)j(according)c(to)j(the)g(sp)r(eci\014cation)g
(and)f(outputs)h(the)g(resulting)f(trans-)440 830 y(formed)24
b(term.)36 b(In)24 b(this)g(section)g(w)n(e)g(discuss)f(the)i(arc)n
(hitecture)e(of)h(the)h(compiler)e(and)h(the)440 930
y(run-time)32 b(system)g(used)h(in)f(the)h(generated)e(programs.)49
b(In)32 b(the)h(next)f(section)g(w)n(e)g(giv)n(e)440
1029 y(some)27 b(examples)g(of)h(the)f(sp)r(eci\014cation)h(of)f(the)h
(compiler)f(in)h(Stratego)e(itself.)1831 5662 y(12)p
eop
%%Page: 13 16
13 15 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)440 531 y Fi(AR)m(CHITECTURE)440 726 y Fm(The)36
b(o)n(v)n(erall)e(arc)n(hitecture)h(of)h(the)g(compiler)g(is)g(sho)n
(wn)f(in)h(Figure)g(3.)62 b(The)36 b(compiler)440 825
y(consists)k(of)i(four)f(main)g(comp)r(onen)n(ts:)64
b(fron)n(t-end,)44 b(optimizer,)g(matc)n(hing-tree,)g(and)440
925 y(bac)n(k-end.)440 1094 y(The)21 b(fron)n(t-end)f(tak)n(es)g(a)g
(Stratego)g(sp)r(eci\014cation)g(\(in)h(abstract)f(syn)n(tax)g(form\))h
(and)f(trans-)440 1194 y(lates)k(it)h(to)f(a)g(list)h(of)f(System)h(S)f
(expressions)f(\(SSE\).)i(The)f(fron)n(t-end)g(itself)h(is)f(comp)r
(osed)440 1293 y(of)29 b(\014v)n(e)g(stages:)40 b(joining)29
b(sections)f(of)i(the)g(same)e(kind)i(\(normalization\);)f(translation)
f(of)440 1393 y(rules)34 b(and)h(signatures)f(to)g(strategy)g
(de\014nitions;)39 b(extraction)34 b(of)h(the)g(de\014nitions)g(that)
440 1493 y(are)24 b(actually)g(needed)i(for)e(implemen)n(tation)h(of)g
(the)g(op)r(erator)f Ff(main)p Fm(;)g(elimination)h(of)g(the)440
1592 y(syn)n(tactic)f(abstractions)e(\(sugar\))h(of)i(the)f(Stratego)f
(lev)n(el;)i(and)f(\(selectiv)n(e\))g(inlining)g(de\014-)440
1692 y(nitions.)36 b(The)24 b(result)g(of)g(this)g(stage)f(is)i(a)e
(list)i(of)f(strategy)e(de\014nitions)j(for)e(parameterless)440
1792 y(op)r(erators.)440 1961 y(The)i(optimizer)f(simpli\014es)h(a)f
(System)g(S)h(expression)e(b)n(y)i(applying)f(algebraic)e(la)n(ws.)35
b(The)440 2061 y(matc)n(hing-tree)j(automaton)g(transformer)f(targets)g
(expressions)h(that)h(are)f(c)n(hoices)f(of)440 2160
y(strategies)e(starting)h(with)h(a)f(matc)n(h.)64 b(Common)36
b(pre\014xes)f(are)h(extracted)g(to)g(prev)n(en)n(t)440
2260 y(insp)r(ecting)f(a)f(term)g(more)g(than)g(once.)57
b(The)35 b(bac)n(k-end)e(translates)g(an)i(expression)d(to)440
2359 y(abstract)27 b(mac)n(hine)g(instructions.)1831
5662 y(13)p eop
%%Page: 14 17
14 16 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)p 440 667 2865 4 v 440 5020 4 4353 v 4 setlinewidth
np 1722 993 a 2142 993 li 2142 783 li 1722 783 li closepath
st 1791 859 a Fc(Stratego)1726 950 y(sp)r(eci\014cation)p
np 1932 993 a 1932 1113 li st 0.000 setgray np 1947 1053
a 1932 1113 li 1917 1053 li closepath fil 0 setgray np
1947 1053 a 1932 1113 li 1917 1053 li closepath st np
1932 1218 210 105 0.00 360.00 ellipse st 1791 1189 a(Stratego)1829
1280 y(parser)p np 1932 1323 a 1932 1443 li st 0.000 setgray
np 1947 1383 a 1932 1443 li 1917 1383 li closepath fil
0 setgray np 1947 1383 a 1932 1443 li 1917 1383 li closepath
st np 1722 1653 a 2142 1653 li 2142 1443 li 1722 1443
li closepath st 1791 1519 a(Stratego)1854 1610 y(AST)p
np 1932 1653 a 1932 1773 li st 0.000 setgray np 1947
1713 a 1932 1773 li 1917 1713 li closepath fil 0 setgray
np 1947 1713 a 1932 1773 li 1917 1713 li closepath st
np 1932 1878 210 105 0.00 360.00 ellipse st 1778 1894
a(fron)n(t-end)p np 1932 1983 a 1932 2103 li st 0.000 setgray
np 1947 2043 a 1932 2103 li 1917 2043 li closepath fil
0 setgray np 1947 2043 a 1932 2103 li 1917 2043 li closepath
st np 1722 2313 a 2142 2313 li 2142 2103 li 1722 2103
li closepath st 1863 2224 a(SSE)p np 1932 2313 a 1932
2433 li st 0.000 setgray np 1947 2373 a 1932 2433 li
1917 2373 li closepath fil 0 setgray np 1947 2373 a 1932
2433 li 1917 2373 li closepath st np 1932 2538 210 105
0.00 360.00 ellipse st 1774 2554 a(optimizer)p np 1932
2643 a 1932 2763 li st 0.000 setgray np 1947 2703 a 1932
2763 li 1917 2703 li closepath fil 0 setgray np 1947
2703 a 1932 2763 li 1917 2703 li closepath st np 1722
2973 a 2142 2973 li 2142 2763 li 1722 2763 li closepath
st 1863 2885 a(SSE)p np 1932 2973 a 1932 3093 li st 0.000 setgray
np 1947 3033 a 1932 3093 li 1917 3033 li closepath fil
0 setgray np 1947 3033 a 1932 3093 li 1917 3033 li closepath
st np 1932 3198 210 105 0.00 360.00 ellipse st 1777 3169
a(matc)n(hing)1868 3260 y(tree)p np 1932 3303 a 1932
3423 li st 0.000 setgray np 1947 3363 a 1932 3423 li
1917 3363 li closepath fil 0 setgray np 1947 3363 a 1932
3423 li 1917 3363 li closepath st np 1722 3633 a 2142
3633 li 2142 3423 li 1722 3423 li closepath st 1863 3544
a(SSE)p np 1932 3633 a 1932 3753 li st 0.000 setgray
np 1947 3693 a 1932 3753 li 1917 3693 li closepath fil
0 setgray np 1947 3693 a 1932 3753 li 1917 3693 li closepath
st np 1932 3858 210 105 0.00 360.00 ellipse st 1774 3874
a(optimizer)p np 1932 3963 a 1932 4083 li st 0.000 setgray
np 1947 4023 a 1932 4083 li 1917 4023 li closepath fil
0 setgray np 1947 4023 a 1932 4083 li 1917 4023 li closepath
st np 1722 4293 a 2142 4293 li 2142 4083 li 1722 4083
li closepath st 1863 4204 a(SSE)p np 1932 4293 a 1932
4413 li st 0.000 setgray np 1947 4353 a 1932 4413 li
1917 4353 li closepath fil 0 setgray np 1947 4353 a 1932
4413 li 1917 4353 li closepath st np 1932 4518 210 105
0.00 360.00 ellipse st 1783 4535 a(bac)n(k-end)p np 1932
4623 a 1932 4743 li st 0.000 setgray np 1947 4683 a 1932
4743 li 1917 4683 li closepath fil 0 setgray np 1947
4683 a 1932 4743 li 1917 4683 li closepath st np 1722
4953 a 2142 4953 li 2142 4743 li 1722 4743 li closepath
st 1741 4864 a(AMI)e(\(=)f(C\))p np 2832 1218 210 105
0.00 360.00 ellipse st 2657 1189 a(normalize-)2760 1280
y(sp)r(ec)p np 2832 1323 a 2832 1443 li st 0.000 setgray
np 2847 1383 a 2832 1443 li 2817 1383 li closepath fil
0 setgray np 2847 1383 a 2832 1443 li 2817 1383 li closepath
st np 2832 1548 210 105 0.00 360.00 ellipse st 2748 1519
a(sp)r(ec-)2705 1610 y(to-sdefs)p np 2832 1653 a 2832
1773 li st 0.000 setgray np 2847 1713 a 2832 1773 li
2817 1713 li closepath fil 0 setgray np 2847 1713 a 2832
1773 li 2817 1713 li closepath st np 2832 1878 210 105
0.00 360.00 ellipse st 2639 1894 a(needed-defs)p np 2832
1983 a 2832 2103 li st 0.000 setgray np 2847 2043 a 2832
2103 li 2817 2043 li closepath fil 0 setgray np 2847
2043 a 2832 2103 li 2817 2043 li closepath st np 2832
2208 210 105 0.00 360.00 ellipse st 2691 2179 a(desugar-)2760
2270 y(sp)r(ec)p np 2832 2313 a 2832 2433 li st 0.000 setgray
np 2847 2373 a 2832 2433 li 2817 2373 li closepath fil
0 setgray np 2847 2373 a 2832 2433 li 2817 2373 li closepath
st np 2832 2538 210 105 0.00 360.00 ellipse st 2740 2554
a(inline)p np 2562 2733 a 3102 2733 li 3102 1053 li 2562
1053 li closepath st np [ 30.74 ] 0 setdash 2080 1803
a 2562 1053 li st [] 0 setdash [] 0 setdash np [ 29.61
] 0 setdash 2080 1952 a 2562 2733 li st [] 0 setdash
[] 0 setdash np [ 25.71 ] 0 setdash 1722 1218 a 1542
1218 li st [] 0 setdash [] 0 setdash 0.000 setgray np
1662 1203 a 1722 1218 li 1662 1233 li closepath fil 0 setgray
np 1662 1203 a 1722 1218 li 1662 1233 li closepath st
np 1062 1323 a 1542 1323 li 1542 1113 li 1062 1113 li
closepath st 1116 1189 a(Stratego)i(in)1095 1280 y(LEX/Y)-6
b(A)n(CC)p np [ 25.71 ] 0 setdash 1722 1878 a 1542 1878
li st [] 0 setdash [] 0 setdash 0.000 setgray np 1662
1863 a 1722 1878 li 1662 1893 li closepath fil 0 setgray
np 1662 1863 a 1722 1878 li 1662 1893 li closepath st
np 1452 1878 90 105 0.00 360.00 ellipse st 1420 1894
a(sc)p np [ 25.71 ] 0 setdash 1362 1878 a 1182 1878 li
st [] 0 setdash [] 0 setdash 0.000 setgray np 1302 1863
a 1362 1878 li 1302 1893 li closepath fil 0 setgray np
1302 1863 a 1362 1878 li 1302 1893 li closepath st np
762 1983 a 1182 1983 li 1182 1773 li 762 1773 li closepath
st -678 w(fron)n(tend.r)p np [ 25.71 ] 0 setdash 1722
2538 a 1542 2538 li st [] 0 setdash [] 0 setdash 0.000 setgray
np 1662 2523 a 1722 2538 li 1662 2553 li closepath fil
0 setgray np 1662 2523 a 1722 2538 li 1662 2553 li closepath
st np 1452 2538 90 105 0.00 360.00 ellipse st 1420 2554
a(sc)p np [ 25.71 ] 0 setdash 1362 2538 a 1182 2538 li
st [] 0 setdash [] 0 setdash 0.000 setgray np 1302 2523
a 1362 2538 li 1302 2553 li closepath fil 0 setgray np
1302 2523 a 1362 2538 li 1302 2553 li closepath st np
762 2643 a 1182 2643 li 1182 2433 li 762 2433 li closepath
st -695 w(optimizer.r)p np [ 25.71 ] 0 setdash 1722 3198
a 1542 3198 li st [] 0 setdash [] 0 setdash 0.000 setgray
np 1662 3183 a 1722 3198 li 1662 3213 li closepath fil
0 setgray np 1662 3183 a 1722 3198 li 1662 3213 li closepath
st np 1452 3198 90 105 0.00 360.00 ellipse st 1420 3214
a(sc)p np [ 25.71 ] 0 setdash 1362 3198 a 1182 3198 li
st [] 0 setdash [] 0 setdash 0.000 setgray np 1302 3183
a 1362 3198 li 1302 3213 li closepath fil 0 setgray np
1302 3183 a 1362 3198 li 1302 3213 li closepath st np
642 3303 a 1182 3303 li 1182 3093 li 642 3093 li closepath
st -829 w(matc)n(hing-tree.r)p np [ 25.71 ] 0 setdash
1722 4518 a 1542 4518 li st [] 0 setdash [] 0 setdash
0.000 setgray np 1662 4503 a 1722 4518 li 1662 4533 li
closepath fil 0 setgray np 1662 4503 a 1722 4518 li 1662
4533 li closepath st np 1452 4518 90 105 0.00 360.00
ellipse st 1420 4535 a(sc)p np [ 25.71 ] 0 setdash 1362
4518 a 1182 4518 li st [] 0 setdash [] 0 setdash 0.000 setgray
np 1302 4503 a 1362 4518 li 1302 4533 li closepath fil
0 setgray np 1302 4503 a 1362 4518 li 1302 4533 li closepath
st np 762 4623 a 1182 4623 li 1182 4413 li 762 4413 li
closepath st -687 w(bac)n(k-end.r)p 3301 5020 V 440 5023
2865 4 v 930 5177 a Fm(Figure)27 b(3:)36 b(Arc)n(hitecture)27
b(of)h(the)g(Stratego)e(compiler)h(\(sc\))1831 5662 y(14)p
eop
%%Page: 15 18
15 17 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)440 531 y Fi(R)m(UN-TIME)k(SYSTEM)440 726
y Fm(The)f(abstract)f(mac)n(hine)h(instructions)g(pro)r(duced)g(b)n(y)g
(the)g(compiler)g(are)f(implemen)n(ted)440 825 y(as)25
b(macros)g(or)g(pro)r(cedures)g(in)i(C.)f(These)g(pro)r(cedures)e(mak)n
(e)i(use)g(of)g(a)g(run-time)g(system)440 925 y(that)31
b(supp)r(orts)f(stac)n(k)g(and)g(term)h(managemen)n(t.)44
b(The)31 b(return-)f(and)g(c)n(hoice-stac)n(ks)e(are)440
1024 y(needed)34 b(for)f(con)n(trol.)55 b(The)34 b(term-stac)n(k)e(is)i
(used)g(to)g(deconstruct)f(terms)h(in)g(matc)n(hing)440
1124 y(and)c(term)h(tra)n(v)n(ersal.)43 b(F)-7 b(or)30
b(the)h(represen)n(tation)d(of)j(terms)f(the)h(A)-7 b(T)g(erms)30
b(pac)n(k)-5 b(age)29 b([7])h(is)440 1224 y(used.)36
b(This)25 b(pac)n(k)-5 b(age)23 b(pro)n(vides)g(an)i(implemen)n(tation)
f(of)h(terms)f(based)h(on)f(hash-consing)440 1323 y(and)j(supp)r(orts)h
(garbage)d(collection.)440 1493 y(The)37 b(run-time)f(system)h(is)f
(implemen)n(ted)h(in)g(C.)g(Therefore,)h(the)f(compiler)f(and)g(gen-)
440 1592 y(erated)f(transformation)f(programs)g(only)h(dep)r(end)i(on)e
Ff(gcc)p Fm(.)61 b(The)35 b(Stratego)g(compiler)440 1692
y(\(sc\))29 b(is)f(b)r(eing)h(dev)n(elop)r(ed)f(on)h(a)f(Lin)n(ux)g
(platform)h(and)f(is)g(also)g(used)h(on)f(Sun)h(mac)n(hines.)440
1792 y(Although)35 b(this)f(has)g(not)g(b)r(een)h(done,)h(there)e
(should)h(b)r(e)f(no)g(problem)g(in)h(p)r(orting)f(the)440
1891 y(compiler)27 b(to)g(Windo)n(ws)h(NT)g(platforms)f(with)h(GNU)g
(soft)n(w)n(are.)1831 5662 y(15)p eop
%%Page: 16 19
16 18 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(Examples)440
531 y(In)26 b(this)h(section)e(w)n(e)h(giv)n(e)f(some)h(examples)f(to)h
(illustrate)g(the)h(sp)r(eci\014cation)e(of)h(the)h(com-)440
631 y(piler)g(in)h(Stratego.)1831 5662 y(16)p eop
%%Page: 17 20
17 19 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(Examples)440
531 y Fi(EXAMPLE)32 b(1:)42 b(PIPELINES)440 726 y Fm(The)26
b Ff(main)f Fm(strategy)g(of)h(the)h(fron)n(t-end)f(de\014nes)g(a)g
(pip)r(eline)h(of)f(op)r(erations.)35 b(In)26 b(addition)440
825 y(to)31 b(the)h(op)r(erations)e(discussed)h(in)g(the)h(previous)e
(section,)i(use-def)f(analysis)f(is)h(used)g(to)440 925
y(determine)e(if)h(v)-5 b(ariables)28 b(are)h(used)g(in)h(builds)f
(without)h(b)r(eing)f(b)r(ound)h(in)g(matc)n(h)f(op)r(era-)440
1024 y(tions.)440 1194 y(Note)h(that)g(in)h(general)d(suc)n(h)i(a)g
(pip)r(eline)h(ma)n(y)e(fail)h(to)g(apply)g(to)g(a)f(term.)45
b(In)30 b(this)g(case,)440 1293 y(if)40 b(an)e(error)f(is)i(detected)h
(either)f(in)g(the)g Ff(use-def)e Fm(analysis)g(\(due)j(to)f
(undeclared)f(or)440 1393 y(unitialized)21 b(v)-5 b(ariables\))19
b(or)g(in)i(the)g Ff(needed-defs)16 b Fm(transformation)i(\(missing)j
(de\014nition\),)440 1493 y(the)28 b(pip)r(eline)g(fail.)37
b(In)28 b(these)g(cases)e(an)h(error)f(message)g(is)i(deriv)n(ed)f
(from)g(the)h(failure.)p 440 1612 2865 4 v 440 2709 4
1097 v 468 1687 a Ff(module)41 b(frontend)468 1787 y(imports)g
(normalize-spec)d(spec-to-sdefs)g(needed-defs)817 1887
y(desugar)j(inlining)f(use-def)468 1986 y(strategies)555
2186 y(main)i(=)i(normalize-spec;)861 2285 y(where\(spec-use-)o(de)o
(f\);)861 2385 y(spec-to-sdefs;)861 2484 y(needed-defs;)861
2584 y(desugar-spec;)861 2684 y(inline)p 3301 2709 V
440 2712 2865 4 v 1831 5662 a Fm(17)p eop
%%Page: 18 21
18 20 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(Examples)440
531 y Fi(EXAMPLE)32 b(2:)42 b(DESUGARING)440 726 y Fm(The)31
b(follo)n(wing)f(sp)r(eci\014cation)g(is)h(a)f(fragmen)n(t)g(from)h(mo)
r(dule)g Ff(desugar.r)c Fm(that)k(de\014nes)440 825 y(the)19
b(elimination)f(of)h(syn)n(tactic)f(abstractions)f(\(sugar\).)33
b(Rules)18 b Ff(Bapp2)f Fm(transforms)g(a)h(build)440
925 y(expression)28 b(suc)n(h)i(as)f Ff(!F\(<s>)41 b(G\(y\)\))28
b Fm(to)h Ff({x:)43 b(<s>)f(G\(y\))g(=>)h(x;)g(!F\(x\)})27
b Fm(in)j(order)e(to)440 1024 y(extract)f(the)h(strategy)e(application)
h(inside)h(the)g(build.)440 1194 y(Rule)k Ff(Bapp2)f
Fm(uses)g(a)h(con)n(textual)f(pattern)h Ff(t[App\(s,)41
b(t'\)])30 b Fm(to)i(reac)n(h)f(an)h(application)440
1293 y Ff(App\(s,)41 b(t'\))23 b Fm(at)h(an)f(arbitrary)f(depth)i
(inside)g(the)h(term)f(matc)n(hing)f Ff(t)p Fm(.)35 b(This)24
b(application)440 1393 y(is)k(replaced)f(with)h(the)g(newly)g
(generated)e(v)-5 b(ariable)27 b Ff(Var\(x\))e Fm(in)j(the)g(righ)n
(t-hand)f(side)h(b)n(y)440 1493 y(means)j(of)g(the)h(con)n(text)f
Ff(t[Var\(x\)])p Fm(.)45 b(The)31 b(righ)n(t-hand)f(side)i(replaces)e
(the)i(build)g(b)n(y)f(a)440 1592 y(scop)r(e)e(construct)f(that)h
(declares)f(a)g(new)h(lo)r(cal)g(v)-5 b(ariable)28 b
Ff(x)p Fm(.)40 b(Inside)29 b(the)h(scop)r(e)e(\014rst)h
Ff(s)f Fm(is)440 1692 y(applied)f(to)h Ff(t')f Fm(and)g(the)h(result)f
(matc)n(hed)g(against)g(the)g(new)h(v)-5 b(ariable)26
b Ff(x)p Fm(.)37 b(This)27 b(v)-5 b(ariable)440 1792
y(is)27 b(then)i(used)e(inside)h(the)g(term)f Ff(t)h
Fm(in)g(the)g(build.)440 1961 y(The)37 b(strategy)f Ff(desugar)f
Fm(desugars)h(an)h(expression)f(b)n(y)h(applying)f(a)h(set)h(of)f
(rules,)i(in-)440 2061 y(cluding)28 b Ff(Bapp2)p Fm(,)e(rep)r(eatedly)i
(in)g(a)f(top)r(do)n(wn)h(tra)n(v)n(ersal.)36 b(The)28
b(strategy)e Ff(desugar-spec)440 2160 y Fm(applies)h(this)h(strategy)e
(to)i(eac)n(h)f(de\014nition)h(b)r(o)r(dy)f(in)h(a)g(list)f(of)h
(de\014nitions.)p 440 2279 2865 4 v 440 3693 4 1415 v
468 2355 a Ff(module)41 b(desugar)512 2455 y(...)468
2554 y(rules)555 2753 y(Bapp2)h(:)h(Build\(t[App\(s,)38
b(t'\)]\))j(->)904 2853 y(Scope\([x],)f(Seq\(BAM\(s,)f(t',)j
(Var\(x\)\),)f(Build\(t[Var\(x\)])o(\)\)\))904 2953 y(where)h(new)g(=>)
h(x)468 3152 y(strategies)555 3351 y(desugar)e(=)i(topdown\(try\(desug)
o(ar)o(Rul)o(e\))o(;)1340 3451 y(repeat\(HL)d(+)j(\(Bapp0)e(<+)i(Bapp1)
e(<+)i(Bapp2\)\)\))555 3650 y(desugar-spec)c(=)k(map\(SDef\(id,)c(id,)j
(desugar\)\))p 3301 3693 V 440 3696 2865 4 v 1831 5662
a Fm(18)p eop
%%Page: 19 22
19 21 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 531 y Fi(EXAMPLE)32
b(3:)42 b(COMPILA)-8 b(TION)440 726 y Fm(The)25 b(bac)n(k-end)e(of)i
(the)g(compiler)f(translates)f(expressions)g(to)i(lists)g(of)f
(abstract)g(mac)n(hine)440 825 y(instructions.)40 b(F)-7
b(or)28 b(eac)n(h)f(language)g(construct)i(a)f(rule)g(de\014nes)h(the)g
(pattern)f(of)h(instruc-)440 925 y(tions)g(it)h(corresp)r(onds)d(to.)42
b(F)-7 b(or)29 b(example,)g(the)h(follo)n(wing)e(rules)h(de\014ne)h
(the)g(translation)440 1024 y(of)e(left)g(c)n(hoice)f
Ff(<+)f Fm(and)i(the)g(generic)e(tra)n(v)n(ersal)f(op)r(erator)h
Ff(all)p Fm(.)p 440 1144 2865 4 v 440 3049 4 1906 v 468
1219 a Ff(module)41 b(compiler)512 1319 y(...)468 1418
y(rules)555 1518 y(C)j(:)f(Instr\(LChoice\(s1)o(,)37
b(s2\),)42 b(env,)g(rcs\))g(->)730 1618 y(Block\([Cpush\(fc\))o(,)1035
1717 y(Instr\(s1,)e(env,)i(rcs\),)f(Cpop,)h(Goto\(sc\),)1035
1817 y(Label\(fc\),)d(Instr\(s2,)h(env,)i(rcs\),)1035
1917 y(Label\(sc\)]\))730 2016 y(where)f(new)i(=>)f(sc)h(;)g(new)g(=>)f
(fc)555 2215 y(C)i(:)f(Instr\(All\(s\),)38 b(env,)k(rcs\))g(->)730
2315 y(Block\([AllInit,)1035 2415 y(Label\(c1\),)1035
2514 y(AllNextSon\(c2\),)1035 2614 y(Instr\(s,)e(env,)i(rcs\),)1035
2714 y(Goto\(c1\),)1035 2813 y(Label\(c2\),)1035 2913
y(AllBuild]\))730 3012 y(where)f(new)i(=>)f(c1)h(;)g(new)g(=>)f(c2)p
3301 3049 V 440 3052 2865 4 v 440 3235 a Fm(These)37
b(rules)f(are)h(com)n(bined)g(in)g(the)h(compilation)e(strategy)g
Ff(compile)p Fm(.)63 b(The)37 b(default)440 3335 y Ff(C)31
b Fm(rules)g(are)g(applied)g(after)g(the)h(sp)r(ecialized)f
Ff(Cs)g Fm(rules.)48 b(After)32 b(translation)e(the)i(nested)440
3435 y(co)r(de)f(is)g(\015attened)h(to)f(a)f(single)h(list.)48
b(Some)31 b(simple)g(optimizations)g(are)f(p)r(erformed)h(b)n(y)440
3534 y Ff(peephole)24 b Fm(and)k(\014nally)-7 b(,)27
b(the)h(co)r(de)g(is)f(wrapp)r(ed)g(in)h(some)f(supp)r(ort)h(co)r(de)f
(b)n(y)g Ff(Assemble)p Fm(.)p 440 3656 V 440 4553 4 898
v 468 3731 a Ff(module)41 b(backend)555 3831 y(...)468
3931 y(strategies)555 4130 y(compile)g(=)i(map\(MkInstr;)1166
4229 y(topdown\(repeat\()o(Cs)37 b(<+)43 b(C\)\)\);)991
4329 y(flatten-blocks;)991 4429 y(peephole;)991 4528
y(Assemble)p 3301 4553 V 440 4556 2865 4 v 1831 5662
a Fm(19)p eop
%%Page: 20 23
20 22 bop 1616 2182 a Fb(P)-5 b(art)65 b(I)1557 2667
y Fa(Basics)1831 5662 y Fm(20)p eop
%%Page: 21 24
21 23 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)440
531 y Fi(TERMS)440 726 y Fm(T)-7 b(erms)24 b(are)f(either)h(v)-5
b(ariables,)23 b(in)n(tegers,)h(strings)f(or)g(applications)g(of)h(a)g
(function)h(sym)n(b)r(ol)440 825 y(to)30 b(a)f(list)i(of)f(terms.)43
b(A)31 b(wildcard)e(corresp)r(onds)f(to)i(an)f(anon)n(ymous)g(v)-5
b(ariable.)43 b(In)30 b(com-)440 925 y(men)n(ts)h(after)g(the)h
(declarations)d(of)i(the)h(op)r(erators)d(an)i(example)g(of)g(the)h
(notation)e(used)440 1024 y(in)e(concrete)f(syn)n(tax.)440
1377 y Ff(module)41 b(terms)440 1476 y(imports)g(list-cons)440
1576 y(signature)527 1675 y(sorts)h(Term)527 1775 y(constructors)614
1875 y(Wld)86 b(:)1046 b(Term)129 b(\(*)43 b(_)g(*\))614
1974 y(Var)86 b(:)43 b(String)608 b(->)43 b(Term)129
b(\(*)43 b(x)g(*\))614 2074 y(Int)86 b(:)43 b(Int)740
b(->)43 b(Term)129 b(\(*)43 b(0,)g(1,)f(2)h(...)g(*\))614
2174 y(Real)f(:)h(Real)696 b(->)43 b(Term)129 b(\(*)43
b(0.0,)f(0.1,)g(2.3)g(...)g(*\))614 2273 y(Str)86 b(:)43
b(String)608 b(->)43 b(Term)129 b(\(*)43 b("",)f("a',)g(...)g(*\))614
2373 y(Op)130 b(:)43 b(String)f(*)h(List\(Term\))c(->)k(Term)129
b(\(*)43 b(f\(t1,...,tn\))38 b(*\))440 2625 y Fm(Remarks:)440
2795 y(List)28 b(notation)f([t1,...,tn])h(translates)e(to)i(Cons\(t1,)f
(...,)h(Cons\(tn,)g(Nil\)\))440 2964 y(T)-7 b(uple)28
b(notation)f(\(t1,...,tn\))i(translates)d(to)i(TCons\(t1,)f(...,)h
(TCons\(tn,)f(TNil\)\))1831 5662 y(21)p eop
%%Page: 22 25
22 24 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Fi(STRA)-8 b(TEGIES)523 656 y Fm(In)25 b(this)g(mo)r(dule)g(w)n
(e)f(de\014ne)h(the)g(op)r(erators)d(of)j(the)g(core)e(strategy)g
(language)g(that)i(will)440 755 y(b)r(e)j(used)g(to)f(express)f(all)i
(programs)d(in)j(the)g(high-lev)n(el)f(language.)440
937 y Ff(module)41 b(strategy)440 1036 y(imports)g(terms)440
1136 y(imports)g(list-cons)440 1318 y Fh(sequential)31
b(non-deterministic)i(pr)n(ograms)523 1417 y Fm(The)f(follo)n(wing)f
(op)r(erators)f(pro)n(vide)g(a)i(language)e(for)i(sequen)n(tial)f
(non-deterministic)440 1517 y(programming.)440 1698 y
Ff(signature)527 1798 y(sorts)42 b(SVar)g(Strat)f(SDef)527
1898 y(constructors)614 1997 y(Id)261 b(:)1482 b(Strat)172
b(\(*)43 b(id)f(*\))614 2097 y(Fail)173 b(:)1482 b(Strat)172
b(\(*)43 b(fail)f(*\))614 2296 y(Test)173 b(:)43 b(Strat)1088
b(->)43 b(Strat)172 b(\(*)43 b(test)f(s)h(*\))614 2396
y(Not)217 b(:)43 b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43
b(not)f(s)h(*\))614 2595 y(Seq)217 b(:)43 b(Strat)f(*)h(Strat)739
b(->)43 b(Strat)172 b(\(*)43 b(s1)f(;)87 b(s2)43 b(*\))614
2695 y(Choice)85 b(:)43 b(Strat)f(*)h(Strat)739 b(->)43
b(Strat)172 b(\(*)43 b(s1)f(+)87 b(s2)43 b(*\))614 2794
y(LChoice)e(:)i(Strat)f(*)h(Strat)739 b(->)43 b(Strat)172
b(\(*)43 b(s1)f(<+)h(s2)g(*\))614 2993 y(SVar)173 b(:)43
b(String)1044 b(->)43 b(SVar)614 3093 y(Rec)217 b(:)43
b(String)e(*)i(Strat)696 b(->)43 b(Strat)172 b(\(*)43
b(rec)f(x)h(.)g(s)g(*\))614 3193 y(Let)217 b(:)43 b(SDef)f(*)h(Strat)
783 b(->)43 b(Strat)172 b(\(*)43 b(let)f(sdef)g(in)h(s2)f(*\))614
3392 y(SDef)173 b(:)43 b(String)e(*)i(List\(String\))c(*)k(Strat)f(->)h
(SDef)216 b(\(*)43 b(f\(xs\))e(=)i(s)g(*\))614 3591 y(SDef)173
b(:)43 b(List\(Pragma\))c(*)k(String)e(*)1050 3691 y(List\(String\))e
(*)k(Strat)434 b(->)43 b(SDef)216 b(\(*)43 b(f\(xs\))e(=)i(s)g(*\))614
3890 y(DontInline)d(:)j(Pragma)614 4089 y(Call)173 b(:)43
b(SVar)f(*)h(List\(Strat\))519 b(->)43 b(Strat)172 b(\(*)43
b(f\(ss\))e(*\))440 4271 y Fh(tra)-7 b(versal)31 b(opera)-6
b(tors)614 4452 y Ff(Path)173 b(:)43 b(Int)g(*)g(Strat)826
b(->)43 b(Strat)172 b(\(*)43 b(i\(s\))f(*\))614 4552
y(Cong)173 b(:)43 b(String)e(*)i(List\(Strat\))432 b(->)43
b(Strat)172 b(\(*)43 b(f\(s1,...,sn\))38 b(*\))614 4652
y(One)217 b(:)43 b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43
b(one\(s\))e(*\))614 4751 y(Some)173 b(:)43 b(Strat)1088
b(->)43 b(Strat)172 b(\(*)43 b(some\(s\))d(*\))614 4851
y(All)217 b(:)43 b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43
b(all\(s\))e(*\))614 4950 y(Thread)85 b(:)43 b(Strat)1088
b(->)43 b(Strat)172 b(\(*)43 b(thread\(s\))c(*\))440
5132 y Fh(ma)-6 b(tching)32 b(and)f(building)440 5313
y Ff(signature)527 5413 y(constructors)1831 5662 y Fm(22)p
eop
%%Page: 23 26
23 25 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)614
531 y Ff(Assign)129 b(:)43 b(Term)f(*)h(Term)f(->)h(Strat)614
731 y(Match)173 b(:)43 b(Term)1131 b(->)43 b(Strat)172
b(\(*)43 b(match\(s\))d(*\))614 830 y(Build)173 b(:)43
b(Term)1131 b(->)43 b(Strat)172 b(\(*)43 b(build\(s\))d(*\))614
930 y(MatchVar)h(:)i(String)1043 b(->)43 b(Strat)172
b(\(*)43 b(matchv\(x\))d(*\))614 1029 y(MatchFun)h(:)i(String)1043
b(->)43 b(Strat)172 b(\(*)43 b(matcho\(f\))d(*\))614
1229 y(Scope)129 b(:)43 b(List\(String\))c(*)k(Strat)434
b(->)43 b(Strat)172 b(\(*)43 b({xs:)f(s})g(*\))614 1328
y(Where)129 b(:)43 b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43
b(where)e(s)i(*\))440 1511 y Fh(annot)-6 b(a)g(tion)614
1694 y Ff(Mark)173 b(:)43 b(Term)1132 b(->)43 b(Strat)172
b(\(*)43 b(!)g(t)g(*\))614 1793 y(IsMark)85 b(:)43 b(Term)1132
b(->)43 b(Strat)172 b(\(*)43 b(?)g(t)g(*\))614 1993 y(AnnBuild)84
b(:)43 b(Term)f(*)h(Term)740 b(->)43 b(Strat)614 2092
y(AnnMatch)84 b(:)43 b(Term)f(*)h(Term)740 b(->)43 b(Strat)614
2192 y(AnnRemove)d(:)j(Term)1045 b(->)43 b(Strat)440
2374 y Fh(primitives)523 2474 y Fm(Example)22 b(primitiv)n(es)g(for)h
(In)n(tegers)e(are:)34 b(Plus,)23 b(Min)n(us,)h(Geq,)f(NewIn)n(t)g
(\(generate)f(new)440 2574 y(in)n(teger\),)27 b(etc.)37
b(*\))523 2673 y(Strings)27 b(New,)h(StrConc)440 2856
y Ff(signature)527 2956 y(constructors)614 3055 y(Prim)173
b(:)43 b(String)e(->)i(Strat)614 3254 y(CountRule)d(:)j(String)e(->)i
(Strat)1831 5662 y Fm(23)p eop
%%Page: 24 27
24 26 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Fi(SIGNA)-8 b(TURES)523 656 y Fm(T)n(yp)r(es)27
b(and)h(Kinds)440 839 y Ff(module)41 b(signatures)440
938 y(signature)527 1038 y(constructors)614 1137 y(ConstType)f(:)j
(Term)609 b(->)43 b(Type)614 1237 y(FunType)128 b(:)43
b(List\(Term\))d(*)j(Term)f(->)h(Type)523 1420 y Fm(Signatures)440
1602 y Ff(signature)527 1702 y(sorts)f(SortDecl)e(OpDecl)h(BSig)527
1802 y(constructors)614 1901 y(Sort)304 b(:)43 b(String)e(*)i
(List\(Kind\))d(->)i(SortDecl)614 2001 y(OpDecl)216 b(:)43
b(String)e(*)i(Type)304 b(->)42 b(OpDecl)614 2100 y(Sorts)260
b(:)43 b(List\(SortDecl\))256 b(->)42 b(BSig)614 2200
y(Operations)e(:)j(List\(OpDecl\))344 b(->)42 b(BSig)1831
5662 y Fm(24)p eop
%%Page: 25 28
25 27 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Fi(SYNT)-8 b(A)m(CTIC)33 b(SUGAR)523 656 y Fm(In)22
b(this)f(section)g(w)n(e)g(de\014ne)h(sp)r(eci\014cations)f(that)g
(declare)g(signatures,)g(rules)g(and)g(strat-)440 756
y(egy)34 b(de\014nitions.)60 b(This)35 b(is)g(just)h(syn)n(tactic)e
(sugar)g(for)h(declaring)e(a)i(strategy)-7 b(.)58 b(In)36
b(Sec-)440 855 y(tion)28 b Fi(??)h Fm(w)n(e)f(will)g(sho)n(w)g(ho)n(w)f
(these)i(constructs)e(can)h(b)r(e)h(de\014ned)f(in)h(terms)f(of)g(the)h
(basic)440 955 y(strategies)d(of)i(Section)f(.)440 1137
y Ff(module)41 b(sugar)440 1237 y(imports)g(strategy)f(signatures)440
1420 y Fh(v)-7 b(ariadic)31 b(versions)g(of)h(some)f(combina)-6
b(tors)440 1602 y Ff(signature)527 1702 y(constructors)614
1802 y(Seqs)217 b(:)43 b(List\(Strat\))c(->)k(Strat)614
1901 y(Choices)85 b(:)43 b(List\(Strat\))c(->)k(Strat)614
2001 y(LChoices)e(:)i(List\(Strat\))c(->)k(Strat)614
2200 y(Lets)217 b(:)43 b(List\(SDef\))c(*)k(Strat)f(->)h(Strat)440
2383 y Fh(ma)-6 b(tch,)31 b(build,)g(appl)-6 b(y)32 b(combina)-6
b(tions)440 2565 y Ff(signature)527 2665 y(constructors)614
2765 y(MA)87 b(:)43 b(Term)85 b(*)44 b(Strat)303 b(->)42
b(Strat)129 b(\(*)43 b(t)g(=>)g(s)g(*\))614 2864 y(AM)87
b(:)43 b(Strat)e(*)j(Term)347 b(->)42 b(Strat)129 b(\(*)43
b(s)g(=>)g(t)g(*\))614 2964 y(BA)87 b(:)43 b(Strat)e(*)j(Term)347
b(->)42 b(Strat)129 b(\(*)43 b(<s>)f(t)h(*\))614 3064
y(BAM)g(:)g(Strat)e(*)j(Term)d(*)j(Term)e(->)g(Strat)129
b(\(*)43 b(<s>)f(t)h(=>)g(t')g(*\))440 3246 y Fh(contexts)32
b(&)f(term)h(applica)-6 b(tion)440 3429 y Ff(signature)527
3528 y(constructors)614 3628 y(Con)435 b(:)43 b(Var)f(*)i(Term)e(*)h
(SVar)f(->)g(Term)173 b(\(*)43 b(x[t]\(f\))e(*\))614
3728 y(App)435 b(:)43 b(Strat)f(*)h(Term)260 b(->)42
b(Term)173 b(\(*)43 b(<s>)f(t)h(*\))614 3827 y(Explode)259
b(:)43 b(Term)f(*)h(Term)304 b(->)42 b(Term)173 b(\(*)43
b(t1)g(#)g(\(t2\))f(*\))614 3927 y(ExplodeCong)83 b(:)43
b(Strat)f(*)h(Strat)216 b(->)42 b(Strat)129 b(\(*)43
b(s1)g(#)g(\(s2\))f(*\))614 4027 y(As)479 b(:)43 b(Var)f(*)i(Term)347
b(->)42 b(Term)173 b(\(*)43 b(x@t)f(*\))614 4126 y(BuildDefault)d(:)k
(Term)609 b(->)42 b(Term)173 b(\(*)43 b(_)g(t)g(*\))440
4309 y Fh(r)n(ules)31 b(&)h(r)n(ule)f(definitions)440
4491 y Ff(signature)527 4591 y(sorts)42 b(Rule)g(RDef)527
4691 y(constructors)614 4790 y(Rule)86 b(:)43 b(Term)f(*)h(Term)f(*)h
(Strat)434 b(->)43 b(Rule)172 b(\(*)43 b(t1)g(->)g(t2)g(where)e(s)i
(*\))614 4890 y(LRule)f(:)h(Rule)1088 b(->)43 b(Strat)128
b(\(*)43 b(\\)g(t1)g(->)g(t2)g(where)e(\\)i(*\))614 4990
y(SRule)f(:)h(Rule)1088 b(->)43 b(Strat)614 5089 y(RDef)86
b(:)43 b(String)e(*)i(List\(String\))c(*)k(Rule)f(->)h(RDef)172
b(\(*)43 b(f\(xs\))f(:)h(r)g(*\))440 5272 y Fh(o)n(verla)-6
b(ys)1831 5662 y Fm(25)p eop
%%Page: 26 29
26 28 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)440
531 y Ff(signature)527 631 y(sorts)42 b(Overlay)527 731
y(constructors)614 830 y(Overlay)f(:)i(String)e(*)i(List\(String\))c(*)
k(Term)f(->)h(Overlay)440 1013 y Fh(specifica)-6 b(tions)440
1196 y Ff(signature)527 1295 y(sorts)42 b(BSpec)f(Spec)527
1395 y(constructors)614 1494 y(Signature)215 b(:)43 b(List\(BSig\))170
b(->)43 b(BSpec)614 1594 y(Overlays)259 b(:)43 b(List\(Overlay\))38
b(->)43 b(BSpec)614 1694 y(Rules)391 b(:)43 b(List\(RDef\))170
b(->)43 b(BSpec)614 1793 y(Strategies)171 b(:)43 b(List\(SDef\))170
b(->)43 b(BSpec)614 1893 y(Imports)303 b(:)43 b(List\(String\))82
b(->)43 b(BSpec)614 1993 y(Specification)c(:)k(List\(BSpec\))126
b(->)43 b(Spec)1831 5662 y Fm(26)p eop
%%Page: 27 30
27 29 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Ff(STRATEGO-NORMAL-)o(FOR)o(MA)o(T)440 731 y(module)41
b(Stratego-Normal-)o(For)o(ma)o(t)440 830 y(imports)g(stratego)f(lib)
440 930 y(strategies)527 1129 y(main)i(=)h(iowrap\(stratego-s)o(pe)o
(cif)o(ic)o(ati)o(on)o(\))527 1328 y(stratego-specific)o(at)o(io)o(n)38
b(=)614 1428 y(list\(strategy-def)o(in)o(iti)o(on)o(\))614
1528 y(<+)43 b(debug\(!"not)c(a)k(stratego-specific)o(at)o(ion)o(:)37
b("\))527 1727 y(strategy-definiti)o(on)g(=)614 1826
y(SDef\(is-string,)h([],)k(strategy-express)o(ion)o(\))614
1926 y(<+)h(debug\(!"not)c(a)k(strategy-definiti)o(on)o(:)38
b("\))527 2125 y(strategy-expressi)o(on)f(=)527 2225
y(rec)43 b(exp\()789 2325 y(Id)789 2424 y(+)g(Fail)789
2524 y(+)g(Not\(exp\))789 2623 y(+)g(Test\(exp\))789
2723 y(+)g(Seq\(exp,)d(exp\))789 2823 y(+)j(Choice\(exp,)c(exp\))789
2922 y(+)k(LChoice\(exp,)38 b(exp\))789 3022 y(+)43 b
(Call\(SVar\(is-str)o(in)o(g\),)o([])o(\))789 3122 y(+)g
(Rec\(is-string,)38 b(exp\))789 3221 y(+)43 b(Path\(is-int,)38
b(exp\))789 3321 y(+)43 b(Cong\(is-string,)37 b(list\(exp\)\))789
3421 y(+)43 b(One\(exp\))789 3520 y(+)g(Some\(exp\))789
3620 y(+)g(All\(exp\))789 3719 y(+)g(Thread\(exp\))789
3819 y(+)g(Match\(term-expre)o(ss)o(ion)o(\))789 3919
y(+)g(Build\(term-expre)o(ss)o(ion)o(\))789 4018 y(+)g
(Scope\(list\(is-st)o(ri)o(ng\))o(,)37 b(exp\))789 4118
y(+)43 b(Where\(exp\))789 4218 y(+)g(Prim\(is-string\))789
4317 y(<+)f(debug\(!"not)d(a)44 b(strategy-expres)o(sio)o(n:)37
b("\))789 4417 y(\))527 4616 y(term-expression)h(=)527
4716 y(rec)43 b(trm\()789 4815 y(Wld)789 4915 y(+)g(Var\(is-string\))
789 5015 y(+)g(Int\(is-int\))789 5114 y(+)g(Real\(is-real\))789
5214 y(+)g(Str\(is-string\))789 5313 y(+)g(BuildDefault\(trm)o(\))789
5413 y(+)g(As\(Var\(is-string)o(\),)37 b(trm\))1831 5662
y Fm(27)p eop
%%Page: 28 31
28 30 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)789
531 y Ff(+)43 b(Op\(is-string,)38 b(list\(trm\)\))789
631 y(<+)k(debug\(!"not)d(a)44 b(term-expression)o(:)38
b("\))789 731 y(\))1831 5662 y Fm(28)p eop
%%Page: 29 32
29 31 bop 440 199 a Fm(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Ff(STRATEGO-OPTIMIZ)o(ED-)o(FO)o(RMA)o(T)440 731
y(module)41 b(Stratego-Optimiz)o(ed-)o(Fo)o(rma)o(t)440
830 y(imports)g(stratego)f(automaton)g(lib)440 930 y(strategies)527
1129 y(main)i(=)h(iowrap\(stratego-s)o(pe)o(cif)o(ic)o(ati)o(on)o(\))
527 1328 y(stratego-specific)o(at)o(io)o(n)38 b(=)614
1428 y(list\(strategy-def)o(in)o(iti)o(on)o(\))614 1528
y(<+)43 b(debug\(!"Not)c(a)k(strategy-specific)o(at)o(ion)o(:)37
b("\))527 1727 y(strategy-definiti)o(on)g(=)614 1826
y(SDef\(is-string,)h([],)k(strategy-express)o(ion)o(\))614
1926 y(+)i(SDef\(list\(DontI)o(nl)o(ine)o(\),)37 b(is-string,)i([],)k
(strategy-express)o(io)o(n\))614 2026 y(<+)g(debug\(!"Not)c(a)k
(strategy-definiti)o(on)o(:)38 b("\))527 2225 y(strategy-expressi)o(on)
f(=)527 2325 y(rec)43 b(exp\()789 2424 y(Id)789 2524
y(+)g(Fail)789 2623 y(+)g(Not\(exp\))789 2723 y(+)g(Test\(exp\))789
2823 y(+)g(Seq\(exp,)d(exp\))789 2922 y(+)j(Choice\(exp,)c(exp\))789
3022 y(+)k(LChoice\(exp,)38 b(exp\))789 3122 y(+)43 b
(Call\(SVar\(is-str)o(in)o(g\),)o([])o(\))789 3221 y(+)g
(Rec\(is-string,)38 b(exp\))789 3321 y(+)43 b(Path\(is-int,)38
b(exp\))789 3421 y(+)43 b(Cong\(is-string,)37 b(list\(exp\)\))789
3520 y(+)43 b(One\(exp\))789 3620 y(+)g(Some\(exp\))789
3719 y(+)g(All\(exp\))789 3819 y(+)g(Thread\(exp\))789
3919 y(//)f(+)i(Match\(term-expr)o(ess)o(io)o(n\))789
4018 y(+)f(Build\(term-expre)o(ss)o(ion)o(\))789 4118
y(+)g(Scope\(list\(is-st)o(ri)o(ng)37 b(+)43 b(list\(is-int\)\),)38
b(exp\))789 4218 y(+)43 b(Where\(exp\))789 4317 y(+)g
(Prim\(is-string\))789 4516 y(+)g(Let\(SDef\(is-stri)o(ng)o(,[])o(,e)o
(xp\))o(,)37 b(exp\))789 4716 y(+)43 b(Let\(SDef\(list\(id)o(\),)37
b(is-string,[],exp)o(\),)g(exp\))789 4915 y(+)43 b(Case\(is-string,)37
b(Var\(id\),)k(list\(Alt\(id,id,)o(ex)o(p\)\))o(,)c(exp\))789
5015 y(+)43 b(Continue\(is-stri)o(ng)o(\))789 5214 y(+)g
(Assign\(Var\(id\),t)o(er)o(m-e)o(xp)o(res)o(si)o(on)o(\))789
5313 y(+)g(Assign\(Var\(id\)\))1831 5662 y Fm(29)p eop
%%Page: 30 33
30 32 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)789 531 y Ff(<+)42 b(debug\(!"Not)d(a)44
b(strategy-expres)o(sio)o(n:)37 b("\))789 631 y(\))527
830 y(term-expression)h(=)527 930 y(rec)43 b(trm\()789
1029 y(Wld)789 1129 y(+)g(Var\(is-string\))789 1229 y(+)g
(Int\(is-int\))789 1328 y(+)g(Real\(is-real\))789 1428
y(+)g(Str\(is-string\))789 1528 y(+)g(Op\(is-string,)38
b(list\(trm\)\))789 1627 y(+)43 b(BuildDefault\(trm)o(\))789
1727 y(<+)f(debug\(!"Not)d(a)44 b(term-expression)o(:)38
b("\))789 1826 y(\))1831 5662 y Fm(30)p eop
%%Page: 31 34
31 33 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 531 y Ff(\045{)440
731 y(#include)40 b(<aterm2.h>)440 830 y(#include)g("stratego.h")440
930 y(#include)g("stratego.grm.tab)o(.h)o(")440 1029
y(#include)g("options.h")440 1229 y(static)h(void)h(eat_comment\(\);)
440 1328 y(static)f(void)h(eat_c_comment\(\);)440 1428
y(static)f(ATerm)h(mkstring\(\);)440 1528 y(void)g(yyerror\(char)d
(*msg\);)440 1727 y(FILE)j(*outfile;)440 1926 y(#define)f(lexerror\(x,)
e(y\))j(fprintf\(stderr,)c("\045s)k(\045s\\n",)f(x,)i(y\))440
2125 y(#define)e(YY_DECL)84 b(int)42 b(yylex\(YYSTYPE)d(*lvalp\))440
2325 y(extern)i(char)h(file_name[256];)440 2524 y(/*)440
2623 y(lcid)g({lcstart}{idchar)o(s})o(*)440 2723 y(ucid)g
({ucstart}{idchar)o(s})o(*)440 2823 y(lcid)g({idchars}+)440
2922 y(ucid)g({idchars}+)440 3022 y(*/)440 3221 y(\045})440
3421 y(lcstart)f([a-z`])440 3520 y(ucstart)g([A-Z_])440
3620 y(idchars)g({lcstart}|{ucst)o(art)o(}|)o([0-)o(9')o(.\\-)o(])440
3719 y(lcid)h({lcstart}{idchar)o(s})o(*)440 3819 y(ucid)g
({ucstart}{idchar)o(s})o(*)440 3919 y(primeid)f([']{lcid}|{ucid)o(})440
4018 y(ID)i({lcid}|{ucid})440 4118 y(ws)g([\\t\\)f(]*)440
4218 y(num)g([0-9]+)440 4317 y(real)g([\\-]?[0-9]+[.][0)o(-9)o(]+)440
4417 y(shortcom)e("//"[^\\n]*[\\n])440 4516 y(backslash)g(\\x5C)440
4616 y(literate)g({backslash}"liter)o(at)o(e")440 4716
y(endcode)h({backslash}"end)o(\\{c)o(od)o(e\\})o(")440
4815 y(begincode)f({backslash}"begi)o(n\\)o({co)o(de)o(\\}")440
4915 y(endliterate)f({backslash}"endl)o(ite)o(ra)o(te")440
5114 y(\045x)k(COMM)f(MODNAME)e(IMP)j(LIT)f(STARTLIT)440
5313 y(\045option)f(yylineno)440 5413 y(\045option)g(noyywrap)1831
5662 y Fm(31)p eop
%%Page: 32 35
32 34 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 631 y Ff(\045\045)440
830 y(/*)43 b(Literate)d(programs)g(*/)440 1029 y(<INITIAL>{litera)o
(te})d(BEGIN)k(LIT;)440 1129 y(<INITIAL>{endcod)o(e})c(BEGIN)42
b(LIT;)440 1229 y(<LIT>{begincode})37 b(BEGIN)k(INITIAL;)440
1328 y(<LIT>{endliterat)o(e})c(BEGIN)42 b(INITIAL;)440
1428 y(<LIT>\\n)f(;)i(/*)g(ignore)e(newlines)f(*/)440
1528 y(<LIT>.)h(;)i(/*)g(ignore)e(text)h(*/)440 1727
y(/*)h(Layout)e(*/)440 1926 y(<INITIAL>{ws})d(;)43 b(/*)g(ignore)e
(whitespace)f(*/)440 2026 y(<INITIAL>{shortc)o(om})80
b(;)43 b(/*)g(ignore)e(comments)g(*/)440 2125 y(<INITIAL>\\n)e(;)k(/*)g
(ignore)e(newlines)f(*/)440 2325 y(/*)j(Comments)d(\(SML)i(style\))f
(*/)440 2524 y(<INITIAL>"\(*")125 b(eat_comment\(\);)440
2623 y(<INITIAL>"/*")g(eat_c_comment\(\);)440 2823 y(/*)43
b(Module)e(header)g(*/)440 3022 y(<INITIAL>"module)o(")d(BEGIN)j
(MODNAME;)f(return)h(MODULE;)440 3122 y(<INITIAL>"*")e(return)i
(ASTERISK;)440 3221 y(<INITIAL>"=")e(return)i(EQ;)440
3421 y(/*)i(Imports)d(*/)440 3620 y(<INITIAL,MODNAME)o(>"i)o(mp)o(or)o
(ts")80 b(BEGIN)42 b(MODNAME;)e(return)h(IMPORTS;)440
3819 y(<INITIAL,MODNAME)o(>"s)o(tr)o(at)o(egi)o(es)o(")81
b(BEGIN)42 b(INITIAL;)e(return)h(STRATEGIES;)440 3919
y(<INITIAL,MODNAME)o(>"r)o(ul)o(es)o(")299 b(BEGIN)42
b(INITIAL;)e(return)h(RULES;)440 4018 y(<INITIAL,MODNAME)o(>"s)o(ig)o
(na)o(tur)o(e")81 b(BEGIN)41 b(INITIAL;)f(return)h(SIGNATURE;)440
4118 y(<INITIAL,MODNAME)o(>"o)o(ve)o(rl)o(ays)o(")81
b(BEGIN)42 b(INITIAL;)e(return)h(OVERLAYS;)440 4317 y(<MODNAME>">")e
(BEGIN)i(INITIAL;)f(return)i(GT;)440 4516 y(<INITIAL,MODNAME)o(>":)o
(du)o(mp)o(")c(BEGIN)j(INITIAL;)f(return)i(DUMP;)440
4616 y(<INITIAL,MODNAME)o(>":)o(lo)o(ad)o(")c(BEGIN)j(INITIAL;)f
(return)i(LOAD;)440 4815 y(<MODNAME>"\(*")c(eat_comment\(\);)440
4915 y(<MODNAME>"/*")g(eat_c_comment\(\);)440 5114 y(<MODNAME>{endcod)o
(e})f(BEGIN)42 b(LIT;)440 5313 y(<MODNAME>{lcid})81 b(\(*lvalp\).term)
38 b(=)43 b(ATmakeString\(yyte)o(xt)o(\);)37 b(return)k(LCID;)440
5413 y(<MODNAME>{ucid})81 b(\(*lvalp\).term)38 b(=)43
b(ATmakeString\(yyte)o(xt)o(\);)37 b(return)k(UCID;)1831
5662 y Fm(32)p eop
%%Page: 33 36
33 35 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 631 y Ff(<MODNAME>[)39
b(\\t\\n])j(;)h(/*)g(ignore)e(whitespace)e(*/)527 830
y(/*)k(keywords)d(*/)440 1129 y(<INITIAL>"rec")e(return)j(MU;)440
1229 y(<INITIAL>"fail")c(return)k(FAIL;)440 1328 y(<INITIAL>"id")d
(return)j(SUCC;)440 1528 y(<INITIAL>"some")c(return)k(SOMETOK;)440
1627 y(<INITIAL>"one")d(return)j(ONE;)440 1727 y(<INITIAL>"thread)o(")d
(return)j(THREAD;)440 1826 y(<INITIAL>"all")d(return)j(ALL;)440
1926 y(<INITIAL>"not")d(return)j(NOT;)440 2026 y(<INITIAL>"let")d
(return)j(LET;)440 2125 y(<INITIAL>"in")d(return)j(IN;)440
2325 y(<INITIAL>"?")257 b(return)41 b(MATCHe;)440 2424
y(<INITIAL>"!")82 b(return)41 b(BUILDe;)440 2623 y(<INITIAL>"@")82
b(return)41 b(AS;)440 2823 y(<INITIAL>"where")81 b(return)41
b(WHERE;)440 2922 y(<INITIAL>"test")81 b(return)41 b(TEST;)440
3022 y(<INITIAL>"sorts")81 b(return)41 b(SORTS;)440 3221
y(<INITIAL>"constr)o(uct)o(or)o(s")c(return)k(CONSTRUCTORS;)440
3321 y(<INITIAL>"prim")81 b(return)41 b(PRIM;)440 3520
y(<INITIAL>"strate)o(go")211 b(return)41 b(STRATEGO;)440
3620 y(<INITIAL>"script)o(")d(return)j(SCRIPT;)440 3819
y(/*)i(Operators)d(*/)440 4018 y(<INITIAL>"\\\\")213
b(return)41 b(BACKSLASH;)440 4118 y(<INITIAL,MODNAME)o(>".)o(")168
b(return)41 b(DOT;)440 4218 y(<INITIAL>":-")d(return)j(BACKARROW;)440
4317 y(<INITIAL>":=")d(return)j(ASSIGN;)440 4417 y(<INITIAL>"+")e
(return)i(PLUS;)440 4516 y(<INITIAL>"<+")d(return)j(LTPLUS;)440
4616 y(<INITIAL>"_")e(return)i(UNDERSCORE;)440 4716 y(<INITIAL>"**")d
(return)j(STARSTAR;)440 4815 y(<INITIAL>"*")e(return)i(ASTERISK;)440
4915 y(<INITIAL>"=")e(return)i(EQ;)440 5015 y(<INITIAL>",")e(return)i
(COMMA;)440 5114 y(<INITIAL>";")e(return)i(SEMICOLON;)440
5214 y(<INITIAL>":")e(return)i(COLON;)440 5313 y(<INITIAL>"::")d
(return)j(DOUBLECOLON;)440 5413 y(<INITIAL>"\(")e(return)i(LPAREN;)1831
5662 y Fm(33)p eop
%%Page: 34 37
34 36 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 531 y Ff(<INITIAL>"\)")39
b(return)i(RPAREN;)440 631 y(<INITIAL>"{")e(return)i(LCURLY;)440
731 y(<INITIAL>"}")e(return)i(RCURLY;)440 830 y(<INITIAL>"[")e(return)i
(LBRACK;)440 930 y(<INITIAL>"]")e(return)i(RBRACK;)440
1029 y(<INITIAL>"<")e(return)i(LT;)440 1129 y(<INITIAL>">")e(return)i
(GT;)440 1229 y(<INITIAL>"<<")d(return)j(LL;)440 1328
y(<INITIAL>">>")d(return)j(GG;)440 1428 y(<INITIAL>"-->")d(return)j
(LONGARROW;)440 1528 y(<INITIAL>"->")d(return)j(ARROW;)440
1627 y(<INITIAL>"=>")d(return)j(DOUBLEARROW;)440 1727
y(<INITIAL>"<=")d(return)j(LEFTDOUBLEARROW;)440 1826
y(<INITIAL>"|")e(return)i(BAR;)440 1926 y(<INITIAL>"#")257
b(return)41 b(EXPLODE;)440 2026 y(<INITIAL>"^")257 b(return)41
b(MODIFIER;)440 2225 y(/*)i(Identifiers,)38 b(strings)j(and)h(numbers)f
(*/)440 2424 y(<INITIAL>{lcid})81 b(\(*lvalp\).term)38
b(=)43 b(ATmakeString\(yyte)o(xt)o(\);)37 b(return)k(LCID;)440
2524 y(<INITIAL>{ucid})81 b(\(*lvalp\).term)38 b(=)43
b(ATmakeString\(yyte)o(xt)o(\);)37 b(return)k(UCID;)440
2623 y(<INITIAL>{primei)o(d})81 b(\(*lvalp\).term)38
b(=)43 b(ATmakeString\(yyt)o(ext)o(+1)o(\);)37 b(return)k(UCID;)440
2723 y(<INITIAL>"\\"")474 b(\(*lvalp\).term)38 b(=)43
b(mkstring\(\);)c(return)j(STRINGTOK;)440 2823 y(<INITIAL>{num})c
(\(*lvalp\).num)82 b(=)43 b(atoi\(yytext\);)38 b(return)j(INT;)440
2922 y(<INITIAL>{real})c(\(*lvalp\).real)i(=)k(atof\(yytext\);)38
b(return)j(REAL;)440 3122 y(/*)i(All)f(other)g(characters)d(are)j
(wrong)g(*/)440 3321 y(<INITIAL>.)d(lexerror)i(\("ignoring)e(illegal)i
(character",)e(yytext\);)440 3520 y(<<EOF>>{BEGIN\(IN)o(ITI)o(AL)o(\);)
e(yyterminate\(\);})440 3719 y(\045\045)440 3919 y(/*)484
4018 y(*)43 b(Function)d(which)i(skips)f(comment)g(chars.)g(The)h
(function)e(allows)i('*')g(to)484 4118 y(*)h(occure)e(within)g
(comments.)484 4218 y(*/)440 4417 y(static)g(void)h(eat_comment\(\))440
4516 y({)571 4616 y(char)g(c;)571 4815 y(while\()f(1)i(\))571
4915 y({)702 5015 y(/*)f(get)h(a)g(character)d(*/)702
5114 y(c)j(=)g(input\(\);)702 5313 y(/*)f(if)h(it)g(equals)e('*")h(and)
h(the)f(next)g(character)e(equals)h('\)')h(then)745 5413
y(*)h(the)g(end)f(of)h(the)f(comment)f(is)i(reached.)1831
5662 y Fm(34)p eop
%%Page: 35 38
35 37 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)745 531 y Ff(*/)702
631 y(if\()42 b(c)h(==)g('*')f(\))702 731 y({)832 830
y(c)h(=)h(input\(\);)832 930 y(if\()f(c)g(==)g('\)')f(\))963
1029 y(return;)702 1129 y(})571 1229 y(})440 1328 y(})440
1627 y(static)f(void)h(eat_c_comment\(\))440 1727 y({)571
1826 y(char)g(c;)571 2026 y(while\()f(1)i(\))571 2125
y({)702 2225 y(/*)f(get)h(a)g(character)d(*/)702 2325
y(c)j(=)g(input\(\);)702 2524 y(/*)f(if)h(it)g(equals)e('*")h(and)h
(the)f(next)g(character)e(equals)h('/')h(then)745 2623
y(*)h(the)g(end)f(of)h(the)f(comment)f(is)i(reached.)745
2723 y(*/)702 2823 y(if\()f(c)h(==)g('*')f(\))702 2922
y({)832 3022 y(c)h(=)h(input\(\);)832 3122 y(if\()f(c)g(==)g('/')f(\))
963 3221 y(return;)702 3321 y(})571 3421 y(})440 3520
y(})440 3719 y(static)f(char*)h(resize_buf\()d(char*)i(buf,)h(int)g
(size\))440 3819 y({)571 3919 y(buf)g(=)h(\(char*\)realloc\()38
b(buf,)k(size)g(\);)571 4018 y(assert\()e(buf)j(!=)g(NULL)e(\);)571
4118 y(return)g(buf;)440 4218 y(})440 4417 y(#define)g(CHECK\(buf,)e
(size,)j(ind)g(\))h(\\)440 4516 y(if\()f(ind)h(==)f(size)g(\){)h(size)f
(*=)h(2;)g(buf)f(=)h(resize_buf\()c(buf,)j(size)g(\);})440
4716 y(/*)484 4815 y(*)h(This)f(functions)e(parses)h(a)i(quoted)e
(string)g(and)h(accepts)484 4915 y(*)h(escaped)d(quotes)i(\(e.g.,)f
("hello)g(\\"world\\""\))e(within)i(strings.)484 5015
y(*/)440 5114 y(static)g(ATerm)h(mkstring\(\))440 5214
y({)571 5313 y(ATerm)f(theString;)571 5413 y(char*)g(buf)i(=)g(NULL;)
1831 5662 y Fm(35)p eop
%%Page: 36 39
36 38 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)571 531 y Ff(int)42
b(c;)571 631 y(int)g(size)g(=)h(512;)571 731 y(int)f(ind)86
b(=)43 b(0;)571 930 y(/*)g(use)f(dynamically)d(resizable)h(buffer)h(to)
i(store)e(string)g(*/)571 1029 y(buf)h(=)h(resize_buf\()c(buf,)j(size)g
(\);)571 1229 y(/*)h(add)f(opening)f(quote)g(*/)571 1328
y(CHECK\()g(buf,)h(size,)f(ind)i(\);)571 1428 y(buf[ind++])c(=)k('"';)
571 1627 y(while\()e(1)i(\))571 1727 y({)702 1826 y(c)g(=)g(input\(\);)
702 2026 y(if\()f(c)h(==)g('\\"')f(\))832 2125 y(break;)702
2325 y(if\()g(c)h(<=)g(0)g(\))702 2424 y({)832 2524 y(yyerror\()e
("String)f(not)j(terminated)c(at)k(eof")f(\);)832 2623
y(return)f(NULL;)702 2723 y(})702 2922 y(/*)h(Handle)f(escaped)g
(character)f(*/)702 3022 y(if\()i(c)h(==)g('\\\\')f(\))702
3122 y({)832 3221 y(CHECK\()f(buf,)h(size,)g(ind)g(\);)832
3321 y(buf[ind++])e(=)j(c;)832 3421 y(c)g(=)h(input\(\);)702
3520 y(})702 3719 y(CHECK\()d(buf,)h(size,)f(ind)h(\);)702
3819 y(buf[ind++])d(=)k(c;)571 3919 y(})571 4018 y(/*)g(Add)f(closing)f
(quote)g(*/)571 4118 y(CHECK\()g(buf,)h(size,)f(ind)i(\);)571
4218 y(buf[ind++])c(=)k('"';)571 4417 y(/*)g(terminate)c(string)i(*/)
571 4516 y(buf[ind])f(=)j('\\0';)571 4716 y(/*)g(convert)d(to)j(aterm)e
(*/)571 4815 y(theString)f(=)j(ATparse\()d(buf)i(\);)571
5015 y(/*)h(free)e(buffer)h(*/)571 5114 y(free\()f(buf)i(\);)571
5313 y(/*)g(return)e(quotes)g(string)g(*/)571 5413 y(return)g
(theString;)1831 5662 y Fm(36)p eop
%%Page: 37 40
37 39 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 531 y Ff(})440
631 y(/*)43 b(flex)f(user)g(code)g(*/)1831 5662 y Fm(37)p
eop
%%Page: 38 41
38 40 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Ff(\045{)440 631 y(#include)j
(<aterm1.h>)440 731 y(#include)g("stratego.h")440 930
y(extern)h(int)h(yylineno;)440 1029 y(extern)f(char)h(file_name[256];)
440 1129 y(extern)f(FILE)h(*yyin;)440 1328 y(ATerm)g(parse_tree;)440
1528 y(void)g(yymessage\(char)c(*msg\))440 1627 y({)527
1727 y(fprintf\(stderr,)g("\045s:)j(line)h(\045d)h(-)g(\045s\\n",)e
(file_name,)f(yylineno)g(+)j(1,)g(msg\);)440 1826 y(})440
2026 y(void)f(yyerror\(char)d(*msg\))440 2125 y({)527
2225 y(yymessage\(msg\);)527 2325 y(exit\(1\);)440 2424
y(})440 2623 y(\045})440 2823 y(\045union{)571 2922 y(int)173
b(num;)571 3022 y(double)41 b(real;)571 3122 y(char)129
b(*string;)571 3221 y(ATerm)85 b(term;)571 3321 y(ATermList)40
b(list;)440 3421 y(})440 3620 y(\045{)440 3819 y(/*)j(int)f
(yylex\(void\);)d(*/)440 4018 y(int)j(yylex\(YYSTYPE)d(*lvalp\);)440
4118 y(int)j(yyparse\(void\);)440 4317 y(int)g(parse\(\))440
4417 y({)571 4516 y(int)g(result;)571 4616 y(result)f(=)i(yyparse\(\);)
571 4716 y(return)e(result;)440 4815 y(})440 4915 y(\045})440
5114 y(\045token)g(<term>)g(LCID)440 5214 y(\045token)g(<term>)g
(STRINGTOK)440 5313 y(\045token)g(<term>)g(UCID)440 5413
y(\045token)g(<term>)g(ID)1831 5662 y Fm(38)p eop
%%Page: 39 42
39 41 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 631 y Ff(\045token)k(ARROW)440
731 y(\045token)g(LONGARROW)440 830 y(\045token)g(ASSIGN)440
930 y(\045token)g(ASTERISK)440 1029 y(\045token)g(BACKARROW)440
1129 y(\045token)g(BAR)440 1229 y(\045token)g(BUILD)440
1328 y(\045token)g(AS)440 1428 y(\045token)g(ANNBUILD)440
1528 y(\045token)g(ANNRM)440 1627 y(\045token)g(BUILDe)440
1727 y(\045token)g(COMMA)440 1826 y(\045token)g(EQ)440
1926 y(\045token)g(FAIL)440 2026 y(\045token)g(GG)440
2125 y(\045token)g(IMPORTS)440 2225 y(\045token)g(KIDS)440
2325 y(\045token)g(LBRACK)440 2424 y(\045token)g(LCURLY)440
2524 y(\045token)g(LL)440 2623 y(\045token)g(LPAREN)440
2723 y(\045token)g(LT)440 2823 y(\045token)g(GT)440 2922
y(\045token)g(ANNMATCH)440 3022 y(\045token)g(MATCH)440
3122 y(\045token)g(MATCHe)440 3221 y(\045token)g(MODULE)440
3321 y(\045token)g(NEW)440 3421 y(\045token)g(CONSTRUCTORS)440
3520 y(\045token)g(OVERLAYS)440 3620 y(\045token)g(PARSEPROG)440
3719 y(\045token)g(PARSEQUERY)440 3819 y(\045token)g(PRIM)440
3919 y(\045token)g(RCURLY)440 4018 y(\045token)g(RPAREN)440
4118 y(\045token)g(RULES)440 4218 y(\045token)g(SIGNATURE)440
4317 y(\045token)g(SORTS)440 4417 y(\045token)g(STARSTAR)440
4516 y(\045token)g(STRATEGIES)440 4616 y(\045token)g(STR_GT)440
4716 y(\045token)g(SUCC)440 4815 y(\045token)g(UNDERSCORE)440
4915 y(\045token)g(DOT)440 5015 y(\045token)g(BACKSLASH)440
5114 y(\045token)g(EXPLODE)440 5214 y(\045token)g(MODIFIER)440
5413 y(\045token)g(STRATEGO)1831 5662 y Fm(39)p eop
%%Page: 40 43
40 42 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Ff(\045token)k(SCRIPT)440
631 y(\045token)g(DUMP)440 731 y(\045token)g(LOAD)440
930 y(\045token)g(IN)440 1129 y(\045right)g(COLON)h(DOUBLECOLON)440
1229 y(\045right)f(PLUS)h(LTPLUS)440 1328 y(\045right)f(SEMICOLON)440
1428 y(\045right)g(DOUBLEARROW)440 1528 y(\045right)g(LEFTDOUBLEARROW)
440 1627 y(\045left)85 b(ASSIGN)440 1727 y(\045right)41
b(RBRACK)440 1826 y(\045right)g(NOT)h(WHERE)g(TEST)g(ONE)g(ALL)h
(THREAD)e(SOMETOK)f(MU)j(LET)440 1926 y(\045right)e(<real>)g(REAL)440
2026 y(\045right)g(<num>)h(INT)440 2225 y(\045type)g(<list>)f(commands)
440 2325 y(\045type)h(<term>)f(command)440 2524 y(\045type)h(<term>)f
(decl)440 2623 y(\045type)h(<list>)f(decls)440 2723 y(\045type)h
(<term>)f(id)440 2823 y(\045type)h(<list>)f(idlist)440
2922 y(\045type)h(<term>)f(kind)440 3022 y(\045type)h(<list>)f(kinds)
440 3122 y(\045type)h(<list>)f(mods)440 3221 y(\045type)h(<term>)f
(opdecl)440 3321 y(\045type)h(<list>)f(opdecls)440 3421
y(\045type)h(<term>)f(optcond)440 3520 y(\045type)h(<list>)f(optcont)
440 3620 y(\045type)h(<term>)f(optkind)440 3719 y(\045type)h(<list>)f
(optstrategylist)440 3819 y(\045type)h(<list>)f(opttermlist)440
3919 y(\045type)h(<list>)f(optvarlist)440 4018 y(\045type)h(<list>)f
(overlays)440 4118 y(\045type)h(<term>)f(overlay)440
4218 y(\045type)h(<term>)f(rule)440 4317 y(\045type)h(<term>)f
(stratrule)440 4417 y(\045type)h(<term>)f(rule_def)440
4516 y(\045type)h(<list>)f(rules)440 4616 y(\045type)h(<term>)f(sdecl)
440 4716 y(\045type)h(<list>)f(sdecls)440 4815 y(\045type)h(<term>)f
(start)440 4915 y(\045type)h(<list>)f(strategies)440
5015 y(\045type)h(<term>)f(strategy)440 5114 y(\045type)h(<term>)f
(optapplication)440 5214 y(\045type)h(<term>)f(strategy_def)440
5313 y(\045type)h(<list>)f(strategylist)440 5413 y(\045type)h(<term>)f
(strategytail)1831 5662 y Fm(40)p eop
%%Page: 41 44
41 43 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Ff(\045type)42 b(<term>)f(tail)440
631 y(\045type)h(<term>)f(term)440 731 y(\045type)h(<list>)f(termlist)
440 830 y(\045type)h(<term>)f(trav)440 930 y(\045type)h(<list>)f
(tvarlist)440 1029 y(\045type)h(<term>)f(type)440 1129
y(\045type)h(<list>)f(typelist)440 1229 y(\045type)h(<list>)f(varlist)
440 1428 y(\045start)g(start)440 1627 y(\045pure_parser)440
1826 y(\045\045)440 2026 y(start)85 b(:)43 b(MODULE)e(id)i(decls)434
b({parse_tree)39 b(=)k(ATmake\("Specifica)o(ti)o(on)o(\([<)o(li)o(st>)o
(]\))o(",)37 b($3\);})440 2125 y(|)43 b(STRATEGO)d(SCRIPT)i(commands)e
({parse_tree)f(=)k($3})789 2225 y(|)g(LT)g(strategy)d(GT)j(term)85
b({parse_tree)39 b(=)k(App2\("App",)c($2,)k($4\);})440
2325 y(|)g(strategy)d({parse_tree)f(=)44 b(App1\("Strategy")o(,$1)o
(\);)o(})440 2424 y(;)440 2623 y(commands)c(:)j(command)85
b({$$)42 b(=)h(ATmakeList1\($1\);})440 2723 y(|)g(commands)d(command)85
b({$$)42 b(=)h(ATappend\($1,)c($2\);})440 2823 y(|)k({$$)g(=)g
(ATmakeList0\(\);})440 2922 y(;)440 3122 y(command)e(:)i(DUMP)f
(STRINGTOK)e({$$)i(=)h(App1\("Dump",)c($2\);})440 3221
y(|)k(LOAD)f(STRINGTOK)e({$$)i(=)h(App1\("Load",)c($2\);})440
3321 y(|)k(decl)f({$$)g(=)i($1;})440 3421 y(|)f(GT)g(strategy)d({$$)j
(=)g(App1\("Eval",)38 b($2\);})440 3520 y(;)440 3719
y(decls)k(:)h(decl)303 b({$$)42 b(=)i(ATmakeList1\($1\))o(;})440
3819 y(|)f(decls)f(decl)85 b({$$)43 b(=)g(ATappend\($1,)38
b($2\);})527 3919 y(|)43 b({$$)g(=)g(ATmakeList0\(\);})789
4018 y(;)440 4218 y(mods)f(:)87 b({$$)42 b(=)h(ATmakeList0\(\);})440
4317 y(|)g(mods)f(id)h({$$)f(=)h(ATappend\($1,)c($2\);})440
4417 y(;)440 4616 y(decl)j(:)h(IMPORTS)e(mods)h({$$)g(=)h
(App1\("Imports",)38 b(\(ATerm\))i($2\);})440 4716 y(|)j(RULES)f(rules)
85 b({$$)42 b(=)h(App1\("Rules",)c(\(ATerm\))h($2\);})440
4815 y(|)j(STRATEGIES)d(strategies)83 b({$$)42 b(=)h
(App1\("Strategies")o(,)37 b(\(ATerm\))k($2\);})440 4915
y(|)i(SIGNATURE)d(sdecls)h({$$)h(=)i(App1\("Signature)o(",)37
b(\(ATerm\))k($2\);})440 5015 y(|)i(OVERLAYS)d(overlays)h({$$)h(=)h
(App1\("Overlays",)37 b(\(ATerm\))k($2\);})789 5114 y(;)440
5313 y(sdecls)g(:)i(sdecl)f({$$)g(=)h(ATmakeList1\($1\);})440
5413 y(|)g(sdecls)e(sdecl)85 b({$$)43 b(=)g(ATappend\($1,)c($2\);})1831
5662 y Fm(41)p eop
%%Page: 42 45
42 44 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Ff(|)87 b({$$)42 b(=)h
(ATmakeList0\(\);})789 631 y(;)440 830 y(sdecl)f(:)h(SORTS)e(idlist)g
({$$)i(=)g(App1\("Sorts",)38 b(\(ATerm\))j($2\);})440
930 y(|)i(CONSTRUCTORS)c(opdecls)h({$$)j(=)g(App1\("Operations)o(",)37
b(\(ATerm\))k($2\);})789 1029 y(;)440 1229 y(idlist)85
b(:)871 b({$$)42 b(=)i(ATmakeList0\(\);})789 1328 y(|)f(idlist)e(id)i
(optkind)563 b({$$)43 b(=)g(ATinsert\($1,)c(App2\("Sort",)f($2,)43
b($3\)\);})440 1528 y(optkind)e(:)86 b({$$)43 b(=)g(ATmake\("Nokind"\))
o(;})440 1627 y(|)g(LPAREN)e(termlist)g(RPAREN)84 b({$$)43
b(=)g(App1\("Kinds",)38 b(\(ATerm\))j($2\);})789 1727
y(;)440 1926 y(kinds)129 b(:)43 b(kind)85 b({$$)43 b(=)g
(ATmakeList1\($1\);)o(})440 2026 y(|)g(kinds)f(kind)85
b({$$)43 b(=)g(ATappend\($1,)38 b($2\);})789 2125 y(;)440
2325 y(kind)k(:)h(ASTERISK)d({$$)j(=)g(ATmake\("Type"\);})440
2424 y(|)g(STARSTAR)d({$$)j(=)g(ATmake\("TypeList)o("\);)o(})789
2524 y(;)440 2723 y(opdecls)e(:)86 b({$$)43 b(=)g(ATmakeList0\(\);})440
2823 y(|)g(opdecls)e(opdecl)85 b({$$)42 b(=)h(ATappend\($1,)c($2\);})
789 2922 y(;)440 3122 y(opdecl)i(:)i(id)g(COLON)f(type)f({$$)i(=)g
(App2\("OpDecl",)38 b($1,)k($3\);})789 3221 y(;)440 3421
y(type)86 b(:)43 b(typelist)d(ARROW)h(term)86 b({$$)42
b(=)i(App2\("FunType",)37 b(\(ATerm\))k($1,)h($3\);})440
3520 y(|)h(term)f({$$)g(=)i(App1\("ConstType)o(",)37
b($1\);})789 3620 y(;)440 3819 y(typelist)440 3919 y(:)43
b(typelist)d(ASTERISK)h(term)85 b({$$)43 b(=)g(ATappend\($1,)38
b($3\);})440 4018 y(|)43 b(term)f({$$)g(=)i(ATmakeList1\($1\))o(;})789
4118 y(;)440 4317 y(id)261 b(:)43 b(LCID)85 b({$$)43
b(=)g($1;})614 4417 y(|)h(UCID)85 b({$$)42 b(=)i($1;})789
4516 y(;)440 4716 y(/*)f(Terms)e(*/)440 4915 y(term)86
b(:)43 b(id)f(optcont)346 b({if\(ATisEmpty\($2\))o(\))571
5015 y($$)43 b(=)g(App1\("Var",)c($1\);)484 5114 y(else)571
5214 y($$)k(=)g(App3\("Con",)702 5313 y(App1\("Var",)c($1\),)i
(ATgetFirst\($2\),)702 5413 y(ATgetFirst\(ATge)o(tN)o(ext)o(\($)o
(2\)\))o(\);)o(})1831 5662 y Fm(42)p eop
%%Page: 43 46
43 45 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 631 y Ff(|)43 b(UNDERSCORE)d({$$)i(=)h
(ATmake\("Wld"\);})440 830 y(|)g(UNDERSCORE)d(term)i({$$)g(=)h
(App1\("BuildDefau)o(lt")o(,)37 b($2\);})440 1029 y(|)43
b(INT)348 b({$$)42 b(=)h(App1\("Int",)c(\(ATerm\))i
(ATmakeInt\($1\)\);})440 1129 y(|)i(REAL)347 b({$$)43
b(=)g(App1\("Real",)38 b(\(ATerm\))j(ATmakeReal\($1\)\);)o(})440
1229 y(|)i(STRINGTOK)d({$$)i(=)i(App1\("Str",)39 b($1\);})702
1328 y(|)k(id)f(opttermlist)83 b({$$)42 b(=)i(App2\("Op",)39
b($1,)j(\(ATerm\))f($2\);})789 1428 y(|)i(id)g(AS)f(term)870
b({$$)43 b(=)g(App2\("As",)c(App1\("Var",)g($1\),)j($3\);})440
1528 y(|)h(LT)g(strategy)d(GT)j(term)85 b({$$)43 b(=)g(App2\("App",)c
($2,)j($4\);})440 1627 y(|)h(LBRACK)e(termlist)g(tail)g(RBRACK)129
b({$$)42 b(=)h(list_to_consnil_o)o(p_)o(tl\()o($2)o(,)38
b($3\);})440 1727 y(|)43 b(LPAREN)e(termlist)g(RPAREN)g({$$)h(=)h
(list_to_tconstnil)o(_o)o(p\()o($2\))o(;})440 1826 y(|)g(term)f
(EXPLODE)f(LPAREN)g(term)h(RPAREN)440 1926 y({$$)g(=)i
(App2\("Explode",)37 b($1,)42 b($4\)})789 2026 y(;)440
2225 y(tail)173 b(:)86 b({$$)43 b(=)g(ATmake\("Op\(\\"Nil)o(\\",)o([])o
(\)")o(\);})440 2325 y(|)g(BAR)g(term)85 b({$$)42 b(=)i($2;})789
2424 y(;)440 2623 y(optcont)d(:)i({$$)f(=)h(ATmakeList0\(\);})440
2723 y(|)g(LBRACK)e(term)h(optcond)f(RBRACK)g(trav)440
2823 y({$$)h(=)i(ATmakeList2\($2,)37 b(App2\("Call",)i($5,)j(\(ATerm\))
f(ATmakeList0\(\)\)\))o(;})789 2922 y(;)440 3122 y(trav)173
b(:)86 b({$$)43 b(=)g(ATmake\("SVar\(\\"o)o(nce)o(td)o(\\")o(\)"\))o(;)
37 b(})440 3221 y(|)43 b(LPAREN)e(id)i(RPAREN)85 b({$$)42
b(=)h(App1\("SVar",)c($2\);})440 3421 y(opttermlist)440
3520 y(:)87 b({$$)42 b(=)h(ATmakeList0\(\);})440 3620
y(|)g(LPAREN)e(termlist)g(RPAREN)84 b({$$)43 b(=)g($2;})789
3719 y(;)440 3919 y(termlist:)d(term)i({$$)g(=)h(ATmakeList1\($1\);})
440 4018 y(|)g(term)f(COMMA)g(termlist)127 b({$$)42 b(=)i
(ATinsert\($3,)38 b($1\);})789 4118 y(|)43 b({$$)f(=)h
(ATmakeList0\(\);})789 4218 y(;)440 4417 y(tvarlist:)d(LCID)i({$$)g(=)h
(ATmakeList1\($1\);})440 4516 y(|)g(LCID)f(COMMA)g(tvarlist)127
b({$$)42 b(=)i(ATinsert\($3,)38 b($1\);})789 4616 y(|)43
b({$$)f(=)h(ATmakeList0\(\);})789 4716 y(;)440 4915 y(/*)g(Rewrite)d
(rules)i(*/)440 5114 y(rules)85 b(:)523 b({$$)42 b(=)h
(ATmakeList0\(\);})745 5214 y(|)g(rules)f(rule_def)127
b({$$)43 b(=)g(ATappend\($1,)38 b($2\);})789 5313 y(;)1831
5662 y Fm(43)p eop
%%Page: 44 47
44 46 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Ff(rule_def)440 631
y(:)43 b(id)g(optvarlist)c(COLON)j(rule)g({$$)g(=)h(App3\("RDef",)c
($1,)j(\(ATerm\))f($2,)h(\(ATerm\))f($4\);})440 731 y(|)i(id)g
(optvarlist)440 830 y(DOUBLECOLON)c(stratrule)h({$$)i(=)h
(App3\("RDef",)c($1,)j(\(ATerm\))f($2,)h(\(ATerm\))f($4\);})789
930 y(;)440 1129 y(rule)173 b(:)43 b(term)f(ARROW)f(term)h(optcond)85
b({$$)42 b(=)h(App3\("Rule",)c($1,)j($3,)g($4\);)440
1229 y(})789 1328 y(;)440 1528 y(stratrule)e(:)j(strategy)d(LONGARROW)g
(strategy)g(optcond)440 1627 y({$$)i(=)i(App3\("StratRule)o(",)37
b($1,)42 b($3,)h($4\);)f(})789 1727 y(;)440 1926 y(optcond)f(:)i({$$)f
(=)h(ATmake\("Id"\);})440 2026 y(|)g(WHERE)f(strategy)e({$$)i(=)h
(App1\("Where",)c($2\);})789 2125 y(;)440 2325 y(/*)k(Strategies)c(*/)
440 2524 y(optapplication)440 2623 y(:)87 b({$$)42 b(=)h
(ATmake\("Id"\);})440 2723 y(|)g(LEFTDOUBLEARROW)38 b(strategy)i({$$)i
(=)h($2;})440 2922 y(strategy)440 3022 y(:)g(id)g(optstrategylist)81
b({$$)42 b(=)h(App2\("Call",)c(App1\("SVar",)g($1\),)j(\(ATerm\))e
($2\);})440 3221 y(|)j(id)g(MODIFIER)d(id)j(optstrategylist)527
3321 y({$$)g(=)g(App2\("Call",)38 b(App1\("SVar",)h(App2\("Mod",)g($1,)
j($3\)\),)g(\(ATerm\)$4\);})440 3520 y(|)h(strategy)d(EXPLODE)h(LPAREN)
g(strategy)g(RPAREN)440 3620 y({$$)h(=)i(App2\("ExplodeCo)o(ng)o(",)37
b($1,)43 b($4\)})440 3819 y(|)g(MATCH)f(LPAREN)f(term)h(RPAREN)f({$$)h
(=)h(App1\("Match",)c($3\);})440 4018 y(|)k(MATCH)f(LPAREN)f(term)h
(RPAREN)f({$$)h(=)h(App1\("Match",)c($3\);})440 4218
y(/*)k(|)g(MATCHe)e(term)h(optapplication)c({$$)k(=)h(App2\("AM",)d
($3,)i($2\);})g(*/)440 4417 y(|)h(MATCHe)e(term)86 b({$$)42
b(=)h(App1\("Match",)c($2\);})440 4616 y(|)k(BUILD)85
b(LPAREN)41 b(term)h(RPAREN)f({$$)i(=)g(App1\("Build",)38
b($3\);})440 4716 y(|)43 b(BUILDe)e(term)h({$$)h(=)g(App1\("Build",)38
b($2\);})440 4915 y(|)43 b(ANNMATCH)d(LPAREN)i(term)f(COMMA)h(term)g
(RPAREN)440 5015 y({$$)g(=)i(App2\("AnnMatch")o(,)37
b($3,)43 b($5\);})440 5114 y(|)g(ANNBUILD)d(LPAREN)i(term)f(COMMA)h
(term)g(RPAREN)440 5214 y({$$)g(=)i(App2\("AnnBuild")o(,)37
b($3,)43 b($5\);})440 5313 y(|)g(ANNRM)f(term)870 b({$$)42
b(=)h(App1\("AnnRemove",)37 b($2\);})1831 5662 y Fm(44)p
eop
%%Page: 45 48
45 47 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Ff(|)43 b(NEW)217 b({$$)42
b(=)h(ATmake\("Prim\(\\"ne)o(w\\")o(\)")o(\);)o(})440
631 y(|)g(STR_GT)216 b({$$)42 b(=)h(ATmake\("Prim\(\\"st)o(r_)o(gt)o
(\\"\))o("\))o(;})440 731 y(|)g(KIDS)216 b({$$)43 b(=)g
(ATmake\("Prim\(\\"k)o(ids)o(\\")o(\)")o(\);})789 830
y(|)g(PRIM)f(LPAREN)f(STRINGTOK)f(RPAREN)84 b({$$)43
b(=)g(App1\("Prim",)c($3\);})789 1029 y(|)k(BACKSLASH)d(rule)i
(BACKSLASH)e({$$)i(=)h(App1\("LRule",)38 b($2\);})440
1129 y(|)43 b(LT)g(strategy)d(GT)j(term)f({$$)g(=)h(App2\("BA",)d($2,)i
($4\);})440 1328 y(|)h(strategy)d(DOUBLEARROW)f(term)j({$$)h(=)g
(App2\("AM",)c($1,)k($3\);})440 1528 y(/*)g(|)g(term)f(ASSIGN)f(term)h
({$$)g(=)h(App2\("AM",)d($1,)i(App1\("Build",)c($3\)\);})k(*/)789
1627 y(|)h(FAIL)85 b({$$)43 b(=)g(ATmake\("Fail"\);})789
1727 y(|)g(SUCC)85 b({$$)43 b(=)g(ATmake\("Id"\);})789
1826 y(|)g(INT)f(strategy)e({$$)j(=)g(App2\("Path",)c(\(ATerm\))h
(ATmakeInt\($1\),)e($2\);)k(})789 1926 y(|)h(NOT)86 b(LPAREN)41
b(strategy)f(RPAREN)h({$$)i(=)g(App1\("Not",)c($3\);})789
2026 y(|)k(WHERE)e(LPAREN)g(strategy)g(RPAREN)g({$$)h(=)h
(App1\("Where",)c($3\);})789 2125 y(|)k(TEST)85 b(LPAREN)41
b(strategy)g(RPAREN)g({$$)h(=)h(App1\("Test",)c($3\);})440
2225 y(|)k(LCURLY)e(tvarlist)g(COLON)g(strategy)f(RCURLY)440
2325 y({$$)i(=)i(App2\("Scope",)38 b(\(ATerm\))i($2,)j($4\);})440
2424 y(|)g(strategy)d(SEMICOLON)g(strategy)h({$$)h(=)h(App2\("Seq",)c
($1,)j($3\);})440 2524 y(|)h(strategy)d(PLUS)i(strategy)84
b({$$)43 b(=)g(App2\("Choice",)38 b($1,)k($3\);})789
2623 y(|)h(strategy)d(LTPLUS)h(strategy)171 b({$$)43
b(=)g(App2\("LChoice",)37 b($1,)43 b($3\);})440 2723
y(|)g(MU)g(id)g(LPAREN)e(strategy)f(RPAREN{$$)g(=)j(App2\("Rec",)c($2,)
j($4\);})440 2823 y(|)h(SOMETOK)e(LPAREN)g(strategy)f(RPAREN{$$)g(=)j
(App1\("Some",)c($3\);})440 2922 y(|)k(ONE)g(LPAREN)e(strategy)f
(RPAREN)h({$$)h(=)i(App1\("One",)39 b($3\);})440 3022
y(|)k(ALL)g(LPAREN)e(strategy)f(RPAREN)h({$$)h(=)i(App1\("All",)39
b($3\);})440 3122 y(|)k(THREAD)e(LPAREN)g(strategy)g(RPAREN)g({$$)h(=)h
(App1\("Thread",)38 b($3\);})440 3221 y(|)43 b(LPAREN)e(strategylist)e
(RPAREN)i({$$)h(=)i(tuple_cong\($2\);)o(})440 3321 y(|)f(LBRACK)e
(strategylist)484 3421 y(strategytail)d(RBRACK)j({$$)i(=)g
(list_cong\($2,)38 b($3\);})440 3520 y(|)43 b(STRINGTOK)d({$$)i(=)i
(App1\("Match",)38 b(App1\("Str",)h($1\)\);})440 3620
y(|)k(INT)348 b({$$)42 b(=)h(App1\("Match",)702 3719
y(App1\("Int",)c(\(ATerm\))h(ATmakeInt\($1\)\)\);})440
3819 y(|)j(REAL)347 b({$$)43 b(=)g(App1\("Match",)702
3919 y(App1\("Real",)38 b(\(ATerm\))j(ATmakeReal\($1\)\)\))o(;})440
4018 y(|)i(LET)g(strategies)c(IN)k(strategy)171 b({$$)42
b(=)h(App2\("Let",)c($2,)k($4\);})789 4118 y(;)440 4317
y(strategytail)440 4417 y(:)87 b({$$)42 b(=)h(ATmake\("Call\(SVar)o
(\(\\)o("Ni)o(l\\)o("\),)o([])o(\)")o(\);})440 4516 y(|)g(BAR)g
(strategy)d({$$)i(=)h($2;})440 4616 y(;)440 4815 y(optstrategylist)440
4915 y(:)305 b({$$)42 b(=)h(ATmakeList0\(\);})440 5015
y(|)g(LPAREN)e(strategylist)e(RPAREN)85 b({$$)42 b(=)h($2;})789
5114 y(;)440 5313 y(strategylist)440 5413 y(:)87 b({$$)42
b(=)h(ATmakeList0\(\);})1831 5662 y Fm(45)p eop
%%Page: 46 49
46 48 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Ff(|)43 b(strategy)84
b({$$)42 b(=)i(ATmakeList1\($1\))o(;})440 631 y(|)f(strategy)d(COMMA)i
(strategylist)82 b({$$)43 b(=)g(ATinsert\($3,)38 b($1\);})789
731 y(;)440 930 y(/*)43 b(Strategy)d(definitions)f(*/)440
1129 y(strategies)440 1229 y(:)1133 b({$$)42 b(=)h(ATmakeList0\(\);})
440 1328 y(|)g(strategies)d(strategy_def)82 b({$$)42
b(=)h(ATappend\($1,)c($2\);})789 1428 y(;)440 1627 y(strategy_def)440
1727 y(:)k(id)g(optvarlist)c(EQ)k(strategy)d({$$)j(=)g(App3\("SDef",)c
($1,)j(\(ATerm\))f($2,)h($4\);})789 1826 y(;)440 2026
y(optvarlist)440 2125 y(:)87 b({$$)42 b(=)h(ATmakeList0\(\);})440
2225 y(|)g(LPAREN)e(varlist)g(RPAREN)85 b({$$)42 b(=)h($2;})789
2325 y(;)440 2524 y(varlist)e(:)86 b({$$)43 b(=)g(ATmakeList0\(\);})440
2623 y(|)g(id)g({$$)f(=)h(ATmakeList1\($1\);})440 2723
y(|)g(id)g(COMMA)e(varlist)85 b({$$)42 b(=)h(ATinsert\($3,)c($1\);})789
2823 y(;)440 3022 y(overlays:)h({$$)i(=)h(ATmakeList0\(\);})440
3122 y(|)g(overlay)e(overlays)84 b({$$)42 b(=)h(ATinsert\($2,)c($1\);})
789 3221 y(;)440 3421 y(overlay)i(:)i(id)g(LPAREN)e(varlist)f(RPAREN)i
(EQ)g(term)440 3520 y({$$)g(=)i(App3\("Overlay",)37 b($1,)42
b(\(ATerm\))f($3,)h($6\);})440 3620 y(|)h(id)g(EQ)g(term)85
b({$$)43 b(=)g(App3\("Overlay",)37 b($1,)42 b(\(ATerm\))f
(ATmakeList0\(\),)d($3\);})789 3719 y(;)440 3919 y(/*)43
b(Note)f(this)g(allows)f(contexts)f(in)j(overlay)d(definitions;)f
(should)i(be)i(excluded)440 4018 y(by)g(checking)d(in)j(front-end)d(*/)
1831 5662 y Fm(46)p eop
%%Page: 47 50
47 49 bop 440 199 a Fm(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Mo)r(dule)28 b(Flattening)440 531 y Ff(PACK-STRATEGO)p
440 642 2865 4 v 440 765 4 124 v 468 724 a Fm(This)g(mo)r(dule)g
(de\014nes)f(a)g(pac)n(king)g(algorithm)f(for)h(Stratego.)p
3301 765 V 440 768 2865 4 v 440 904 a(-)g(command-line)g(option)h
(handling)440 1074 y(-)f(writing)h(dep)r(endencies)f(to)h(.r.dep)440
1243 y(-)f(\014nding)h(\014le)g(based)f(on)g(path)440
1412 y(-)g(parsing)g(the)h(\014le)f(for)g(a)h(mo)r(dule)g(based)f(on)g
(giv)n(en)g(parser)440 1582 y(-)g(\015attening)440 1826
y Ff(module)41 b(pack-stratego)440 1926 y(imports)g(lib)h(pack-graph)d
(pack-modules)g(sugar)440 2125 y(strategies)527 2325
y(main)j(=)h(pack-modules\(pack)o(-s)o(tra)o(te)o(go,)37
b(basename\))440 2524 y(strategies)527 2723 y(pack-stratego\(mkp)o(t\))
g(=)789 2823 y(\\)43 b(root)f(->)h(\(root,)e(\(\),)h([]\))g(\\;)789
2922 y(graph-nodes\(Fst)o(;)c(get-module\(![".)o(")g(|)43
b(<mkpt>\(\)]\),)1312 3022 y(get-stratego-imp)o(or)o(ts)o(,)1312
3122 y(\\)g(\(n,x,xs\))d(->)j([x|xs])e(\\)i(\);)789 3221
y(unzip;)789 3321 y(\(id,)f(flatten-strateg)o(o\))527
3520 y(get-module\(mkpath)o(\))37 b(=)614 3620 y(guarantee-extensi)o
(on)o(\(!")o(r")o(\);)g(//debug\(!"looking)g(for:)42
b("\);)614 3719 y(split\(id,)e(mkpath\);)g(find-in-path;)614
3819 y(split\(id,)g(parse-mod\))614 3919 y(<+)j(guarantee-extens)o(ion)
o(\(!)o("tr)o(ee)o("\);)37 b(//debug\(!"looki)o(ng)g(for:)42
b("\);)745 4018 y(split\(id,)e(mkpath\);)g(find-in-path;)745
4118 y(split\(id,)g(ReadFromFile\))614 4218 y(<+)j(\\)g(x)g(->)g
(<fatal-error>)38 b(["module)j(",)h(x,)h(")g(not)g(found"])d(\\)527
4417 y(get-stratego-impo)o(rt)o(s)d(=)614 4516 y(\\)44
b(\(_,)e(Specification\(xs)o(\)\))37 b(->)43 b(xs)g(\\;)614
4616 y(filter\(\\Imports\(x)o(s\))37 b(->)43 b(xs\\)f(\);)614
4716 y(concat)527 4915 y(flatten-stratego)37 b(=)614
5015 y(map\(\\Specificatio)o(n\()o(xs\))g(->)43 b(xs\\;)f
(filter\(not\(Impo)o(rt)o(s\(i)o(d\))o(\)\)\))o(;)614
5114 y(concat;)614 5214 y(\\)i(xs)e(->)h(Specification\(xs)o(\))38
b(\\)440 5413 y(rules)1831 5662 y Fm(47)p eop
%%Page: 48 51
48 50 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)527 631 y Ff(parse-mod)40
b(:)614 731 y('in)j(->)f(trm)614 830 y(where)g(<conc-strings>)c
(\("pack-stratego)o(",)1573 930 y(<get-pid;)i(int-to-string>\(\))o(\))e
(=>)k(out;)876 1029 y(\(*)h(<printnl>)c(\(stderr,)i([")86
b(parsing)41 b(",)i(in]\);)e(*\))876 1129 y(<call>\("parse-mo)o(d")o(,)
d(["-silent",)h("-i",)i('in,)h("-o",)g(out]\);)876 1229
y(<ReadFromFile>)c(out)k(=>)h(trm;)876 1328 y(<rm-files>)c([out])1831
5662 y Fm(48)p eop
%%Page: 49 52
49 51 bop 440 199 a Fm(Chapter:)36 b(Library)440 531
y(The)26 b(mo)r(dules)g(in)h(this)f(c)n(hapter)f(de\014ne)i(common)e
(op)r(erations)g(on)h(Stratego)f(data)g(t)n(yp)r(es.)1831
5662 y(49)p eop
%%Page: 50 53
50 52 bop 440 199 a Fm(Chapter:)36 b(Library)440 531
y Fi(LIBRAR)-8 b(Y)32 b(F)m(OR)g(STRA)-8 b(TEGIES)440
726 y Fm(This)19 b(mo)r(dule)f(instan)n(tiates)g(sev)n(eral)f(language)
g(indep)r(enden)n(t)j(functions)f(de\014ned)g(in)f(mo)r(d-)440
825 y(ule)28 b(subs)f(to)h(the)g(strategy)e(language.)440
1078 y Ff(module)41 b(stratlib)440 1177 y(imports)g(strategy)f
(substitution)f(free-variables)440 1430 y(rules)527 1629
y(Add1)j(:)h(Var\(x\))85 b(->)43 b([x])527 1729 y(Add2)f(:)h(SVar\(x\))
e(->)i([x])527 1928 y(IsVar)85 b(:)43 b(Var\(x\))f(->)g(x)527
2027 y(IsSVar)f(:)i(Call\(SVar\(x\),)c([]\))j(->)h(x)527
2127 y(MkTVar)e(:)i(x)h(->)e(Var\(x\))527 2227 y(MkSVar)f(:)i(x)h(->)e
(SVar\(x\))527 2326 y(MkCall)f(:)i(x)h(->)e(Call\(SVar\(x\),)d([]\))440
2526 y(strategies)527 2725 y(SVarShape\(s\))g(=)k(Call\(SVar\(s\),)38
b([]\))440 3077 y Fh(bound)31 b(v)-7 b(ariables)440 3246
y Fm(The)30 b(follo)n(wing)f(rules)g(and)h(strategies)f(de\014ne)h
(whic)n(h)g(constructs)f(bind)i(v)-5 b(ariables.)42 b(The)440
3346 y Ff(Bnd)28 b Fm(rules)g(de\014ne)i(whic)n(h)f(v)-5
b(ariables)28 b(are)g(b)r(ound.)42 b(The)29 b Ff(paste)e
Fm(strategies)h(de\014ne)h(where)440 3445 y(new)35 b(v)-5
b(ariables)34 b(should)h(b)r(e)h(pasted)f(in)h(case)e(of)h(renaming.)59
b(The)35 b Ff(boundin)e Fm(strategies)440 3545 y(de\014ne)28
b(in)g(whic)n(h)f(argumen)n(ts)g(of)g(the)h(constructs)f(the)h(v)-5
b(ariables)26 b(are)h(binding.)440 3797 y Ff(rules)527
3997 y(Bind0)42 b(:)h(Scope\(xs,)d(s\))i(->)h(xs)527
4096 y(Bind0)f(:)h(LRule\(Rule\(t1,)38 b(t2,)k(s\)\))g(->)h(<tvars>)e
(t1)527 4196 y(Bind1)h(:)h(Let\(SDef\(f,)c(xs,)j(s1\),)g(s2\))h(->)f
([f])527 4296 y(Bind2)g(:)h(SDef\(f,)e(xs,)h(s\))h(->)f(xs)527
4395 y(Bind3)g(:)h(Rec\(x,)e(s\))i(->)f([x])440 4594
y(strategies)527 4794 y(tpaste\(nwvars\))c(=)789 4893
y(Scope\(nwvars,)g(id\))527 5093 y(tboundin\(bnd,)g(ubnd,)k(ignore\))f
(=)789 5192 y(Scope\(ignore,)d(bnd\))527 5391 y(spaste\(nwvars\))g(=)
1831 5662 y Fm(50)p eop
%%Page: 51 54
51 53 bop 440 199 a Fm(Chapter:)36 b(Library)876 531
y Ff(Let\(SDef\(nwvars;)h(Hd,)42 b(id,)h(id\),)e(id\))789
631 y(+)i(SDef\(id,)d(nwvars,)h(id\))789 731 y(+)i(Rec\(nwvars;)c(Hd,)j
(id\))527 930 y(sboundin\(bnd,)c(ubnd,)k(ignore\))f(=)876
1029 y(Let\(SDef\(ignore,)c(ignore,)k(ubnd\),)g(bnd\))789
1129 y(+)i(SDef\(ignore,)38 b(ignore,)j(bnd\))789 1229
y(+)i(Rec\(ignore,)c(bnd\))440 1577 y Fh(free)32 b(v)-7
b(ariables)31 b(and)g(renaming)440 1826 y Ff(strategies)527
2026 y(tvars)42 b(=)h(free-vars\(Add1,)37 b(Bind0,)k(tboundin\))527
2225 y(svars)h(=)h(free-vars\(Add2,)37 b(Bind1)42 b(+)h(Bind2)e(+)j
(Bind3,)d(sboundin\))527 2424 y(trename)g(=)i(rename\(Var,)c(Bind0,)i
(tboundin,)f(tpaste\))527 2524 y(srename)h(=)i(rename\(SVar,)c(Bind1)i
(+)i(Bind2)f(+)h(Bind3,)e(sboundin,)f(spaste\))527 2723
y(svars-arity)f(=)614 2823 y(free-vars2\(\\Call\()o(SV)o(ar\()o(f\))o
(,)f(as\))k(->)h([\(f,)f(<length>)e(as\)]\\)1050 2922
y(,\(Bind1)h(+)i(Bind2)f(+)h(Bind3\))1050 3022 y(,sboundin)1050
3122 y(,{f:?\(\(f,_\),f\)}\))527 3321 y(tsubs)f(=)h(substitute\(IsVar)o
(\))527 3520 y(ssubs)f(=)h(substitute\(IsSVa)o(r\))527
3719 y(tsubstitute)c(=)k(substitute\(IsVar,)37 b(Var,)42
b(Bind0,)f(tboundin,)f(tpaste\))527 3919 y(strename)g(=)k(trename)c(;)j
(srename)527 4118 y(is_var_list)c(=)k(map\(Var\(id\)\))527
4218 y(is_svar_list)c(=)k(map\(SVar\(id\)\))440 4467
y Fm(Con)n(text)27 b(strategies)f(for)h(strategies)440
4716 y Ff(strategies)527 4915 y(conLChoice\(s\))38 b(=)44
b(rec)e(x\(s)g(+)h(LChoice\(x,)d(id\))i(+)h(LChoice\(id,)c(x\)\))527
5114 y(conChoice\(s\))g(=)k(rec)f(x\(s)h(+)g(\(Choice\(x,)c(id\))k(+)g
(Choice\(id,)c(x\)\)\))527 5313 y(conChoiceL\(s\))f(=)44
b(Choice\(s,)39 b(id\))k(+)g(s)1831 5662 y Fm(51)p eop
%%Page: 52 55
52 54 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)527 531 y Ff(choicebu-l'\(s\))38
b(=)43 b(rec)f(x\(try\(Choice\(id,)37 b(x\);)43 b(s\)\))527
731 y(choicebu-l\(s\))38 b(=)44 b(rec)e(x\(try\(Choice\(x,)37
b(x\);)43 b(s\)\))527 930 y(choicetd\(s\))c(=)k(rec)g(x\(s)f(<+)h
(Choice\(x,)d(x\)\))527 1129 y(choicemap\(s\))f(=)k(rec)f
(x\(Choice\(x,)d(x\))k(<+)g(s\))527 1328 y(choicebu\(s\))c(=)k(rec)g
(x\(try\(Choice\(x,)37 b(x\);)42 b(s\)\))527 1528 y(firstInSeq\(s\))c
(=)44 b(s)f(<+)f(Seq\(s,)g(id\))527 1727 y(lastInSeq\(s\))d(=)k
(Seq\(id,)e(rec)h(x\(s)g(<+)h(Seq\(not\(oncetd\(s)o(\)\),)37
b(x\)\)\))1831 5662 y Fm(52)p eop
%%Page: 53 56
53 55 bop 1577 2168 a Fb(P)-5 b(art)65 b(I)5 b(I)1248
2653 y Fa(Compilation)1831 5662 y Fm(53)p eop
%%Page: 54 57
54 56 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y(In)22 b(this)h(section)f(w)n(e)g(de\014ne)g(the)h(desugaring)d
(pro)r(cedure)h(that)i(translates)e(a)h(sp)r(eci\014cation)440
631 y(in)28 b(the)g(high-lev)n(el)e(syn)n(tax)h(to)h(an)f(expression)f
(in)i(the)g(core)e(language.)1831 5662 y(54)p eop
%%Page: 55 58
55 57 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Ff(FRONTEND)440 809 y(module)41 b(frontend)440
908 y(imports)g(normalize-spec)789 1008 y(spec-to-sdefs)789
1108 y(use-def)789 1207 y(check-construct)o(ors)789 1307
y(desugar)440 1506 y(strategies)527 1705 y(frontendIO)f(=)j
(iowrap\(frontend\))527 1905 y(frontend)d(=)789 2004
y(//where\(dtime;)d(debug\(!")84 b(frontend)41 b(initialization:)c
("\)\);)789 2104 y(normalize-spec;)789 2203 y(//where\(dtime;)g
(debug\(!")84 b(normalize-spec:)38 b("\)\);)789 2303
y(where\(spec-use-)o(def)o(\);)789 2403 y(//where\(dtime;)f(debug\(!")
84 b(spec-use-def:)39 b("\)\);)789 2502 y(ExpandOverlays;)789
2602 y(//where\(dtime;)e(debug\(!")84 b(ExpandOverlays:)38
b("\)\);)789 2702 y(try\(CheckConstr)o(uct)o(or)o(s\);)789
2801 y(//where\(dtime;)f(debug\(!")84 b(CheckConstructors)o(:)37
b("\)\))789 2901 y(RulesToSdefs;)789 3000 y(//where\(dtime;)g
(debug\(!")84 b(RulesToSdefs:)39 b("\)\);)789 3100 y(strename;)789
3200 y(//where\(dtime;)e(debug\(!")84 b(strename:)40
b("\)\);)789 3299 y(\\Specification\()o([_,)o(St)o(rat)o(eg)o(ies)o
(\(s)o(de)o(fs\))o(]\))d(->)43 b(sdefs\\;)789 3399 y(//)f
(where\(dtime;)d(debug\(!")84 b(needed-defs:)39 b("\)\);)789
3499 y(desugar-spec)1831 5662 y Fm(55)p eop
%%Page: 56 59
56 58 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Ff(NORMALIZE-SPEC)440 802 y(module)41 b(normalize-spec)440
902 y(imports)g(stratego)f(lib)440 1149 y Fm(The)29 b(\014rst)f(phase)g
(of)g(the)h(fron)n(t-end)f(is)g(the)h(normalization)e(of)i(sp)r
(eci\014cations.)39 b(A)29 b(sp)r(eci-)440 1248 y(\014cation)h
(consists)f(of)i(a)f(list)g(of)g(basic)g(sp)r(eci\014cations)g
(\(signatures,)g(o)n(v)n(erla)n(ys,)e(rules)i(and)440
1348 y(strategy)19 b(de\014nitions\))j(in)f(an)n(y)f(order.)33
b(Normalization)19 b(collects)i(the)g(basic)f(sp)r(eci\014cations)440
1448 y(of)28 b(eac)n(h)e(kind)i(and)g(creates)e(a)h(sp)r(eci\014cation)
g(of)h(the)g(form)527 1679 y Ff(Specification\([Si)o(gn)o(at)o(ure)o
(\(i)o(d\),)1181 1779 y(Overlays\(id\),)1181 1878 y(Rules\(id\),)1181
1978 y(Strategies\(id\)]\))440 2225 y(rules)527 2424
y(BSpecs)41 b(:)i(Specification\(bsp)o(ecs)o(\))37 b(->)43
b(bspecs)527 2623 y(NormBSIG)d(:)k(Operations\(ods\))37
b(->)43 b(ods)527 2723 y(NormBSIG)d(:)k(Sorts\(ss\))39
b(->)k([])527 2922 y(NormBSP)e(:)i(Signature\(bsigs\))81
b(->)42 b(\(<normalize-sigs>)37 b(bsigs,)k([],)h([],)h([]\))527
3022 y(NormBSP)e(:)i(Strategies\(sdefs)o(\))38 b(->)k(\([],)g([],)h
([],)f(sdefs\))527 3122 y(NormBSP)f(:)i(Rules\(rdefs\))257
b(->)42 b(\([],)g([],)h(rdefs,)e([]\))527 3221 y(NormBSP)g(:)i
(Overlays\(ols\))213 b(->)42 b(\([],)g(ols,)g([],)h([]\))527
3421 y(Combine)e(:)i(\(\(ods1,)e(ols1,)g(rdefs1,)g(sdefs1\),)f(\(ods2,)
h(ols2,)h(rdefs2,)f(sdefs2\)\))f(->)963 3520 y(\(<conc>)h(\(ods1,)g
(ods2\),)1007 3620 y(<conc>)g(\(ols1,)g(ols2\),)1007
3719 y(<conc>)g(\(rdefs1,)f(rdefs2\),)1007 3819 y(<conc>)h(\(sdefs1,)f
(sdefs2\)\))527 4018 y(MkSpec)h(:)i(\(ods,)f(ols,)g(rdefs,)f(sdefs\))g
(->)919 4118 y(Specification\([Si)o(gna)o(tu)o(re\()o([O)o(pe)o(rat)o
(io)o(ns\()o(od)o(s\))o(]\),)1573 4218 y(Overlays\(ols\),)1573
4317 y(Rules\(rdefs\),)1573 4417 y(Strategies\(sdefs\))o(]\))440
4616 y(strategies)527 4815 y(normalize-sigs)d(=)789 4915
y(map\(NormBSIG\);)789 5015 y(concat)527 5214 y(normalize-specIO)f(=)43
b(iowrap\(normalize-)o(sp)o(ec\))527 5413 y(normalize-spec)38
b(=)1831 5662 y Fm(56)p eop
%%Page: 57 60
57 59 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)789
531 y Ff(BSpecs;)789 631 y(map\(NormBSP\);)789 731 y(foldr\(!\([],)39
b([],)j([],)g([]\),)g(Combine\);)789 830 y(MkSpec;)789
930 y(Specification\(v)o(ars)o(-t)o(o-c)o(on)o(sts)o(\);)789
1029 y(define-lrules)440 1282 y Fm(F)-7 b(urthermore,)32
b(the)h(grammar)d(cannot)h(distigh)n(uish)h(term)g(v)-5
b(ariables)31 b(from)h(unary)f(con-)440 1381 y(structors.)36
b(This)27 b(distinction)h(can)g(only)f(b)r(e)h(made)f(based)g(on)h(the)
g(signature.)35 b(V)-7 b(ariables)440 1481 y(are)25 b(renamed)f(to)i
(op)r(erator)e(applications)g(b)n(y)i(duplicating)f(the)h(sp)r
(eci\014cation)f(and)h(map-)440 1581 y(ping)i(one)f(sp)r(eci\014cation)
g(to)g(a)h(substitution.)440 1833 y Ff(rules)527 2032
y(Names)129 b(:)43 b(Signature\(bsigs\))37 b(->)43 b
(<filter\(OpNames\))o(;)37 b(concat>)k(bsigs)527 2132
y(OpNames)g(:)i(Operations\(ods\))81 b(->)43 b(<filter\(OpName\)>)37
b(ods)527 2232 y(OpName)85 b(:)43 b(OpDecl\(f,)d(ConstType\(_\)\))e(->)
43 b(f)527 2431 y(Names)129 b(:)43 b(Overlays\(ols\))38
b(->)43 b(<filter\(OLName\)>)37 b(ols)527 2531 y(OLName)85
b(:)43 b(Overlay\(x,)c([],)k(t\))g(->)f(x)440 2730 y(strategies)527
2929 y(const-names)d(=)k(filter\(Names\);)38 b(concat)527
3128 y(vars-to-consts)g(=)614 3228 y(split\(const-names)o(;)f
(map\(split\(id,)i(\\x)j(->)h(Op\(x,[]\)\\)d(\)\))832
3328 y(,id\);)614 3427 y(tsubs)440 3680 y(rules)527 3879
y(UnaryConstructorN)o(am)o(e)d(:)44 b(OpDecl\(f,)c(ConstType\(_\)\))e
(->)k(f)527 3978 y(UnaryConstructorN)o(am)o(e)37 b(:)44
b(Overlay\(x,)39 b([],)j(t\))h(->)g(x)440 4231 y(rules)527
4430 y(DefLRule)d(:)k(LRule\(Rule\(t1,)37 b(t2,)43 b(s\)\))f(->)1007
4530 y(Scope\(<tvars>)c(t1,)k(SRule\(Rule\(t1,)c(t2,)k(s\)\)\))440
4729 y(strategies)527 4928 y(define-lrules)c(=)44 b(topdown\(try\(Def)o
(LRu)o(le)o(\)\))1831 5662 y Fm(57)p eop
%%Page: 58 61
58 60 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Ff(USE-DEF)440 787 y(module)41 b(use-def)440 886
y(imports)g(sugar)g(list-set)f(stratlib)440 1120 y Fm(In)c(the)g
(triple)f Ff(\(u,)42 b(d,)h(e\))35 b(u)g Fm(represen)n(ts)f(the)i(v)-5
b(ariables)34 b(used)i(in)f(a)g(build)h(and)g Ff(d)f
Fm(the)440 1220 y(v)-5 b(ariables)29 b(b)r(ound)h(\(de\014ned\))h(in)f
(a)g(matc)n(h.)44 b Ff(e)29 b Fm(represen)n(ts)g(the)h(v)-5
b(ariables)29 b(that)h(are)f(used)440 1319 y(but)34 b(nev)n(er)e
(de\014ned.)53 b(The)33 b(follo)n(wing)f(strategies)f(de\014ne)j(for)e
(eac)n(h)g(construct)h(in)n(v)n(olv)n(ed)440 1419 y(with)28
b(term)g(v)-5 b(ariables)26 b(ho)n(w)h(it)h(uses)f(or)g(de\014nes)g(v)
-5 b(ariables.)440 1653 y Ff(strategies)527 1852 y(use-term)215
b(=)43 b({t:)f(?t;)h(![\(<tvars>)c(t,)k([],)f([]\)]})527
1952 y(def-term)215 b(=)43 b({t:)f(?t;)h(![\([],)e(<tvars>)f(t,)j
([]\)]})527 2151 y(constructs\(x\))38 b(=)832 2251 y(Build\(use-term\))
g(+)43 b(Match\(def-term\))37 b(+)43 b(MA\(def-term,)c(x\))k(+)832
2350 y(AM\(x,)f(def-term\))e(+)j(BA\(x,)e(use-term\))f(+)j(BAM\(x,)e
(use-term,)f(def-term\))g(+)832 2450 y(Scope\(id,)g(x\))j(+)g
(Rule\(def-term,)38 b(use-term,)i(x\))i(+)832 2550 y(Overlay\(id,)d
(id,)k(use-term\))d(+)j(Cong\(id,)d(map\(x\)\))440 2784
y Fm(The)31 b(parallell)f(union)i(of)f(t)n(w)n(o)f(use-def)h(triples)g
(simply)h(tak)n(es)e(the)h(p)r(oin)n(t-wise)g(union)g(of)440
2883 y(eac)n(h)h(of)g(the)h(sets.)52 b(In)32 b(the)h(sequen)n(tial)f
(union)h(the)g(uses)f(of)g(the)h(second)f(triple)h(are)e(are)440
2983 y(accoun)n(ted)c(for)g(b)n(y)g(the)h(de\014nes)g(in)g(the)g
(\014rst)f(triple.)440 3217 y Ff(rules)527 3416 y(Union)42
b(:)h(\(\(u1,)e(d1,)i(e1\),)f(\(u2,)g(d2,)g(e2\)\))g(->)876
3516 y(\(<union>)e(\(u1,)i(u2\),)g(<union>)f(\(d1,)h(d2\),)g(<union>)e
(\(e1,)i(e2\)\))527 3715 y(SeqUnion)e(:)k(\(\(u1,)d(d1,)h(e1\),)g
(\(u2,)g(d2,)h(e2\)\))f(->)1007 3815 y(\(<union>)e(\(u1,)i(<diff>)f
(\(u2,)h(d1\)\),)1050 3914 y(<union>)f(\(d1,)h(d2\),)g(<union>)e(\(e1,)
i(e2\)\))440 4148 y Fm(Because)31 b(System)i(S)g(expressions)d(can)j
(con)n(tain)e(c)n(hoice)h(op)r(erators,)g(the)h(use-def)f(infor-)440
4248 y(mation)f(of)h(an)f(expression)f(is)i(represen)n(ted)e(as)h(a)h
(set)f(of)h(use-def)f(triples,)i(one)e(for)g(eac)n(h)440
4347 y(path.)55 b(The)33 b(strategy)g Ff(seq-join)d Fm(joins)j(t)n(w)n
(o)g(sets)g(of)h(triples,)h(where)e(for)g(eac)n(h)g(pair)f(of)440
4447 y(triples)27 b(\()p Ff(cart)g Fm(stands)g(for)g(Cartesian)f(pro)r
(duct\))i(the)g(sequen)n(tial)f(union)h(is)f(tak)n(en.)440
4681 y Ff(strategies)527 4880 y(seq-join)40 b(=)k(cart\(SeqUnion\))527
4980 y(seqs-join)c(=)j(foldr\(![\([],)c([],)j([]\)],)g
(cart\(SeqUnion\)\))440 5313 y Fm(The)28 b Ff(UDjoin)d
Fm(rules)j(de\014ne)g(for)f(eac)n(h)g(construct)h(in)n(v)n(olv)n(ed)e
(with)j(v)-5 b(ariables)26 b(ho)n(w)h(use-def)440 5413
y(information)g(is)g(propagated.)1831 5662 y(58)p eop
%%Page: 59 62
59 61 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Ff(rules)527 731 y(UDjoin)41 b(:)i(Seqs\(xs\))477
b(->)42 b(<seqs-join>)d(xs)527 830 y(UDjoin)i(:)i(Seq\(xs,)e(ys\))348
b(->)42 b(<seqs-join>)d([xs,)j(ys])527 930 y(UDjoin)f(:)i(Rule\(l,)e
(r,)i(c\))261 b(->)42 b(<seqs-join>)d([l,)k(c,)f(r])527
1029 y(UDjoin)f(:)i(StratRule\(l,)c(r,)k(c\))g(->)f(<seqs-join>)d([l,)k
(c,)f(r])527 1129 y(UDjoin)f(:)i(MA\(t,)f(s\))479 b(->)42
b(<seqs-join>)d([t,)k(s])527 1229 y(UDjoin)e(:)i(AM\(s,)f(t\))479
b(->)42 b(<seqs-join>)d([s,)k(t])527 1328 y(UDjoin)e(:)i(BA\(s,)f(t\))
479 b(->)42 b(<seqs-join>)d([t,)k(s])527 1428 y(UDjoin)e(:)i(BAM\(s,)f
(t1,)g(t2\))217 b(->)42 b(<seqs-join>)d([t1,)j(s,)h(t2])527
1528 y(UDjoin)e(:)i(Cong\(f,)e(ss\))348 b(->)42 b(<seqs-join>)d(ss)527
1627 y(UDjoin)i(:)i(Scope\(xs,)d(uds\))217 b(->)42 b
(<map\(JoinScope\(!x)o(s\))o(\)>)37 b(uds)527 1727 y(UDjoin)k(:)i
(Overlay\(f,)d(xs,)i(t\))87 b(->)42 b(Overlay\(f,)e(xs,)i(<seqs-join>)d
([\([],xs,[]\),t]\))527 1926 y(JoinScope\(xs\))f(:)44
b(\(u,)e(d,)h(e\))f(->)1225 2026 y(\(u,)g(<diff>)f(\(d,)h(<xs>\(\)\),)
1399 2125 y(<conc>)f(\(<isect>)f(\(u,)j(<xs>\(\)\),)d(e\)\))440
2374 y Fm(F)-7 b(or)19 b(all)h(other)f(constructs)g(the)h(use-def)g
(information)f(is)h(com)n(bined)g(with)g Ff(Union)p Fm(.)32
b(Finally)-7 b(,)440 2474 y(the)28 b(use-def)g(information)e(for)i(an)f
(expression)f(is)h(computed)h(b)n(y)g Ff(use-def)p Fm(.)440
2723 y Ff(strategies)527 2922 y(default-join)39 b(=)789
3022 y(explode-term;)f(Snd;)789 3122 y(foldr\(![\([],)g([],)43
b([]\)],)e(cart\(Union\)\))527 3321 y(use-def)g(=)789
3421 y(rec)h(x\(\(constructs\(x\))37 b(<+)43 b(all\(x\)\);)d(\(UDjoin)h
(<+)h(default-join\)\))440 3670 y Fm(Eac)n(h)20 b(de\014nition)i(of)g
(the)g(the)g(sp)r(eci\014cation)f(is)g(c)n(hec)n(k)n(ed)f(for)h(v)-5
b(alid)22 b(use)f(of)h(v)-5 b(ariables.)33 b(That)440
3769 y(is,)28 b(v)-5 b(ariables)26 b(should)h(b)r(e)h(declared)f(and)g
(de\014ned)h(b)r(efore)g(they)f(are)g(used.)440 4018
y Ff(strategies)527 4218 y(spec-use-defIO)38 b(=)43 b
(iowrap\(where\(spec)o(-u)o(se)o(-de)o(f\))o(\))527 4417
y(spec-use-def)c(=)k(Specification\([S)o(ign)o(at)o(ur)o(e\(i)o(d\))o
(,)1835 4516 y(Overlays\(defs-us)o(e-)o(de)o(f\),)1835
4616 y(Rules\(defs-use-d)o(ef)o(\),)1835 4716 y(Strategies\(defs-)o(us)
o(e-)o(def)o(\)])o(\))527 4915 y(defs-use-def)c(=)k(filter\(check\);)38
b(?[])527 5114 y(check)k(=)h(SDef\(id,)d(id,)i(use-def;)f(not\([\([],)f
(id,)i([]\)]\)\);)f(err-msg)f(+)876 5214 y(RDef\(id,)g(id,)i(use-def;)f
(not\([\([],)f(id,)i([]\)]\)\);)f(err-msg)f(+)876 5313
y(Overlay\(id,)f(id,)j(id\);)g(use-def;)963 5413 y(not\(Overlay\(id,i)o
(d,[)o(\([)o(],[)o(],)o([])o(\)]\))o(\);)37 b(err-msg)1831
5662 y Fm(59)p eop
%%Page: 60 63
60 62 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y(The)21 b(follo)n(wing)g(rules)f(transform)h(de\014nitions)g(with)
h(use-def)f(information)g(that)h(indicates)440 631 y(an)27
b(error)f(to)h(a)h(readable)e(error)g(message.)440 883
y Ff(rules)527 1083 y(MsgU)42 b(:)h([])g(->)g([])527
1182 y(MsgU)f(:)h([x])g(->)832 1282 y(["variable)d(",)i(x,)h(":)g
(used,)f(but)g(not)g(bound"])527 1381 y(MsgU)g(:)h([x,)g(y)g(|)g(ys])f
(->)832 1481 y(["variables)d(",)k(Cons\(x,)e(Cons\(y,)f(ys\)\),)i(":)h
(used,)e(but)i(not)f(bound"])527 1680 y(MsgD)g(:)h([])g(->)g([])527
1780 y(MsgD)f(:)h([x])g(->)832 1880 y(["variable)d(",)i(x,)h(":)g
(matched,)d(but)j(not)f(declared"])527 1979 y(MsgD)g(:)h([x,)g(y)g(|)g
(ys])f(->)832 2079 y(["variables)d(",)k(Cons\(x,)e(Cons\(y,)f(ys\)\),)i
(":)h(matched,)d(but)i(not)h(declared"])527 2278 y(MsgE)f(:)h([])g(->)g
([])527 2477 y(MsgE)f(:)h([x])g(->)832 2577 y(["variable)d(",)i(x,)h
(":)g(declared,)d(but)i(not)h(bound"])527 2776 y(MsgE)f(:)h([x,)g(y)g
(|)g(ys])f(->)832 2876 y(["variables)d(",)k([x,)f(y)i(|)f(ys],)f(":)g
(declared,)e(but)j(not)f(bound"])527 3075 y(MsgS)g(:)h(\(u,)g(d,)f(e\))
h(->)g(<concat>)d([<MsgU>)h(u,)i(<MsgE>)e(e])527 3175
y(MsgR)h(:)h(\(u,)g(d,)f(e\))h(->)g(<concat>)d([<MsgU>)h(u,)i(<MsgE>)e
(e])527 3374 y(MkMsg)h(:)h(RDef\(l,)e(xs,)h(uds\))g(->)h(["error)d(in)j
(rule)f(",)h(l,)f(")i(:)f(")1748 3474 y(|)g(<map\(MsgR\);)c(concat>)h
(uds])527 3673 y(MkMsg)i(:)h(SDef\(f,)e(xs,)h(uds\))g(->)h(["error)d
(in)j(definition)c(",)k(f,)g(")g(:)g(")1748 3773 y(|)g(<map\(MsgS\);)c
(concat>)h(uds])527 3972 y(MkMsg)i(:)h(Overlay\(f,)c(xs,)k(uds\))f(->)g
(["error)f(in)i(overlay)d(",)j(f,)g(")g(:)g(")1878 4071
y(|)h(<map\(MsgR\);)39 b(concat>)h(uds])440 4271 y(strategies)527
4470 y(err-msg)h(=)i(MkMsg;)e(fatal-error)1831 5662 y
Fm(60)p eop
%%Page: 61 64
61 63 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fi(SPECIFICA)f(TION)33 b(TO)f(LIST)g(OF)g(DEFINITIONS)440
722 y Fm(T)-7 b(ranslation)28 b(of)h(a)f(sp)r(eci\014cation)h
(consisting)f(of)h(a)g(signature,)f(rules)h(and)g(strategy)e(de\014-)
440 822 y(nitions)h(to)f(a)g(list)h(of)g(strategy)e(de\014nitions.)440
1055 y Ff(module)41 b(spec-to-sdefs)440 1155 y(imports)g(strategy)f
(sugar)h(stratlib)g(list-sort)440 1389 y Fh(congr)n(uences)32
b(fr)n(om)g(signa)-6 b(ture)440 1558 y Fm(Congruences)24
b(are)g(recognized)g(b)n(y)h(the)g(parser)f(as)g(strategy)g(calls;)i
(The)f(follo)n(wing)f(strat-)440 1658 y(egy)e(generates)g(strategy)g
(de\014nitions)h(from)g(the)h(signature;)f(F)-7 b(or)23
b(instance,)h(the)f(op)r(erator)440 1757 y(declaration)658
1978 y Ff(OpDecl\("F",)39 b(FunType\([_,)g(_],)j(_\)\))440
2199 y Fm(is)27 b(translated)g(to)h(the)g(strategy)e(de\014nition)658
2420 y Ff(SDef\("F",)40 b(["x1",)h("x2"],)g(Cong\("F",)f
([SVar\("x1"\),)e(SVar\("x2"\)]\)\))440 2654 y(rules)527
2853 y(MkCongDef)i(:)j(OpDecl\(f,)d(ConstType\(t\)\))e(->)43
b(SDef\(f,)e([],)h(Cong\(f,)f([]\)\))527 3053 y(MkCongDef)f(:)j
(OpDecl\(f,)d(FunType\(ts,)f(t\)\))j(->)1050 3152 y(SDef\(f,)f(xs,)h
(Cong\(f,)f(<map\(MkCall\)>)d(xs\)\))1050 3252 y(where)k(<map\(new\)>)d
(ts)k(=>)g(xs)527 3451 y(MkCongDefs)d(:)j(Sorts\(sds\))257
b(->)43 b([])527 3551 y(MkCongDefs)d(:)j(Operations\(ods\))37
b(->)43 b(<map\(MkCongDef\)>)37 b(ods)440 3750 y(strategies)527
3949 y(congdefs)j(=)k(map\(MkCongDefs\))o(;)38 b(concat)440
4183 y Fh(constr)n(uctors)31 b(fr)n(om)h(opera)-6 b(tors)440
4417 y Ff(\(*)527 4516 y(MkConsDef)40 b(:)j(OpDecl\(f,)d(FunType\(ts,)f
(t\)\))j(->)1050 4616 y(RDef\(f,)f([],)h(\))1050 4716
y(where)g(<map\(new\)>)d(ts)k(=>)g(xs)789 4915 y(RDef\(f,)d([],)919
5015 y(Rule\(Op\(x1,...,xn)o(\),)d(Op\(f,)42 b(xs\),)g(id\))527
5214 y(MkConsDef)e(:)614 5313 y(Overlay\(f,)g(xs,)i(t\))h(->)g
(RDef\(f,)d([],)j(Op\(x1,...,xn\),)37 b(t\))440 5413
y(*\))1831 5662 y Fm(61)p eop
%%Page: 62 65
62 64 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fh(congr)n(uences)32 b(fr)n(om)g(o)n(verla)-6 b(ys)440
701 y Fm(Eac)n(h)31 b(o)n(v)n(erla)n(y)e(de\014nes)j(a)g(congruence)e
(op)r(erator)g(as)i(w)n(ell)f(as)h(abstractions)e(to)i(b)r(e)g(used)440
800 y(in)c(matc)n(h)f(and)h(build)g(op)r(erations.)440
1053 y Ff(rules)527 1252 y(Overlay-to-Congde)o(f)37 b(:)614
1352 y(Overlay\(f,)j(xs,)i(t\))h(->)g(SDef\(f,)d(xs,)j(<trm-to-cong>)38
b(t\))527 1551 y(Trm-to-Cong)h(:)k(Var\(x\))434 b(->)43
b(Call\(SVar\(x\),)38 b([]\))527 1650 y(Trm-to-Cong)h(:)k(Op\(f,)f
(ts\))304 b(->)43 b(Call\(SVar\(f\),)38 b(ts\))527 1750
y(Trm-to-Cong)h(:)k(Str\(x\))434 b(->)43 b(Match\(Str\(x\)\))527
1850 y(Trm-to-Cong)c(:)k(Int\(x\))434 b(->)43 b(Match\(Int\(x\)\))527
1949 y(Trm-to-Cong)c(:)k(Real\(x\))390 b(->)43 b(Match\(Real\(x\)\))527
2049 y(Trm-to-Cong)c(:)k(BuildDefault\(x\))38 b(->)43
b(Id)440 2248 y(strategies)527 2447 y(trm-to-cong)c(=)k(rec)g
(x\(try\(Op\(id,)38 b(map\(x\)\)\);)i(Trm-to-Cong\))440
2700 y Fh(exp)-6 b(anding)32 b(o)n(verla)-6 b(ys)440
2952 y Ff(rules)527 3152 y(ExpOverlay\(ols\))38 b(:)614
3251 y(Op\(f,)k(ts\))g(->)h(<tsubstitute>)38 b(\(sbs,)k(t\))614
3351 y(where)g(ols;)g(fetch\(where\({xs,)37 b(t:)43 b(?Overlay\(f,)c
(xs,)j(t\);)1966 3450 y(!\(<zip\(id\)>)d(\(xs,)i(ts\),)h(t\)})1617
3550 y(=>)h(\(sbs,)e(t\)\)\))440 3749 y(//)i(Note:)e(when)h(overlays)e
(in)j(overlay)e(definitions)e(already)i(have)h(been)440
3849 y(//)h(expanded)d(the)i(repeat)f(is)i(not)g(necessary.)c
(Therefore)h(exp-overlays1)e(and)440 3949 y(//)43 b(exp-overlays2:)440
4148 y(strategies)527 4347 y(exp-overlays1\(ols)o(\))37
b(=)614 4447 y(try\(where\(not\(ols)g(=>)43 b([]\)\);)789
4546 y(topdown\(repeat\()o(Exp)o(Ov)o(erl)o(ay)o(\(ol)o(s\))o(\)\))o
(\))527 4746 y(exp-overlays2\(ols)o(\))37 b(=)614 4845
y(try\(where\(not\(ols)g(=>)43 b([]\)\);)789 4945 y(topdown\(try\(Exp)o
(Ove)o(rl)o(ay\()o(ol)o(s\)\))o(\)\))440 5197 y Fh(r)n(ule)31
b(definitions)h(to)g(stra)-6 b(tegy)32 b(definitions)440
5367 y Fm(A)c(rule)f(de\014nition)h(de\014nes)g(an)f(implicitly)h(scop)
r(ed)g(strategy)e(de\014nition;)1831 5662 y(62)p eop
%%Page: 63 66
63 65 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Ff(rules)527 731 y(RDtoSD)41 b(:)i(RDef\(f,)e(xs,)h(r\))h(->)g
(SDef\(f,)e(xs,)h(Scope\(<tvars>)c(r,)43 b(SRule\(r\)\)\))527
930 y(DeclareVariables)37 b(:)789 1029 y(SDef\(f,)j(xs,)j(s\))f(->)h
(SDef\(f,)e(xs,)h(Scope\(<tvars>)c(s,)43 b(s\)\))440
1282 y Fh(counting)571 1534 y Ff(AddCounter)c(:)k(SDef\(f,)e(xs,)h(s\))
h(->)g(SDef\(f,)e(xs,)h(Seq\(s,)f(CountRule\(f\)\)\))440
1787 y Fh(specifica)-6 b(tion)33 b(to)e(definition)h(list)440
1956 y Fm(Desugaring)d(a)h(sp)r(eci\014cation)g(consist)f(of)i
(deriving)e(the)i(list)g(of)f(joined)g(strategy)f(de\014ni-)440
2056 y(tions)18 b(from)h(its)f(rule)h(de\014nitions)f(and)h(strategy)e
(de\014nitions;)22 b(The)c(signature)g(comp)r(onen)n(ts)440
2155 y(are)27 b(ignored;)440 2408 y Ff(rules)527 2607
y(Sp0)43 b(:)g(Specification\(b)o(spe)o(cs)o(\))38 b(->)k(bspecs)527
2707 y(Sp1)h(:)g(Signature\(bsigs)o(\))256 b(->)42 b(<congdefs>)e
(bsigs)527 2806 y(Sp2)j(:)g(Strategies\(sdef)o(s\))212
b(->)42 b(sdefs)527 2906 y(Sp3)h(:)g(Rules\(rdefs\))431
b(->)42 b(<map\(RDtoSD\)>)d(rdefs)527 3105 y(RulesToSdefs)g(:)614
3205 y(Specification\([)702 3304 y(Signature\(bsigs)o(\),)702
3404 y(Rules\(rdefs\),)702 3504 y(Strategies\(sdef)o(s\))614
3603 y(]\))k(->)614 3703 y(Specification\([)702 3802
y(Signature\(bsigs)o(\),)702 3902 y(Strategies\(<con)o(ca)o(t>)1181
4002 y([<congdefs>)c(bsigs,)1225 4101 y(<map\(RDtoSD\)>)f(rdefs,)1225
4201 y(<map\(DeclareVar)o(iab)o(le)o(s\))o(>)g(sdefs]\))614
4301 y(]\))527 4500 y(ExpandOverlays)g(:)614 4599 y(Specification\([)
702 4699 y(Signature\(bsigs)o(\),)702 4799 y(Overlays\(ols\),)702
4898 y(Rules\(rdefs\),)702 4998 y(Strategies\(sdef)o(s\))614
5098 y(]\))43 b(->)614 5197 y(Specification\([)702 5297
y(Signature\(bsigs)o(\),)702 5396 y(Rules\(<exp-over)o(la)o(ys2)o(\(!)o
(ols)o('\))o(>)38 b(rdefs\),)1831 5662 y Fm(63)p eop
%%Page: 64 67
64 66 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)702
531 y Ff(Strategies\(<con)o(c>)o(\(<m)o(ap)o(\(Ov)o(er)o(lay)o(-t)o(o-)
o(Con)o(gd)o(ef\))o(>)37 b(ols,)42 b(<exp-overlays2\(!o)o(ls)o('\)>)37
b(sdefs\)\))614 631 y(]\))614 731 y(where)42 b(<exp-overlays1\(!)o(ol)o
(s\)>)37 b(ols)42 b(=>)h(ols')440 930 y(strategies)527
1129 y(ExpandOverlaysIO)37 b(=)43 b(iowrap\(ExpandOver)o(la)o(ys\))527
1328 y(spec-to-sdefs)38 b(=)789 1428 y(Spec-to-Sdefs;)789
1528 y(strename)1831 5662 y Fm(64)p eop
%%Page: 65 68
65 67 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fi(DESUGARING)440 725 y Fm(Desugaring)26 b(:)37
b(translating)26 b(high-lev)n(el)h(constructs)g(to)g(lo)n(w-lev)n(el)f
(ones)440 972 y Ff(module)41 b(desugar)440 1071 y(imports)g(stratego)f
(stratlib)g(list-sort)g(use-def)h(lib)440 1318 y Fh(v)-7
b(ar)h(y)g(adic)32 b(opera)-6 b(tors)440 1565 y Ff(rules)527
1765 y(HL)43 b(:)g(Seqs\([]\))476 b(->)43 b(Id)527 1864
y(HL)g(:)g(Seqs\([s)e(|)i(ss]\))216 b(->)43 b(Seq\(s,)e(Seqs\(ss\)\))
527 1964 y(HL)i(:)g(Choices\([]\))344 b(->)43 b(Fail)527
2064 y(HL)g(:)g(Choices\([s)d(|)j(ss]\))85 b(->)43 b(Choice\(s,)d
(Choices\(ss\)\))527 2163 y(HL)j(:)g(LChoices\([]\))300
b(->)43 b(Fail)527 2263 y(HL)g(:)g(LChoices\([s)c(|)k(ss]\))f(->)h
(LChoice\(s,)c(LChoices\(ss\)\))527 2462 y(HL)k(:)g(Lets\([],)d(s\))j
(->)g(s)527 2562 y(HL)g(:)g(Lets\([sdef)d(|)j(sdefs],)d(s\))j(->)g
(Let\(sdef,)d(Lets\(sdefs,)f(s\)\))527 2761 y(MkSeq)j(:)h(\(s1,)f(s2\))
g(->)h(Seq\(s1,)e(s2\))440 2960 y(strategies)527 3159
y(seqs)h(=)h(foldr\(!Id,)d(MkSeq\))440 3407 y Fh(ma)-6
b(tch,)31 b(build,)g(appl)-6 b(y)32 b(combina)-6 b(tions)440
3654 y Ff(rules)527 3853 y(HL)43 b(:)g(BA\(s,)f(t\))304
b(->)43 b(Seq\(Build\(t\),)38 b(s\))527 3952 y(HL)43
b(:)g(MA\(t,)f(s\))304 b(->)43 b(Seq\(Match\(t\),)38
b(s\))527 4052 y(HL)43 b(:)g(AM\(s,)f(t\))304 b(->)43
b(Seq\(s,)e(Match\(t\)\))527 4152 y(HL)i(:)g(BAM\(s,)e(t1,)i(t2\))f(->)
h(Seqs\([Build\(t1\))o(,)38 b(s,)k(Match\(t2\)]\))440
4399 y Fh(stra)-6 b(tegy)32 b(applica)-6 b(tions)440
4568 y Fm(F)f(actoring)30 b(out)i(strategy)f(applications;)h(The)g
(righ)n(t-hand)f(side)g(of)h(a)f(rule)h(can)f(con)n(tain)440
4668 y(applications)d(of)h(a)g(strategy)e(to)i(a)g(term;)h(This)f(is)g
(factored)f(out)h(b)n(y)g(translating)e(it)j(to)f(a)440
4767 y(condition)h(that)h(applies)e(the)i(strategy)e(and)h(matc)n(hes)g
(the)g(result)g(against)f(a)h(new)g(v)-5 b(ari-)440 4867
y(able,)22 b(whic)n(h)f(is)g(then)h(used)f(in)g(the)g(rhs;)i(In)e(fact)
g(this)h(can)e(b)r(e)i(generalized)d(to)i(applications)440
4967 y(in)28 b(arbitrary)d(builds;)440 5214 y Ff(rules)527
5413 y(Bapp0)42 b(:)h(Build\(t[App\(Buil)o(d\()o(t'\))o(,)37
b(t''\)]\))k(->)i(Build\(t[t']\))1831 5662 y Fm(65)p
eop
%%Page: 66 69
66 68 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)527
631 y Ff(Bapp1)42 b(:)h(Build\(App\(s,)38 b(t'\)\))k(->)h
(Seq\(Build\(t'\),)38 b(s\))527 830 y(Bapp2)k(:)h(Build\(t[App\(s,)38
b(t'\)]\))j(->)876 930 y(Scope\([x],)e(Seq\(BAM\(s,)h(t',)i
(Var\(x\)\),)e(Build\(t[Var\(x\)]\)\))o(\))876 1029 y(where)h(new)i(=>)
f(x)440 1282 y Fh(term)32 b(explosion)f(an)g(constr)n(uction)440
1534 y Ff(rules)527 1733 y(Expl)86 b(:)43 b(Match\(t[Explode\()o(t1)o
(,)38 b(t2\)]\))j(->)876 1833 y(Scope\([x],)1137 1933
y(Seq\(Match\(t[Var\(x)o(\)]\))o(,)1312 2032 y(Where\(BAM\(Prim\(")o
(_S)o(T_)o(exp)o(lo)o(de_)o(te)o(rm)o("\),)1573 2132
y(Var\(x\),)1573 2232 y(Op\("TCons",)e([t1,)j(Op\("TCons",)d([t2,)j
(Op\("TNil",[]\)]\)]\))1573 2331 y(\)\)\)\))876 2431
y(where)f(new)i(=>)f(x)527 2630 y(Expl)86 b(:)43 b(Build\(t[Explode\()o
(t1)o(,)38 b(t2\)]\))j(->)876 2730 y(Scope\([x],)1137
2829 y(Seq\(BAM\(Prim\("_ST)o(_mk)o(te)o(rm)o("\),)1486
2929 y(Op\("TCons",)e([t1,)j(Op\("TCons",)d([t2,)j(Op\("TNil",[]\)]\)])
o(\),)1486 3029 y(Var\(x\)\),)1312 3128 y(Build\(t[Var\(x\)]\))o(\)\))
876 3228 y(where)f(new)i(=>)f(x)527 3427 y(Expl)g(:)h(ExplodeCong\(s1,)
38 b(s2\))k(->)832 3527 y(Seq\(Prim\("_ST_exp)o(lo)o(de_)o(te)o(rm")o
(\),)832 3626 y(Seq\(Cong\("TCons",)37 b([s1,)42 b(Cong\("TCons",)c
([s2,)k(Cong\("TNil",[]\)])o(\)])o(\),)1007 3726 y(Prim\("_ST_mkter)o
(m"\))o(\)\))440 3978 y Fh(r)n(ules)31 b(to)h(stra)-6
b(tegies)440 4148 y Fm(A)39 b(rule)g(corresp)r(onds)f(to)h(a)f
(strategy)g(that)h(\014rst)g(matc)n(hes)g(the)g(left-hand)h(side,)i
(then)440 4247 y(c)n(hec)n(ks)27 b(the)i(conditions)e(and)h(\014nally)g
(builds)h(the)f(righ)n(t-hand)f(side;)i(The)f(left-hand)g(side)440
4347 y(and)e(righ)n(t-hand)e(side)i(should)f(b)r(e)i(in)f(basic)f(term)
g(format,)h(as)f(de\014ned)h(b)n(y)g(the)g(predicate)440
4447 y(|bterm|;)440 4699 y Ff(strategies)527 4898 y(pureterm)40
b(=)k(not\(topdown\(Con)o(\(id)o(,)37 b(id,)43 b(id\))f(+)h(App\(id,)e
(id\)\)\))527 5098 y(buildterm)f(=)j(not\(topdown\(Con\(i)o(d,)37
b(id,)42 b(id\))h(+)g(Wld\)\))440 5297 y(rules)1831 5662
y Fm(66)p eop
%%Page: 67 70
67 69 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)527
531 y Ff(RtoS)42 b(:)h(SRule\(Rule\(l,)38 b(r,)43 b(s\)\))g(->)f
(Seqs\([Match\(l\),)c(s,)k(Build\(r\)]\))832 631 y(where)g(<pureterm>)d
(l)k(;)h(<buildterm>)39 b(r)527 830 y(RtoS)j(:)h(SRule\(StratRule\(l)o
(,)37 b(r,)43 b(s\)\))g(->)f(Seqs\([l,)f(s,)h(r]\))440
1076 y Fh(contexts)440 1245 y Fm(F)-7 b(actoring)19 b(out)i(con)n
(texts;)h(Con)n(texts)f(used)f(in)h(a)f(rule)h(are)e(translated)h(to)h
(a)f(lo)r(cal)g(tra)n(v)n(ersal)440 1345 y(that)41 b(replaces)e(the)i
(pattern)f(o)r(ccuring)f(in)i(the)g(con)n(text)f(in)g(the)h(lhs)g(b)n
(y)f(the)h(pattern)440 1445 y(o)r(ccurring)26 b(in)i(the)g(con)n(text)f
(in)h(the)g(rhs;)440 1691 y Ff(rules)527 1890 y(Rcon)42
b(:)h(SRule\(Rule\(l[Con\()o(Va)o(r\(c)o(\),)37 b(l',)42
b(f\)],)g(r[Con\(Var\(c\),)c(r',)43 b(Call\(f',)d([]\)\)],)h(s\)\))h
(->)832 1989 y(Scope\([c'],SRule\()919 2089 y(Rule\(l[Var\(c\)],)c
(r[Var\(c'\)],)1137 2189 y(Seq\(s,)j(BAM\(Call\(f',)e
([SRule\(Rule\(l',)e(r',)43 b(Id\)\)]\),)1617 2288 y(Var\(c\),)e
(Var\(c'\)\)\)\)\)\))832 2388 y(where)h(new)g(=>)h(c')527
2587 y(Rcon')f(:)h(SRule\(Rule\(l[Con)o(\(V)o(ar\()o(c\))o(,)38
b(l',)k(f\)],)g(r[Con\(Var\(c\),)c(r',)k(Call\(f',)f([]\)\)],)g(s\)\))h
(->)832 2687 y(SRule\(Rule\(l[Var\()o(c\))o(],)1312 2786
y(r[App\(Call\(f',)c([SRule\(Rule\(l',)f(r',)42 b(Id\)\)]\),)f
(Var\(c\)\)],)1312 2886 y(s\)\))527 3085 y(Rcon'')g(:)i
(SRule\(Rule\(l[Con\()o(Var)o(\(c)o(\),)37 b(l',)42 b(Call\(f,)f
([]\)\)],)g(r,)i(s\)\))f(->)832 3185 y(SRule\(Rule\(l[Var\()o(c\))o(],)
37 b(r,)1094 3285 y(Seq\(s,)k(BA\(Call\(f,)e([Match\(l'\)]\),)g
(Var\(c\)\)\)\)\))789 3384 y(\(*)j(Con\(Var\(c\),)d(_,)k(_\))g(should)e
(not)h(occur)g(in)h(r)g(*\))440 3630 y Fm(Note:)34 b(The)21
b(lo)r(cal)g(tra)n(v)n(ersal)d(should)j(b)r(e)h(closed)f(for)f(v)-5
b(ariables)20 b(not)i(o)r(ccuring)e(in)h(the)h(outer)440
3730 y(pattern;)34 b(But)f(this)f(is)h(more)e(relev)-5
b(an)n(t)32 b(for)f(m)n(ulti-con)n(texts)h(whic)n(h)g(are)f(not)i(supp)
r(orted)440 3829 y(y)n(et;)440 3999 y(Other)27 b(problems:)440
4168 y(-)18 b(lo)r(cal)g(v)-5 b(ariables)17 b(for)h(inner)g(rule;)j
(the)e(inner)f(SRule)h(should)f(b)r(e)h(enclosed)f(in)g(a)g
Ff(Scope\(xs,)40 b(_\))440 4268 y Fm(where)571 4498 y
Ff(<diff>)h(\(<tvars>)f(\(l',)i(r'\),)g(<tvars>)f(\(l[Var\(c\)],)e
(r[Var\(c'\)]\)\))f(=>)43 b(xs)440 4729 y Fm(-)d(placemen)n(t)f(of)h
(deriv)n(ed)g(strategy)e(in)i(where)g(clause;)45 b(option)40
b(\014rst)g(do)f(a)h(matc)n(hing)440 4828 y(tra)n(v)n(ersal)25
b(at)i(start)g(of)h(where,)f(and)h(at)f(end)h(of)f(where)g(do)h(a)f
(replacing)f(tra)n(v)n(ersal.)440 4998 y(-)h(m)n(ultiple)i(uses)e(of)g
(con)n(text)g(in)h(rhs)440 5167 y Fh(desugaring)k(single)f(r)n(ules)440
5413 y Ff(strategies)1831 5662 y Fm(67)p eop
%%Page: 68 71
68 70 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)527
631 y Ff(desugarRule)39 b(=)k(rec)g(x\(try\(Rcon;)c(x)k(+)g(Scope\(id,)
d(x\))j(+)g(RtoS\)\))440 883 y Fh(desugaring)32 b(stra)-6
b(tegies)440 1136 y Ff(strategies)527 1335 y(desugar)41
b(=)614 1435 y(topdown\(try\(desug)o(ar)o(Rul)o(e\))o(;)963
1534 y(repeat\(HL)f(+)j(\(Bapp0)e(<+)i(Bapp1)e(<+)i(Bapp2\))e(+)i
(Expl\)\))527 1733 y(desugar')d(=)k(topdown\(try\(des)o(uga)o(rR)o(ule)
o(\);)37 b(repeat\(HL\)\))527 1933 y(desugar-spec)i(=)k(map\(SDef\(id,)
c(id,)j(desugar\)\))1831 5662 y Fm(68)p eop
%%Page: 69 72
69 71 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fi(NEEDED)31 b(DEFINITIONS)p 440 635 2865 4 v 440
859 4 224 v 468 718 a Fm(Extract)g(those)g(de\014nitions)h(that)h(are)d
(needed)i(for)g(the)g(main)g(strategy)e(and)i(join)g(the)468
817 y(b)r(o)r(dies)c(of)g(op)r(erators)d(with)j(m)n(ultiple)g
(de\014nitions.)p 3301 859 V 440 862 2865 4 v 440 1062
a Ff(module)41 b(needed-defs)440 1162 y(imports)g(strategy)f(sugar)h
(stratlib)g(list-set)f(list-misc)g(lib)i(pack-graph)440
1403 y Fh(joining)32 b(definitions)440 1644 y Ff(strategies)527
1843 y(joindefs)40 b(=)k(JoinDefs1)39 b(<+)k(JoinDefs2)440
2042 y(rules)527 2241 y(JoinDefs1)d(:)614 2341 y([sdef])h(->)i(sdef)527
2540 y(JoinDefs2)d(:)614 2640 y(defs)i(@)h([SDef\(f,)e(xs,)h(s\))h(|)g
(_])g(->)g(SDef\(f,)d(ys,)j(<choices>)c(ss\))614 2739
y(where)j(<map\(new\)>)d(xs)k(=>)g(ys;)876 2839 y(<map\(MkCall\)>)38
b(ys)43 b(=>)g(ys';)876 2939 y(<map\({zs,)d(s:)i(?SDef\(f,)f(zs,)h
(s\);)g(!<ssubs>)f(\(zs,)h(ys',)g(s\)}\)>)f(defs)h(=>)h(ss)440
3180 y Fh(obt)-6 b(aining)32 b(needed)g(definitions)440
3421 y Ff(strategies)527 3620 y(choices)41 b(=)i(foldr\(!Fail,)c(\\)k
(\(s1,s2\))e(->)h(Choice\(s1,s2\))c(\\)44 b(\))527 3819
y(definition-names)37 b(=)614 3919 y(foldr\(![],)j(union,)h(\\)i
(SDef\(f,xs,_\))c(->)j([\(f,)g(<length>xs\)]\\)d(\))527
4118 y(all-defs)h(=)614 4218 y(\\)k(defs)d(->)i(\(<definition-name)o
(s>)37 b(defs,)k(defs,)h([]\))g(\\;)614 4317 y(graph-nodes-undef)o(-r)o
(oot)o(s\()o(get)o(-d)o(efi)o(ni)o(ti)o(on)1617 4417
y(,svars-arity)1617 4516 y(,\\)h(\(_,x,d\))d(->)j([x|d])f(\\)h(\);)614
4616 y(\(NoMissingDefs)38 b(<+)43 b(MissingDefs;)c(<exit>)i(1\))527
4815 y(needed-defs)e(=)614 4915 y(\\)44 b(defs)d(->)i(\(\("main",)d
(0\),)i(defs,)g([]\))g(\\;)614 5015 y(graph-nodes-undef)o(\(g)o(et-)o
(de)o(fin)o(it)o(ion)1355 5114 y(,svars-arity)1355 5214
y(,\\)h(\(_,x,d\))e(->)i([x|d])e(\\)i(\);)614 5313 y(\(NoMissingDefs)38
b(<+)43 b(MissingDefs;)c(<exit>)i(1\))1831 5662 y Fm(69)p
eop
%%Page: 70 73
70 72 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)527
531 y Ff(get-definition)38 b(=)745 631 y(CongruenceDef//;)f(debug)614
731 y(<+)43 b(OverloadedDef;)38 b(joindefs)614 830 y(<+)43
b(NonOverloadedDef)o(;)38 b(joindefs)440 1055 y Fm(A)25
b(strategy)e(op)r(erator)g(f)h(with)h(arit)n(y)f(n)g(is)h(needed.)36
b(All)24 b(de\014nitions)h(for)f(the)h(op)r(erator)d(are)440
1155 y(fetc)n(hed)28 b(and)g(joined.)37 b(Note)28 b(that)g(this)g(en)n
(tails)g(that)g(\(1\))g(op)r(erators)d(can)j(b)r(e)g(o)n(v)n(erloaded)
440 1255 y(and)f(\(2\))h(there)g(can)f(b)r(e)h(more)f(than)g(one)h
(de\014nition)g(of)f(an)g(op)r(erator.)440 1480 y Ff(rules)527
1679 y(OverloadedDef)38 b(:)614 1779 y(\(\(f,)k(n\),)h(defs\))e(->)i
(fdefs)614 1878 y(where)f(<filter\(SDef\(?f,)o(wh)o(ere)o(\(l)o(eng)o
(th)37 b(=>)43 b(n\),id\)\)>)d(defs)i(=>)h(fdefs)527
2078 y(NonOverloadedDef)37 b(:)614 2177 y(\(\(f,)42 b(0\),)h(defs\))e
(->)i(fdefs)614 2277 y(where)f(<filter\(SDef\(?f,)o(id)o(,id)o(\)\))o
(>)c(defs)j(=>)i(fdefs)527 2476 y(CongruenceDef)38 b(:)614
2576 y(\(\(Mod\(c,)j(mod\),)g(n\),)h(defs\))g(->)h(fdef)614
2675 y(where)f(<DefineCongruenc)o(e>)37 b(\(c,)42 b(mod,)g(n\))h(=>)g
(fdef)527 2875 y(NoMissingDefs)38 b(:)614 2974 y(\(defs,)j([]\))i(->)g
(defs)527 3173 y(MissingDefs)c(:)614 3273 y(\(defs,)i([f|fs]\))g(->)i
(defs)614 3373 y(where)f(<map\(MissingDefM)o(od)37 b(<+)43
b(MissingDef\)>)38 b([f|fs])527 3572 y(MissingDef)i(:)614
3672 y(\(f,)j(n\))f(->)h(<error>)e(["error:)f(operator)g(",)j(f,)g
("/",)f(n,)h(")g(undefined)d("])527 3871 y(MissingDefMod)e(:)614
3970 y(\(Mod\(c,)j(m\),)h(n\))h(->)614 4070 y(<error>)e(["error:)f
(operator)h(",)h(c,)h("^",)f(m)h(,)g("/",)f(n,)h(")g(undefined)d("])440
4395 y Fh(distributing)32 b(congr)n(uences)440 4564 y
Fm(F)-7 b(or)33 b(eac)n(h)g(constructor)f Ff(c)p Fm(,)i(there)g(is)f(a)
g(corresp)r(onding)f(distributing)h(congruence)f Ff(c^D)p
Fm(,)440 4664 y(de\014ned)c(according)e(to)h(the)h(follo)n(wing)f(sc)n
(heme:)527 4889 y Ff(c^D\(s1,...,sn\))38 b(:)43 b(Pair\(c\(x1,...,xn\))
o(,e)o(nv)o(\))38 b(->)k(c\(y1,...,yn\))527 4989 y(where)g(<s1>)g
(Pair\(x1,env\))c(=>)43 b(y1;)789 5088 y(...)789 5188
y(<sn>)f(Pair\(xn,)e(envn\))h(=>)i(yn)440 5413 y Fm(This)28
b(is)f(implemen)n(ted)h(b)n(y)g(the)g(follo)n(wing)e(rules.)1831
5662 y(70)p eop
%%Page: 71 74
71 73 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Ff(overlays)527 631 y(OpPair\(t1,)40 b(t2\))i(=)h(Op\("Pair",)d
([t1,t2]\))440 830 y(rules)527 930 y(DefineCongruence)d(:)614
1029 y(\(c,)43 b("D",)f(n\))g(->)614 1129 y(SDef\(Mod\(c,)d("D"\),)j
(ss,)g(Scope\([env)e(|)j(<conc>\(xs1,)c(ys1\)],)1835
1229 y(SRule\(Rule\(OpPai)o(r\()o(Op)o(\(c,)e(xs2\),)k(Var\(env\)\),)
2314 1328 y(Op\(c,)h(ys2\),)2314 1428 y(Seqs\(conds\)\)\)\)\))614
1528 y(where)g(new)g(=>)h(env;)876 1627 y(<copy\(MkDistAppl)o(ic)o(ati)
o(on)o(\);)37 b(tuple-unzip\(id\)>)g(\(n,)42 b(Var\(env\)\))1050
1727 y(=>)h(\(conds,)e(ss,)h(xs1,)g(xs2,)g(ys1,)g(ys2\))527
1926 y(MkDistApplication)37 b(:)614 2026 y(env)43 b(->)f
(\(BAM\(Call\(SVar\(s\))o(,[])o(\),)37 b(OpPair\(Var\(x\),)h(env\),)j
(Var\(y\)\),)963 2125 y(s,)i(x,)g(Var\(x\),)d(y,)j(Var\(y\)\))614
2225 y(where)f(new)g(=>)h(s;)g(new)f(=>)h(x;)g(new)f(=>)h(y)440
2477 y Fh(threading)32 b(congr)n(uences)440 2647 y Fm(F)-7
b(or)41 b(eac)n(h)f(constructor)g Ff(c)p Fm(,)k(there)d(is)g(a)g
(corresp)r(onding)e(threading)i(congruence)e Ff(c^T)p
Fm(,)440 2746 y(de\014ned)28 b(according)e(to)h(the)h(follo)n(wing)f
(sc)n(heme:)527 2999 y Ff(c^T\(s1,...,sn\))38 b(:)43
b(Pair\(c\(x1,...,xn\))o(,e)o(-f)o(irs)o(t\))37 b(->)43
b(Pair\(c\(y1,...,yn)o(\),)37 b(e-last\))527 3098 y(where)42
b(<s1>)g(Pair\(x1,e-first)o(\))c(=>)k(Pair\(y1,e2\);)1050
3198 y(...;)789 3298 y(<sn>)g(Pair\(xn,)e(en\))i(=>)h(Pair\(yn,)d
(e-last\))440 3550 y Fm(The)28 b(follo)n(wing)e(rules)h(implemen)n(t)h
(this)g(sc)n(heme:)527 3802 y Ff(DefineCongruence)37
b(:)614 3902 y(\(c,)43 b("T",)f(0\))g(->)614 4002 y(SDef\(Mod\(c,)d
("T"\),)j([],)g(Scope\([e],)1835 4101 y(SRule\(Rule\(OpPai)o(r\()o(Op)o
(\(c,)37 b([]\),)42 b(Var\(e\)\),)2314 4201 y(OpPair\(Op\(c,)d([]\),)j
(Var\(e\)\),)2314 4301 y(Id\)\)\)\))614 4400 y(where)g(new)g(=>)h(e)527
4599 y(DefineCongruence)37 b(:)614 4699 y(\(c,)43 b("T",)f(n\))g(->)614
4799 y(SDef\(Mod\(c,)d("T"\),)j(ss,)g(Scope\([e-first)c(|)43
b(<concat>)d([es,)i(xs1,)g(ys1]],)1835 4898 y(SRule\(Rule\(OpPai)o(r\()
o(Op)o(\(c,)37 b(xs2\),)k(Var\(e-first\)\),)2314 4998
y(OpPair\(Op\(c,)e(ys2\),)i(Var\(e-last\)\),)2314 5098
y(Seqs\(as\)\)\)\)\))614 5197 y(where)h(<copy\(new\)>)d
(\(<add>\(n,1\),)g(\(\)\))j(=>)h([e-first)d(|)j(es];)876
5297 y(<last>)e(es)i(=>)f(e-last;)876 5396 y(<zipr\(MkThreadAp)o(pl)o
(ica)o(ti)o(on\))o(;)37 b(tuple-unzip\(id\)>)g(\([e-first)j(|)j(es],)f
(es\))1831 5662 y Fm(71)p eop
%%Page: 72 75
72 74 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)1007
531 y Ff(=>)42 b(\(as,)g(ss,)h(xs1,)f(xs2,)g(ys1,)f(ys2\))527
631 y(MkThreadApplicati)o(on)c(:)614 731 y(\(e1,e2\))k(->)i
(\(BAM\(Call\(SVar\(s)o(\),)o([]\))o(,)37 b(OpPair\(Var\(x\),)h
(Var\(e1\)\),)2096 830 y(OpPair\(Var\(y\),)g(Var\(e2\)\)\),)1137
930 y(s,)43 b(x,)g(Var\(x\),)e(y,)h(Var\(y\)\))614 1029
y(where)g(new)g(=>)h(s;)g(new)f(=>)h(x;)g(new)f(=>)h(y)1831
5662 y Fm(72)p eop
%%Page: 73 76
73 75 bop 440 199 a Fm(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fi(INLINING)440 799 y Ff(module)41 b(inlining)440
899 y(imports)g(strategy)f(stratlib)g(lib)j(stratego-laws)440
1144 y Fh(inlining)31 b(with)h(definition)g(envir)n(onment)440
1313 y Fm(The)22 b(inlining)f(strategy)f(uses)h(an)g(en)n(vironmen)n(t)
g(with)h(all)f(the)h(de\014ninitions)g(to)f(b)r(e)h(inlined)440
1413 y(and)40 b(distributes)g(it)g(o)n(v)n(er)e(the)j(other)e
(de\014nitions,)k(substituting)e(b)r(o)r(dies)f(for)f(calls)g(to)440
1512 y(op)r(erators.)440 1682 y(Heuristics)26 b(for)f(inlining:)37
b(inline)26 b(all)g(op)r(erators)e(with)j(argumen)n(ts.)35
b(Also)26 b(n)n(ullary)f(op)r(era-)440 1781 y(tors)i(that)h(represen)n
(t)e(rules)h(\(do)h(a)f(matc)n(h)g(as)g(\014rst)g(action\).)440
2026 y Ff(strategies)527 2225 y(inlineIO)40 b(=)k(iowrap\(inline\))527
2424 y(inline)d(=)614 2524 y(repeat\(init-exand)o(;)919
2623 y(expand-definition)o(s\);)614 2723 y(rename-sdefs)527
2922 y(//)i(select)e(definitions)e(to)k(inline)527 3122
y(init-exand)d(=)614 3221 y(//map\(simplify0\);)614 3321
y(split\(filter\(not\()o(de)o(fin)o(it)o(ion)o(-t)o(o-i)o(nl)o(in)o
(e\)\))o(,)876 3421 y(filter\(definitio)o(n-)o(to-)o(in)o(lin)o(e\))o
(;)d(not\([]\)\))527 3620 y(definition-to-inl)o(in)o(e)g(=)614
3719 y(SDef\(id,)k([id|)h(id],)f(id\))i(+)614 3819 y
(SDef\(not\("main"\),)37 b([],)42 b(body-to-inline\))527
4018 y(body-to-inline)c(=)614 4118 y(rec)43 b(x\()789
4218 y(Id)789 4317 y(+)g(Fail)789 4417 y(+)g(Seq\(Match\(id\),)38
b(id\))789 4516 y(+)43 b(Scope\(id,)d(Seq\(Match\(id\),)e(id\)\))789
4616 y(+)43 b(Seq\(Scope\(id,)38 b(Seq\(Match\(id\),)g(id\)\),)j(id\))
789 4716 y(//)h(+)i(Choice\(x,)39 b(x\))789 4815 y(//)j(+)i
(LChoice\(x,)39 b(x\))614 4915 y(\))440 5114 y(strategies)527
5313 y(//)k(inlining)d(calls)1831 5662 y Fm(73)p eop
%%Page: 74 77
74 76 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)527 531 y Ff(expand-definition)o(s)37
b(=)614 631 y(env-topdown\(repea)o(t\()o(Exp)o(an)o(dCa)o(ll)g(\(*)43
b(+)g(Simplify)d(*\))j(\)\))440 830 y(rules)527 1029
y(ExpandCall)d(:)614 1129 y(\(Call\(SVar\(f\),)e(ss\),)k(env\))g(->)h
(\(<strename>)c(s,)k(<ExtendEnv>)c(\(xs,)j(ss,)g(env\)\))614
1229 y(where)g(<length>)e(ss)j(=>)g(n;)876 1328 y(<fetch\(SDef\(?f,)37
b(where\(length)i(=>)k(n\);)f(?xs)g(,)h(?s\)\)>)f(env)527
1528 y(ExpandCall)e(:)614 1627 y(\(Call\(SVar\(f\),)e(ss\),)k(env\))g
(->)h(\(Call\(SVar\(g\),)38 b(ss\),)j(env\))614 1727
y(where)h(<fetch\(?SDef\(f,)37 b([],)43 b(Call\(SVar\(g\),)38
b([]\)\)\)>)j(env)527 1926 y(ExtendEnv)f(:)614 2026 y(\(xs,)i(ss,)h
(env\))f(->)614 2125 y(<conc>)f(\(<zip\(\\)g(\(x,)h(s\))h(->)g
(SDef\(x,)e([],)h(s\)\\)g(\)>)h(\(xs,)f(ss\),)g(env\))440
2325 y(rules)527 2524 y(//)h(Rename)e(the)h(names)g(of)h(all)f
(top-level)e(strategy)g(definitions;)527 2623 y(//)j(The)f(Stratego)f
(syntax)g(cannot)g(be)i(used)e(for)i(names)e(of)i(C)g(functions.)527
2823 y(rename-sdefs)c(:)614 2922 y(sdefs)j(->)h(sdefs')614
3022 y(where)f(<filter\(NewName\))o(>)37 b(sdefs)42 b(=>)h(tbl;)876
3122 y(<map\(\(id,)d(MkCall\)\)>)g(tbl)i(=>)h(sbs;)876
3221 y(<map\(RenameSDef\()o(!t)o(bl,)37 b(!sbs\)\)>)j(sdefs)i(=>)h
(sdefs')527 3421 y(NewName)e(:)614 3520 y(SDef\(x,)g(_,)i(_\))g(->)f
(\(x,)h(<new>\(\)\))614 3620 y(where)f(not\(!x)f(=>)i("main"\))527
3819 y(RenameSDef\(mktbl,)37 b(mksbs\))k(:)614 3919 y(SDef\(x,)g(xs,)h
(s\))h(->)g(SDef\(y,)e(xs,)h(<ssubs>)f(\(<mksbs>\(\),)e(s\)\))614
4018 y(where)j(\(mktbl;)f(fetch\(?\(x,)e(y\)\)\))j(<+)h(\(!x)f(=>)h
(y\))440 4271 y Fm(TODO:)27 b(generate)g(a)g(name)g(that)h(lo)r(oks)f
(more)f(lik)n(e)i(the)g(original)e(name.)1831 5662 y(74)p
eop
%%Page: 75 78
75 77 bop 440 199 a Fm(Chapter:)36 b(Optimizer)440 531
y Ff(module)41 b(optimizer)440 631 y(imports)g(stratego)f
(stratego-laws)e(lib)440 830 y(strategies)527 1029 y(main)k(=)h
(iowrap\(optimizer\))527 1229 y(optimizer)d(=)j(downup\(repeat\(sim)o
(pl)o(ify)o(\)\))440 1481 y(\\literate[{\\btt)37 b(stratego-laws}])440
1680 y(\045)43 b($Id:)f(stratego-laws.r,)o(v)c(1.4)k(2001/01/20)d
(08:33:14)i(visser)g(Exp)h($)440 1880 y(\045)h(Copyright)d(\(C\))i
(1998,)g(1999,)f(2000)h(Eelco)g(Visser)f(<visser@acm.org>)440
1979 y(\045)440 2079 y(\045)i(This)f(program)f(is)i(free)e(software;)f
(you)j(can)f(redistribute)d(it)j(and/or)g(modify)440
2178 y(\045)h(it)g(under)e(the)i(terms)e(of)i(the)f(GNU)h(General)d
(Public)i(License)e(as)j(published)d(by)440 2278 y(\045)j(the)g(Free)e
(Software)g(Foundation;)e(either)i(version)g(2,)h(or)h(\(at)f(your)g
(option\))440 2378 y(\045)h(any)g(later)e(version.)440
2477 y(\045)440 2577 y(\045)i(This)f(program)f(is)i(distributed)c(in)j
(the)h(hope)f(that)g(it)g(will)g(be)h(useful,)440 2677
y(\045)g(but)g(WITHOUT)d(ANY)j(WARRANTY;)c(without)i(even)h(the)g
(implied)f(warranty)f(of)440 2776 y(\045)j(MERCHANTABILITY)38
b(or)k(FITNESS)f(FOR)h(A)i(PARTICULAR)39 b(PURPOSE.)84
b(See)42 b(the)440 2876 y(\045)h(GNU)g(General)d(Public)h(License)g
(for)h(more)g(details.)440 2976 y(\045)440 3075 y(\045)h(You)g(should)e
(have)h(received)e(a)j(copy)f(of)h(the)f(GNU)g(General)f(Public)g
(License)440 3175 y(\045)i(along)f(with)g(this)g(program;)e(if)j(not,)f
(write)f(to)i(the)f(Free)g(Software)440 3274 y(\045)h(Foundation,)c
(Inc.,)j(59)g(Temple)g(Place)f(-)i(Suite)f(330,)g(Boston,)e(MA)440
3374 y(\045)j(02111-1307,)c(USA.)440 3673 y(This)j(module)f(specifies)f
(basic)h(simplification)d(rules)k(for)g(strategies.)440
3872 y(\\begin{code})440 3972 y(module)f(stratego-laws)440
4071 y(imports)g(stratego)f(desugar)h(list)h(scope-laws)d(bind-laws)h
(idfail-laws)789 4171 y(congruence-laws)440 4271 y(strategies)527
4470 y(Simplify)g(=)614 4570 y(ElimId)614 4669 y(+)k(ElimFail)614
4769 y(+)g(AssociateR)614 4868 y(+)g(Idempotency)614
4968 y(+)g(EmptyScope)527 5167 y(Optimize)c(=)614 5267
y(Simplify)614 5367 y(+)k(HL)1831 5662 y Fm(75)p eop
%%Page: 76 79
76 78 bop 440 199 a Fm(Chapter:)36 b(Optimizer)614 531
y Ff(+)44 b(HoistLet)614 631 y(+)g(CopyPropagation)614
731 y(+)g(FuseScope)614 830 y(+)g(NoEffect)614 930 y(+)g(\(Inline)c(<+)
j(InlineDont\))527 1129 y(simplify0)d(=)614 1229 y(downup\(repeat\(Sim)
o(pl)o(ify)o(\)\))527 1428 y(simplify)g(=)614 1528 y
(downup\(repeat\(Opt)o(im)o(ize)o(\)\))527 1727 y(simplify-cong)e(=)614
1826 y(downup\(repeat\(Opt)o(im)o(ize)f(+)43 b(MatchingCongruen)o(ce\))
o(\);)614 1926 y(topdown\(try\(Narro)o(wS)o(cop)o(e\))o(\))527
2125 y(simplify-widen)38 b(=)614 2225 y(downup\(repeat\(Opt)o(im)o(ize)
f(+)43 b(WidenScope\)\);)614 2325 y(topdown\(try\(Clean)o(up)o(Sco)o
(pe)o(;)38 b(try\(FuseScope\)\))o(\))440 2524 y(rules)527
2723 y(Commutativity)g(:)614 2823 y(Choice\(x,)i(y\))j(->)g(Choice\(y,)
d(x\))527 3022 y(AssociateR:)614 3122 y(Choice\(Choice\(x,)d(y\),)43
b(z\))f(->)h(Choice\(x,)d(Choice\(y,)g(z\)\))527 3321
y(AssociateR)g(:)614 3421 y(Seq\(Seq\(x,)g(y\),)i(z\))h(->)g(Seq\(x,)e
(Seq\(y,)g(z\)\))527 3620 y(AssociateR)f(:)614 3719 y
(LChoice\(LChoice\(x)o(,)d(y\),)43 b(z\))g(->)f(LChoice\(x,)e
(LChoice\(y,)f(z\)\))527 3919 y(AssociateL:)614 4018
y(Seq\(s1,)i(Seq\(s2,)g(s3\)\))h(->)g(Seq\(Seq\(s1,)d(s2\),)j(s3\))527
4218 y(Idempotency)d(:)614 4317 y(Choice\(x,)h(x\))87
b(->)42 b(x)527 4417 y(Idempotency)d(:)614 4516 y(LChoice\(x,)h(x\))j
(->)f(x)527 4616 y(Idempotency)d(:)614 4716 y(Where\(Where\(s\)\))81
b(->)43 b(Where\(s\))527 4815 y(Idempotency)c(:)614 4915
y(Not\(Not\(s\)\))g(->)k(Test\(s\))527 5015 y(Idempotency)c(:)614
5114 y(Test\(Test\(s\)\))g(->)j(Test\(s\))527 5214 y(Idempotency)d(:)
614 5313 y(Where\(Seq\(Where\(s)o(1\))o(,)f(Seq\(Build\(t\),)g
(s2\)\)\))j(->)614 5413 y(Where\(Seq\(s1,)e(Seq\(Build\(t\),)f
(s2\)\)\))1831 5662 y Fm(76)p eop
%%Page: 77 80
77 79 bop 440 199 a Fm(Chapter:)36 b(Optimizer)440 531
y Ff(\\end{code})440 784 y(module)41 b(bind-laws)440
883 y(imports)g(stratego)440 983 y(strategies)440 1083
y(rules)527 1282 y(//)i(inlining)d(with)i(contextual)e(rules)527
1481 y(InlineC1)g(:)614 1581 y(Let\(SDef\(f,)f([],)k(s1\),)f
(s2[Call\(SVar\(f\))o(,)c([]\)]\))j(->)614 1680 y(Let\(SDef\(f,)e([],)k
(s1\),)f(s2[<strename>)c(s1]\))527 1880 y(InlineC2)i(:)614
1979 y(Let\(SDef\(f,)f(xs@[_|_],)h(s1\),)i(s2[Call\(SVar\(f\),)37
b(ss\)]\))42 b(->)614 2079 y(Let\(SDef\(f,)d(xs,)k(s1\),)440
2178 y(s2[<ssubs;)c(strename>)h(\(xs,)i(ss,)h(s1\)]\))527
2378 y(InlineC3)d(:)614 2477 y(Let\(SDef\(f,)f(xs@[_|_],)h(s1\),)i
(s2[Call\(SVar\(f\),)37 b(ss\)]\))42 b(->)614 2577 y(Let\(SDef\(f,)d
(xs,)k(s1\),)440 2677 y(s2[<zip\(\\)d(\(x,)i(s\))h(->)g(SDef\(x,)d([],)
j(s\)\\)f(\);)963 2776 y(foldr\(!s1,)d(\\)44 b(\(def,)d(s\))i(->)g
(Let\(def,)d(s\)\\)i(\);)614 2876 y(strename>)e(\(xs,)i(ss\)]\))527
3075 y(//)h(inlining)d(with)i(hand-made)e(contextual)f(traversal)527
3274 y(Inline1)i(:)614 3374 y(Let\(SDef\(f,)e([],)k(s\),)f
(Call\(SVar\(f\),)c([]\)\))k(->)h(s)527 3573 y(Inline)e(:)614
3673 y(Let\(SDef\(f,)e([],)k(s1\),)f(s2\))g(->)h(s2')614
3773 y(where)f(<oncetd-stop\(?Ca)o(ll)o(\(SV)o(ar)o(\(f\))o(,[)o(]\))o
(;)c(!s1,)1225 3872 y(Case\(id,id,id,i)o(d\))f(+)43 b
(Matrix\(id,id\)\)>)38 b(s2)k(=>)h(s2';)876 3972 y(<not\('in\)>)c
(\(Call\(SVar\(f\),[]\))o(,)e(s2'\))527 4171 y(InlineDont)j(:)614
4271 y(Let\(SDef\(f,)f([],)k(s1\),)f(s2\))g(->)614 4370
y(Let\(SDef\([DontInl)o(in)o(e],)37 b(f,)43 b([],)f(s1\),)g(s2\))527
4570 y(//)h(dead)f(code)g(elimination)527 4769 y(Dead)g(:)614
4868 y(Let\(SDef\(f,)d(xs,)k(s1\),)f(s2\))g(->)h(s2)614
4968 y(where)f(<not\('in\)>)d(\(SVar\(f\),)h(s2\))527
5167 y(//)j(hoisting)d(let)j(bindings)527 5367 y(HoistLet)d(:)1831
5662 y Fm(77)p eop
%%Page: 78 81
78 80 bop 440 199 a Fm(Chapter:)36 b(Optimizer)614 531
y Ff(Seq\(s1,)41 b(Let\(sdef,)f(s2\)\))i(->)614 631 y(Let\(sdef,)e
(Seq\(s1,)h(s2\)\))527 830 y(HoistLetFromCase)c(:)614
930 y(Case\(lab,)j(t,)j(alts,)e(def\))h(->)614 1029 y(Lets\(sdefs,)d
(Case\(lab,)h(t,)j(alts',)e(def\)\))614 1129 y(where)h
(<map\(AltGiveSDef)o(\)>)37 b(alts)42 b(=>)h(sdefs)e(=>)i([_|_];)876
1229 y(<map\(AltDropLet\))o(>)37 b(alts)42 b(=>)h(alts')527
1428 y(AltDropLet)d(:)614 1528 y(Alt\(c,)h(args,)h(Let\(sdef,)e(s\)\))i
(->)h(Alt\(c,)e(args,)h(s\))527 1727 y(AltGiveSDef)d(:)614
1826 y(Alt\(c,)i(args,)h(Let\(sdef,)e(s\)\))i(->)h(sdef)440
2026 y(rules)527 2225 y(NoEffect)d(:)614 2325 y(Seq\(Build\(t1\),)e
(Seq\(Build\(t2\),)g(s\)\))k(->)614 2424 y(Seq\(Build\(t2\),)c(s\))527
2623 y(CopyPropagation)g(:)614 2723 y(Seq\(Build\(t\),)h(Scope\(xs,)g
(Seq\(Assign\(Var\(x\))o(\),)e(s\)\)\))42 b(->)614 2823
y(Seq\(Build\(t\),)d(Scope\(ys,)g(<tsubs>)i(\([x],)h([t],)g(s\)\)\))614
2922 y(where)g(<'in>)f(\(x,)i(xs\);)f(<diff>)f(\(xs,)h([x]\))g(=>)g(ys)
527 3122 y(CopyPropagation)c(:)614 3221 y(Scope\(xs,)i
(Seq\(Assign\(Var\(x\))o(,)d(Var\(y\)\),)k(s\)\))h(->)614
3321 y(Scope\(ys,)e(<tsubs>)h(\([x],)g([Var\(y\)],)f(s\)\))614
3421 y(where)i(<'in>)f(\(x,)i(xs\);)f(<diff>)f(\(xs,)h([x]\))g(=>)g(ys)
527 3620 y(CopyPropagation)c(:)614 3719 y(Scope\(xs,)i
(Seq\(Assign\(Var\(x\))o(\),)d(Seq\(Assign\(Var\(y)o(\)\))o(,)h
(s\)\)\))k(->)614 3819 y(Scope\(ys,)e(Seq\(Assign\(Var\(x\))o(\),)d
(<tsubs>)k(\([y],)g([Var\(x\)],)f(s\)\)\))614 3919 y(where)i(<'in>)f
(\(x,)i(xs\);)f(<'in>)f(\(y,)i(xs\);)e(<diff>)h(\(xs,)f([y]\))h(=>)h
(ys)527 4118 y(CopyPropagation)38 b(:)614 4218 y(Scope\(xs,)i
(Seq\(Assign\(Var\(x\))o(\),)d(Seq\(Assign\(Var\(y)o(\),)g(Var\(x\)\),)
j(s\)\)\))i(->)614 4317 y(Scope\(ys,)e(Seq\(Assign\(Var\(x\))o(\),)d
(<tsubs>)k(\([y],)g([Var\(x\)],)f(s\)\)\))614 4417 y(where)i(<'in>)f
(\(x,)i(xs\);)f(<'in>)f(\(y,)i(xs\);)e(<diff>)h(\(xs,)f([y]\))h(=>)h
(ys)527 4616 y(CopyPropagation)38 b(:)614 4716 y(Seq\(Assign\(Var\(x\))
o(\),)f(Seq\(Build\(Var\(x\))o(\),)g(s\)\))43 b(->)614
4815 y(Seq\(Assign\(Var\(x\))o(\),)37 b(s\))527 5015
y(CopyPropagationNo)o(tV)o(al)o(id)g(:)614 5114 y(Seq\(Assign\(x\),)h
(Seq\(Assign\(y,x\),)f(s\)\))42 b(->)614 5214 y(Seq\(Assign\(x\),)c
(Seq\(Assign\(y\),)g(s\)\))1831 5662 y Fm(78)p eop
%%Page: 79 82
79 81 bop 440 199 a Fm(Chapter:)36 b(Optimizer)440 531
y Ff(module)41 b(idfail-laws)440 631 y(imports)g(stratego)440
731 y(strategies)527 930 y(ElimId)g(=)i(I1)g(+)g(I2)g(+)g(I3)g(+)g(I4)g
(+)g(I7)g(+)g(I8)g(+)g(I9)g(+)g(I10)f(+)h(I12)g(+)g(I16)440
1129 y(rules)527 1229 y(I1)87 b(:)43 b(Test\(Id\))345
b(->)43 b(Id)527 1328 y(I2)87 b(:)43 b(Not\(Id\))389
b(->)43 b(Fail)527 1428 y(I3)87 b(:)43 b(Seq\(Id,)d(s\))261
b(->)43 b(s)527 1528 y(I4)87 b(:)43 b(Seq\(s,)e(Id\))260
b(->)43 b(s)527 1627 y(I5)87 b(:)43 b(Choice\(s,)d(Id\))129
b(->)43 b(Id)g(//)f(!!!)h(very)f(aggressive)d(!)527 1727
y(I6)87 b(:)43 b(Choice\(Id,)c(s\))130 b(->)43 b(Id)g(//)f(!!!)h(very)f
(aggressive)d(!)527 1826 y(I7)87 b(:)43 b(LChoice\(Id,)c(s\))86
b(->)43 b(Id)527 1926 y(I8)87 b(:)43 b(Scope\(xs,)d(Id\))129
b(->)43 b(Id)527 2026 y(I9)87 b(:)43 b(Rec\(x,Id\))301
b(->)43 b(Id)527 2125 y(I10)g(:)g(All\(Id\))389 b(->)43
b(Id)527 2225 y(I12)g(:)g(Where\(Id\))301 b(->)43 b(Id)527
2325 y(I16)g(:)g(Match\(Wld\))257 b(->)43 b(Id)527 2524
y(NotValid)d(:)k(One\(Id\))171 b(->)43 b(Id)527 2623
y(NotValid)d(:)k(Some\(Id\))127 b(->)43 b(Id)440 2823
y(strategies)527 3022 y(ElimFail)d(=)614 3122 y(F1)j(+)g(F2)g(+)g(F3)g
(+)g(F5)g(+)g(F6)g(+)g(F7)g(+)g(F8)g(+)g(F9)g(+)g(F10)f(+)614
3221 y(F11)h(+)g(F12)f(+)h(F13)g(+)g(F14)f(+)h(F15)440
3421 y(rules)527 3620 y(F1)87 b(:)43 b(Test\(Fail\))301
b(->)42 b(Fail)527 3719 y(F2)87 b(:)43 b(Not\(Fail\))345
b(->)42 b(Id)527 3819 y(F3)87 b(:)43 b(Seq\(Fail,)d(s\))217
b(->)42 b(Fail)527 3919 y(F4)87 b(:)43 b(Seq\(s,)e(Fail\))216
b(->)42 b(Fail)g(//)h(!)g(not)g(valid)e(with)h(side)g(effects)527
4018 y(F5)87 b(:)43 b(Scope\(xs,)d(Fail\))85 b(->)42
b(Fail)527 4118 y(F6)87 b(:)43 b(Rec\(x,Fail\))257 b(->)42
b(Fail)527 4218 y(F7)87 b(:)43 b(Some\(Fail\))301 b(->)42
b(Fail)527 4317 y(F8)87 b(:)43 b(One\(Fail\))345 b(->)42
b(Fail)527 4417 y(F9)87 b(:)43 b(Path\(i,Fail\))213 b(->)42
b(Fail)527 4516 y(F10)h(:)g(Cong\(f,)d(ls\))261 b(->)42
b(Fail)g(where)g(<fetch\(?Fail\)>)c(ls)527 4616 y(F11)43
b(:)g(Choice\(Fail,)38 b(s\))87 b(->)42 b(s)527 4716
y(F12)h(:)g(Choice\(s,)d(Fail\))85 b(->)42 b(s)527 4815
y(F13)h(:)g(LChoice\(Fail,)38 b(s\))43 b(->)f(s)527 4915
y(F14)h(:)g(LChoice\(s,)c(Fail\))j(->)g(s)527 5015 y(F15)h(:)g
(Where\(Fail\))257 b(->)42 b(Fail)527 5214 y(NotValid)e(:)k
(All\(Fail\))39 b(->)k(Fail)1831 5662 y Fm(79)p eop
%%Page: 80 83
80 82 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 531 y Ff(module)41 b(scope-laws)440
631 y(imports)g(stratego)f(list-set)440 830 y(rules)527
1029 y(EmptyScope:)614 1129 y(Scope\([],)g(s\))j(->)g(s)527
1328 y(FuseScope)d(:)614 1428 y(Scope\(xs,)g(Scope\(ys,)g(s\)\))i(->)h
(Scope\(<conc>)c(\(xs,)j(ys\),)g(s\))527 1627 y(WidenScope)e(:)614
1727 y(Seq\(Scope\(xs,)f(s1\),)i(s2\))i(->)614 1826 y(Scope\(xs,)d
(Seq\(s1,)h(s2\)\))527 2026 y(WidenScope)f(:)614 2125
y(Seq\(s1,)h(Scope\(xs,)f(s2\)\))i(->)614 2225 y(Scope\(xs,)e(Seq\(s1,)
h(s2\)\))527 2424 y(CleanupScope)e(:)614 2524 y(Scope\(xs,)h(s\))j(->)g
(Scope\(ys,)d(s\))614 2623 y(where)i(<isect>)f(\(xs,)g(<tvars>)g(s\))i
(=>)g(ys;)f(not\(?xs\))527 2823 y(NarrowScope)d(:)614
2922 y(Scope\(xs,)h(Seq\(s1,)h(s2\)\))h(->)614 3022 y(Scope\(ys,)e
(Seq\(s1,)h(Scope\(zs,)f(s2\)\)\))614 3122 y(where)i(<isect>)f
(\(<tvars>)f(s1,)i(xs\))h(=>)f(ys;)876 3221 y(<diff>)f(\(xs,)h(ys\))g
(=>)h(zs;)f(not\([]\))440 3573 y(module)f(congruence-laws)440
3673 y(imports)g(stratego)440 3872 y(rules)527 4071 y
(MatchingCongruenc)o(e)c(:)614 4171 y(Cong\(f,)k(ss\))h(->)h
(Match\(Op\(f,)c(ts\)\))614 4271 y(where)j(<map\(\\)f(Match\(t\))f(->)j
(t)g(\\)g(+)h(\\)f(Id)f(->)h(Wld)g(\\)g(\)>)f(ss)h(=>)g(ts)527
4470 y(TransformingCongr)o(ue)o(nc)o(e)38 b(:)614 4570
y(Cong\(f,)j(ss\))h(->)614 4669 y(Scope\(xs,)e(Seq\(Match\(Op\(f,)e
(xs'\)\),)1225 4769 y(Build\(Op\(f,)h(ts\)\)\)\))614
4868 y(where)j(<map\(new\)>)d(ss)k(=>)g(xs;)876 4968
y(<map\(\\)e(x)i(->)g(Var\(x\))e(\\)i(\)>)g(xs)g(=>)f(xs';)876
5068 y(<zip\(\\)f(\(x,)h(s\))h(->)g(App\(s,)e(x\))i(\\)g(\)>)g(\(xs',)e
(ss\))h(=>)h(ts)1831 5662 y Fm(80)p eop
%%Page: 81 84
81 83 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)440
531 y Ff(module)41 b(compile-match)440 631 y(imports)g(match-to-matrix)
c(matrix-to-dfa)440 830 y(strategies)527 1029 y(//)43
b(the)f(following)e(optimization)f(algorithm)h(has)i(been)g(split)f
(into)527 1129 y(//)i(three)e(separate)g(components:)e(optimize1,)g
(compile-match,)f(optimize2)527 1328 y(optimize)i(=)527
1428 y(apply-to-bodies\()614 1528 y(simplify-cong;)614
1627 y(match-to-dfa;)614 1727 y(simplify;)614 1826 y(simplify-widen)527
1926 y(\))527 2125 y(optimize-body)e(=)614 2225 y(simplify-cong;)614
2325 y(match-to-dfa;)614 2424 y(simplify;)614 2524 y(simplify-widen)527
2723 y(apply-to-bodies\(s)o(\))f(=)43 b(map\(SDef\(id,id,s\))o(\))527
2922 y(optimize1-comp)38 b(=)614 3022 y(iowrap\(apply-to-b)o(od)o(ies)o
(\(s)o(imp)o(li)o(fy-)o(co)o(ng)o(\)\))527 3221 y(compile-match-com)o
(p)f(=)614 3321 y(iowrap\(apply-to-b)o(od)o(ies)o(\(m)o(atc)o(h-)o(to-)
o(df)o(a\))o(\))527 3520 y(optimize2-comp)h(=)614 3620
y(iowrap\(apply-to-b)o(od)o(ies)o(\(s)o(imp)o(li)o(fy;)f
(simplify-widen\))o(\))527 3819 y(match-to-dfa)i(=)614
3919 y(match-to-matrix;)614 4018 y(matrix-to-dfa;)614
4118 y(strename)440 4370 y(module)i(match-to-matrix)440
4470 y(imports)g(stratego)f(matrix)h(desugar)g(stratego-laws)440
4669 y(strategies)527 4868 y(match-to-matrix)d(=)614
4968 y(downup\(repeat\(Mat)o(ch)o(ToM)o(at)o(rix)f(+)43
b(MatrixMerge)c(+)k(Simplify\)\))440 5167 y(rules)527
5367 y(MatchToMatrix)38 b(:)1831 5662 y Fm(81)p eop
%%Page: 82 85
82 84 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)614
531 y Ff(Match\(t\))41 b(->)h(<term-to-matrix>)37 b(t)527
731 y(MatrixMerge)i(:)614 830 y(Seq\(Matrix\(ps,)f([Row\(ts,)i
(s1\)]\),)i(s2\))g(->)614 930 y(Matrix\(ps,)e([Row\(ts,)g(Seq\(s1,)h
(s2\)\)]\))527 1129 y(MatrixMerge)e(:)614 1229 y(Scope\(xs,)h
(Matrix\(ps,)g(rows\)\))h(->)614 1328 y(Matrix\(ps,)f(<map\(\\)h
(Row\(ts,)g(s\))h(->)h(Row\(ts,)e(Scope\(xs,)f(s\)\))i(\\)h(\)>)g
(rows\))527 1528 y(MatrixMerge)c(:)614 1627 y(Choice\(Matrix\(ps1)o(,)e
(rows1\),)k(Matrix\(ps2,)e(rows2\)\))i(->)614 1727 y(Matrix\(<union>)d
(\(ps1,)k(ps2\),)f(<conc>)g(\(rows1,)g(rows2\)\))527
1926 y(MatrixMerge)e(:)614 2026 y(Choice\(Matrix\(ps1)o(,)e(rows1\),)k
(Choice\(Matrix\(ps2)o(,)c(rows2\),)k(s\)\))h(->)614
2125 y(Choice\(Matrix\(<un)o(io)o(n>)37 b(\(ps1,)42 b(ps2\),)f(<conc>)g
(\(rows1,)g(rows2\)\),)f(s\))527 2325 y(MatrixMerge)f(:)614
2424 y(Choice\(Matrix\(ps1)o(,)e(rows1\),)k(LChoice\(Matrix\(ps)o(2,)c
(rows2\),)k(s\)\))h(->)614 2524 y(LChoice\(Matrix\(<u)o(ni)o(on>)37
b(\(ps1,)k(ps2\),)h(<conc>)f(\(rows1,)g(rows2\)\),)f(s\))527
2723 y(MatrixMerge)f(:)614 2823 y(LChoice\(Matrix\(ps)o(1,)e(rows1\),)k
(Matrix\(ps2,)e(rows2\)\))h(->)614 2922 y(Matrix\(<union>)e(\(ps1,)k
(ps2\),)f(<conc>)g(\(rows1,)g(rows2\)\))527 3122 y(MatrixMerge)e(:)614
3221 y(LChoice\(Matrix\(ps)o(1,)e(rows1\),)k(LChoice\(Matrix\(p)o(s2)o
(,)c(rows2\),)k(s\)\))i(->)614 3321 y(LChoice\(Matrix\(<u)o(ni)o(on>)37
b(\(ps1,)k(ps2\),)h(<conc>)f(\(rows1,)g(rows2\)\),)f(s\))527
3520 y(MatrixMerge)f(:)614 3620 y(LChoice\(Matrix\(ps)o(1,)e(rows1\),)k
(Choice\(Matrix\(ps)o(2,)c(rows2\),)k(s\)\))h(->)614
3719 y(LChoice\(Matrix\(<u)o(ni)o(on>)37 b(\(ps1,)k(ps2\),)h(<conc>)f
(\(rows1,)g(rows2\)\),)f(s\))527 3919 y(//)j(The)f(following)e(rule)i
(is)h(invalid)e(because)f(of)j(the)f(inequality)527 4018
y(//)527 4118 y(//)87 b(\(s1)42 b(+)h(s2\);)f(s3)h(=/=)f(\(s1;)g(s3\))g
(+)i(\(s2;)d(s3\))527 4218 y(//)527 4317 y(//)i(Also)f(it)h(leads)e(to)
i(code)f(explosion)527 4516 y(MatrixMergeNotVal)o(id)37
b(:)614 4616 y(Seq\(Matrix\(ps,)h(rows\),)j(s1\))i(->)614
4716 y(Matrix\(ps,)d(<map\(\\)h(Row\(ts,)g(s2\))h(->)h(Row\(ts,)d
(Seq\(s2,)h(s1\)\))h(\\)h(\)>)g(rows\))527 5015 y(//)g(In)g(some)f
(cases)f(it)i(might)e(be)i(interesting)c(to)k(consider)d(though,)h
(e.g.,)527 5114 y(//)i(if)g(s1)f(is)h(small)f(and)g(always)f(succeeds.)
440 5367 y(module)g(matrix)1831 5662 y Fm(82)p eop
%%Page: 83 86
83 85 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)440
531 y Ff(imports)41 b(stratego)f(automaton)440 631 y(signature)527
731 y(\(*)j(subsorts)d(Matrix)h(<)i(Strat)f(*\))527 830
y(constructors)614 930 y(Row)173 b(:)44 b(List\(Term\))39
b(*)k(Strat)f(->)86 b(Row)614 1029 y(Row)173 b(:)44 b(List\(Term\))39
b(*)k(List\(Term\))d(*)j(Strat)e(->)87 b(Row)614 1129
y(Matrix)41 b(:)j(List\(List\(Int\)\))37 b(*)43 b(List\(Row\))d(->)j
(Matrix)614 1229 y(Matrix)e(:)j(List\(Row\))39 b(->)k(Matrix)614
1328 y(Off)173 b(:)44 b(List\(Int\))39 b(->)k(Term)440
1528 y(strategies)440 1727 y(//)g(Creating)d(a)j(matrix)e(from)h(a)h
(term)527 1926 y(term-to-matrix)38 b(=)614 2026 y(\\)44
b(t)f(->)f(As\(Off\([]\),)d([t]\))j(\\;)614 2125 y(topdown\(try\(Propa)
o(ga)o(te\))o(\);)614 2225 y(collect-substitut)o(io)o(ns;)614
2325 y(\\)i(\(ts,)d(s\))i(->)g(Matrix\(<collect-)o(off)o(se)o(ts)o(>)38
b(ts,)k([Row\(ts,)e(Seqs\(s\)\)]\))g(\\)527 2524 y(collect-offsets)e(=)
614 2623 y(collect\()j(\\)i(Off\(p\))e(->)i(p)g(\\)g(\))440
2823 y(//)g(Renaming)d(the)i(matrix)f(to)i(obtain)e(the)i(same)f
(variables)d(based)j(on)h(position)440 2922 y(//)g(relative)d(to)j(the)
f(root)g(in)h(all)f(patterns)527 3122 y(rename-matrix)c(=)614
3221 y(Matrix\(map\(rename)o(-r)o(ow\))o(\);)614 3321
y(\\)44 b(Matrix\(rows\))38 b(->)702 3421 y(Matrix\(<map\()g(\\)43
b(Row\(ts,s\))d(->)j(ts)g(\\)g(\);)g(collect-offsets)o(>)38
b(rows,)j(rows\))h(\\)527 3620 y(rename-row)e(=)614 3719
y(RenameRow;)614 3819 y(Row\(topdown\(try\(P)o(ro)o(pag)o(at)o(e\)\))o
(,)d(id\);)614 3919 y(AddRowSubstitutio)o(ns)440 4118
y(rules)527 4317 y(RenameRow)j(:)614 4417 y(Row\(ts,)h(fin\))h(->)h
(Row\(As\(Off\([]\),)37 b(ts\),)42 b(fin\))527 4616 y(Propagate)e(:)614
4716 y(As\(Off\(path\),)f(Op\(f,)i(ts\)\))h(->)h(As\(Off\(path\),)38
b(Op\(f,)j(As\(Off\(path\),)e(ts\)\)\))527 4915 y(Propagate)h(:)614
5015 y(As\(Off\(path\),)f(As\(Var\(x\),)g(t\)\))j(->)h(As\(Var\(x\),)d
(As\(Off\(path\),)e(t\)\))527 5214 y(Propagate)i(:)614
5313 y(As\(Off\(path\),)f(BuildDefault\(t\))o(\))f(->)k
(As\(Off\(path\),)c(Wld\))1831 5662 y Fm(83)p eop
%%Page: 84 87
84 86 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)527
531 y Ff(Propagate)40 b(:)614 631 y(As\(Off\(path\),)f(ts\))j(->)h(ts')
614 731 y(where)f(<nzip0\(Annotate\()o(!p)o(ath)o(\)\))o(>)c(ts)k(=>)h
(ts')527 930 y(Annotate\(mkpath\))37 b(:)614 1029 y(\(i,)43
b(t\))f(->)h(As\(Off\([i)d(|)j(path]\),)e(t\))614 1129
y(where)h(mkpath)f(=>)i(path)440 1328 y(//)g(Replace)d(variables)g(by)j
(wildcards)d(and)i(add)h(renamings)c(from)j(new)h(to)g(old)440
1428 y(//)g(variables)440 1627 y(rules)527 1826 y(AddRowSubstitutio)o
(ns)37 b(:)614 1926 y(Row\(ts,)k(s\))i(->)g(Row\(ts',)d
(Seq\(Seqs\(sbs\),)e(s\)\))614 2026 y(where)k(<collect-substit)o(ut)o
(ion)o(s>)37 b(ts)43 b(=>)f(\(ts',)g(sbs\))440 2225 y(//)h(Collecting)c
(substitution)440 2424 y(strategies)527 2623 y(collect-substitut)o(io)o
(ns)e(=)614 2723 y(collect-split\(Ign)o(or)o(eVa)o(r,)g(CollectSubst\))
440 2922 y(rules)527 3122 y(IgnoreVar)j(:)614 3221 y(As\(Off\(path\),)f
(Var\(x\)\))h(->)j(As\(Off\(path\),)38 b(Wld\))k(where)g(<is-list>)e
(path)527 3421 y(IgnoreVar)g(:)614 3520 y(As\(Var\(x\),)g
(As\(Off\(path\),)e(t\)\))k(->)h(As\(Off\(path\),)38
b(t\))527 3719 y(CollectSubst)h(:)614 3819 y(As\(Off\(path\),)g
(Var\(x\)\))h(->)j([Assign\(Var\(x\),)37 b(Var\(path\)\)])527
4018 y(CollectSubst)i(:)614 4118 y(As\(Var\(x\),)h(As\(Off\(path\),)e
(t\)\))k(->)h([Assign\(Var\(x\),)37 b(Var\(path\)\)])440
4570 y(module)k(automaton)440 4669 y(imports)g(stratego)440
4868 y(signature)527 4968 y(constructors)614 5068 y(Final)85
b(:)44 b(List\(Int\))39 b(->)k(Automaton)614 5167 y(Case)129
b(:)44 b(String)d(*)i(Path)f(*)h(List\(Alt\))d(*)j(Automaton)d(->)j
(Automaton)614 5267 y(Alt)173 b(:)44 b(String)d(*)i(List\(Path\))c(*)44
b(Automaton)39 b(->)k(Automaton)1831 5662 y Fm(84)p eop
%%Page: 85 88
85 87 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)614
531 y Ff(Continue)41 b(:)i(String)e(->)i(Automaton)614
731 y(//)g(Assign\(t1,)d(t2\))i(assigns)f(t2)h(to)h(t1)614
930 y(Assign)e(:)j(Term)e(*)h(Term)f(->)g(Term)614 1129
y(//)h(Assign\(t\))d(assigns)h(the)h(current)f(term)h(to)g(the)h(term)f
(t)614 1328 y(Assign)f(:)j(Term)e(->)g(Term)440 1581
y(//)h(Translating)c(renamed)h(matrix)i(to)g(automaton)440
1780 y(module)f(matrix-to-dfa)440 1880 y(imports)g(matrix)g
(stratego-laws)d(desugar)j(match-to-matrix)440 2079 y(strategies)527
2278 y(matrix-to-dfa)d(=)614 2378 y(init-matrix-table)o(;)614
2477 y(topdown\(repeat\(re)o(du)o(ce-)o(ma)o(tri)o(x)f(+)44
b(MatrixScope)39 b(+)k(Simplify\)\);)614 2577 y(destroy-matrix-ta)o(bl)
o(e)527 2776 y(reduce-matrix)38 b(=)614 2876 y(\(MatrixSeenBefore)f(<+)
658 2976 y(MatrixRowsEmpty)g(<+)658 3075 y(SkipWild)j(<+)658
3175 y(ShiftColumn)f(<+)658 3274 y(Mixture\))440 3474
y(strategies)527 3673 y(//)k(Matrix)e(memoization)e(table)j(interface)
527 3872 y(init-matrix-table)37 b(=)614 3972 y(where\(<create-tab)o(le)
o(>)h("matrix"\))527 4171 y(destroy-matrix-ta)o(bl)o(e)f(=)614
4271 y(where\(<destroy-ta)o(bl)o(e>)g("matrix"\))440
4470 y(rules)527 4669 y(memo-matrix)i(:)614 4769 y(\(m,)k(f\))f(->)h
(<table-put>)c(\("matrix",)h(m,)i(f\))527 4968 y(matrix-is-defined)37
b(:)614 5068 y(m)44 b(->)e(<table-get>)d(\("matrix",)h(m\))440
5267 y(rules)1831 5662 y Fm(85)p eop
%%Page: 86 89
86 88 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)527
531 y Ff(MatrixScope)39 b(:)614 631 y(Matrix\(ps,)h(rows\))h(->)614
731 y(Scope\(ps,)f(Lets\(sdefs,)f(Seq\(Assign\(Var\([0)o(]\))o(\),)e
(Matrix\(rows'\)\)\)\))614 830 y(where)42 b(<unzip\(RowLet\)>)37
b(rows)42 b(=>)h(\(sdefs,)e(rows'\))527 1029 y(RowLet)g(:)614
1129 y(Row\(ts,)g(s\))i(->)g(\(SDef\(f,)d([],)i(s\),)h(Row\([],)d(ts,)j
(Call\(SVar\(f\),)38 b([]\)\)\))614 1229 y(where)k(new)g(=>)h(f)527
1428 y(//)g(If)g(matrix)e(already)f(computed)h(create)g(a)i(reference)d
(to)j(the)f(corresponding)c(case)527 1627 y(MatrixSeenBefore)f(:)614
1727 y(Matrix\(rows\))i(->)k(Continue\(label\))614 1826
y(where)f(<matrix-is-defin)o(ed)o(>)c(rows)k(=>)g(label)527
2026 y(//)h(All)f(rows)g(are)h(empty)527 2225 y(MatrixRowsEmpty)38
b(:)614 2325 y(Matrix\(rows\))h(->)k(LChoices\(states\))614
2424 y(where)f(<map\(\\)f(Row\([],[],s\))e(->)j(s)i(\\)f(\)>)f(rows)g
(=>)h(states)527 2623 y(//)g(The)f(next)g(column)f(contains)g(only)h
(wildcards)527 2823 y(SkipWild)e(:)614 2922 y(Matrix\(rows\))f(->)k
(Matrix\(rows'\))614 3022 y(where)f(<map\(Row\(id,)c
([As\(id,Wld\)|id];)f(Tl,)43 b(id\)\)>)e(rows)h(=>)h(rows')527
3221 y(//)g(The)f(next)g(column)f(contains)g(a)i(mixture)d(of)j
(constructors)c(and)j(wildcards)527 3321 y(//)h(Move)f(it)h(to)f(the)h
(first)e(list)h(for)h(later)e(consideration)527 3520
y(ShiftColumn)e(:)614 3620 y(Matrix\(rows\))g(->)k(Matrix\(rows'\))614
3719 y(where)f(<not\(map\(Row\([As)o(\(i)o(d,n)o(ot)o(\(Wl)o(d\))o(\)|)
o(id])o(,i)o(d,i)o(d\))o(\)\))o(>)c(rows;)527 3819 y
(<map\(ShiftColumnR)o(ow)o(\)>)f(rows)42 b(=>)h(rows')527
4018 y(ShiftColumnRow)38 b(:)614 4118 y(Row\(ts1,)j([t)h(|)i(ts2],)d
(s\))i(->)g(Row\([t)e(|)i(ts1],)e(ts2,)h(s\))527 4317
y(//)h(The)f(last)g(column)f(contains)g(at)h(least)g(one)g(constructor)
d(and)k(possibly)527 4417 y(//)g(a)g(mixture)e(of)i(wildcards)c(and)k
(constructors.)527 4516 y(//)g(The)f(outedges)f(are)h(the)g
(constructors)d(that)j(are)g(matched)f(against.)527 4616
y(//)i(For)f(each)g(constructor)d(there)j(is)h(a)g(transition.)c(The)j
(default)f(state)g(is)527 4716 y(//)i(the)f(one)h(reachable)c(when)j
(none)g(of)h(the)f(constructors)d(match,)i(i.e.,)h(reachable)527
4815 y(//)h(through)e(a)i(wildcard.)527 5015 y(Mixture)e(:)614
5114 y(Matrix\(rows\))e(->)k(Case\(label,)c(Var\(path\),)g(alts,)j
(def\))614 5214 y(where)g(<get-path>)d(rows)j(=>)h(path;)876
5313 y(<outedges>)c(rows)j(=>)h(cs;)876 5413 y(<transitions>)38
b(\(rows,)j(cs\))i(=>)f(alts;)1831 5662 y Fm(86)p eop
%%Page: 87 90
87 89 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)527
531 y Ff(<default-state>)38 b(rows)j(=>)i(def;)527 631
y(new)g(=>)f(label;)f(<memo-matrix>)e(\(rows,)i(label\))527
830 y(get-path)f(:)614 930 y([Row\([As\(Off\(path)o(\),)o(_\))d(|)43
b(_],)g(_,)g(_\))f(|)h(_])g(->)g(path)440 1129 y(strategies)527
1328 y(//)g(Get)f(the)h(outgoing)d(edges)h(for)i(a)g(state,)e(i.e.,)h
(the)g(list)g(of)527 1428 y(//)h(constructor)c(name)j(and)g(its)h
(arguments)c(from)j(the)527 1528 y(//)h(first)e(column)h(of)g(a)h(row)
527 1727 y(outedges)d(=)k(filter\(ConsArgs)o(\);)37 b(uniq)527
1926 y(offsets)k(=)i(map\()f(\\)h(As\(Off\(p\),)d(t\))i(->)h(Var\(p\))e
(\\)i(\))440 2125 y(rules)527 2325 y(ConsArgs)d(:)614
2424 y(Row\([As\(_,)g(Op\(c,ts\)\)|_],)e(_,)43 b(_\))g(->)f(\(Fun\(c,)f
(<length>)f(ts\),)i(<offsets>)e(ts\))527 2623 y(ConsArgs)g(:)614
2723 y(Row\([As\(_,)g(Int\(n\)\)|_],)f(_,)k(_\))f(->)h(\(Int\(n\),)d
([]\))527 2922 y(ConsArgs)g(:)614 3022 y(Row\([As\(_,)g(Str\(x\)\)|_],)
f(_,)k(_\))f(->)h(\(Str\(x\),)d([]\))440 3221 y(strategies)527
3421 y(//)j(Compute)e(the)h(transitions)527 3620 y(transitions)d(=)k
(rzip\(Transition\))440 3819 y(rules)527 4018 y(Transition)d(:)614
4118 y(\(rows,)h(\(c,)i(args\)\))e(->)i(Alt\(c,)e(args,)g
(Matrix\(rows'\)\))614 4218 y(where)h(<filter\(ConsTran)o(si)o(tio)o
(n\()o(Mat)o(ch)o(Co)o(ns\()o(!c)o(,)c(!args\)\)\)>)h(rows)j(=>)h
(rows')527 4417 y(//)g(map)f(a)h(row)g(onto)f(the)g(row)g(of)h
(patterns)d(left)i(to)h(match)f(after)f(the)527 4516
y(//)i(given)e(constructor)e(is)k(matched.)e(Shift)g(the)h(new)h
(patterns)d(to)j(the)527 4616 y(//)g(list)f(of)h(unprocessed)c
(patterns)h(on)j(the)f(right.)527 4815 y(ConsTransition\(ma)o(tc)o(h-)o
(con)o(s\))37 b(:)614 4915 y(Row\([As\(_,)j(t\))j(|)g(pats],)e(pats',)g
(fin\))h(->)614 5015 y(Row\(pats,)e(<conc>)h(\(pats'',)g(pats'\),)f
(fin\))614 5114 y(where)i(<match-cons>)c(t)44 b(=>)e(pats'')527
5313 y(MatchCons\(mkc,)c(mkargs\))j(:)614 5413 y(Op\(c,)h(ts\))g(->)h
(ts)1831 5662 y Fm(87)p eop
%%Page: 88 91
88 90 bop 440 199 a Fm(Chapter:)36 b(Matc)n(hing)27 b(Automata)614
531 y Ff(where)42 b(mkc)g(=>)h(Fun\(c,)e(ar\);)h(<eq>)g(\(<length>)e
(ts,)i(ar\))527 731 y(MatchCons\(mkc,)c(mkargs\))j(:)614
830 y(Str\(x\))g(->)i([])614 930 y(where)f(mkc)g(=>)h(Str\(x\);)e
(mkargs)g(=>)i([])527 1129 y(MatchCons\(mkc,)38 b(mkargs\))j(:)614
1229 y(Real\(r\))g(->)i([])614 1328 y(where)f(mkc)g(=>)h(Real\(r\);)d
(mkargs)h(=>)i([])527 1528 y(MatchCons\(mkc,)38 b(mkargs\))j(:)614
1627 y(Int\(n\))g(->)i([])614 1727 y(where)f(mkc)g(=>)h(Int\(n\);)e
(mkargs)g(=>)i([])527 1926 y(MatchCons\(mkc,)38 b(mkargs\))j(:)614
2026 y(Wld)i(->)f(ts)614 2125 y(where)g(mkargs;)f(map\(\\)g(Var\(p\))g
(->)i(As\(Off\(p\),)c(Wld\)\\)j(\))h(=>)g(ts)440 2325
y(strategies)527 2524 y(//)g(Get)f(the)h(default)d(state)i(\(reachable)
d(via)k(wildcards\))527 2723 y(default-state)38 b(=)614
2823 y(filter\(WildPat\);)614 2922 y(\\)44 b(rows)d(->)i
(Matrix\(rows\))c(\\)440 3122 y(rules)527 3321 y(WildPat)i(:)614
3421 y(Row\([As\(_,)f(Wld\))i(|)h(pats],)e(pats',)g(fin\))h(->)h
(Row\(pats,)d(pats',)h(fin\))440 3872 y(//)i(Linearizing)c(match)i
(operations)440 4071 y(module)g(linearize)440 4171 y(imports)g
(stratego)440 4370 y(strategies)527 4570 y(make-linear)e(=)614
4669 y(choicemap\(MakeLin)o(ea)o(r\))440 4868 y(rules)527
5068 y(MakeLinear')g(:)614 5167 y(Scope\(xs,)h(Seq\(Match\(t\),)e
(s\)\))43 b(->)614 5267 y(Scope\(<conc>)c(\(xs,)j(ys\),)g
(Seq\(Match\(t'\),)c(Seq\(Where\(ts\),)f(s\)\)\))614
5367 y(where)42 b(<linearize>)d(t)k(=>)g(\(t',)f(ys,)g(ts\))1831
5662 y Fm(88)p eop
%%Page: 89 92
89 91 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)527 631 y Ff(MakeLinear)40
b(:)614 731 y(Match\(t\))h(->)614 830 y(Scope\(ys,)f(Seq\(Match\(t'\),)
e(Where\(ts\)\)\))614 930 y(where)k(<linearize>)d(t)k(=>)g(\(t',)f(ys,)
g(ts\))527 1129 y(linearize)e(:)614 1229 y(t)k(->)e(\(t',)g(ys,)h(ts\))
614 1328 y(where)f(<thread-alltd\(Ne)o(wV)o(ar)37 b(+)43
b(OldVar\)>)963 1428 y(Pair\(t,)e(\([],)h([],)g(Id\)\))g(=>)h
(Pair\(t',)d(\(xs,)i(ys,)g(ts\)\))527 1627 y(NewVar)f(:)614
1727 y(Pair\(Var\(x\),)e(\(xs,)j(ys,)g(ts\)\))g(->)h(Pair\(Var\(x\),)c
(\([x)j(|)h(xs],)f(ys,)g(ts\)\))614 1826 y(where)g(<not\(in\)>)e(\(x,)i
(xs\))527 2026 y(OldVar:)614 2125 y(Pair\(Var\(x\),)d(\(xs,)j(ys,)g
(ts\)\))g(->)614 2225 y(Pair\(Var\(x\),)d(\(xs,)j([y)h(|)g(ys],)f
(Seq\(Assign\(Var\(x)o(\),)37 b(Var\(y\)\),)j(ts\)\)\))614
2325 y(where)i(<in>)g(\(x,)g(xs\);)g(new)g(=>)h(y)1831
5662 y Fm(89)p eop
%%Page: 90 93
90 92 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)440 531 y(In)g(this)g
(section)f(w)n(e)h(de\014ne)g(the)g(abstract)e(mac)n(hine)i
(instructions)f(and)h(a)f(simpli\014er)h(and)440 631
y(p)r(eephole)h(optimizer)f(for)g(abstract)f(mac)n(hine)i(programs.)
1831 5662 y(90)p eop
%%Page: 91 94
91 93 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)440 531 y Fi(INSTR)m(UCTION)
33 b(SIMPLIFICA)-8 b(TION)440 807 y Ff(module)41 b(ins-simplificati)o
(on)440 907 y(imports)g(instructions)d(list)440 1158
y Fh(block)31 b(fla)-6 b(ttening)440 1327 y Fm(The)35
b(follo)n(wing)f(rules)g(sp)r(ecify)h(the)h(\015attening)e(of)h(nested)
g(blo)r(c)n(ks)f(in)n(to)h(a)g(single)f(blo)r(c)n(k)440
1427 y(with)c(a)e(list)i(of)f(instructions.)41 b(This)29
b(transformation)f(enables)g(p)r(eephole)i(optimization,)440
1527 y(whic)n(h)e(optimizes)f(adjacen)n(t)g(instructions.)440
1696 y(The)h(strategy)e Ff(flatten-blocks)c Fm(is)27
b(designed)g(to)h(minimize)g(stac)n(k-depth.)440 1947
y Ff(rules)527 2147 y(BlkFlat')40 b(:)k(Block\(is\))39
b(->)k(Block\(is'\))963 2246 y(where)f(<rec)f(x\(Nil)h(+)h(Cons\(id,)d
(x\))j(;)g(try\(BlkFlatAux\)\)>)37 b(is)43 b(=>)f(is')527
2445 y(BlkFlatAux)e(:)j(Cons\(Block\(is1\),)37 b(is2\))42
b(->)g(<conc>)g(\(is1,)f(is2\))527 2645 y(BlkFlat1)f(:)k
(Cons\(Block\([]\),)37 b(is\))42 b(->)h(is)527 2744 y(BlkFlat2)d(:)k
(Cons\(Block\(Cons)o(\(i,)37 b(is\)\),)k(is'\))h(->)1007
2844 y(Cons\(i,)e(Cons\(Block\(is\),)e(is'\)\))440 3043
y(strategies)527 3242 y(flatten-blocks)g(=)789 3342 y(rec)k
(x\(try\(Nil)e(+)j(Block\(x\))d(+)1225 3442 y(Cons\(id,)g(x\);)1225
3541 y(rec)i(y\(try\(BlkFlat1)c(+)43 b(BlkFlat2;)d(Cons\(id,)g(y\);)i
(y\)\)\)\))440 3793 y Fh(peephole)32 b(optimiza)-6 b(tion)440
3962 y Fm(Some)32 b(sequences)g(of)g(adjacen)n(t)g(instructions)g(can)g
(b)r(e)g(reduced)g(to)g(an)g(equiv)-5 b(alen)n(t,)34
b(but)440 4062 y(shorter)26 b(\(co)r(de)i(size)f(reduction\))h(or)e
(more)h(e\016cien)n(t)h(sequence)f(of)h(instructions.)440
4313 y Ff(rules)527 4412 y(PH)43 b(:)g(Cons\(MatchVar\(n\))o(,)38
b(Cons\(BuildVar\(n)o(\),)f(is\)\))42 b(->)745 4512 y
(Cons\(MatchVar\(n\))o(,)c(is\))527 4711 y(PH)43 b(:)g
(Cons\(MatchFun\(f,)37 b(n\),)42 b(Cons\(TravInit,)c(Cons\(AllBuild,)g
(is\)\)\))k(->)745 4811 y(Cons\(MatchFun\(f,)37 b(n\),)42
b(is\))440 5062 y Fm(En)n(vironmen)n(t)26 b(stac)n(k)h(op)r(erations)
527 5313 y Ff(PH)43 b(:)g(Cons\(Epush\(0\),)38 b(is\))k(->)h(is)1831
5662 y Fm(91)p eop
%%Page: 92 95
92 94 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)527 531 y Ff(PH)43
b(:)g(Cons\(Epop\(0\),)38 b(is\))43 b(->)f(is)527 731
y(PH)h(:)g(Cons\(Epush\(n\),)38 b(Cons\(Epush\(m\),)g(is\)\))k(->)745
830 y(Cons\(Epush\(<plus)o(>)c(\(n,)k(m\)\),)g(is\))527
1029 y(PH)h(:)g(Cons\(Epop\(n\),)38 b(Cons\(Epop\(m\),)h(is\)\))i(->)
745 1129 y(Cons\(Epop\(<plus>)c(\(n,)42 b(m\)\),)g(is\))440
1381 y Fm(T)-7 b(erm)27 b(stac)n(k)g(op)r(erations)527
1634 y Ff(PH)43 b(:)g(Cons\(Arg\(n\),)c(Cons\(Tpop,)g(is\)\))j(->)h(is)
440 1886 y Fm(Redundan)n(t)28 b(jumps)527 2139 y Ff(PH')43
b(:)g(Cons\(Goto\(l\),)38 b(Cons\(Label\(l\),)g(is\)\))k(->)745
2238 y(Cons\(Label\(l\),)c(is\))527 2438 y(//)43 b(leave)e(this)h(for)h
(the)f(C)h(compiler)e(to)h(avoid)g(getting)e(warnings)h(in)527
2537 y(//)i(case)f(that)g(the)g(label)g(is)g(not)h(used)f(anywhere.)527
2736 y(PH')h(:)g(Cons\(Goto\(l\),)38 b(is[Cons\(Label\(l\))o(,)f
(Cons\(Goto\(l'\),)h(is'\)\)]\))j(->)789 2836 y(Cons\(Goto\(l'\),)c
(is\))440 3088 y Fh(mer)n(ging)32 b(labels)440 3258 y
Fm(Tw)n(o)20 b(adjacen)n(t)g(lab)r(el)h(de\014nitions)g(can)f(b)r(e)h
(merged)f(in)n(to)g(a)h(single)f(lab)r(el)h(de\014nitions.)34
b(This)440 3357 y(requires)f(substituting)h(the)g(lab)r(el)g(that)h(is)
f(left)g(for)g(the)g(lab)r(el)g(that)g(is)g(remo)n(v)n(ed)e(in)j(all)
440 3457 y(jumps)28 b(to)g(that)g(lab)r(el.)440 3709
y Ff(rules)527 3909 y(DblLbls)41 b(:)i(Cons\(Label\(l1\),)37
b(Cons\(Label\(l2\),)h(is\)\))k(->)963 4008 y(Cons\(LabelSubsU\()o(l2,)
37 b(l1\),)963 4108 y(Cons\(Label\(l1\),)963 4208 y(Cons\(LabelSubsD\()
o(l2,)g(l1\),)42 b(is\)\)\))440 4460 y Fm(Applying)28
b(up)n(w)n(ard)e(substitutions)527 4712 y Ff(SbsU)42
b(:)130 b(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42 b(Cons\(Label\(l2\),)
37 b(is\)\))42 b(->)919 4812 y(Cons\(LabelSubsU\(l)o(2,)37
b(l1\),)42 b(Cons\(Label\(l1\),)37 b(is\)\))527 5011
y(SbsU)42 b(:)130 b(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42
b(Cons\(Goto\(l2\),)c(is\)\))k(->)919 5111 y(Cons\(LabelSubsU\(l)o(2,)
37 b(l1\),)42 b(Cons\(Goto\(l1\),)c(is\)\))527 5310 y(SbsU)k(:)130
b(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42 b(Cons\(Cpush\(l2\),)37
b(is\)\))42 b(->)919 5410 y(Cons\(LabelSubsU\(l)o(2,)37
b(l1\),)42 b(Cons\(Cpush\(l1\),)37 b(is\)\))1831 5662
y Fm(92)p eop
%%Page: 93 96
93 95 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)527 631 y Ff(SbsU)42
b(:)130 b(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42 b(Cons\(Rpush\(l2\),)
37 b(is\)\))42 b(->)919 731 y(Cons\(LabelSubsU\(l)o(2,)37
b(l1\),)42 b(Cons\(Rpush\(l1\),)37 b(is\)\))440 983 y
Fm(Applying)28 b(do)n(wn)n(w)n(ard)d(substitutions)527
1235 y Ff(SbsD)42 b(:)130 b(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Cons\(Label\(l2\),)37 b(is\)\))42 b(->)919
1335 y(Cons\(Label\(l1\),)c(Cons\(LabelSubsD\()o(l2)o(,)g(l1\),)j
(is\)\))527 1534 y(SbsD)h(:)130 b(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Cons\(Goto\(l2\),)c(is\)\))k(->)919 1634
y(Cons\(Goto\(l1\),)c(Cons\(LabelSubsD\(l)o(2,)f(l1\),)42
b(is\)\))527 1833 y(SbsD)g(:)130 b(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Cons\(Cpush\(l2\),)37 b(is\)\))42 b(->)919
1933 y(Cons\(Cpush\(l1\),)c(Cons\(LabelSubsD\()o(l2)o(,)g(l1\),)j
(is\)\))527 2132 y(SbsD)h(:)130 b(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Cons\(Rpush\(l2\),)37 b(is\)\))42 b(->)919
2232 y(Cons\(Rpush\(l1\),)c(Cons\(LabelSubsD\()o(l2)o(,)g(l1\),)j
(is\)\))440 2484 y Fm(Propagating)25 b(substitutions)j(up)g(and)f(do)n
(wn)g(the)h(list.)527 2736 y Ff(Up)43 b(:)217 b(Cons\(i,)41
b(Cons\(LabelSubsU\(l)o(1,)c(l2\),)42 b(is\)\))g(->)919
2836 y(Cons\(LabelSubsU\(l)o(1,)37 b(l2\),)42 b(Cons\(i,)f(is\)\))919
2936 y(where)h(not)g(\(<id>)g(i)h(=>)g(LabelSubsU\(_,_\)\))527
3135 y(Down)f(:)130 b(Cons\(LabelSubsD\(l)o(2,)37 b(l1\),)42
b(Cons\(i,)f(is\)\))h(->)919 3235 y(Cons\(i,)f(Cons\(LabelSubsD\(l)o
(1,)c(l2\),)42 b(is\)\))919 3334 y(where)g(not)g(\(<id>)g(i)h(=>)g
(LabelSubsD\(_,_\)\))440 3587 y Fm(Remo)n(ving)27 b(substitutions)h(at)
f(top)h(and)f(b)r(ottom)h(of)f(the)h(list.)527 3839 y
Ff(UnSbsU)41 b(:)i(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42
b(is\))g(->)h(is)527 4038 y(UnSbsD)e(:)i(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Nil\))g(->)h(Nil)440 4291 y Fh(the)32 b(stra)-6
b(tegy)440 4460 y Fm(The)28 b(p)r(eephole)f(optimization)h(strategy)-7
b(.)440 4712 y Ff(strategies)527 4912 y(ph)43 b(=)g(rec)f(y\(try\(PH;)e
(y)j(+)h(SbsU)e(+)h(\(Up;)f(\(SbsU)f(<+)i(Cons\(id,)d(y\)\)\)\)\))527
5111 y(phdown)h(=)i(repeat\(PH)d(+)j(DblLbls)e(+)i(\(SbsD)f(<+)h
(\(UnSbsD)d(+)j(Down\)\)\))527 5210 y(phup)129 b(=)43
b(repeat\(PH)d(+)j(\(SbsU)f(<+)h(rec)f(x\(Up;)g(Cons\(id,)e
(try\(x\)\)\)\)\))527 5410 y(peephole')g(=)j(Block\(listbu\(ph\);)1831
5662 y Fm(93)p eop
%%Page: 94 97
94 96 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)1268 531 y
Ff(repeat\(UnSbsU\);)1268 631 y(listtd\(try\(SbsD)38
b(<+)k(\(UnSbsD)f(<+)i(Down\)\)\)\))527 830 y(peephole')d(=)j
(Block\(listdu2\(phd)o(ow)o(n,)37 b(phup\);)1268 930
y(repeat\(UnSbsU\)\))527 1129 y(peephole)j(=)k(try\(Block\(listd)o
(u\(r)o(ep)o(eat)o(\(P)o(H\))o(\)\)\))1831 5662 y Fm(94)p
eop
%%Page: 95 98
95 97 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(In)h(this)f(section)g(w)n(e)g
(de\014ne)h(the)f(translation)f(from)h(strategies)f(to)h(abstract)g
(mac)n(hine)440 631 y(instructions.)440 800 y(\(***)27
b(Consider)f(transformation)g(to)i(an)f(A-Normal-form)f(lik)n(e)h
(format.)36 b(***\))1831 5662 y(95)p eop
%%Page: 96 99
96 98 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y Fi(BA)m(CKEND)440
809 y Ff(module)k(backend)440 908 y(imports)g(compiler)f(specialized)f
(ins-simplificati)o(on)e(lib)440 1008 y(strategies)527
1207 y(main)42 b(=)h(iowrap\(compile\))527 1406 y(compile)e(=)614
1506 y(where\(declare-pro)o(cs)c(=>)43 b(decls\);)614
1606 y(where\(compile-pro)o(cs)37 b(=>)43 b(funs\);)614
1705 y(where\(get-afuns)38 b(=>)k(\(vardecls,)e(mkafuns\)\);)614
1805 y(!Block\([Block\(var)o(de)o(cls)o(\),)963 1905
y(Block\(decls\),)963 2004 y(Block\([PROC\("ini)o(t_a)o(fu)o(ns")o(\),)
d(Block\(mkafuns\),)g(ENDPROC]\),)963 2104 y(Block\(funs\)]\))527
2303 y(declare-procs)h(=)614 2403 y(where\(<create-tab)o(le)o(>)g
("symbol-table"\))o(;)614 2502 y(map\(DeclareProc\))527
2702 y(DeclareProc)h(=)614 2801 y(?SDef\(f,)i([],)h(s\);)614
2901 y(<table-put>)d(\("symbol-table",)e(f,)43 b(<conc-strings>)38
b(\("_stratego_",)g(f\)\);)614 3000 y(!PROCDECL\(f\))527
3200 y(is-toplevel-proc)f(=)43 b(?f;)614 3299 y(<table-get>)c
(\("symbol-table",)e(f\))527 3499 y(get-afun)j(=)k(?AFun\(f,)c(i\);)527
3598 y(where\()614 3698 y(<table-get>)f(\("symbol-table",)e(AFun\(f,)k
(i\)\))h(=>)h(lab)614 3797 y(<+)g(new)f(=>)h(lab;)745
3897 y(<table-put>)c(\("symbol-table",)e(AFun\(f,)k(i\),)h(lab\))527
3997 y(\);)527 4096 y(!lab)527 4296 y(get-afuns)e(=)614
4395 y(<table-getlist>)e("symbol-table";)614 4495 y
(filter\(?\(AFun\(_,_)o(\),)o(_\)\))o(;)614 4594 y(map\(\\)k
(\(AFun\(f,)e(i\),)i(lab\))g(->)876 4694 y(\(VARDECL\(ATerm\(\))o(,)37
b(lab\),)42 b(MOVE\(lab,)e(ATmakeAFun\(f,)e(i,)43 b(0\)\)\))f(\\)h(\);)
614 4794 y(unzip)527 4993 y(compile-procs)38 b(=)614
5093 y(map\(MkInstr;)789 5192 y(try\(Ctop\);)789 5292
y(topdown\(repeat\()o(Csp)o(ec)o(ial)f(<+)43 b(C\)\);)789
5391 y(flatten-blocks;)1831 5662 y Fm(96)p eop
%%Page: 97 100
97 99 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)789 531 y Ff(peephole\))440
784 y Fm(Mak)n(e)27 b(a)g(strategy)f(in)n(to)i(an)f(instruction)440
1036 y Ff(rules)527 1235 y(MkInstr)41 b(:)i(s)g(->)g(Instr\(s,)d([],)j
(0\))1831 5662 y Fm(97)p eop
%%Page: 98 101
98 100 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y Fi(COMPILER)440
781 y Ff(module)k(compiler)440 880 y(imports)g(instructions)d(strategy)
j(list)h(automaton)d(stratlib)440 1109 y Fm(semi-instructions:)d
(strategies)26 b(em)n(b)r(edded)i(in)n(to)g(instructions)440
1339 y Ff(signature)527 1438 y(constructors)614 1538
y(Instr)42 b(:)h(Strategy)d(*)j(Env)g(*)g(REnv)f(->)h(Instr)440
1767 y Fm(Lo)r(oking)26 b(up)i(v)-5 b(ariables)27 b(in)h(the)f(en)n
(vironmen)n(t)440 1996 y Ff(rules)527 2195 y(io-index)40
b(:)k(\(x,)e(env\))g(->)h(\(i,)f(o\))658 2295 y(where)f(<fetch\({i,)f
(xs:)i(?\(i,)g(xs\);)g(!\(i,)g(<get-index>)d(\(x,)j(xs\)\)};)g(?\(i,)f
(o\)\)>)h(env)440 2524 y Fm(Semi-instructions)24 b(can)g(b)r(e)h
(re\014ned)f(to)g(instructions)g(b)n(y)g(means)g(of)g(the)h(follo)n
(wing)e(rules.)440 2693 y Fh(sequential)31 b(pr)n(ogramming)440
2863 y Fm(Iden)n(tit)n(y)d(and)f(failure)440 3092 y Ff(rules)527
3291 y(C)43 b(:)h(Instr\(Id,)39 b(env,)j(rcs\))g(->)702
3391 y(Block\([]\))527 3590 y(C)h(:)h(Instr\(Fail,)39
b(env,)i(rcs\))h(->)702 3690 y(Goto\("fail"\))440 3919
y Fm(T)-7 b(est)28 b(and)f(negation)440 4088 y(Note:)37
b(this)28 b(is)f(really)g(a)g(where)g(implemen)n(tation)h(the)g(en)n
(vironmen)n(t)e(is)i(not)f(restored.)527 4317 y Ff(C)43
b(:)h(Instr\(Test\(s\),)37 b(env,)42 b(rcs\))g(->)702
4417 y(Block\([Tdupl,)1007 4516 y(Instr\(s,)e(env,)i(rcs\),)1007
4616 y(Tpop]\))527 4815 y(C)h(:)h(Instr\(Not\(s\),)38
b(env,)k(rcs\))g(->)702 4915 y(Block\([Cpush\(fc)o(\),)1007
5015 y(Tdupl,)1007 5114 y(Instr\(s,)e(env,)i(rcs\),)1007
5214 y(Cpop,)f(Crestore,)f(Cjump,)1007 5313 y(Label\(fc\)]\))702
5413 y(where)h(new)h(=>)h(fc)1831 5662 y Fm(98)p eop
%%Page: 99 102
99 101 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(Sequen)n(tial)27
b(comp)r(osition)527 784 y Ff(C)43 b(:)h(Instr\(Seq\(s1,)38
b(s2\),)k(env,)g(rcs\))g(->)702 883 y(Block\([Instr\(s1)o(,)37
b(env,)42 b(rcs\),)1007 983 y(Instr\(s2,)d(env,)j(rcs\)]\))440
1235 y Fm(Choice)527 1488 y Ff(C)h(:)h(Instr\(LChoice\(s)o(1,)37
b(s2\),)42 b(env,)g(rcs\))g(->)702 1587 y(Instr\(Choice\(s1)o(,)37
b(s2\),)42 b(env,)g(rcs\))527 1787 y(C)h(:)h(Instr\(Choice\(s1)o(,)37
b(s2\),)42 b(env,)g(rcs\))g(->)702 1886 y(Block\([Cpush\(fc)o(\),)1007
1986 y(Instr\(s1,)d(env,)j(rcs\),)1007 2086 y(Goto\(sc\),)1007
2185 y(Label\(fc\),)1007 2285 y(Choices\(s2,)d(sc,)j(env,)g(rcs\)]\))
702 2384 y(where)f(new)h(=>)h(sc)g(;)g(new)f(=>)h(fc)527
2584 y(C)g(:)h(Choices\(Choice\()o(s1)o(,)38 b(s2\),)k(sc,)g(env,)g
(rcs\))g(->)702 2683 y(Block\([Ccontinu)o(e\()o(fc\))o(,)1007
2783 y(Instr\(s1,)d(env,)j(rcs\),)1007 2883 y(Goto\(sc\),)1007
2982 y(Label\(fc\),)1007 3082 y(Choices\(s2,)d(sc,)j(env,)g(rcs\)]\))
702 3181 y(where)f(new)h(=>)h(fc)527 3381 y(C)g(:)h(Choices\(LChoice)o
(\(s)o(1,)37 b(s2\),)42 b(sc,)h(env,)e(rcs\))h(->)702
3480 y(Choices\(Choice\()o(s1)o(,)c(s2\),)k(sc,)g(env,)g(rcs\))527
3680 y(C)h(:)h(Choices\(s,)39 b(sc,)j(env,)g(rcs\))g(->)702
3779 y(Block\([Instr\(s,)37 b(env,)42 b(rcs\),)1007 3879
y(Goto\(done\),)1007 3978 y(Label\(sc\),)1007 4078 y(Cpop,)1007
4178 y(Label\(done\)]\))702 4277 y(where)f(not\(<Choice\(id,i)o(d\))c
(+)43 b(LChoice\(id,id\)>)38 b(s\);)963 4377 y(new)k(=>)h(done)440
4629 y Fm(Matc)n(hing)27 b(automaton)527 4882 y Ff(C)43
b(:)h(Instr\(Assign\(Va)o(r\()o(x\)\))o(,)37 b(env,)42
b(rcs\))g(->)702 4981 y(MoveTop\(j,)d(o\))702 5081 y(where)i
(<io-index>)e(\(x,)k(env\))f(=>)h(\(j,)f(o\))527 5280
y(C)h(:)h(Instr\(Assign\(Va)o(r\()o(x\),)37 b(Var\(y\)\),)j(env,)i
(rcs\))g(->)702 5380 y(Move\(j1,)e(o1,)i(j2,)g(o2\))1831
5662 y Fm(99)p eop
%%Page: 100 103
100 102 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)702 531 y Ff(where)k(<io-index>)e(\(x,)k
(env\))f(=>)h(\(j1,)e(o1\);)963 631 y(<io-index>)e(\(y,)k(env\))f(=>)h
(\(j2,)e(o2\))527 830 y(C)i(:)h(Instr\(Assign\(Va)o(r\()o(x\),)37
b(t\),)42 b(env,)g(rcs\))g(->)702 930 y(Instr\(Where\(Seq)o(\(B)o(uil)o
(d\()o(t\),)37 b(Assign\(Var\(x\)\)\)\))o(,)g(env,)42
b(rcs\))702 1029 y(where)f(!t;)h(\(?Op\(_,_\))e(+)j(?Int\(_\))e(+)i
(?Str\(_\))e(+)i(?Real\(_\)\))440 1229 y(//)g(Case)f(expressions)440
1428 y(rules)527 1627 y(C)h(:)h(Instr\(Case\(lab,)37
b(x,)43 b(alts,)e(def\),)h(env,)g(rcs\))g(->)702 1727
y(Block\([Branch\(C)o(as)o(e\(l)o(ab)o(,)c(x,)k(alts,)g(def\),)f(sc,)i
(env,)f(rcs\),)1007 1826 y(Label\(sc\)]\))702 1926 y(where)f(new)h(=>)h
(sc)440 2125 y(strategies)527 2325 y(C)g(=)h(Cbranch)c(<+)j
(CbranchOther)440 2524 y(rules)527 2723 y(Cbranch)e(:)614
2823 y(Branch\(Case\(lab,)c(Var\(x\),)k(alts,)h(def\),)f(sc,)h(env,)g
(rcs\))g(->)614 2922 y(Block\([Goto\(lab\),)919 3022
y(Label\(lab\),)919 3122 y(Alts\(alts,)e(\(j,)i(o\),)h(fc,)f(sc,)g
(env,)g(rcs\),)919 3221 y(ins]\))614 3321 y(where)g(<io-index>)d(\(x,)k
(env\))f(=>)g(\(j,)h(o\);)876 3421 y(<DefaultLabel>)38
b(\(def,)j(sc,)i(env,)e(rcs\))h(=>)h(\(fc,)f(ins\))527
3620 y(Cbranch)f(:)614 3719 y(Branch\(Continue\(l)o(ab)o(\),)c(sc,)43
b(env,)f(rcs\))f(->)i(Goto\(lab\))527 3919 y(Cbranch)e(:)614
4018 y(Branch\(Call\(SVar\()o(f\))o(,[])o(\),)c(sc,)42
b(env,)g(rcs\))g(->)658 4118 y(Block\([Rpush\(sc\))o(,)963
4218 y(Goto\(f\)]\))614 4317 y(where)g(<not\(is-toplevel)o(-p)o(roc)o
(\)>)37 b(f)43 b(=>)g(lab)527 4516 y(Cbranch)e(:)614
4616 y(Branch\(Call\(SVar\()o(f\))o(,[])o(\),)c(sc,)42
b(env,)g(rcs\))g(->)614 4716 y(Ccall\(f,[]\))614 4815
y(where)g(<is-toplevel-pro)o(c>)37 b(f)43 b(=>)g(lab)527
5015 y(CbranchOther)c(:)614 5114 y(Branch\(s,)h(sc,)j(env,)e(rcs\))h
(->)614 5214 y(Block\([Instr\(s,)c(env,)k(rcs\),)919
5313 y(Goto\(sc\)]\))1810 5662 y Fm(100)p eop
%%Page: 101 104
101 103 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)527 531 y Ff(DefaultLabel)i(:)658
631 y(\(Fail,)i(sc,)h(env,)g(rcs\))g(->)h(\("fail",)d(Block\([]\)\))527
830 y(DefaultLabel)f(:)658 930 y(\(s,)j(sc,)h(env,)f(rcs\))f(->)658
1029 y(\(lab,)g(Block\([Label\(lab\))o(,)d(Branch\(s,)h(sc,)k(env,)f
(rcs\)]\)\))658 1129 y(where)f(<not\(eq\)>)f(\(s,)j(Fail\);)e(new)h(=>)
h(lab)527 1328 y(C)g(:)h(Alts\([],)c(x,)j(fc,)f(sc,)g(env,)g(rcs\))g
(->)702 1428 y(Block\([]\))527 1627 y(C)h(:)h(Alts\([Alt\(c,)38
b(args,)k(s\)],)g(x,)g(fc,)h(sc,)f(env,)g(rcs\))g(->)702
1727 y(Block\([)789 1826 y(<TestConstructo)o(r>)37 b(\(x,)43
b(c,)f(fc\),)789 1926 y(Block\(get-args\))o(,)789 2026
y(Branch\(s,)e(sc,)i(env,)g(rcs\))702 2125 y(]\))702
2225 y(where)f(<nzip0\(CArg\(!env)o(,!x)o(\)\))o(>)d(args)j(=>)i
(get-args)527 2424 y(C)g(:)h(Alts\([Alt\(c,)38 b(args,)k(s\))g(|)i
(alts],)d(x,)h(fc,)h(sc,)f(env,)g(rcs\))g(->)702 2524
y(Block\([)789 2623 y(<TestConstructo)o(r>)37 b(\(x,)43
b(c,)f(match-fail\),)789 2723 y(Block\(get-args\))o(,)789
2823 y(Branch\(s,)e(sc,)i(env,)g(rcs\),)789 2922 y(Label\(match-fai)o
(l\),)789 3022 y(Alts\(alts,)d(x,)k(fc,)f(sc,)h(env,)f(rcs\))702
3122 y(]\))702 3221 y(where)f(!alts)h(=>)g([_|_];)963
3321 y(new)g(=>)h(match-fail;)963 3421 y(<nzip0\(CArg\(!env)o(,!x)o
(\)\))o(>)38 b(args)j(=>)i(get-args)527 3620 y(TestConstructor)38
b(:)614 3719 y(\(\(j,)k(o\),)h(Fun\(f,)e(n\),)h(fc\))g(->)614
3819 y(TestFunFC\(VAR\(lab)o(\),)37 b(fc,)42 b(Egetd\(j,)f(o\)\))614
3919 y(where)h(<get-afun>)d(AFun\(f,)i(n\))i(=>)g(lab)527
4118 y(TestConstructor)38 b(:)43 b(\(\(j,)f(o\),)g(Int\(n\),)f(fc\))86
b(->)42 b(TestInt\(j,)e(o,)j(n,)f(fc\))527 4218 y(TestConstructor)c(:)
43 b(\(\(j,)f(o\),)g(Real\(n\),)e(fc\))j(->)f(TestReal\(j,)d(o,)k(n,)g
(fc\))527 4317 y(TestConstructor)38 b(:)43 b(\(\(j,)f(o\),)g(Str\(x\),)
f(fc\))86 b(->)42 b(TestStr\(j,)e(o,)j(<escape>)d(x,)j(fc\))527
4516 y(CArg\(env,src\))38 b(:)614 4616 y(\(n,)43 b(Var\(x\)\))d(->)j
(MoveArg\(i1,)c(o1,)k(i2,)f(o2,)g(n\))614 4716 y(where)g(<io-index>)d
(\(x,)k(<env>\(\)\))d(=>)j(\(i1,)f(o1\);)g(src)g(=>)h(\(i2,o2\))440
4965 y Fh(jumping)527 5214 y Ff(C)g(:)h(Instr\(Rec\(x,)38
b(s\),)k(env,)g(rcs\))g(->)702 5313 y(Block\([Rpush\(sc)o(\),)1007
5413 y(Label\(x\),)1810 5662 y Fm(101)p eop
%%Page: 102 105
102 104 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)1007 531 y Ff(Instr\(s,)j(env,)i(rcs\),)
1007 631 y(Return,)1007 731 y(Label\(sc\)]\))702 830
y(where)f(new)h(=>)h(sc)527 1079 y(C)g(:)h(Instr\(Call\(SVar)o(\(x)o
(\),)37 b([]\),)42 b(env,)g(rcs\))g(->)702 1179 y(Ccall\(lab,)d([]\))
702 1279 y(where)i(<is-toplevel-pro)o(c>)c(x)43 b(=>)g(lab)527
1478 y(C)g(:)h(Instr\(Call\(SVar)o(\(x)o(\),)37 b([]\),)42
b(env,)g(rcs\))g(->)702 1577 y(Block\([Rpush\(re)o(t\))o(,)c
(Goto\(x\),)i(Label\(ret\)]\))702 1677 y(where)h(<not\(is-toplevel)o
(-pr)o(oc)o(\)>)c(x;)43 b(new)f(=>)h(ret)527 1926 y(C)g(:)h
(Instr\(Let\(sdef,)37 b(s\),)42 b(env,)g(rcs\))g(->)702
2026 y(Block\([Instr\(s,)37 b(env,)42 b(rcs\),)1007 2125
y(Goto\(y\),)1007 2225 y(Instr\(sdef,)d(env,)j(rcs\),)1007
2325 y(Label\(y\)]\))702 2424 y(where)f(new)h(=>)h(y)789
2623 y(//)f(This)g(is)h(not)f(optimal!)f(Causes)g(a)i(chain)f(of)g
(jumps)g(to)h(the)f(end)g(of)h(the)789 2723 y(//)f(code)527
2922 y(Ctop)g(:)614 3022 y(Instr\(SDef\(x,)d([],)j(s\),)g(env,)g(rcs\))
g(->)614 3122 y(Block\([PROC\(x\),)919 3221 y(Instr\(s,)f(env,)h
(rcs\),)919 3321 y(ENDPROC\(\)]\))527 3520 y(Ctop)g(:)614
3620 y(Instr\(SDef\(pragma)o(s,)37 b(x,)43 b([],)f(s\),)h(env,)e(rcs\))
h(->)614 3719 y(Instr\(SDef\(x,)d([],)j(s\),)g(env,)g(rcs\))527
4018 y(C)h(:)h(Instr\(SDef\(x,)38 b([],)k(s\),)g(env,)g(rcs\))g(->)702
4118 y(Block\([Label\(x\))o(,)1007 4218 y(Instr\(s,)e(env,)i(rcs\),)
1007 4317 y(Return]\))527 4516 y(C)h(:)h(Instr\(SDef\(prag)o(ma)o(s,)37
b(x,)43 b([],)f(s\),)h(env,)f(rcs\))g(->)702 4616 y(Instr\(SDef\(x,)c
([],)k(s\),)g(env,)g(rcs\))440 4865 y Fm(P)n(ath)527
5114 y Ff(C)h(:)h(Instr\(Path\(i,)38 b(s\),)k(env,)g(rcs\))g(->)702
5214 y(Block\([TpushIth)o(So)o(n\(i)o(\),)1007 5313 y(Instr\(s,)e(env,)
i(rcs\),)1007 5413 y(TputIthSon\(i\)]\))1810 5662 y Fm(102)p
eop
%%Page: 103 106
103 105 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(Congruence)527
764 y Ff(C)43 b(:)h(Instr\(Cong\(f,)38 b(ss\),)k(env,)g(rcs\))g(->)702
863 y(Block\([TestFunT)o(op)o(\(VA)o(R\()o(lab)o(\)\))o(,)1007
963 y(TravInit,)1007 1063 y(Instr\(CongKids\()o(ss\))o(,)37
b(env,)42 b(rcs\),)1007 1162 y(AllBuild]\))614 1262 y(where)g
(<get-afun>)d(AFun\(f,)i(<length>)f(ss\))j(=>)f(lab)527
1461 y(C)h(:)h(Instr\(CongWld\(s)o(s\))o(,)38 b(env,)k(rcs\))g(->)702
1561 y(Block\([TravInit)o(,)1007 1660 y(Instr\(CongKids\()o(ss\))o(,)37
b(env,)42 b(rcs\),)1007 1760 y(AllBuild]\))527 1959 y(C)h(:)h
(Instr\(CongKids\()o(Ni)o(l\),)37 b(env,)42 b(rcs\))g(->)702
2059 y(Block\([]\))527 2258 y(C)h(:)h(Instr\(CongKids\()o(Co)o(ns\()o
(s,)37 b(ss\)\),)42 b(env,)f(rcs\))h(->)702 2358 y(Block\([OneNextS)o
(on)o(,)1007 2457 y(Instr\(s,)e(env,)i(rcs\),)1007 2557
y(Instr\(CongKids\()o(ss\))o(,)37 b(env,)42 b(rcs\)]\))440
2790 y Fm(Generic)27 b(tra)n(v)n(ersal)e(op)r(erators;)h(All)527
3022 y Ff(C)43 b(:)h(Instr\(All\(s\),)38 b(env,)k(rcs\))g(->)702
3122 y(Block\([AllInit,)1007 3221 y(Label\(c1\),)1007
3321 y(AllNextSon\(c2\),)211 b(\(*)43 b(Succeed)e(if)i(there)e(are)h
(no)h(more)f(children)e(*\))1007 3421 y(Instr\(s,)g(env,)i(rcs\),)1007
3520 y(Goto\(c1\),)475 b(\(*)43 b(process)e(next)h(child)f(*\))1007
3620 y(Label\(c2\),)1007 3719 y(AllBuild]\))702 3819
y(where)g(new)h(=>)h(c1)g(;)g(new)f(=>)h(c2)440 4051
y Fm(One)527 4284 y Ff(C)g(:)h(Instr\(One\(s\),)38 b(env,)k(rcs\))g(->)
702 4384 y(Block\([IsAppl,)1007 4483 y(OneInit,)1007
4583 y(Label\(c1\),)1007 4682 y(OneNextSon,)344 b(\(*)43
b(Fail)e(if)i(there)f(are)g(no)h(more)f(children)e(*\))1007
4782 y(Cpush\(c1\),)1007 4882 y(Instr\(s,)g(env,)i(rcs\),)1007
4981 y(Cpop,)1007 5081 y(OneBuild]\))702 5181 y(where)f(new)h(=>)h(c1)g
(;)g(new)f(=>)h(c2)440 5413 y Fm(Some)1810 5662 y(103)p
eop
%%Page: 104 107
104 106 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)527 531 y Ff(C)43 b(:)h(Instr\(Some\(s\),)
37 b(env,)42 b(rcs\))g(->)702 631 y(Block\([IsAppl,)1007
731 y(SomeInit,)1007 830 y(Label\(c1\),)1007 930 y(SomeNextSon\(c2\))o
(,)c(\(*)k(jump)g(to)h(c2)g(if)g(all)f(children)e(have)i(been)g
(handled)1878 1029 y(and)h(CounterOk)d(*\))1007 1129
y(Cpush\(c1\),)1007 1229 y(Instr\(s,)g(env,)i(rcs\),)1007
1328 y(Cpop,)1007 1428 y(CounterOK,)d(\(*)k(record)e(success)g(of)h(at)
h(least)f(one)g(child)g(*\))1007 1528 y(Goto\(c1\),)1007
1627 y(Label\(c2\),)1007 1727 y(SomeBuild]\))702 1826
y(where)f(new)h(=>)h(c1)g(;)g(new)f(=>)h(c2)440 2076
y Fm(Thread)527 2325 y Ff(C)g(:)h(Instr\(Thread\(s\))o(,)37
b(env,)42 b(rcs\))g(->)702 2424 y(Block\([ThreadIn)o(it)o(\(\),)1007
2524 y(Label\(c1\),)1007 2623 y(ThreadNextSon\(c)o(2\),)1007
2723 y(Instr\(s,)e(env,)i(rcs\),)1007 2823 y(ThreadSetEnv\(\),)1007
2922 y(Goto\(c1\),)1007 3022 y(Label\(c2\),)1007 3122
y(ThreadBuild\(\)]\))702 3221 y(where)f(new)h(=>)h(c1)g(;)g(new)f(=>)h
(c2)440 3470 y Fm(Scop)r(e)527 3719 y Ff(C)g(:)h(Instr\(Scope\(xs,)37
b(s\),)42 b(env,)g(i\))h(->)702 3819 y(Block\([Epushd\(i)o(,)37
b(o\),)1007 3919 y(Instr\(s,)j([\(i,)i(xs\))g(|)h(env],)f(<add>)f(\(i,)
i(1\)\),)1007 4018 y(Epopd\(i,)d(o\)]\))702 4118 y(where)h(<length>)f
(xs)j(=>)g(o)440 4367 y Fm(Where)527 4616 y Ff(C)g(:)h
(Instr\(Where\(s\),)37 b(env,)42 b(rcs\))g(->)702 4716
y(Block\([Tdupl,)1007 4815 y(Instr\(s,)e(env,)i(rcs\),)1007
4915 y(Tpop]\))440 5164 y Fm(Primitiv)n(es)527 5413 y
Ff(C)h(:)h(Instr\(Prim\(x\),)37 b(env,)42 b(rcs\))g(->)1810
5662 y Fm(104)p eop
%%Page: 105 108
105 107 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)702 531 y Ff(Iprim\(x\))527
731 y(C)43 b(:)h(Instr\(Prim2\(x,)37 b(y\),)43 b(env,)f(rcs\))g(->)702
830 y(Iprim2\(x,)d(y\))527 1029 y(C)k(:)h(Instr\(CountRule)o(\(x)o(\),)
37 b(env,)42 b(rcs\))g(->)702 1129 y(ICountRule\(x\))440
1378 y Fm(Building)28 b(T)-7 b(erms)527 1627 y Ff(//)43
b(what)f(happens)f(with)g(NULL)h(variables?)527 1826
y(C)h(:)h(Instr\(Build\(t\),)37 b(env,)42 b(rcs\))g(->)702
1926 y(Block\([Block\(xs)o(\),)1007 2026 y(Tset\(BuildTerm\()o(t,)37
b(env,)42 b(rcs\)\)]\))702 2125 y(where)f(<tvars;)g(map\(TestVar\(!env)
o(,)c(!rcs\)\)>)k(t)i(=>)g(xs)527 2325 y(TestVar\(env,)c(rcs\))j(:)614
2424 y(x)i(->)e(ins)614 2524 y(where)g(<io-index>)d(\(x,)k(<env>\(\)\))
d(=>)j(\(i,o\);)876 2623 y(\(\(<eq>)e(\(i,)h(<rcs>\(\)\);)e
(!NotNULL\(o\)\))f(<+)k(!NotNULLd\(i,)38 b(o\))43 b(=>)g(ins\))527
2823 y(C)g(:)h(BuildTerm\(Str\(x)o(\),)37 b(env,)42 b(rcs\))g(->)702
2922 y(ATmakeString\(<e)o(sc)o(ape)o(>)37 b(x\))527 3122
y(C)43 b(:)h(BuildTerm\(Int\(x)o(\),)37 b(env,)42 b(rcs\))g(->)702
3221 y(MakeInt\(x\))527 3421 y(C)h(:)h(BuildTerm\(Real\()o(x\))o(,)38
b(env,)k(rcs\))g(->)702 3520 y(ATmakeReal\(x\))527 3719
y(C)h(:)h(BuildTerm\(Var\(x)o(\),)37 b(env,)42 b(rcs\))g(->)702
3819 y(ins)702 3919 y(where)f(<io-index>)e(\(x,)k(env\))f(=>)h(\(i,)f
(o\);)963 4018 y(\(\(<eq>)f(\(i,)h(rcs\);)g(!Eget\(o\)\))e(<+)j
(!Egetd\(i,)c(o\))k(=>)g(ins\))527 4218 y(C)g(:)h(BuildTerm\(Build)o
(De)o(fau)o(lt)o(\(t\))o(,)37 b(env,)42 b(rcs\))g(->)702
4317 y(BuildTerm\(t,)c(env,)k(rcs\))527 4516 y(C)h(:)h
(BuildTerm\(Op\(f,)37 b(ts\),)42 b(env,)g(rcs\))g(->)702
4616 y(app)g(#)h(\()g([f)g(|)g(<map\(\\)e(t)i(->)g(BuildTerm\(t,)c
(env,)j(rcs\))g(\\)h(\)>)g(ts])f(\))702 4716 y(where)f(<length>)f(ts)j
(=>)g(len;)f(<leq>)f(\(len,)h(6\);)1007 4815 y(<conc-strings>)37
b(\("App",)k(<int-to-string>)c(len\))42 b(=>)h(app)527
5015 y(C)g(:)h(BuildTerm\(Op\(f,)37 b(ts\),)42 b(env,)g(rcs\))g(->)702
5114 y(AppN\(f,)e("ATmakeList")f(#)k(\([len)f(|)h(args]\)\))702
5214 y(where)e(<length>)84 b(ts)43 b(=>)f(len;)g(<gt>)g(\(len,)g(6\);)
1007 5313 y(<map\(\\)f(t)i(->)g(BuildTerm\(t,)38 b(env,)k(rcs\))g(\\)h
(\)>)g(ts)g(=>)g(args)1810 5662 y Fm(105)p eop
%%Page: 106 109
106 108 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)527 531 y Ff(C)43 b(:)h(BuildTerm\(App\(s)
o(,)37 b(t\),)43 b(env,)f(rcs\))g(->)702 631 y(AppEncountered\()o(Ap)o
(p\(s)o(,)37 b(t\)\))702 731 y(//Block\([BuildT)o(er)o(m\(t)o(,)g(env,)
42 b(rcs\),)702 830 y(//)304 b(Instr\(s,)40 b(env,)i(rcs\)]\))702
930 y(where)f(debug\(!"compiler)o(.r:)c(App)42 b(encountered:)d("\))
1810 5662 y Fm(106)p eop
%%Page: 107 110
107 109 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y Fi(SPECIAL)c(P)-8
b(A)g(TTERNS)440 724 y Fm(This)40 b(mo)r(dule)g(de\014nes)g(exceptions)
f(to)g(the)i(normal)d(compiler)h(rules)h(b)n(y)f(recognizing)440
823 y(patterns)27 b(that)h(can)f(b)r(e)h(implemen)n(ted)g(in)g(a)g
(more)e(e\016cien)n(t)i(w)n(a)n(y)-7 b(.)440 1067 y Ff(module)41
b(specialized)440 1167 y(imports)g(compiler)f(stratego-laws)440
1410 y Fh(repea)-6 b(t)440 1580 y Fm(A)22 b(rep)r(etition)f(of)g(a)g
(strategy)f Ff(s1)h Fm(for)f(0)h(or)g(more)f(times,)j(terminated)e
(with)h(an)f(application)440 1679 y(of)36 b(a)g(strategy)f
Ff(s2)h Fm(can)g(b)r(e)g(translated)g(in)n(to)g(a)g(lo)r(op)g
(structure.)62 b(Only)36 b(one)g Ff(Cpush)e Fm(is)440
1779 y(p)r(erformed)e(to)h(deal)f(with)h(failure)g(of)f(the)h(lo)r(op)g
(b)r(o)r(dy)-7 b(.)52 b(This)33 b(has)f(the)h(e\013ect)g(that)g(t)n(w)n
(o)440 1879 y(copies)d(of)g(the)h(sub)5 b(ject)31 b(term)f(are)f(on)i
(the)f(stac)n(k.)45 b(The)30 b(lo)r(op)g(b)r(o)r(dy)h(w)n(orks)e(on)h
(the)h(top-)440 1978 y(most.)36 b(If)26 b(the)f(b)r(o)r(dy)h(succeeds,)
f(this)h(term)f(can)g(b)r(e)h(committed)f(and)h(`sa)n(v)n(ed')e(b)n(y)h
(cop)n(ying)440 2078 y(it)j(o)n(v)n(er)e(the)i(term)f(under)h(the)g
(top)f(of)h(the)g(stac)n(k.)440 2247 y(The)g(pattern)f
Ff(Repeat\(s1,)40 b(s2\))26 b Fm(is)h(an)h(o)n(v)n(erla)n(y)d(that)j
(is)f(de\014ned)h(b)r(elo)n(w.)440 2491 y Ff(rules)484
2690 y(Cspecial)40 b(::)j(Instr\(Repeat\(?s)o(1,)37 b(?s2\),)42
b(?env,)f(?rcs\))h(-->)745 2790 y(!)h(Block\([Cpush\(end_)o(lo)o(op\))o
(,)1094 2889 y(Label\(loop\),)1094 2989 y(Instr\(s1,)d(env,)i(rcs\),)
1094 3089 y(Tduplinv,)1094 3188 y(Goto\(loop\),)1094
3288 y(Label\(end_loop\),)1094 3388 y(Instr\(s2,)e(env,)i(rcs\)]\))745
3487 y(where)g(new)g(=>)h(loop;)e(new)i(=>)f(end_loop)440
3731 y Fm(This)26 b(is)f(an)g(instance)g(of)h(tail)f(recursion)g(that)g
(can)g(b)r(e)h(further)g(generalized)e(to)h(arbitrary)440
3830 y(man)n(y)30 b(lo)r(op)g(b)r(o)r(dies.)45 b(In)30
b(that)h(generalization)d(w)n(e)i(migh)n(t)g(consider)g(the)g(follo)n
(wing)g(rule)440 3930 y(whic)n(h)e(is)f(not)h(applicable)f(in)h
(general)e(b)r(ecause)h(of)g(bac)n(ktrac)n(king:)789
4159 y Ff(Choice\(Seq\(s1,)37 b(Call\(SVar\(x\),)i([]\)\),)i(Seq\(s2,)g
(Call\(SVar\(x\),)d([]\)\)\))k(->)789 4258 y(Seq\(Choice\(s1,)37
b(s2\),)42 b(Call\(SVar\(x\),)d([]\)\))440 4487 y Fm(It)28
b(is)f(applicable)g(when)g(the)h(strategies)e Ff(s1)h
Fm(and)g Ff(s2)f Fm(are)h(m)n(utually)g(exclusiv)n(e,)g(i.e.,)g(if)h
Ff(s1)440 4587 y Fm(succeeds,)f Ff(s2)g Fm(cannot)g(p)r(ossibly)g
(succeed.)440 4756 y(The)d Ff(Repeat\(s1,)39 b(s2\))22
b Fm(o)n(v)n(erla)n(y)-7 b(.)33 b(The)24 b(o)n(v)n(erla)n(y)d
(recognizes)g(the)j(pattern)f(of)h(the)g Ff(repeat)440
4856 y Fm(strategy)i(op)r(erator)g(from)h(the)h(library:)789
5085 y Ff(repeat\(s\))40 b(=)j(rec)f(x\(\(s;)g(x\))g(<+)h(id\))440
5313 y Fm(but)19 b(generalized)e(to)i(arbitrary)d(terminators)i
(\(other)g(than)h Ff(id)p Fm(\).)33 b(The)19 b(o)n(v)n(erla)n(y)d
(transforms)440 5413 y(the)k(\014rst)g(argumen)n(t)f(of)h(the)g
Ff(LChoice)d Fm(to)j(a)f(left-asso)r(ciativ)n(e)g(pattern.)34
b(The)20 b(result)g(should)1810 5662 y(107)p eop
%%Page: 108 111
108 110 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(b)r(e)24 b(a)f(sequen)n(tial)g
(comp)r(osition)g(with)h(the)g(recursion)e(v)-5 b(ariable)22
b(as)h(second)g(argumen)n(t)g(and)440 631 y(a)33 b(strategy)g(as)g
(\014rst)h(argumen)n(t,)g(where)f(the)i(recursion)d(v)-5
b(ariable)33 b(do)r(es)g(not)h(app)r(ear)f(in)440 731
y(the)k(strategy)-7 b(.)64 b(The)37 b(second)f(de\014nition)i(tak)n(es)
e(care)g(of)h(the)g(presence)f(of)h Ff(CountRule)440
830 y Fm(strategies,)26 b(whic)n(h)i(are)e(added)i(b)n(y)f(the)h(fron)n
(tend)f(for)g(pro\014ling.)440 1083 y Ff(strategies)527
1282 y(Repeat\(s1,)40 b(s2\))i(=)789 1381 y({x:)g(Rec\(?x,)f
(LChoice\(repeat\(A)o(ss)o(oc)o(iat)o(eL)o(\);)1660 1481
y(Seq\(not\(oncetd\(SV)o(ar\()o(?x)o(\)\))o(\);)c(s1,)1835
1581 y(Call\(SVar\(?x\),)h([]\)\))1617 1680 y(,not\(oncetd\(SVar)o(\(?)
o(x\)\))o(\);)f(s2\)\)})527 1880 y(Repeat\(s1,)j(s2\))i(=)789
1979 y({x,)g(s1',)g(str:)832 2079 y(Rec\(?x,)f(LChoice\(repeat\(A)o
(sso)o(ci)o(at)o(eL\))o(;)1530 2178 y(?Seq\(s1',)f(Seq\(Call\(SVar\(x)o
(\),)d([]\),)42 b(Countrule\(str\)\)\))o(;)1530 2278
y(!Seq\(Seq\(s1',)c(CountRule\(str\)\),)f(Call\(SVar\(x\),)h([]\)\);)
1530 2378 y(Seq\(not\(oncetd\()o(SVa)o(r\()o(?x\))o(\)\))o(;)f(s1,)43
b(id\))1486 2477 y(,not\(oncetd\(SVar)o(\(?x)o(\)\))o(\);)37
b(s2\)\)})440 2730 y Fh(ma)-6 b(tching)32 b(onl)-6 b(y)31
b(tra)-7 b(versals)440 2899 y Fm(If)25 b(a)f(tra)n(v)n(ersal)d(is)k
(matc)n(hing)e(only)h(it)h(do)r(es)f(not)g(need)h(to)f(rebuild)g(the)h
(sub)5 b(ject)24 b(term)h(after)440 2999 y(insp)r(ection;)34
b(the)d(original)f(sub)5 b(ject)32 b(term)f(is)h(not)f(transformed.)47
b(This)32 b(should)f(b)r(e)h(done)440 3098 y(for)26 b(all)g(tra)n(v)n
(ersals)e(in)j(general,)e(but)i(w)n(e)f(try)h(it)g(out)f(\014rst)g(for)
g(the)h(oncetd)g(tra)n(v)n(ersal)d(from)440 3198 y(the)k(library)-7
b(.)440 3450 y Ff(strategies)527 3650 y(IsMatch)41 b(=)i
(not\(oncetd\(Build)o(\(id)o(\)\))o(\))527 3849 y(Oncetd\(s\))d(=)j
({x:)g(Rec\(?x,)d(LChoice\(s,)g(One\(Call\(SVar\(?)o(x\),)d
([]\)\)\)\)})527 4048 y(Cspecial)j(=)k(CsOncetd)440 4301
y(rules)527 4500 y(CsOncetd)c(::)614 4599 y(Instr\(Oncetd\(?s;)d
(IsMatch\),)j(?env,)i(?rcs\))f(-->)614 4699 y(!)j(Block\([)789
4799 y(Rpush\(endloop\),)789 4898 y(Label\(startloop)o(\),)789
4998 y(Cpush\(else\),)789 5098 y(Instr\(s,)c(env,)i(rcs\),)789
5197 y(Cpop,)789 5297 y(Goto\(repeat\),)789 5396 y(Label\(else\),)1810
5662 y Fm(108)p eop
%%Page: 109 112
109 111 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)789 531 y Ff(IsAppl,)789
631 y(MatchTravInit,)789 731 y(Label\(nextson\),)789
830 y(OneMatchNextSon)o(,)789 930 y(Cpush\(nextson\),)789
1029 y(Rpush\(doneit\),)789 1129 y(Goto\(startloop\))o(,)789
1229 y(Label\(doneit\),)789 1328 y(Cpop,)789 1428 y(MatchTravEnd,)789
1528 y(Label\(repeat\),)789 1627 y(Return,)789 1727 y(Label\(endloop\))
658 1826 y(]\))658 1926 y(where)k(new)i(=>)g(startloop;)919
2026 y(new)g(=>)g(else;)919 2125 y(new)g(=>)g(nextson;)919
2225 y(new)g(=>)g(doneit;)919 2325 y(new)g(=>)g(repeat;)919
2424 y(new)g(=>)g(endloop)440 2673 y Fh(fetch)440 2922
y Ff(strategies)527 3122 y(Fetch\(s\))d(=)k({x:)614 3221
y(Rec\(?x,)d(LChoice\(Cong\("Co)o(ns")o(,)c([s,)43 b(Id]\),)1312
3321 y(Cong\("Cons",)38 b([Id,)k(Call\(SVar\(?x\),[]\))o(]\))o(\)\)})
527 3520 y(Fetch\(s\))e(=)k({x:)614 3620 y(Rec\(?x,)d
(LChoice\(Seq\(Cong)o(\("C)o(on)o(s",)o([s)o(,I)o(d]\))o(,)c
(CountRule\("Cons"\))o(\),)1312 3719 y(Seq\(Cong\("Cons",)o([I)o(d,)o
(Cal)o(l\()o(SVa)o(r\()o(?x)o(\),[)o(]\))o(]\),)g(CountRule\("Cons")o
(\)\))o(\)\))o(})527 3919 y(Cspecial)j(=)k(CsFetch)440
4118 y(rules)527 4317 y(CsFetch)d(::)614 4417 y(Instr\(Fetch\(?s;)d
(IsMatch\),)i(?env,)h(?rcs\))h(-->)614 4516 y(!)i(Block\([)789
4616 y(Tdupl,)789 4716 y(Label\(a\),)789 4815 y(TestFunTop\(VAR\()o
(lab)o(\)\))o(,)789 4915 y(Cpush\(b\),)789 5015 y(Arg\(0\),)789
5114 y(Instr\(s,)c(env,)i(rcs\),)789 5214 y(Tpop,)789
5313 y(Cpop,)789 5413 y(Goto\(end\),)1810 5662 y Fm(109)p
eop
%%Page: 110 113
110 112 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)789 531 y Ff(Label\(b\),)789
631 y(Arg\(1\),)789 731 y(Tdrop,)789 830 y(Goto\(a\),)789
930 y(Label\(end\),)789 1029 y(Tpop,)702 1129 y(]\))571
1229 y(where)k(new)i(=>)f(a;)h(new)f(=>)h(b;)g(new)f(=>)h(end;)832
1328 y(<get-afun>)d(AFun\("Cons",)e(2\))43 b(=>)g(lab)440
1680 y Fm(This)23 b(can)f(b)r(e)i(generalized)d(to)i(other)f(tra)n(v)n
(ersals)e(that)j(ha)n(v)n(e)f(congruences)f(with)i(recursiv)n(e)440
1780 y(calls,)43 b(if)f(the)f(recursiv)n(e)e(call)h(is)h(only)f(to)g
(one)h(of)f(the)i(c)n(hildren)e(and)g(the)h(others)f(are)440
1880 y(iden)n(tities.)1810 5662 y(110)p eop
%%Page: 111 114
111 113 bop 440 199 a Fm(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(P)n(ostpro)r(ccesing)440 531 y(The)c(p)r(ostpro)r
(cessing)e(phase)h(of)h(the)g(compiler)f(tak)n(es)g(an)g(abstract)g
(mac)n(hine)g(program)440 631 y(and)d(deriv)n(es)f(initialization)i
(information)e(from)h(it.)43 b(Curren)n(tly)28 b(it)i(only)f(deals)g
(with)h(the)440 731 y(initialization)d(of)h(rule)f(coun)n(ters)g(b)n(y)
g(lo)r(oking)g(at)g(the)h(use)f(of)h Ff(CountRule)c Fm(instructions.)
1810 5662 y(111)p eop
%%Page: 112 115
112 114 bop 440 199 a Fm(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 531 y Fi(POSTPR)m(OCESS)440
726 y Fm(P)n(ostpro)r(cessing)e(of)i(generated)g(co)r(de)g(to)h
(extract)f(global)f(v)-5 b(ariable)27 b(information.)440
978 y Ff(module)41 b(postprocess)440 1078 y(imports)g(instructions)d
(lib)43 b(list-misc)d(list-sort)440 1277 y(rules)527
1476 y(CR1)j(:)g(ICountRule\(f\))38 b(->)43 b(RuleCounter\(f\))527
1675 y(CR2)g(:)g(RuleCounter\(f\))37 b(->)43 b(RuleCounter\(f,)38
b(<new>)k(f\))527 1875 y(CR3\(b_rcs\))e(:)j(ICountRule\(f\))38
b(->)43 b(ICountRule\(f'\))789 1974 y(where)e(b_rcs;)g
(fetch\(?RuleCounte)o(r\()o(f,)c(f'\)\))527 2174 y(Main)42
b(:)h(Block\(is\))d(->)j(Program\(RuleCoun)o(te)o(rs\()o(rc)o(s\),)37
b(Block\(is'\)\))832 2273 y(where)963 2373 y(<filter\(CR1\);)h(uniq;)k
(map\(CR2\)>)e(is)i(=>)h(rcs;)963 2472 y(<map\(try\(CR3\(!rc)o(s\)\))o
(\)>)37 b(is)43 b(=>)f(is')440 2672 y(strategies)527
2871 y(main)g(=)h(iowrap\(id\))1810 5662 y Fm(112)p eop
%%Page: 113 116
113 115 bop 440 199 a Fm(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)440 531 y(Consider)27
b(as)g(an)g(example)g(of)h(optimization:)440 767 y Ff(conc)42
b(.)h(map\(s\))440 867 y(zip\(id\))e(.)i(unzip)e(->)i(id)1810
5662 y Fm(113)p eop
%%Page: 114 117
114 116 bop 440 199 a Fm(Chapter:)36 b(Compiler)440 531
y(In)23 b(this)f(c)n(hapter)g(w)n(e)g(put)h(the)g(compiler)f(comp)r
(onen)n(ts)f(dev)n(elop)r(ed)h(in)h(the)g(previous)e(c)n(hap-)440
631 y(ters)27 b(together)g(in)n(to)g(the)h(Stratego)e(Compiler)h
Fd(sc)p Fm(.)1810 5662 y(114)p eop
%%Page: 115 118
115 117 bop 440 199 a Fm(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)440 531 y Ff(PROTO-SC)p Fi(:)28 b(STRA)-8
b(TEGO)32 b(COMPILER)440 722 y Fm(This)20 b(mo)r(dule)h(glues)f
(together)g(the)h(comp)r(onen)n(ts)f(that)g(mak)n(e)g(up)h(the)g
(Stratego)e(compiler.)440 822 y(It)j(is)f(usually)g(run)g(from)g(a)g
(script)g(that)g(pro)n(vides)f(the)i(default)g(information)e(ab)r(out)h
(paths.)440 1057 y Ff(module)41 b(sc)440 1157 y(imports)g(lib)h(sugar)
440 1256 y(signature)527 1356 y(sorts)g(Option)527 1456
y(constructors)614 1555 y(Dir)261 b(:)43 b(String)e(->)i(Option)614
1655 y(ExecDir)85 b(:)43 b(String)e(->)i(Option)614 1754
y(InclDir)85 b(:)43 b(String)e(->)i(Option)614 1854 y(CInclDir)e(:)i
(String)e(->)i(Option)614 1954 y(CLibDir)85 b(:)43 b(String)e(->)i
(Option)614 2053 y(Input)173 b(:)43 b(String)e(->)i(Option)614
2153 y(Main)217 b(:)43 b(String)e(->)i(Option)614 2253
y(AST)261 b(:)43 b(Option)614 2352 y(Ignore)129 b(:)43
b(Option)614 2452 y(CC)305 b(:)43 b(Option)614 2551 y(NORM)217
b(:)43 b(Option)614 2651 y(FUSION)129 b(:)43 b(Option)614
2751 y(FRONTEND)e(:)i(Option)440 2986 y Fm(Pro)r(cessing)26
b(the)h(command-line)h(options)440 3221 y Ff(strategies)527
3421 y(main)42 b(=)h(sc)527 3620 y(sc)g(=)g(\(process-sc-opti)o(ons)37
b(<+)43 b(sc-usage;)c(<exit>)j(1\);)745 3719 y(\(\(need-help\(sc-u)o
(sag)o(e;)37 b(<exit>)k(1\),)h(id\))789 3819 y(<+)g(sc-announce;)919
3919 y(parse;)919 4018 y(output-ast;)919 4118 y(add-main;)919
4218 y(core;)919 4317 y(cc1;)919 4417 y(cc2;)919 4516
y(try\(not\(\(option-d)o(efi)o(ne)o(d\(?)o(NO)o(RM)o(\(\)\))o(,)37
b(id\)\);)1094 4616 y(\(id,)42 b(remove-intermedi)o(at)o(es)o(\)\);)919
4716 y(<printnl>\(stderr,)37 b(["compilation)h(succeeded"]\);)919
4815 y(<exit>)k(0)789 4915 y(<+)g(<printnl>\(stderr,)37
b(["compilation)h(failed"]\);)919 5015 y(<exit>)k(1)745
5114 y(\))527 5313 y(process-sc-option)o(s)37 b(=)789
5413 y(where\(filter-op)o(tio)o(ns)o(\(?")o(-I)o("\))g(=>)43
b(incl\);)1810 5662 y Fm(115)p eop
%%Page: 116 119
116 118 bop 440 199 a Fm(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)789 531 y Ff(where\(filter-op)o(tio)o(n-)o(arg)o(s\()
o(?"-)o(CI)o("\))g(=>)43 b(cincl\);)789 631 y(where\(filter-op)o(tio)o
(n-)o(arg)o(s\()o(?"-)o(CL)o("\))37 b(=>)43 b(clib\);)789
731 y(parse-options\(s)o(c-o)o(pt)o(ion)o(s)37 b(<+)43
b(io-options\);)789 830 y(\(option-defined)o(\(In)o(pu)o(t\(?)o('i)o
(n\)\))o(;)789 930 y(\\)g(opts)f(->)876 1029 y(\([InclDir\(incl\),)37
b(CInclDir\(cincl\),)g(CLibDir\(clib\))h(|)43 b(opts],)919
1129 y(\('in,)f(".r"\)\))f(\\)789 1229 y(<+)h(\\opts)g(->)h(\([Help)e
(|)i(opts],)e(""\)\\)h(\))527 1428 y(sc-options)e(=)789
1528 y(ArgOption\("-e",)429 b(\\x)43 b(->)g(ExecDir\(x\)\\)c(\))789
1627 y(+)k(ArgOption\("-I",)342 b(!Ignore\))41 b(//)h(\\x)h(->)g
(InclDir\(x\)\\)c(\))789 1727 y(+)k(ArgOption\("--Inc)o(lu)o(de")o(,)37
b(!Ignore\))k(//)h(\\x)h(->)g(InclDir\(x\)\\)c(\))789
1826 y(+)k(ArgOption\("-CI",)298 b(!Ignore\))41 b(//)h(\\)i(\(x,y\))d
(->)i(CInclDir\(x\)\\)38 b(\))789 1926 y(+)43 b(ArgOption\("-CL",)298
b(!Ignore\))41 b(//)h(\\)i(\(x,y\))d(->)i(CLibDir\(x\)\\)c(\))789
2026 y(+)k(Option\("-CC",)430 b(!CC)43 b(\))789 2125
y(+)g(Option\("--norm",)342 b(!NORM)41 b(\))789 2225
y(+)i(ArgOption\("-i",)342 b(\\x)43 b(->)g(Input\(<basename>)37
b(x\)\\)42 b(\))789 2325 y(+)h(ArgOption\("--mai)o(n")o(,)168
b(\\x)43 b(->)g(Main\(x\)\\)d(\))789 2424 y(+)j(ArgOption\("-m",)342
b(\\x)43 b(->)g(Main\(x\)\\)d(\))789 2524 y(+)j(Option\("--ast",)342
b(!AST)42 b(\))789 2623 y(+)h(Option\("-F",)474 b(!FRONTEND)40
b(\))789 2723 y(+)j(Option\("--fusion)o(",)211 b(!FUSION)41
b(\))440 2922 y(strategies)527 3122 y(sc-usage)f(=)527
3221 y(sc-version;)527 3321 y(<printnl>\(stderr,)963
3421 y(["Usage:)g(sc)j([options])d(-i)j(file\\n",)1007
3520 y("Options:\\n",)1007 3620 y(")86 b(-i)43 b(spec)216
b(Compile)41 b(specification)d(spec\\n",)1007 3719 y(")86
b(-o)43 b(target)128 b(Name)42 b(executable)e(target\\n",)1007
3819 y(")86 b(--main)41 b(s)174 b(Name)42 b(main)g(strategy)f
([default:)e(main]\\n",)1007 3919 y(")86 b(-I)43 b(dir)260
b(Look)42 b(in)h(dir)f(for)h(imported)d(Stratego)g(modules\\n",)1007
4018 y(")86 b(-CI)43 b(dir)216 b(Look)42 b(in)h(dir)f(for)h(C)g
(include)e(files\\n",)1007 4118 y(")86 b(-CL)43 b(dir)216
b(Look)42 b(in)h(dir)f(for)h(C)g(object)e(libraries\\n",)1007
4218 y(")86 b(--ast)303 b(Output)42 b(abstract)e(syntax)h(of)i
(specification\\n)o(",)1007 4317 y(")86 b(--norm)259
b(Do)43 b(not)g(remove)e(intermediate)d(files\\n",)1007
4417 y(")86 b(-F)435 b(Produce)41 b(all)h(definitions)d(pre-processed)g
(by)j(frontend\\n",)1007 4516 y(")86 b(-h|--help)127
b(Display)41 b(this)h(message")963 4616 y(]\))527 4815
y(sc-version)e(=)527 4915 y(\(option-defined\(D)o(ec)o(lV)o(ers)o(io)o
(n\(?)o(ve)o(rsi)o(on)o(\)\))d(<+)43 b(!"")f(=>)h(version\);)527
5015 y(where\(<printnl>\(s)o(td)o(er)o(r,)789 5114 y(["The)e(Stratego)f
(Compiler)h(\(version)f(",)j(version,)d("\)"]\)\))527
5313 y(sc-announce)f(=)527 5413 y(try\(\(option-defin)o(ed)o(\(V)o(erb)
o(os)o(e\),)e(id\);)1810 5662 y Fm(116)p eop
%%Page: 117 120
117 119 bop 440 199 a Fm(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)702 531 y Ff(\(sc-version,)h(id\)\))440
756 y Fm(P)n(arsing)25 b(sp)r(eci\014cations)440 982
y Ff(strategies)527 1181 y(parse)42 b(=)614 1281 y(\(option-defined\(I)
o(nc)o(lDi)o(r\()o(?in)o(cl)o(\)\);)658 1380 y(option-defined\(E)o(xe)o
(cDi)o(r\()o(?ed)o(ir)o(\)\);)658 1480 y(try\(option-defin)o(ed)o(\(Ou)
o(tp)o(ut\()o(?o)o(ut\))o(\)\))o(,)37 b(id\);)614 1579
y(\(id,)42 b(pipe'\(<pref\(!edir)o(\)>)37 b("/pack-stratego")o(,)h
(!".tree",)1094 1679 y(<conc>)j(\(<!["-dep",)e(out])j(<+)h(![]>\(\),)d
(["--silent")f(|)44 b(incl]\)\)\);)614 1779 y(try\(\(id,)d
(copy-file\(id,)d(!out,)j(!".tree"\)\)\))440 2004 y(strategies)527
2203 y(output-ast)f(=)614 2303 y(try\(\(option-defin)o(ed)o(\(AS)o(T\))
o(,)e(\(?file,)i(?ext\)\);)789 2402 y(<printnl>\(stder)o(r,)1225
2502 y(["abstract)f(syntax)i(\(after)g(parsing\))f(written)h(to)i(",)g
(file,)e(ext]\);)789 2602 y(<exit>)g(0\))527 2801 y(output-frontend\(d)
o(ir)o(\))c(=)614 2900 y(try\(\(option-defin)o(ed)o(\(FR)o(ON)o(TEN)o
(D\))o(,id)o(\);)789 3000 y(\(id,)42 b(extract-all\(dir)o(\))1007
3100 y(<+)g(<fatal-error>)d(["extracting)f(all)43 b(definitions)c
(failed"]\);)789 3199 y(\(id,)j(\(?file,)e(?ext\)\);)789
3299 y(<printnl>\(stder)o(r,)1225 3399 y(["abstract)f(syntax)i(\(after)
g(frontend\))f(written)h(to)i(",)f(file,)g(ext]\);)789
3498 y(<exit>)f(0\))440 3723 y Fm(Adding)28 b(main)f(strategy)440
3893 y(\(***)g(What)g(happ)r(ens)h(if)g(the)g(sp)r(eci\014cation)f
(already)f(con)n(tains)h(a)g(main)h(strategy?)36 b(***\))440
4118 y Ff(rules)527 4317 y(AddMain\(m\))k(:)614 4417
y(Specification\(sec)o(ts)o(\))e(->)614 4516 y(Specification\([St)o(ra)
o(teg)o(ie)o(s\([)o(SD)o(ef\()o("m)o(ai)o(n",)f([],)42
b(Call\(SVar\(<m>\(\)\),)37 b([]\)\)]\))1225 4616 y(|)43
b(sects]\))440 4815 y(strategies)527 5015 y(add-main)d(=)614
5114 y(\(\(option-defined\()o(Ma)o(in\()o(?m)o(\)\),)d(id\);)658
5214 y(\(id,)42 b(transform-file\(A)o(dd)o(Mai)o(n\()o(!m\))o(,)37
b(!".tree1"\)\))658 5313 y(<+)43 b(\(id,)f(transform-file\()o(id,)37
b(!".tree1"\)\)\))1810 5662 y Fm(117)p eop
%%Page: 118 121
118 120 bop 440 199 a Fm(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)440 531 y(The)26 b(core)f(of)h(the)h(compiler)e
(consists)h(of)g(the)g(comp)r(onen)n(ts)g(that)g(transform)f(a)h(sp)r
(eci\014ca-)440 631 y(tion)i(to)f(abstract)g(mac)n(hine)g
(instructions.)440 883 y Ff(strategies)527 1083 y(core)42
b(=)614 1182 y(\(list\(try\(ExecDir)o(\(?)o(dir)o(\)\))o(\),)37
b(id\);)614 1282 y(\(id,)42 b(frontend\(!dir\)\);)832
1481 y(output-frontend\(!)o(di)o(r\);)614 1680 y(\(id,)g
(extract\(!dir\);)832 1780 y(inline\(!dir\);)832 1880
y(stratego-nf\(!dir\))o(;)832 1979 y(optimize1\(!dir\)\);)614
2178 y(try\(\(option-defin)o(ed)o(\(FU)o(SI)o(ON\))o(,)832
2278 y(fusion\(!dir\)\)\);)614 2477 y(\(id,)g(compile-match\(!di)o(r\))
o(;)832 2577 y(optimize2\(!dir\);)832 2677 y(stratego-of\(!dir\))o(;)
832 2776 y(backend\(!dir\);)832 2876 y(abstract-mf\(!dir\))o(;)832
2976 y(postprocess\(!dir\))o(;)832 3075 y(pp-instructions\(!)o(di)o
(r\))614 3175 y(\))527 3374 y(core-old)e(=)614 3474 y
(\(list\(try\(ExecDir)o(\(?)o(dir)o(\)\))o(\),)d(id\);)614
3573 y(\(id,)42 b(frontend\(!dir\);)832 3673 y(extract\(!dir\);)832
3773 y(inline\(!dir\);)832 3872 y(stratego-nf\(!dir\))o(;)832
3972 y(optimizer\(!dir\);)832 4071 y(stratego-nf\(!dir\))o(;)832
4171 y(matching-tree\(!di)o(r\))o(;)832 4271 y(stratego-of\(!dir\))o(;)
832 4370 y(optimizer\(!dir\);)832 4470 y(stratego-of\(!dir\))o(;)832
4570 y(backend\(!dir\);)832 4669 y(abstract-mf\(!dir\))o(;)832
4769 y(postprocess\(!dir\))o(;)832 4868 y(pp-instructions\(!)o(di)o
(r\))614 4968 y(\))440 5167 y(rules)527 5367 y(pref\(d\))f(:)i(x)g(->)g
(<conc-strings>)38 b(\(<d>\(\),)i(x\))1810 5662 y Fm(118)p
eop
%%Page: 119 122
119 121 bop 440 199 a Fm(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)440 631 y Ff(strategies)527 830 y(frontend\(d\))344
b(=)43 b(pipe\(<pref\(d\)>)38 b("/frontend",)257 b(!".s1"\))527
930 y(extract\(d\))388 b(=)43 b(pipe\(<pref\(d\)>)38
b("/extract",)301 b(!".s2"\))527 1029 y(extract-all\(d\))212
b(=)43 b(pipe\(<pref\(d\)>)38 b("/extract-all",)125 b(!".sdefs"\))527
1129 y(inline\(d\))432 b(=)43 b(pipe\(<pref\(d\)>)38
b("/inline",)345 b(!".s"\))527 1229 y(optimizer\(d\))300
b(=)43 b(pipe\(<pref\(d\)>)38 b("/optimizer",)213 b(!".so1"\))527
1328 y(matching-tree\(d\))124 b(=)43 b(pipe\(<pref\(d\)>)38
b("/matching-tree",)f(!".so2"\))527 1627 y(optimize1\(d\))300
b(=)43 b(pipe\(<pref\(d\)>)38 b("/optimize1",)213 b(!".so1"\))527
1826 y(fusion\(d\))432 b(=)43 b(pipe\(<pref\(d\)>)38
b("/fusion",)345 b(!".so2"\))527 2026 y(compile-match\(d\))124
b(=)43 b(pipe\(<pref\(d\)>)38 b("/compile-match",)f(!".so3"\))527
2125 y(optimize2\(d\))300 b(=)43 b(pipe\(<pref\(d\)>)38
b("/optimize2",)213 b(!".so4"\))527 2325 y(backend\(d\))388
b(=)43 b(pipe\(<pref\(d\)>)38 b("/backend",)301 b(!".i1"\))527
2524 y(new-backend\(d\))212 b(=)43 b(pipe\(<pref\(d\)>)38
b("/newbackend",)125 b(!".i1"\))527 2723 y(postprocess\(d\))212
b(=)43 b(pipe\(<pref\(d\)>)38 b("/postprocess",)125 b(!".i"\))527
2922 y(pp-instructions\(d)o(\))37 b(=)43 b(pipe\(<pref\(d\)>)38
b("/pp-instructions)o(",)f(!".c"\))527 3122 y(stratego-nf\(d\))212
b(=)43 b(pipe\(<pref\(d\)>)38 b("/Stratego-Normal)o(-F)o(orm)o(at)o(",)
f(id\))527 3221 y(stratego-of\(d\))212 b(=)43 b(pipe\(<pref\(d\)>)38
b("/Stratego-Optimi)o(ze)o(d-F)o(or)o(mat)o(",)f(id\))527
3321 y(abstract-mf\(d\))212 b(=)43 b(pipe\(<pref\(d\)>)38
b("/Abstract-Machin)o(e-)o(For)o(ma)o(t",)f(id\))440
3573 y(strategies)440 3773 y(rules)527 3972 y(I-option)j(:)k(x)f(->)g
(<conc-strings>\()o("-I)o(",)37 b(x\))527 4071 y(L-option)j(:)k(x)f(->)
g(<conc-strings>\()o("-L)o(",)37 b(x\))440 4271 y(strategies)527
4470 y(lib\(d\))259 b(=)43 b(<conc-strings>\(<d)o(>\(\))o(,)37
b("/lib"\))527 4570 y(liblib\(d\))127 b(=)43 b(<conc-strings>\(<l)o
(ib\()o(d\))o(>\()o(\),)37 b("/lib"\))527 4669 y(include\(d\))83
b(=)43 b(<conc-strings>\(<l)o(ib\()o(d\))o(>\()o(\),)37
b("/include"\))527 4769 y(libstrat\(d\))i(=)k(<conc-strings>\(<l)o
(ib\()o(d\))o(>\()o(\),)37 b("/stratego"\))527 4968 y(gcc)43
b(=)g(\\)g(args)f(->)h(<call>\("gcc",)38 b(args\))j(\\)527
5167 y(cc1)i(=)789 5267 y(where\(<printnl>)o(\(st)o(de)o(rr,)37
b(["compiling"]\)\);)789 5367 y(\(list\(try\(CIncl)o(Dir)o(\(?)o(cin)o
(cl)o(\)\)\))o(,)g(id\);)1810 5662 y Fm(119)p eop
%%Page: 120 123
120 122 bop 440 199 a Fm(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)789 531 y Ff(\(id,)42
b(where\(conc-stri)o(ngs)37 b(=>)43 b(cfile\);)1007 631
y(\(id,)f(!".o"\);)1007 731 y(where\(conc-stri)o(ngs)37
b(=>)43 b(target\);)1007 830 y(where\(<gcc>)c(<conc>)i(\(cincl,["-c",)d
(cfile,"-o",)h(target]\)\)\))527 1029 y(cc2)k(=)789 1129
y(where\(<printnl>)o(\(st)o(de)o(rr,)37 b(["linking"]\)\);)789
1229 y(\(list\(try\(Dir\(?)o(dir)o(\))g(+)44 b(CLibDir\(?clib\))37
b(+)44 b(Output\(?out\)\)\),)37 b(id\);)789 1328 y(\(id,)42
b(where\(conc-stri)o(ngs)37 b(=>)43 b(ofile\);)1007 1428
y(\(try\(!out\),)c(!""\);)1007 1528 y(where\(conc-stri)o(ngs)e(=>)43
b(target\);)1007 1627 y(where\(<gcc>)c(<conc>\([ofile,)e("-o",)42
b(target],)1835 1727 y(<map\(split-at-sp)o(ac)o(e\))o(;)c(concat>)i
(clib\)\)\))527 1926 y(remove-intermedia)o(te)o(s)d(=)614
2026 y(?\(base,)k(_\);)614 2125 y(where\(<rzip\(conc-)o(st)o(rin)o(gs)o
(\);)c(rm-files>)963 2225 y(\(base,)k([".tree",)f(".tree1",)g(".s",)h
(".s1",)g(".s2",)1312 2325 y(".so1",)f(".so2",)h(".so3",)g(".so4",)1312
2424 y(".i1",)g(".i",)g(".o"]\)\))1810 5662 y Fm(120)p
eop
%%Page: 121 124
121 123 bop 1538 2168 a Fb(P)-5 b(art)66 b(I)5 b(I)g(I)949
2653 y Fa(Run-Time)78 b(System)1810 5662 y Fm(121)p eop
%%Page: 122 125
122 124 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
531 y Fh(displa)-6 b(ys)32 b(vs)f(st)-6 b(a)g(tic)32
b(links)440 701 y Fm(Dealing)21 b(with)g(static)g(scop)r(e)g(requires)f
(k)n(eeping)g(trac)n(k)g(of)h(the)h(curren)n(tly)e(enclosing)g(scop)r
(e.)440 800 y(In)27 b(simple)g(cases)f(it)h(is)f(su\016cien)n(t)h(to)g
(tak)n(e)f(an)g(o\013set)h(from)g(the)g(top)f(of)h(the)g(en)n(vironmen)
n(t)440 900 y(stac)n(k.)440 1136 y Ff(environment[esp)37
b(-)44 b(o])440 1372 y Fm(But)25 b(when)f(sev)n(eral)e(activ)-5
b(ations)24 b(of)g(the)h(same)e(scop)r(e)h(can)g(b)r(e)h(created)e(due)
i(to)f(recursion,)440 1471 y(this)34 b(mec)n(hanism)e(fails)i(b)r
(ecause)f(the)g(static)g(o\013sets)g(to)h(v)-5 b(ariables)32
b(in)h(outer)g(scop)r(es)g(do)440 1571 y(not)28 b(corresp)r(ond)e(to)h
(the)h(dynamic)f(o\013sets)h(on)f(the)h(actual)f(stac)n(k.)440
1740 y(Common)e(solutions)g(for)h(this)g(problem)f(are)g(static)g
(links,)h(displa)n(ys)f(and)g(lam)n(b)r(da)h(lifting)440
1840 y(\(e.g.,)i([1)o(]\).)440 2009 y(Displa)n(ys)35
b(use)h(a)f(global)g(arra)n(y)e(that)j(giv)n(e)f(for)g(eac)n(h)g
(nesting)h(depth)g(the)g(most)g(recen)n(t)440 2109 y(activ)-5
b(ation)35 b(record)g(for)g(that)h(nesting)f(depth.)62
b(This)36 b(giv)n(es)e(fast)i(access)f(to)g(the)h(stac)n(k.)440
2208 y(Ho)n(w)n(ev)n(er,)25 b(it)j(turns)f(out)g(that)h(this)f(mec)n
(hanism)g(requires)f(a)h(lot)g(of)g(b)r(o)r(okk)n(eeping)f(and)h(it)440
2308 y(do)r(es)g(not)g(com)n(bine)g(w)n(ell)g(with)h(bac)n(ktrac)n
(king.)35 b(F)-7 b(or)26 b(eac)n(h)h(en)n(try)g(in)g(the)h(displa)n(y)e
(a)h(stac)n(k)440 2408 y(of)h(previous)e(activ)-5 b(ation)27
b(records)f(has)h(to)h(b)r(e)g(main)n(tained.)440 2577
y(A)d(static)g(link)g(is)f(a)h(reference)e(to)i(the)g(activ)-5
b(ation)24 b(record)g(of)g(the)i(previous)d(nesting)i(lev)n(el.)440
2677 y(Finding)36 b(a)g(stac)n(k)f(o\013set)h(using)g(static)g(links)f
(requires)g(follo)n(wing)g(the)i(links)f(un)n(til)g(the)440
2776 y(activ)-5 b(ation)27 b(record)f(of)i(the)g(righ)n(t)f(lev)n(el)g
(is)g(found.)440 2946 y(The)20 b(Stratego)e(run-time)i(system)f(uses)h
(static)f(links.)34 b(There)19 b(is)h(a)f(single)g(stac)n(k)g(that)h(k)
n(eeps)440 3045 y(trac)n(k)i(of)g(static)h(links.)35
b(A)23 b(static)g(link)g(consists)f(of)h(a)f(p)r(oin)n(ter)h(to)f(the)h
(en)n(vironmen)n(t)f(stac)n(k,)440 3145 y(the)36 b(nesting)e(depth)i
(and)f(a)g(p)r(oin)n(ter)f(to)h(the)h(static)f(link)g(of)g(the)h
(enclosing)e(activ)-5 b(ation)440 3244 y(record.)1810
5662 y(122)p eop
%%Page: 123 126
123 125 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.h)440 531 y Ff(/*)440 731
y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)
440 930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)k($Id:)f(stratego.h,v)c(1.3)43
b(2000/10/30)c(00:08:44)h(visser)h(Exp)i($)g(*/)440 2823
y(#include)d(<aterm2.h>)440 2922 y(#include)g("stratego/aterm-e)o(xt)o
(ens)o(io)o(n.h)o(")440 3022 y(#include)g("stratego/debug.h)o(")440
3122 y(#include)g("stratego/util.h")440 3221 y(#include)g
("stratego/options)o(.h)o(")440 3321 y(#include)g("stratego/svm.h")1810
5662 y Fm(123)p eop
%%Page: 124 127
124 126 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(aterm-extension.h)440 531 y Ff(/*)440
731 y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g
(<visser@acm.org>)440 930 y(This)h(program)f(is)h(free)g(software;)e
(you)j(can)f(redistribute)c(it)43 b(and/or)e(modify)440
1029 y(it)i(under)e(the)i(terms)e(of)i(the)f(GNU)h(General)d(Public)h
(License)g(as)i(published)d(by)440 1129 y(the)i(Free)g(Software)f
(Foundation;)e(either)i(version)f(2,)j(or)g(\(at)f(your)g(option\))440
1229 y(any)g(later)g(version.)440 1428 y(This)g(program)f(is)h
(distributed)d(in)k(the)g(hope)e(that)h(it)h(will)f(be)h(useful,)440
1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e(without)h(even)h(the)g
(implied)f(warranty)f(of)440 1627 y(MERCHANTABILITY)d(or)43
b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)84 b(See)42
b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h(more)g
(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f(of)h
(the)f(GNU)g(General)f(Public)g(License)440 2026 y(along)h(with)f(this)
h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)g(Software)440
2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h(Suite)f(330,)g
(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440 2424
y(*/)440 2623 y(/*)k($Id:)f(aterm-extension)o(.h,)o(v)37
b(1.5)43 b(2000/09/03)c(17:24:04)h(visser)i(Exp)g($)h(*/)440
2823 y(#include)d(<aterm2.h>)440 3022 y(/*)j(Extension)d(of)i(ATerm)g
(library)f(*/)440 3221 y(#define)g(t_string\(t\))e(ATgetName\(ATgetS)o
(ym)o(bo)o(l\(t)o(\)\))440 3421 y(#define)i(t_is_appl\(t\))d
(\(ATgetType\(t\))h(==)j(AT_APPL\))440 3620 y(#define)f
(t_is_string\(t\))c(\(t_is_appl\(t\))i(&&)j(ATisQuoted\(ATgetS)o(ymb)o
(ol)o(\(t\))o(\)\))440 3819 y(#define)f(ATisReal\(t\))e
(\(ATgetType\(t\))f(==)43 b(AT_REAL\))440 3919 y(#define)e
(ATisInt\(t\))83 b(\(ATgetType\(t\))38 b(==)43 b(AT_INT\))440
4118 y(ATerm)f(list_to_consnil)o(\(A)o(Ter)o(m)37 b(t\);)440
4218 y(ATerm)42 b(list_to_tconstn)o(il)o(\(AT)o(er)o(m)c(t\);)440
4317 y(ATerm)k(list_to_consnil)o(_o)o(p\(A)o(Te)o(rmL)o(is)o(t)c(t\);)
440 4417 y(ATerm)k(list_to_consnil)o(_o)o(p_t)o(l\()o(ATe)o(rm)o(Lis)o
(t)37 b(t,)43 b(ATerm)f(tl\);)440 4516 y(ATerm)g(list_to_consnil)o(_s)o
(hal)o(lo)o(w\(A)o(Te)o(rm)37 b(t\);)440 4616 y(ATerm)42
b(list_to_tconstn)o(il)o(_op)o(\(A)o(Ter)o(mL)o(ist)37
b(t\);)440 4716 y(ATerm)42 b(consnil_to_list)o(\(A)o(Ter)o(m)37
b(t\);)440 4815 y(ATerm)42 b(consnil_to_list)o(_s)o(hal)o(lo)o(w\(A)o
(Te)o(rm)37 b(t\);)440 4915 y(ATerm)42 b(tuple_cong\(ATer)o(mL)o(ist)37
b(t\);)440 5015 y(ATerm)42 b(list_cong\(ATerm)o(Li)o(st)37
b(t,)43 b(ATerm)f(tl\);)440 5214 y(#define)f(MakeInt\(n\))e
(\(\(ATerm\)ATmakeInt)o(\(n)o(\)\))440 5413 y(ATerm)j(ATmakeString\(ch)
o(ar)37 b(*name\);)1810 5662 y Fm(124)p eop
%%Page: 125 128
125 127 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(aterm-extension.h)440 531 y Ff(ATerm)42
b(ATmakeStringQ\(c)o(ha)o(r)c(*name\);)440 631 y(ATbool)j
(ATisString\(ATerm)c(t\);)440 731 y(ATbool)k(ATisThisString\(A)o(Ter)o
(m)c(t,)43 b(char)f(*name\);)440 830 y(ATermList)e(ATmap\(ATermList)d
(l,)43 b(ATerm)f(\(*)g(f\)\(ATerm\)\);)440 930 y(ATbool)f
(AThasName\(ATerm)c(t,)43 b(char)f(*name\);)440 1129
y(ATerm)g(App0\(char)d(*name\);)440 1229 y(ATerm)j(App1\(char)d(*name,)
i(ATerm)h(arg1\);)440 1328 y(ATerm)g(App2\(char)d(*name,)i(ATerm)h
(arg1,)g(ATerm)f(arg2\);)440 1428 y(ATerm)h(App3\(char)d(*name,)i
(ATerm)h(arg1,)g(ATerm)f(arg2,)h(ATerm)f(arg3\);)440
1528 y(ATerm)h(App4\(char)d(*name,)i(ATerm)h(arg1,)g(ATerm)f(arg2,)h
(ATerm)f(arg3,)h(ATerm)f(arg4\);)440 1627 y(ATerm)h(App5\(char)d
(*name,)i(ATerm)h(arg1,)g(ATerm)f(arg2,)h(ATerm)f(arg3,)h(ATerm)f
(arg4,)h(ATerm)f(arg5\);)440 1727 y(ATerm)h(App6\(char)d(*name,)i
(ATerm)h(arg1,)g(ATerm)f(arg2,)h(ATerm)f(arg3,)h(ATerm)f(arg4,)h(ATerm)
f(arg5,)h(ATerm)f(arg6\);)440 1826 y(ATerm)h(App7\(char)d(*name,)i
(ATerm)h(arg1,)g(ATerm)f(arg2,)h(ATerm)f(arg3,)h(ATerm)f(arg4,)h(ATerm)
f(arg5,)h(ATerm)f(arg6,)h(ATerm)f(arg7\);)440 2026 y(ATerm)h
(AppN\(char)d(*name,)i(ATermList)f(args\);)440 2225 y(#define)h
(ATisInt\(t\))e(\(ATgetType\(t\))f(==)43 b(AT_INT\))1810
5662 y Fm(125)p eop
%%Page: 126 129
126 128 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(debug.h)440 531 y Ff(/*)440 731 y(Copyright)j
(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)440
930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)k(Booleans)d(*/)440 2723 y(#include)g
(<assert.h>)440 2922 y(#define)h(true)h(1)440 3022 y(#define)f(false)g
(0)440 3221 y(extern)g(int)h(debugging;)440 3421 y(/*)h(#define)d
(DEBUG)i(*/)440 3620 y(#define)f(toe\(t\))g(\(ATisEmpty\(t\))d(?)43
b(t)g(:)h(ATgetFirst\(t\)\))440 3819 y(#ifdef)d(DEBUG)440
3919 y(#define)g(trace\(x\))f(Trace\("",)g(x,)j(term_stack,)c
(return_stack,)f(environment,)g(\\)745 4018 y(choice_stack,)g
(lchoice_stack\))440 4118 y(#define)j(debug\(x\))f(Trace\(x,)g(-1,)j
(term_stack,)c(return_stack,)f(environment,)g(\\)745
4218 y(choice_stack,)g(lchoice_stack\))440 4317 y(#define)j
(debugs\(x\))f(if)i(\(debugging)e(>)j(1\))g(x)440 4417
y(#else)440 4516 y(#define)e(trace\(x\))440 4616 y(#define)g
(debug\(x\))440 4716 y(#define)g(debugs\(x\))440 4815
y(#endif)1810 5662 y Fm(126)p eop
%%Page: 127 130
127 129 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(util.h)440 531 y Ff(/*)440 731 y(Copyright)j(\(C\))
i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)440
930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(#ifndef)i(UTIL_H)440 2723 y(#define)g(UTIL_H)440
2922 y(#include)f(<string.h>)440 3122 y(#ifndef)h(streq)440
3221 y(#)87 b(define)41 b(streq\(s,t\))e(\(!\(strcmp\(s,t\)\)\))440
3321 y(#endif)440 3520 y(#ifndef)i(MIN)440 3620 y(#)87
b(define)41 b(MIN\(a,b\))f(\(\(a\))i(<)h(\(b\))g(?)g(\(a\))f(:)h
(\(b\)\))440 3719 y(#endif)440 3919 y(#ifndef)e(MAX)440
4018 y(#)87 b(define)41 b(MAX\(a,b\))f(\(\(a\))i(>)h(\(b\))g(?)g(\(a\))
f(:)h(\(b\)\))440 4118 y(#endif)440 4317 y(#define)e(IDX_TOTAL)650
b(0)440 4417 y(#define)41 b(IDX_MIN)738 b(1)440 4516
y(#define)41 b(IDX_MAX)738 b(2)440 4716 y(#define)41
b(STATS\(array,)d(value\))85 b(\\)527 4815 y(array[IDX_TOTAL])37
b(+=)43 b(value;)e(\\)527 4915 y(if\(value)f(<)k(array[IDX_MIN]\))37
b(\\)614 5015 y(array[IDX_MIN])h(=)43 b(value;)85 b(\\)527
5114 y(if\(value)40 b(>)k(array[IDX_MAX]\))37 b(\\)614
5214 y(array[IDX_MAX])h(=)43 b(value)1810 5662 y Fm(127)p
eop
%%Page: 128 131
128 130 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(util.h)440 531 y Ff(#define)k(MYMAXINT)f
(0x7FFFFFFF)440 731 y(#endif)1810 5662 y Fm(128)p eop
%%Page: 129 132
129 131 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(options.h)440 531 y Ff(/*)440 731
y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)
440 930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(#include)h(<aterm2.h>)440 2823 y(ATbool)h(silent;)
440 2922 y(char)h(*program_name;)440 3022 y(char)g(*input_file;)440
3122 y(char)g(*output_file;)440 3221 y(ATbool)f(binary_output;)440
3321 y(int)86 b(show_stats;)440 3421 y(ATermList)40 b(includes;)440
3620 y(void)i(process_options\()o(in)o(t)c(argc,)j(char)h(*argv[]\);)
1810 5662 y Fm(129)p eop
%%Page: 130 133
130 132 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Ff(/*)440 731 y(Copyright)j(\(C\))i
(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)440
930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)440 2823 y($Id:)j(svm.h,v)f(1.11)h(2000/09/21)d
(11:18:38)h(visser)h(Exp)i($)440 3022 y(Implementation)38
b(of)43 b(abstract)d(machine)h(instructions)d(for)k(strategy)f(core)h
(language)440 3221 y(TODO)440 3421 y(*)h(The)g(environment)c(is)j(not)h
(saved)e(before)g(a)i(choice.)e(This)h(means)g(that)g(some)527
3520 y(variables)e(can)i(become)f(instantiated)e(in)k(a)g(failing)e
(alternative)e(and)j(then)527 3620 y(not)h(be)f(restored)f(to)h
(unitialized.)440 3819 y(*)h(Make)f(stack)g(sizes)f(dynamic)g(or)i(at)f
(least)g(configurable)c(from)k(the)527 3919 y(command-line.)440
4118 y(*/)440 4317 y(#ifndef)f(__defined_strat)o(ego)o(_s)o(vm_)o(h)440
4417 y(#define)g(__defined_strat)o(ego)o(_s)o(vm_)o(h)440
4616 y(/*)i(Constants)d(for)i(stack-size)d(*/)440 4815
y(#define)i(TSIZE)g(150000)440 4915 y(#define)g(RSIZE)g(150000)440
5015 y(#define)g(ESIZE)g(150000)440 5114 y(#define)g(DSIZE)g(100000)440
5214 y(#define)g(CSIZE)g(150000)440 5313 y(#define)g(NR_COUNTERS)e
(50000)440 5413 y(#define)i(NR_RULECOUNTERS)c(0)1810
5662 y Fm(130)p eop
%%Page: 131 134
131 133 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 631 y Ff(/*)43 b(Idiom)e(*/)440
830 y(#define)g(between\(a,)e(x,)k(b\))g(\(assert\(\(a\))c(<=)j
(\(x\)\),)g(assert\(\(x\))d(<=)k(\(b\)\)\))440 1029 y(/*)g(Error)e
(handling)g(*/)440 1229 y(#define)g(panic\(s\))f(ATfprintf\(stderr)o(,)
e("fatal)j(error:)g(\045s\\n",)g(s\);)h(exit\(1\);)440
1428 y(/*)h(Dispatching)c(*/)440 1627 y(#define)i(GO\(s\))g({register)f
(void)i(*a;)g(if\(\(a)g(=)h(s\))g(!=)g(NULL\))e(goto)h(*a;})440
1826 y(#define)f(GOBOOL\(s\))f(if\(\(s\))h(==)h(0\))h(goto)f(fail;)440
2026 y(/*)h(Profiling)d(*/)440 2225 y(extern)h(int)h(rule_counter;)440
2325 y(extern)f(int)h(match_counter;)440 2424 y(extern)f(int)h
(build_counter;)440 2623 y(struct)f({)527 2723 y(char)h(*name;)527
2823 y(long)g(int)g(count;)440 2922 y(})h(rule_counters[NR_)o(RU)o(LE)o
(COU)o(NT)o(ERS)o(];)440 3122 y(long)f(int)g(cur_rule_counter;)440
3321 y(#define)f(CountRule\(f\))d(rule_counters[f].)o(co)o(unt)o(++)o
(;)g(rule_counter++;)440 3520 y(#define)j(RuleCounter\(s1,)c(s2,)42
b(n\))h(\\)571 3620 y(rule_counters[n])o(.n)o(am)o(e)38
b(=)43 b(s2;)f(rule_counters[n].)o(co)o(un)o(t)c(=)43
b(0;)440 3919 y(/*)g(Counters)d(*/)440 4118 y(struct)h({)527
4218 y(int)i(count;)527 4317 y(int)g(ok;)440 4417 y(})g
(counter_stack[NR_)o(CO)o(UN)o(TER)o(S])o(;)440 4516
y(long)f(int)g(cur_counter;)440 4716 y(#define)f(CounterInit\(\))81
b(cur_counter)40 b(=)j(-1)440 4915 y(#define)e(NewCounter\(\))82
b(assert\(cur_count)o(er)37 b(<)43 b(NR_COUNTERS)c(-)k(1\);)g(\\)1399
5015 y(cur_counter++;)38 b(\\)1399 5114 y(counter_stack[cu)o(r_)o(cou)o
(nt)o(er])o(.c)o(ou)o(nt)f(=)43 b(1;)g(\\)1399 5214 y(counter_stack[cu)
o(r_)o(cou)o(nt)o(er])o(.o)o(k)37 b(=)44 b(0;)440 5413
y(#define)d(CloseCounter\(\))81 b(cur_counter--;)1810
5662 y Fm(131)p eop
%%Page: 132 135
132 134 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 631 y Ff(#define)k(CounterOK\(\))213
b(counter_stack[cu)o(r_c)o(ou)o(nte)o(r])o(.o)o(k)38
b(=)43 b(1)440 731 y(#define)e(IsCounterOK\(\))125 b(counter_stack[cu)o
(r_c)o(ou)o(nte)o(r])o(.o)o(k)440 930 y(#define)41 b(TheCounter\(\))169
b(\(counter_stack[c)o(ur_)o(co)o(unt)o(er)o(].)o(cou)o(nt)o(\))440
1029 y(#define)41 b(IncCounter\(\))169 b(TheCounter\(\)++)440
1129 y(#define)41 b(DecCounter\(\))169 b(TheCounter\(\)--)440
1229 y(#define)41 b(SetCounter\(i\))125 b(TheCounter\(\))39
b(=)k(i)440 1428 y(/*)g(Term)f(stack)f(*/)440 1627 y(ATerm)h
(term_stack[TSIZ)o(E])o(;)440 1727 y(long)g(int)g(tsp;)440
1926 y(/*)h(The)f(stackpointer)d(tsp)j(points)f(to)i(the)f(element)f
(on)i(top)f(of)h(the)f(stack)g(*/)440 2125 y(#define)f(Ttop\(\))302
b(\(term_stack[tsp]\))440 2225 y(#define)41 b(Ttopi\(i\))214
b(\(term_stack[tsp)38 b(-)43 b(\(i\)]\))440 2325 y(#define)e(Tset\(t\))
258 b(assert\(\(t\))40 b(!=)j(NULL\);)e(Ttop\(\))g(=)i(\(t\))440
2424 y(#define)e(Tseti\(i,)f(t\))86 b(assert\(\(t\))40
b(!=)j(NULL\);)e(Ttopi\(i\))f(=)j(\(t\))440 2524 y(#define)e(Tpush\(\))
258 b(assert\(tsp)40 b(<)j(TSIZE\);)e(tsp++;)g(Ttop\(\))g(=)i(NULL)440
2623 y(#define)e(Tpop\(\))302 b(assert\(tsp)40 b(>)j(0\);)f(tsp--)440
2723 y(#define)f(Tdupl\(\))258 b(Tpush\(\);)41 b(Tset\(Ttopi\(1\)\))440
2823 y(#define)g(Tduplinv\(\))126 b(Tseti\(1,)41 b(Ttop\(\)\);)440
2922 y(#define)g(Tdrop\(\))258 b(Tseti\(1,)41 b(Ttop\(\)\);)f(Tpop\(\))
440 3022 y(#define)h(Tinitst\(\))170 b(tsp)43 b(=)g(0;)g(Ttop\(\))e(=)i
(NULL)440 3221 y(#define)e(Tswap\(i,)f(j\))86 b({ATerm)41
b(t;)i(t)g(=)h(Ttopi\(i\);)39 b(Tseti\(i,)i(Ttopi\(j\)\);)e(Tseti\(j,)h
(t\);})440 3421 y(#define)h(Arg\(n\))302 b(Tpush\(\);)41
b(Tset\(ATgetArgum)o(ent)o(\(T)o(to)o(pi\()o(1\))o(,)d(n\)\))440
3620 y(#define)j(Argi\(i,)f(n\))130 b(Tpush\(\);)41 b(Tset\(ATgetArgum)
o(ent)o(\(T)o(to)o(pi\()o(i\))o(,)d(n\)\))440 3819 y(void)k
(TprintStack\(void)o(\);)440 3919 y(void)g(TprintStackTop\(i)o(nt)37
b(j,)43 b(char)f(*s\);)440 4118 y(/*)h(Return)e(stack)g(*/)440
4317 y(void)h(*return_stack[RS)o(IZ)o(E];)440 4417 y(long)g(int)g(rsp;)
440 4616 y(void)g(*fail_address;)440 4716 y(ATbool)f(failed;)440
4915 y(/*)i(rsp)f(points)f(to)i(the)f(next)g(*free*)f(element)g(of)i
(the)f(return)f(stack)h(*/)440 5114 y(#define)f(Rpush\(l\))f(\\)527
5214 y(if\(rsp)h(>=)i(RSIZE\))e({)i(\\)614 5313 y(ATfprintf\(stderr,)37
b("Fatal)k(error:)g(loop)h(detected")e(\\)702 5413 y(")j(\(rstack)d
(overflow;)g(rsp)j(=)g(\045d\)\\n",)d(rsp\);)i(\\)1810
5662 y Fm(132)p eop
%%Page: 133 136
133 135 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)614 531 y Ff(assert\(rsp)j(<)j(RSIZE\);)e(\\)
527 631 y(})i(return_stack[rsp+)o(+])37 b(=)43 b(&&l;)440
731 y(#define)e(Return\(\))f(goto)i(*\(return_stack[-)o(-r)o(sp])o(\))
440 930 y(/*)h(Environment)c(stack)i(*/)440 1129 y(ATerm)h
(environment[ESI)o(ZE)o(];)440 1229 y(long)g(int)g(esp;)440
1428 y(/*)h(esp)f(points)f(to)i(the)f(next)g(*free*)f(element)g(in)i
(the)f(environment)d(*/)440 1627 y(#define)i(Einit\(\))171
b(esp)42 b(=)i(0;)440 1826 y(#define)d(Ei\(i\))259 b(\(esp)42
b(-)h(\(i\)\))440 2026 y(#define)e(Eget\(i\))171 b(\(between\(0,)39
b(Ei\(i\),)i(ESIZE\),)g(environment[Ei\(i)o(\)]\))440
2125 y(#define)g(Eset\(i,)f(t\))j(\(between\(0,)c(Ei\(i\),)i(ESIZE\),)g
(environment[Ei\(i)o(\)])c(=)43 b(\(t\)\))440 2325 y(#define)e
(Egeta\(i\))171 b(\(between\(0,)39 b(i,)k(ESIZE\),)d(environment[i]\))
440 2424 y(#define)h(Eseta\(i,)f(t\))j(\(between\(0,)c(i,)k(ESIZE\),)d
(environment[i])e(=)43 b(\(t\)\))440 2623 y(#define)e(Enext\(\))171
b({assert\(esp)39 b(<)k(ESIZE\);)e(environment[esp+)o(+])c(=)43
b(NULL;})440 2723 y(#define)e(Eprev\(\))171 b({assert\(esp)39
b(<)k(ESIZE\);)e(environment[--es)o(p])c(=)43 b(NULL;})440
2922 y(#define)e(Epush\(i\))127 b({int)42 b(j;)h(for\(j)e(=)j(0;)e(j)h
(<)h(i;)e(j++\))g({Enext\(\);}})440 3022 y(#define)f(Epop\(i\))171
b({int)42 b(j;)h(for\(j)e(=)j(0;)e(j)h(<)h(i;)e(j++\))g({Eprev\(\);}})
440 3221 y(void)g(EprintStack\(void)o(\);)440 3321 y(void)g
(EprintStackTop\(i)o(nt)o(,)c(char)k(*\);)440 3520 y(/*)h(Display)d
(stack)i(*/)440 3719 y(long)g(int)g(display[DSIZE];)440
3819 y(int)g(dsp;)440 4018 y(long)g(int)g(Ed\(int)f(i,)i(int)f(o\);)440
4218 y(#define)f(Egetd\(i,)f(o\))173 b(Egeta\(Ed\(i,)40
b(o\)\))440 4317 y(#define)h(Esetd\(i,)f(o,)j(t\))f(Eseta\(Ed\(i,)e
(o\),)i(t\))440 4516 y(#define)f(D\(i\))85 b(display)440
4716 y(#define)41 b(DgetEsp\(\))257 b(display_stack[dsp)o(].e)o(sp)440
4815 y(#define)41 b(DsetEsp\(i\))213 b(display_stack[dsp)o(].e)o(sp)37
b(=)43 b(i)440 5015 y(void)f(Epushd\(int)d(i,)k(int)f(o\);)440
5114 y(void)g(Epopd\(int)e(i,)j(int)f(o\);)440 5214 y(void)g
(Dinit\(void\);)440 5313 y(void)g(Drestore\(void\);)1810
5662 y Fm(133)p eop
%%Page: 134 137
134 136 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Ff(/*)43 b(Matching)d(*/)440
731 y(void)i(*_MatchVar\(int)c(i\);)440 830 y(void)k(*_MatchVard\(int)
37 b(i,)43 b(long)f(int)g(o\);)440 930 y(void)g(*_MatchInt\(int)c(i\);)
440 1029 y(void)k(*_MatchIntFC\(int)37 b(i,)43 b(void)f(*\);)440
1129 y(void)g(*_MatchReal\(doub)o(le)37 b(i\);)440 1229
y(void)42 b(*_MatchRealFC\(do)o(ub)o(le)37 b(i,)43 b(void)f(*\);)440
1328 y(void)g(*_MatchString\(ch)o(ar)37 b(*s\);)440 1428
y(void)42 b(*_MatchStringFC\()o(ch)o(ar)37 b(*s,)43 b(void)f(*\);)440
1528 y(void)g(*_MatchFun\(char)37 b(*f,)43 b(int)f(n\);)440
1627 y(void)g(*_MatchFunFC\(cha)o(r)37 b(*f,)43 b(int)f(n,)h(void)f
(*fc\);)440 1826 y(//)h(void)f(*_TestFunFC\(cha)o(r)c(*f,)k(int)g(n,)h
(void)f(*fc,)g(ATerm\);)440 1926 y(void)g(*_TestFunFC\(AFun)o(,)37
b(void)42 b(*fc,)g(ATerm\);)440 2125 y(void)g(*_TestIntFC\(int)37
b(n,)43 b(void)f(*fc,)g(ATerm\);)440 2225 y(void)g(*_TestRealFC\(dou)o
(bl)o(e,)37 b(void)42 b(*fc,)g(ATerm\);)440 2325 y(void)g
(*_TestStringFC\(c)o(ha)o(r)c(*,)k(void)g(*fc,)g(ATerm\);)440
2524 y(#define)f(MatchVar\(i\))431 b(GO\(_MatchVar\(i\)\))440
2623 y(#define)41 b(MatchVard\(i,)d(o\))261 b(GO\(_MatchVard\(i,)37
b(o\)\))440 2723 y(#define)k(MatchInt\(i\))431 b(GO\(_MatchInt\(i\)\))
440 2823 y(#define)41 b(MatchIntFC\(i,)d(fc\))173 b(GO\(_MatchIntFC\(i)
o(,)38 b(fc\)\))440 2922 y(#define)j(MatchReal\(i\))387
b(GO\(_MatchReal\(i\))o(\))440 3022 y(#define)41 b(MatchRealFC\(i,)c
(fc\))130 b(GO\(_MatchRealFC\()o(i,)37 b(fc\)\))440 3122
y(#define)k(MatchString\(s\))299 b(GO\(_MatchString\()o(s\)\))440
3221 y(#define)41 b(MatchStringFC\(s)o(,)d(fc\))k(GO\(_MatchStringF)o
(C\(s)o(,)37 b(fc\)\))440 3321 y(#define)k(MatchFun\(f,)e(n\))304
b(GO\(_MatchFun\(f,)37 b(n\)\))440 3421 y(#define)k(MatchFunFC\(f,)d
(n,)43 b(fc\))f(GO\(_MatchFunFC\(f)o(,)c(n,)k(fc\)\))440
3620 y(//)h(#define)d(TestFunFC\(f,)f(n,)k(fc,)f(t\))174
b(GO\(_TestFunFC\(f)o(,)38 b(n,)k(fc,)h(t\)\))440 3719
y(#define)e(TestFunFC\(f,)d(fc,)43 b(t\))173 b(GO\(_TestFunFC\(f,)37
b(fc,)42 b(t\)\))440 3919 y(#define)f(TestIntFC\(n,)d(fc,)43
b(t\))173 b(GO\(_TestIntFC\(n,)37 b(fc,)42 b(t\)\))440
4018 y(#define)f(TestRealFC\(n,)d(fc,)k(t\))130 b(GO\(_TestStringFC\()o
(n,)37 b(fc,)42 b(t\)\))440 4118 y(#define)f(TestStringFC\(n,)c(fc,)42
b(t\))h(GO\(_TestStringFC\()o(n,)37 b(fc,)42 b(t\)\))440
4317 y(/*)h(Building)d(*/)440 4516 y(#define)h(NotNULLd\(i,)e(o\))j(\\)
527 4616 y({if\(Egetd\(i,)d(o\))k(==)f(NULL\))g(goto)g(*fail_address;})
440 4815 y(#define)f(BuildVar\(i\))e(\\)527 4915 y({ATerm)i(t;)i(\\)571
5015 y(if\(\(t)e(=)i(Eget\(i\)\))e(==)h(NULL\))g({)h(\\)658
5114 y(/*)g(ATfprintf\(stder)o(r,)37 b("Warning:)j(unbound)h(variable)f
(\(\045d\)\\n",)g(i\);)j(*/)f(\\)658 5214 y(goto)g(*fail_address;)c(\\)
571 5313 y(})43 b(else)f({Tset\(t\);}})1810 5662 y Fm(134)p
eop
%%Page: 135 138
135 137 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Ff(#define)k(BuildVard\(i,)d(o\))43
b(\\)527 631 y({ATerm)e(t;)i(\\)571 731 y(if\(\(t)e(=)i(Egetd\(i,)e
(o\)\))h(==)h(NULL\))e({)j(\\)658 830 y(/*)f(ATfprintf\(stder)o(r,)37
b("Warning:)j(unbound)h(variable)f(\(\045d,)i(\045d\)\\n",)f(i,)h(o\);)
h(*/)g(\\)658 930 y(goto)f(*fail_address;)c(\\)571 1029
y(})43 b(else)f({Tset\(t\);}})440 1229 y(#define)f(BuildStr\(s\))e(\\)
527 1328 y(Tset\(ATmakeString)o(\(s)o(\)\))440 1528 y(#define)i
(BuildInt\(i\))e(\\)527 1627 y(Tset\(\(ATerm\))g(ATmakeInt\(i\)\))440
1826 y(#define)i(BuildReal\(r\))d(\\)527 1926 y(Tset\(\(ATerm\))h
(ATmakeReal\(r\)\))440 2125 y(void)j(BuildFun\(char)c(*f,)k(int)h(i\);)
440 2325 y(/*)g(Annotations)c(*/)440 2524 y(#define)i(GetAnn\(\))f(\\)
440 2623 y({ATerm)h(x;)i(\\)484 2723 y(if\(\(x)e(=)i
(ATgetAnnotation\(T)o(to)o(pi\()o(1\))o(,)38 b(Ttop\(\)\)\))i(==)j
(NULL\))e(\\)527 2823 y({)i(goto)f(*fail_address;)c(})43
b(\\)484 2922 y(else)f({)h(Tset\(x\);)d(})j(\\)440 3022
y(})440 3221 y(#define)e(SetAnn\(\))f(\\)484 3321 y(Tseti\(2,)g
(ATsetAnnotation\()o(Tt)o(opi)o(\(2)o(\),)d(Ttopi\(1\),)j
(Ttop\(\)\)\);)g(Tpop\(\);)h(Tpop\(\))440 3520 y(#define)g
(RemoveAnn\(\))e(\\)527 3620 y(Tseti\(1,)h(ATremoveAnnotatio)o(n\(T)o
(to)o(pi\()o(1\))o(,)d(Ttop\(\)\)\);)j(Tpop\(\);)440
3819 y(/*)j(Choice)e(stack)g(*/)440 4018 y(struct)g({)527
4118 y(long)h(int)g(tsp;)527 4218 y(long)g(int)g(esp;)527
4317 y(long)g(int)g(rsp;)527 4417 y(long)g(int)g(counter;)527
4516 y(void)173 b(*continuation;)527 4616 y(int)260 b(dsp;)440
4716 y(})43 b(choice_stack[CSIZ)o(E])o(;)440 4815 y(long)f(int)g(csp;)
440 5015 y(/*)h(csp)f(points)f(to)i(the)f(next)g(free)g(choice)f(stack)
h(entry)f(*/)440 5214 y(#define)g(Cset\(cont,)e(a,)k(b,)g(c,)f(d,)h
(e\))g(\\)440 5313 y({)g(\\)527 5413 y(choice_stack[csp])o(.c)o(on)o
(tin)o(ua)o(tio)o(n)37 b(=)44 b(cont;)d(\\)1810 5662
y Fm(135)p eop
%%Page: 136 139
136 138 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)527 531 y Ff(choice_stack[csp])o(.t)o(sp)g(=)
43 b(a;)g(\\)527 631 y(choice_stack[csp])o(.e)o(sp)37
b(=)43 b(b;)g(\\)527 731 y(choice_stack[csp])o(.r)o(sp)37
b(=)43 b(c;)g(\\)527 830 y(choice_stack[csp])o(.c)o(ou)o(nte)o(r)37
b(=)44 b(d;)e(\\)527 930 y(choice_stack[csp])o(.d)o(sp)37
b(=)43 b(e;)g(\\)440 1029 y(})440 1229 y(#define)e(Cpush\(x\))f(\\)440
1328 y({)j(\\)527 1428 y(assert\(csp)d(<)j(CSIZE\);)d(\\)527
1528 y(Cset\(&&x,)g(tsp,)i(esp,)g(rsp,)g(cur_counter,)c(dsp\);)k(\\)527
1627 y(csp++;)f(Tdupl\(\);)g(\\)440 1727 y(})440 1926
y(#define)g(Cpop\(\))84 b(Tdrop\(\);)41 b(csp--;)440
2125 y(#define)g(Crestore\(\))83 b(\\)440 2225 y({)43
b(\\)527 2325 y(csp--;)e(\\)527 2424 y(tsp)i(=)g(choice_stack[cs)o(p].)
o(ts)o(p;)37 b(\\)527 2524 y(esp)43 b(=)g(choice_stack[cs)o(p].)o(es)o
(p;)37 b(\\)527 2623 y(rsp)43 b(=)g(choice_stack[cs)o(p].)o(rs)o(p;\\)
527 2723 y(dsp)g(=)g(choice_stack[cs)o(p].)o(ds)o(p;)37
b(\\)527 2823 y(cur_counter)i(=)k(choice_stack[csp])o(.co)o(un)o(te)o
(r;)37 b(\\)440 2922 y(})440 3122 y(#define)k(Cjump\(\))f({goto)i
(*choice_stack[cs)o(p])o(.co)o(nt)o(inu)o(at)o(io)o(n;})440
3321 y(#define)f(Ccontinue\(x\))d(\\)440 3421 y({)43
b(\\)527 3520 y(choice_stack[csp])o(.c)o(on)o(tin)o(ua)o(tio)o(n)37
b(=)44 b(&&x;)d(\\)527 3620 y(csp++;)g(\\)527 3719 y(Tdupl\(\);)f(\\)
440 3819 y(})440 4018 y(#define)h(Cempty\(\))f(\(csp)i(==)h(0\))440
4218 y(void)f(CprintStackTop\(i)o(nt)37 b(j,)43 b(char)f(*s\);)440
4417 y(/*)h(Path)f(Traversal)e(*/)440 4616 y(#define)h(IsAppl\(\))f
(if\(!t_is_appl\(Tt)o(op\()o(\)\))o(\))d({goto)42 b(*fail_address;};)
440 4815 y(#define)f(TpushIthSon\(i\))c(Tpush\(\);)k(Tset\(ATgetArgume)
o(nt)o(\(T)o(top)o(i\()o(1\),)c(i)43 b(-)g(1\)\);)440
5015 y(#define)e(TputIthSon\(i\))d(Tseti\(1,)i(ATsetArgument\(Tto)o(pi)
o(\(1)o(\),)d(Ttop\(\),)k(i)i(-)g(1\)\);)f(Tpop\(\);)440
5214 y(/*)h(Traversal)d(*/)440 5413 y(void)i(TravInit\(\);)1810
5662 y Fm(136)p eop
%%Page: 137 140
137 139 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Ff(void)42 b(*_NextSon\(void)c
(*on_empty\);)440 631 y(void)k(*_SomeNextSon\(vo)o(id)37
b(*s\);)440 731 y(void)42 b(TravBuild\(void\);)440 930
y(#define)f(NextSon\(x\))213 b(GO\(_NextSon\(x\)\))440
1029 y(#define)41 b(SomeNextSon\(x\))c(GO\(_SomeNextSon\(x)o(\)\))440
1229 y(#define)k(AllInit\(\))257 b(TravInit\(\))440 1328
y(#define)41 b(AllNextSon\(s\))81 b(NextSon\(s\))440
1428 y(#define)41 b(AllBuild\(\))213 b(TravBuild\(\))440
1627 y(#define)41 b(OneInit\(\))257 b(TravInit\(\))440
1727 y(#define)41 b(OneNextSon\(\))125 b(NextSon\(fail_addr)o(ess)o(\))
440 1826 y(#define)41 b(OneBuild\(\))213 b(TravBuild\(\))440
2026 y(#define)41 b(SomeInit\(\))213 b(TravInit\(\))440
2125 y(#define)41 b(SomeBuild\(\))169 b(TravBuild\(\))440
2325 y(#define)41 b(ThreadInit\(\))82 b(\\)571 2424 y
(MatchFun\("Pair",)37 b(2\);)42 b(\\)571 2524 y(Arg\(1\);)e(\\)571
2623 y(Argi\(2,0\);)f(\\)571 2723 y(TravInit\(\);)440
2922 y(#define)i(ThreadNextSon\(s)o(\))d(\\)571 3022
y(NextSon\(s\);)h(\\)571 3122 y(Tpush\(\);)h(\\)571 3221
y(Tset\(Ttopi\(TheCo)o(un)o(te)o(r\(\))d(+)43 b(3\)\);)f(\\)571
3321 y(Tpush\(\);)e(\\)571 3421 y(BuildFun\("Pair",)d(2\);)440
3620 y(#define)k(ThreadSetEnv\(\))c(\\)571 3719 y(MatchFun\("Pair",)o
(2\))o(;)g(\\)571 3819 y(Arg\(0\);)j(\\)571 3919 y(Argi\(2,)g(1\);)j
(\\)571 4018 y(Tseti\(TheCounter)o(\(\))37 b(+)43 b(4,)g(Ttop\(\)\);)d
(\\)571 4118 y(Tpop\(\);)g(\\)571 4218 y(Tdrop\(\);)440
4417 y(#define)h(ThreadGetEnv\(\))c(ThreadSetEnv\(\))440
4616 y(#define)k(ThreadBuild\(\))81 b(\\)571 4716 y(TravBuild\(\);)38
b(\\)571 4815 y(Tswap\(0,1\);)h(\\)571 4915 y(Tpush\(\);)h(\\)571
5015 y(BuildFun\("Pair",)d(2\);)42 b(\\)571 5114 y(Tdrop\(\);)440
5313 y(void)g(MatchTravInit\(\);)440 5413 y(void)g(*_MatchNextSon\(v)o
(oi)o(d)c(*on_empty\);)1810 5662 y Fm(137)p eop
%%Page: 138 141
138 140 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 631 y Ff(#define)k(OneMatchNextSon)o
(\(\))c(GO\(_MatchNextSon\()o(fa)o(il_)o(ad)o(dr)o(ess)o(\)\))440
731 y(#define)k(MatchTravEnd\(\))81 b({Tpop\(\);)40 b
(CloseCounter\(\);})440 930 y(/*)j(Procedure)d(header)h(and)h(footer)f
(*/)440 1129 y(#define)g(DOIT_START)e(\\)440 1229 y(\\)440
1328 y(ATerm)j(doit\(ATerm)d(t\))k(\\)440 1428 y({)g(\\)527
1528 y(Tinitst\(\);)d(Einit\(\);)g(CounterInit\(\);)e(Tset\(t\);)i
(fail_address)f(=)k(&&fail;)440 1727 y(#define)e(DOIT_END)f(\\)440
1826 y(\\)527 1926 y(return\(Ttop\(\)\);)e(\\)527 2026
y(fail)k(:)h(\\)614 2125 y(if\(csp)e(>)j(0\))e({Crestore\(\);)d
(Cjump\(\);})h(\\)614 2225 y(if\(csp)h(==)i(0\))g({\\)702
2325 y(ATfprintf\(stder)o(r,)37 b("**)42 b(strategy)f(failed\\n"\);)e
(\\)702 2424 y(failed)i(=)i(ATtrue;)d(return)i(Ttop\(\);)e(\\)702
2524 y(exit\(1\);)g(})j(\\)614 2623 y(else)f({ATfprintf\(stderr)o(,)37
b("****)42 b(Cstack)f(underflow\\n"\);)d(exit\(2\);})i(\\)440
2723 y(})440 2922 y(int)i(_stratego_main\(vo)o(id)o(\);)440
3122 y(#define)f(DOIT)h(\\)440 3221 y(\\)440 3321 y(ATerm)g
(doit\(ATerm)d(t\))k(\\)440 3421 y({)g(\\)527 3520 y(Tinitst\(\);)d
(Einit\(\);)g(CounterInit\(\);)e(Tset\(t\);)i(fail_address)f(=)k
(&&fail;)d(\\)527 3620 y(_stratego_init_af)o(un)o(s\()o(\);)d(\\)527
3719 y(_stratego_main\(\);)g(\\)440 3819 y(\\)527 3919
y(return\(Ttop\(\)\);)h(\\)527 4018 y(fail)k(:)h(\\)614
4118 y(if\(csp)e(>)j(0\))e({Crestore\(\);)d(Cjump\(\);})h(\\)614
4218 y(if\(csp)h(==)i(0\))g({\\)702 4317 y(ATfprintf\(stder)o(r,)37
b("**)42 b(strategy)f(failed\\n"\);)e(\\)702 4417 y(failed)i(=)i
(ATtrue;)d(return)i(Ttop\(\);)e(\\)702 4516 y(exit\(1\);)g(})j(\\)614
4616 y(else)f({ATfprintf\(stderr)o(,)37 b("****)42 b(Cstack)f
(underflow\\n"\);)d(exit\(2\);})i(\\)440 4716 y(})440
4815 y(#endif)440 5114 y(/*)j(New)f(instructions)d(*/)440
5413 y(#define)i(MoveTerm\(i1,)d(o1,)43 b(t2\))f(\\)1810
5662 y Fm(138)p eop
%%Page: 139 142
139 141 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)571 531 y Ff({ATerm)k(t1)i(=)g(Egetd\(i1,)d
(o1\);)i(\\)614 631 y(if\(t1)g(!=)h(NULL)f(&&)g(t1)h(!=)g(t2\))f(goto)g
(fail;)g(\\)614 731 y(else)g(Esetd\(i1,)e(o1,)i(t2\);})440
930 y(#define)f(MoveTop\(i,)e(o\))k(MoveTerm\(i,)c(o,)k(Ttop\(\)\))440
1129 y(#define)e(Move\(i1,)f(o1,)i(i2,)h(o2\))f(\\)571
1229 y({ATerm)f(t2)i(=)g(Egetd\(i2,)d(o2\);)i(MoveTerm\(i1,)c(o1,)43
b(t2\);})440 1428 y(#define)e(MoveArg\(i1,)e(o1,)j(i2,)g(o2,)h(n\))g
(\\)571 1528 y(Esetd\(i1,)d(o1,)i(ATgetArgument\(Eg)o(etd)o(\(i)o(2,)37
b(o2\),)42 b(n\)\))440 1727 y(#define)f(TestFun\(i,)e(o,)k(f,)g(n,)f
(k\))h(\\)571 1826 y(TestFunFC\(ATmake)o(AF)o(un)o(\(f,)37
b(n,)43 b(0\),)f(k,)h(Egetd\(i,)d(o\)\))440 2026 y(#define)h
(TestFunTop\(f\))d(\\)571 2125 y(TestFunFC\(f,)g(&&fail,)j(Ttop\(\)\))
440 2325 y(#define)g(TestInt\(i,)e(o,)k(n,)g(k\))f(\\)571
2424 y(TestIntFC\(n,)c(k,)43 b(Egetd\(i,)d(o\)\))440
2623 y(#define)h(TestReal\(i,)e(o,)j(n,)h(k\))g(\\)571
2723 y(TestRealFC\(n,)38 b(k,)43 b(Egetd\(i,)d(o\)\))440
2922 y(#define)h(TestStr\(i,)e(o,)k(n,)g(k\))f(\\)571
3022 y(TestStringFC\(n,)37 b(k,)43 b(Egetd\(i,)d(o\)\))440
3221 y(#define)h(PROC\(f\))f(\\)440 3321 y(int)i(f\(void\))f(\\)440
3421 y({)i(\\)527 3520 y(int)g(csp_bottom)c(=)k(csp;)f(\\)527
3620 y(Cpush\(fail\);)440 3819 y(#define)f(ENDPROC)f(\\)527
3919 y(Cpop\(\);)h(\\)527 4018 y(assert\(csp)f(==)i(csp_bottom\);)d(\\)
527 4118 y(return)i(1;)i(\\)527 4218 y(fail)f(:)h(\\)614
4317 y(if\(csp)e(>)j(csp_bottom\))39 b({Crestore\(\);)f(Cjump\(\);})i
(\\)614 4417 y(if\(csp)h(==)i(csp_bottom\))c(return)i(0;)i(\\)614
4516 y(else)f({ATfprintf\(stderr)o(,)37 b("****)42 b(Cstack)f
(underflow\\n"\);)d(exit\(2\);})i(\\)440 4616 y(})440
4815 y(#define)h(PROCDECL\(f\))e(\\)571 4915 y(int)j(f\(void\))440
5114 y(#define)f(Ccall\(f\))f(\\)571 5214 y(GOBOOL\(f\(\)\))440
5413 y(#define)h(VARDECL\(t,)e(x\))k(t)g(x)1810 5662
y Fm(139)p eop
%%Page: 140 143
140 142 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 631 y Ff(#define)k(MOVE\(x,)f(e\))j(x)g
(=)g(\(e\);)f(ATprotectAFun\(x\))1810 5662 y Fm(140)p
eop
%%Page: 141 144
141 143 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 531 y Ff(/*)440 731
y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)
440 930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)440 2823 y($Id:)j(stratego.c,v)d(1.8)j
(2000/09/20)d(08:08:26)i(visser)g(Exp)h($)440 3022 y(Implementation)c
(of)43 b(abstract)d(machine)h(instructions)d(for)k(stragegy)440
3122 y(primitives.)d(See)j(strategy.h)e(for)i(more)g(documentation.)440
3321 y(*/)440 3520 y(#include)e(<aterm2.h>)440 3620 y(#include)g
("stratego.h")440 3819 y(#define)h(ATmakeSymbol)d(ATmakeAFun)440
4018 y(ATbool)j(ATfindSymbol\(cha)o(r)d(*name,)j(int)h(arity,)f(ATbool)
g(quoted\);)440 4218 y(/*)i(Profiling)d(*/)440 4417 y(int)i
(rule_counter)d(=)k(0;)440 4516 y(int)f(match_counter)d(=)k(0;)440
4616 y(int)f(build_counter)d(=)k(0;)440 4716 y(ATbool)e(failed)g(=)i
(false;)440 4915 y(/*)g(Term)f(stack)f(*/)440 5114 y(void)h
(TprintStack\(void)o(\))440 5214 y({)527 5313 y(TprintStackTop\(ts)o
(p,)37 b(""\);)440 5413 y(})1810 5662 y Fm(141)p eop
%%Page: 142 145
142 144 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 631 y Ff(void)42 b
(TprintStackTop\(i)o(nt)37 b(j,)43 b(char)f(*s\))440
731 y({)527 830 y(int)h(i;)527 930 y(ATfprintf\(stderr,)37
b("tsp)42 b(=)h(\045d)g(\045s\\n",)e(tsp,)h(s\);)527
1029 y(for\(i)g(=)h(tsp;)f(i)h(>=)g(tsp)f(-)h(j)g(&&)g(i)g(>=)g(0;)g
(i--\))f({)614 1129 y(if\(term_stack[i])37 b(==)43 b(NULL\))702
1229 y(ATfprintf\(stder)o(r,)37 b(")87 b(ts[\045d])41
b(=)i(NULL)f(\(\045d\)\\n",)e(i,)j(tsp)f(==)h(i\);)614
1328 y(else)702 1428 y(ATfprintf\(stder)o(r,)37 b(")87
b(ts[\045d])41 b(=)i(\045t)g(\(\045d\)\\n",)127 b(i,)43
b(term_stack[i],)38 b(tsp)k(==)h(i\);)527 1528 y(})440
1627 y(})440 1826 y(/*)g(Environment)c(stack)i(*/)440
2026 y(void)h(EprintStack\(void)o(\))440 2125 y({)527
2225 y(int)h(i;)527 2325 y(ATfprintf\(stdout,)37 b("esp)42
b(=)h(\045d\\n",)e(esp\);)527 2424 y(for\(i)h(=)h(0;)g(i)g(<=)g(esp;)e
(i++\))h({)614 2524 y(if\(environment[i])37 b(==)43 b(NULL\))702
2623 y(ATfprintf\(stdou)o(t,)37 b(")87 b(es[\045d])41
b(=)i(NULL)f(\(\045d\)\\n",)e(i,)j(esp)f(==)h(i\);)614
2723 y(else)702 2823 y(ATfprintf\(stdou)o(t,)37 b(")87
b(es[\045d])41 b(=)i(\045t)g(\(\045d\)\\n",)127 b(i,)43
b(environment[i],)37 b(esp)43 b(==)g(i\);)527 2922 y(})440
3022 y(})440 3221 y(void)f(EprintStackTop\(i)o(nt)37
b(j,)43 b(char)f(*s\))440 3321 y({)527 3421 y(int)h(i;)527
3520 y(ATfprintf\(stdout,)37 b("esp)42 b(=)h(\045d)g(\045s\\n",)e(esp,)
h(s\);)527 3620 y(for\(i)g(=)h(esp;)f(i)h(>=)g(esp)f(-)h(j)g(&&)g(i)g
(>=)g(0;)g(i--\))f({)614 3719 y(if\(environment[i])37
b(==)43 b(NULL\))702 3819 y(ATfprintf\(stdou)o(t,)37
b(")87 b(es[\045d])41 b(=)i(NULL)f(\(\045d\)\\n",)e(i,)j(esp)f(==)h
(i\);)614 3919 y(else)702 4018 y(ATfprintf\(stdou)o(t,)37
b(")87 b(es[\045d])41 b(=)i(\045t)g(\(\045d\)\\n",)127
b(i,)43 b(environment[i],)37 b(esp)43 b(==)g(i\);)527
4118 y(})440 4218 y(})440 4516 y(void)f(CprintStackTop\(i)o(nt)37
b(j,)43 b(char)f(*s\))440 4616 y({)527 4716 y(int)h(i;)527
4815 y(ATfprintf\(stdout,)37 b("csp)42 b(=)h(\045d)g(\045s\\n",)e(csp,)
h(s\);)527 4915 y(for\(i)g(=)h(csp;)f(i)h(>=)g(csp)f(-)h(j)g(&&)g(i)g
(>=)g(0;)g(i--\))f({)614 5015 y(ATfprintf\(stdout,)37
b(")87 b(csp[\045d])40 b(=)k(\(\045d,\045d,\045d,\045d,\045d)o(,\045)o
(d\)\\)o(n")702 5114 y(,i)702 5214 y(,choice_stack[i)o(].)o(con)o(ti)o
(nua)o(ti)o(on)702 5313 y(,choice_stack[i)o(].)o(tsp)702
5413 y(,choice_stack[i)o(].)o(esp)1810 5662 y Fm(142)p
eop
%%Page: 143 146
143 145 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)702 531 y Ff(,choice_stack[i)o(].)o(rsp)
702 631 y(,choice_stack[i)o(].)o(cou)o(nt)o(er)702 731
y(,choice_stack[i)o(].)o(dsp)702 830 y(\);)527 930 y(})440
1029 y(})440 1229 y(/*)43 b(Display)d(stack)i(*/)440
1428 y(int)g(max_nesting)d(=)44 b(-1;)440 1627 y(#define)d(Desp\(x\))
215 b(display[x])440 1727 y(#define)41 b(Dnesting\(x\))e(display[x)h(-)
j(1])440 1826 y(#define)e(Dnext\(x\))171 b(display[x)40
b(-)j(2])440 2026 y(void)f(Dinit\(void\))440 2125 y({)527
2225 y(dsp)h(=)g(-1;)440 2325 y(})440 2524 y(int)f(dframe\(int)e(i\))
440 2623 y({)527 2723 y(int)j(x;)527 2823 y(x)g(=)h(dsp;)527
2922 y(while\(x)d(>=)i(2)g(&&)g(Dnesting\(x\))c(>)k(i\))614
3022 y(x)h(=)f(Dnext\(x\);)527 3122 y(return)e(Dnesting\(x\))e(==)k(i)g
(?)g(x)h(:)f(-1;)440 3221 y(})440 3421 y(long)f(int)g(Ed\(int)f(i,)i
(int)f(o\))440 3520 y({)527 3620 y(int)h(x;)527 3719
y(x)g(=)h(display[dframe\()o(i\))o(])38 b(-)43 b(o;)527
3819 y(//ATfprintf\(stder)o(r,)37 b("Ed\(\045d,)k(\045d\))h(=)h(\045d)g
(\(frame)e(=)i(\045d\)\\n",)e(i,)i(o,)f(x,)h(dframe\(i\)\);)527
3919 y(return)e(x;)440 4018 y(})440 4218 y(void)h(Epushd\(int)d(i,)k
(int)f(o\))440 4317 y({)527 4417 y(int)h(x)g(=)g(dframe\(i)d(-)j(1\);)
527 4516 y(Epush\(o\);)527 4616 y(dsp)g(+=)f(3;)527 4716
y(Desp\(dsp\))214 b(=)44 b(esp;)527 4815 y(Dnesting\(dsp\))38
b(=)44 b(i;)527 4915 y(Dnext\(dsp\))170 b(=)44 b(x;)527
5015 y(//ATfprintf\(stder)o(r,)37 b("Epushd\(\045d,)i(\045d\))j(:)h(x)h
(=)f(\045d)g(dsp)f(=)h(\045d\\n",)e(i,)i(o,)g(x,)f(dsp\);)440
5114 y(})440 5313 y(void)g(Epopd\(int)e(i,)j(int)f(o\))440
5413 y({)1810 5662 y Fm(143)p eop
%%Page: 144 147
144 146 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)527 531 y Ff(assert\(Desp\(dsp\))g(==)43
b(esp\);)527 631 y(assert\(Dnesting\(d)o(sp)o(\))37 b(==)43
b(i\);)527 731 y(Epop\(o\);)527 830 y(dsp)g(-=)f(3;)527
930 y(//ATfprintf\(stder)o(r,)37 b("Epopd\(\045d,)i(\045d\))k(:)g(dsp)f
(=)h(\045d\\n",)e(i,)i(o,)g(dsp\);)440 1029 y(})440 1229
y(void)f(Drestore\(void\))440 1328 y({)440 1428 y(})440
1627 y(/*)h(Matching)d(*/)440 1826 y(void)i(*_MatchVar\(int)c(i\))440
1926 y({)527 2026 y(if\(Eget\(i\))i(==)i(NULL\))g({Eset\(i,)e
(Ttop\(\)\);})527 2125 y(else)i(if\(!ATisEqual\(Eg)o(et\()o(i\))o(,)c
(Ttop\(\)\)\))i({return)h(fail_address;})527 2225 y(return)g(NULL;)440
2325 y(})440 2524 y(void)h(*_MatchVard\(int)37 b(i,)43
b(long)f(int)g(o\))440 2623 y({)527 2723 y(if\(Egetd\(i,)d(o\))k(==)g
(NULL\))e({Esetd\(i,)f(o,)j(Ttop\(\)\);})527 2823 y(else)f
(if\(!ATisEqual\(Eg)o(etd)o(\(i)o(,)c(o\),)k(Ttop\(\)\)\))e({return)h
(fail_address;})527 2922 y(return)g(NULL;)440 3022 y(})440
3221 y(void)h(*_MatchInt\(int)c(i\))440 3321 y({)527
3421 y(if\(\(ATgetType\(Tto)o(p\()o(\)\))f(!=)43 b(AT_INT\))e(||)h
(\(ATgetInt\(\(ATermI)o(nt)o(\))c(Ttop\(\)\))i(!=)j(i\)\))614
3520 y({return)e(fail_address;})527 3620 y(return)g(NULL;)440
3719 y(})440 3919 y(void)h(*_MatchIntFC\(int)37 b(i,)43
b(void)f(*fc\))440 4018 y({)527 4118 y(if\(\(ATgetType\(Tto)o(p\()o
(\)\))37 b(!=)43 b(AT_INT\))e(||)h(\(ATgetInt\(\(ATermI)o(nt)o(\))c
(Ttop\(\)\))i(!=)j(i\)\))614 4218 y({return)e(fc;})527
4317 y(return)g(NULL;)440 4417 y(})440 4616 y(void)h(*_TestIntFC\(int)
37 b(i,)43 b(void)f(*fc,)g(ATerm)f(t\))440 4716 y({)527
4815 y(if\(\(ATgetType\(t\))c(!=)43 b(AT_INT\))e(||)h
(\(ATgetInt\(\(ATermI)o(nt)o(\))c(t\))k(!=)h(i\)\))614
4915 y({return)e(fc;})527 5015 y(return)g(NULL;)440 5114
y(})440 5313 y(void)h(*_MatchReal\(doub)o(le)37 b(i\))440
5413 y({)1810 5662 y Fm(144)p eop
%%Page: 145 148
145 147 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)527 531 y Ff(if\(\(ATgetType\(Tto)o(p\()
o(\)\))g(!=)43 b(AT_REAL\))d(||)j(\(ATgetReal\(\(ATer)o(mR)o(eal)o(\))
37 b(Ttop\(\)\))k(!=)i(i\)\))614 631 y({return)e(fail_address;})527
731 y(return)g(NULL;)440 830 y(})440 1029 y(void)h(*_MatchRealFC\(do)o
(ub)o(le)37 b(i,)43 b(void)f(*fc\))440 1129 y({)527 1229
y(if\(\(ATgetType\(Tto)o(p\()o(\)\))37 b(!=)43 b(AT_REAL\))d(||)j
(\(ATgetReal\(\(ATer)o(mR)o(eal)o(\))37 b(Ttop\(\)\))k(!=)i(i\)\))614
1328 y({return)e(fc;})527 1428 y(return)g(NULL;)440 1528
y(})440 1727 y(void)h(*_TestRealFC\(dou)o(bl)o(e)c(i,)k(void)g(*fc,)g
(ATerm)g(t\))440 1826 y({)527 1926 y(if\(\(ATgetType\(t\))37
b(!=)43 b(AT_REAL\))d(||)j(\(ATgetReal\(\(ATer)o(mR)o(eal)o(\))37
b(t\))43 b(!=)g(i\)\))614 2026 y({return)e(fc;})527 2125
y(return)g(NULL;)440 2225 y(})440 2325 y(void)h(*_MatchString\(ch)o(ar)
37 b(*s\))440 2424 y({)527 2524 y(if\(!ATisThisStrin)o(g\()o(Tt)o(op\()
o(\),)g(s\)\))614 2623 y({return)k(fail_address;})527
2723 y(return)g(NULL;)440 2823 y(})440 3022 y(void)h(*_MatchStringFC\()
o(ch)o(ar)37 b(*s,)43 b(void)f(*fc\))440 3122 y({)527
3221 y(if\(!ATisThisStrin)o(g\()o(Tt)o(op\()o(\),)37
b(s\)\))614 3321 y({return)k(fc;})527 3421 y(return)g(NULL;)440
3520 y(})440 3719 y(void)h(*_TestStringFC\(c)o(ha)o(r)c(*s,)k(void)g
(*fc,)g(ATerm)f(t\))440 3819 y({)527 3919 y(if\(!ATisThisStrin)o(g\()o
(t,)c(s\)\))614 4018 y({return)k(fc;})527 4118 y(return)g(NULL;)440
4218 y(})440 4417 y(void)h(*_MatchFun\(char)37 b(*f,)43
b(int)f(n\))440 4516 y({)527 4616 y(assert\(Ttop\(\))c(!=)43
b(NULL\);)527 4716 y(//ATfprintf\(stder)o(r,)37 b("_MatchFun\(\045s,)h
(\045d\)\\n",)i(f,)j(n\);)527 4815 y(if\(!t_is_appl\(Tto)o(p\()o(\)\))
658 4915 y(||)g(ATgetArity\(ATge)o(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o
(\))37 b(!=)43 b(n)658 5015 y(||)g(strcmp\(ATgetNam)o(e\(A)o(Tg)o(etS)o
(ym)o(bol)o(\(T)o(to)o(p\(\))o(\)\))o(,)38 b(f\))k(!=)h(0)658
5114 y(||)g(ATisQuoted\(ATge)o(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o
(\)\))614 5214 y({return)e(fail_address;})527 5313 y(return)g(NULL;)440
5413 y(})1810 5662 y Fm(145)p eop
%%Page: 146 149
146 148 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 631 y Ff(void)42 b
(*_MatchFunFC\(cha)o(r)37 b(*f,)43 b(int)f(n,)h(void)f(*fc\))440
731 y({)527 830 y(assert\(Ttop\(\))c(!=)43 b(NULL\);)527
930 y(//ATfprintf\(stder)o(r,)37 b("_MatchFunFC\(\045s,)g(\045d\)\\n",)
k(f,)h(n\);)527 1029 y(if\(!t_is_appl\(Tto)o(p\()o(\)\))658
1129 y(||)h(ATgetArity\(ATge)o(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o(\))
37 b(!=)43 b(n)658 1229 y(||)g(strcmp\(ATgetNam)o(e\(A)o(Tg)o(etS)o(ym)
o(bol)o(\(T)o(to)o(p\(\))o(\)\))o(,)38 b(f\))k(!=)h(0)658
1328 y(||)g(ATisQuoted\(ATge)o(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o
(\)\))614 1428 y({)702 1528 y(return)e(fc;)614 1627 y(})527
1727 y(return)g(NULL;)440 1826 y(})440 2026 y(void)h(*_TestFunFC_olde)o
(st)o(\(ch)o(ar)37 b(*f,)42 b(int)h(n,)f(void)g(*fc,)g(ATerm)g(t\))440
2125 y({)527 2225 y(assert\(t)e(!=)j(NULL\);)527 2325
y(if\(!t_is_appl\(t\))658 2424 y(||)g(ATgetArity\(ATge)o(tSy)o(mb)o
(ol\()o(t\))o(\))38 b(!=)k(n)658 2524 y(||)h(strcmp\(ATgetNam)o(e\(A)o
(Tg)o(etS)o(ym)o(bol)o(\(t)o(\)\))o(,)38 b(f\))k(!=)h(0)658
2623 y(||)g(ATisQuoted\(ATge)o(tSy)o(mb)o(ol\()o(t\))o(\)\))614
2723 y({)702 2823 y(return)e(fc;)614 2922 y(})527 3022
y(return)g(NULL;)440 3122 y(})440 3321 y(void)h(*_TestFunFC_old\()o(ch)
o(ar)37 b(*f,)43 b(int)f(n,)h(void)f(*fc,)g(ATerm)f(t\))440
3421 y({)527 3520 y(AFun)h(fun)g(=)i(ATmakeAFun\(f,)38
b(n,)43 b(0\);)527 3620 y(assert\(t)d(!=)j(NULL\);)527
3819 y(if\(!t_is_appl\(t\))37 b(||)43 b(ATgetAFun\(\(ATerm)o(Ap)o(pl\))
37 b(t\))43 b(!=)f(fun\))702 3919 y(return)f(fc;)527
4018 y(else)614 4118 y(return)g(NULL;)440 4218 y(})440
4417 y(void)h(*_TestFunFC\(AFun)37 b(fun,)42 b(void)g(*fc,)g(ATerm)f
(t\))440 4516 y({)527 4616 y(assert\(t)f(!=)j(NULL\);)527
4716 y(if\(!t_is_appl\(t\))37 b(||)43 b(ATgetAFun\(\(ATerm)o(Ap)o(pl\))
37 b(t\))43 b(!=)f(fun\))702 4815 y(return)f(fc;)527
4915 y(else)614 5015 y(return)g(NULL;)440 5114 y(})440
5313 y(/*)i(Building)d(*/)1810 5662 y Fm(146)p eop
%%Page: 147 150
147 149 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 531 y Ff(void)42 b(BuildFun\(char)c
(*f,)k(int)h(i\))440 631 y({)527 731 y(int)g(j;)527 830
y(Tset\(\(ATerm\))c(ATmakeList0\(\)\);)527 930 y(for\(j)j(=)h(i;)g(j)g
(>)g(0;)g(j--\))f({)614 1029 y(Tseti\(1,)f(\(ATerm\))f
(ATinsert\(\(ATermLi)o(st)o(\))e(Ttop\(\),)i(Ttopi\(1\)\)\);)614
1129 y(Tpop\(\);)527 1229 y(})527 1328 y(Tset\(\(ATerm\))f
(ATmakeApplList\(A)o(Tm)o(ake)o(Sy)o(mb)o(ol\()o(f,)e(i,)43
b(ATfalse\),)702 1428 y(\(ATermList\))c(Ttop\(\)\)\);)440
1528 y(})440 1727 y(/*)k(Traversal)440 1926 y(Initialization:)37
b(Declare)k(a)i(new)g(counter)d(that)i(will)g(keep)g(track)g(of)g(the)
440 2026 y(number)f(of)i(arguments)d(of)i(the)h(node.)e(Push)h(the)h
(list)f(of)g(arguments)e(on)j(the)440 2125 y(stack)f(and)g(set)g(the)h
(counter)d(to)j(0.)g(*/)440 2325 y(void)f(TravInit\(\))440
2424 y({)527 2524 y(NewCounter\(\);)527 2623 y(if\(t_is_appl\(Ttop)o
(\(\))o(\)\))37 b({)614 2723 y(Tpush\(\);)614 2823 y(Tset\(\(ATerm\))i
(ATgetArguments\(\()o(ATe)o(rm)o(Ap)o(pl\))e(Ttopi\(1\)\)\);)527
2922 y(})527 3022 y(else)42 b({Tpush\(\);)e(Tset\(\(ATerm\))f
(ATmakeList0\(\)\);)o(})527 3122 y(SetCounter\(0\);)440
3221 y(})440 3421 y(/*)k(When)f(the)g(list)g(of)h(arguments)d(is)i
(empty)g(proceed)f(with)g(the)i(code)f(at)440 3520 y(|on_empty|.)d
(Otherwise)h(shift)h(the)i(next)f(argument)e(on)j(the)f(stack.)85
b(*/)440 3719 y(void)42 b(*_NextSon\(void)c(*on_empty\))440
3819 y({)527 3919 y(if\(ATisEmpty\(\(ATe)o(rm)o(Li)o(st\))f
(Ttopi\(TheCounter)o(\(\))o(\)\)\))614 4018 y({return)k(on_empty;})527
4118 y(else)h({)614 4218 y(Tpush\(\);)614 4317 y(IncCounter\(\);)614
4417 y(Tset\(ATgetFirst\(\()o(AT)o(erm)o(Li)o(st\))37
b(Ttopi\(TheCounter)o(\(\))o(\)\))o(\);)614 4516 y(Tseti\(TheCounter\()
o(\),)g(\(ATerm\))k(ATgetNext\(\(ATerm)o(Li)o(st)o(\))d
(Ttopi\(TheCounte)o(r\(\))o(\)\))o(\);)527 4616 y(})527
4716 y(return)j(NULL;)440 4815 y(})440 5015 y(void)h(*_SomeNextSon\(vo)
o(id)37 b(*s\))440 5114 y({)527 5214 y(if\(ATisEmpty\(\(ATe)o(rm)o(Li)o
(st\))g(Ttopi\(TheCounter)o(\(\))o(\)\)\))614 5313 y
({if\(IsCounterOK\(\))o(\))g({return)k(s;})i(else)e({return)g
(fail_address;}})527 5413 y(else)h({)1810 5662 y Fm(147)p
eop
%%Page: 148 151
148 150 bop 440 199 a Fm(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)614 531 y Ff(Tpush\(\);)614
631 y(IncCounter\(\);)614 731 y(Tset\(ATgetFirst\(\()o(AT)o(erm)o(Li)o
(st\))g(Ttopi\(TheCounter)o(\(\))o(\)\))o(\);)614 830
y(Tseti\(TheCounter\()o(\),)g(\(ATerm\))k(ATgetNext\(\(ATerm)o(Li)o(st)
o(\))d(Ttopi\(TheCounte)o(r\(\))o(\)\))o(\);)527 930
y(})527 1029 y(return)j(NULL;)440 1129 y(})440 1328 y(/*)i(Rebuild)d
(the)j(list)f(of)g(arguments)e(and)j(rebuild)d(the)j(application)c(of)k
(the)440 1428 y(original)d(function)h(symbol.)f(*/)440
1627 y(void)i(TravBuild\(void\))440 1727 y({)527 1826
y(if\(t_is_appl\(Ttop)o(i\()o(Th)o(eCo)o(un)o(ter)o(\(\))37
b(+)43 b(1\)\)\))614 1926 y({)702 2026 y(/*)f(if\(!\(ATgetArity\(A)o
(Tg)o(etS)o(ym)o(bol)o(\(T)o(to)o(pi\()o(Th)o(eCo)o(un)o(te)o(r\(\))37
b(+)43 b(1\)\)\))1050 2125 y(==)g(TheCounter\(\))c(+)k
(ATgetLength\(Ttop)o(i\()o(Th)o(eCo)o(un)o(ter)o(\(\))o(\)\)\))o(\))440
2225 y({)527 2325 y(int)g(i;)527 2424 y(for\(i)f(=)h(0;)g(i)g(<=)g
(TheCounter\(\))38 b(+)43 b(1;)g(i++\))614 2524 y({)702
2623 y(ATfprintf\(stdou)o(t,)37 b("tsp[top-\045d])i(=)k(\045t\\n",)e
(i,)i(Ttopi\(i\)\);)614 2723 y(})527 2823 y(ATfprintf\(stdout,)37
b("TheCounter)i(=)k(\045d)g(arity)e(=)i(\045d\\n",)e(TheCounter\(\),)
614 2922 y(ATgetArity\(ATgetS)o(ym)o(bol)o(\(T)o(top)o(i\()o(The)o(Co)o
(un)o(ter)o(\(\))c(+)43 b(1\)\)\)\);)440 3022 y(})702
3122 y(*/)702 3221 y(assert\(ATgetAri)o(ty)o(\(AT)o(ge)o(tSy)o(mb)o
(ol\()o(Tt)o(op)o(i\(T)o(he)o(Cou)o(nt)o(er)o(\(\))37
b(+)43 b(1\)\)\))f(==)1007 3321 y(\(TheCounter\(\))c(+)43
b(ATgetLength\(Ttop)o(i\(T)o(he)o(Co)o(unt)o(er)o(\(\)\))o(\)\))o(\);)
702 3421 y(for\(;)e(TheCounter\(\))e(>)k(0;)g(DecCounter\(\)\))440
3520 y({)527 3620 y(Tseti\(TheCounter\()o(\),)440 3719
y(\(ATerm\))e(ATinsert\(\(ATerm)o(Lis)o(t\))c(Ttopi\(TheCounter)o
(\(\)\))o(,)g(Ttop\(\)\)\);)527 3819 y(Tpop\(\);)440
3919 y(})702 4018 y(Tseti\(1,)614 4118 y(\(ATerm\))k(ATmakeApplList\(A)
o(Tge)o(tS)o(ymb)o(ol)o(\(T)o(top)o(i\()o(1\)\))o(,)c(\(ATermList\))i
(Ttop\(\)\)\);)614 4218 y(})527 4317 y(Tpop\(\);)527
4417 y(CloseCounter\(\);)440 4516 y(})440 4716 y(/*)k(Matching)d
(Traversal)440 4915 y(When)i(a)h(traversal)d(looks)h(into)h(a)i(term)e
(only)f(to)i(match)f(subterms,)e(there)h(is)i(no)440
5015 y(need)f(to)h(rebuild)d(the)j(term)f(afterwards.)d(*/)440
5214 y(void)j(MatchTravInit\(\))440 5313 y({)527 5413
y(NewCounter\(\);)1810 5662 y Fm(148)p eop
%%Page: 149 152
149 151 bop 440 199 a Fm(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)527 531 y Ff(SetCounter\(ATgetA)o
(ri)o(ty)o(\(AT)o(ge)o(tSy)o(mb)o(ol\()o(Tt)o(op)o(\(\)\))o(\)\))o(;)
527 631 y(Tpush\(\);)440 731 y(})440 930 y(/*)43 b(When)f(the)g(list)g
(of)h(arguments)d(is)i(empty)g(proceed)f(with)g(the)i(code)f(at)440
1029 y(|on_empty|.)d(Otherwise)h(shift)h(the)i(next)f(argument)e(on)j
(the)f(stack.)85 b(*/)440 1229 y(void)42 b(*_MatchNextSon\(v)o(oi)o(d)c
(*on_empty\))440 1328 y({)527 1428 y(if\(TheCounter\(\))g(==)k(0\))614
1528 y({return)f(on_empty;})527 1627 y(else)h({)614 1727
y(DecCounter\(\);)614 1826 y(Tset\(ATgetArgumen)o(t\()o(Tto)o(pi)o
(\(1\))o(,)37 b(TheCounter\(\)\)\);)527 1926 y(})527
2026 y(return)k(NULL;)440 2125 y(})1810 5662 y Fm(149)p
eop
%%Page: 150 153
150 152 bop 440 199 a Fm(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)440 531 y Fi(BIBLIOGRAPHY)482
792 y Fm([1])k(Andrew)29 b(W.)h(App)r(el.)44 b Fd(Mo)l(dern)33
b(Compiler)g(Implementation)g(in)e(ML)p Fm(.)44 b(Cam)n(bridge)611
892 y(Univ)n(ersit)n(y)26 b(Press,)g(1998.)482 1058 y([2])41
b(P)n(eter)g(Boro)n(v)-5 b(ansk)q(\023)-43 b(y,)43 b(Claude)f(Kirc)n
(hner,)i(and)f(H)n(\023)-39 b(el)n(\022)g(ene)40 b(Kirc)n(hner.)79
b(Con)n(trolling)611 1157 y(rewriting)17 b(b)n(y)i(rewriting.)i(In)e
(Jos)n(\023)-39 b(e)16 b(Meseguer,)k(editor,)g Fd(Pr)l(o)l(c)l(e)l(e)l
(dings)i(of)g(the)g(First)g(In-)611 1257 y(ternational)27
b(Workshop)h(on)f(R)l(ewriting)f(L)l(o)l(gic)i(and)f(its)f(Applic)l
(ations)p Fm(,)h(v)n(olume)d(4)f(of)611 1357 y Fd(Ele)l(ctr)l(onic)h
(Notes)g(in)g(The)l(or)l(etic)l(al)h(Computer)g(Scienc)l(e)p
Fm(,)e(Asilomar,)e(P)n(aci\014c)f(Gro)n(v)n(e,)611 1456
y(CA,)28 b(Septem)n(b)r(er)f(1996.)f(Elsevier.)482 1622
y([3])41 b(Mark)20 b(V)-7 b(an)22 b(den)g(Brand)f(and)g(Eelco)g
(Visser.)26 b(F)-7 b(rom)21 b(Bo)n(x)g(to)h(T)2549 1640
y(E)2595 1622 y(X:)34 b(An)22 b(algebraic)e(ap-)611 1722
y(proac)n(h)k(to)i(the)g(generation)e(of)i(do)r(cumen)n(tation)f(to)r
(ols.)34 b(T)-7 b(ec)n(hnical)25 b(Rep)r(ort)h(P9420,)611
1822 y(Programming)e(Researc)n(h)j(Group,)g(Univ)n(ersit)n(y)f(of)i
(Amsterdam,)f(July)h(1994.)482 1988 y([4])41 b(A.)d(V)-7
b(an)38 b(Deursen,)i(J.)e(Heering,)h(and)f(P)-7 b(.)37
b(Klin)n(t,)k(editors.)66 b Fd(L)l(anguage)40 b(Pr)l(ototyp-)611
2087 y(ing.)c(A)n(n)f(A)n(lgebr)l(aic)h(Sp)l(e)l(ci\014c)l(ation)g
(Appr)l(o)l(ach)p Fm(,)h(v)n(olume)d(5)f(of)h Fd(AMAST)h(Series)h(in)
611 2187 y(Computing)p Fm(.)h(W)-7 b(orld)27 b(Scien)n(ti\014c,)h
(Singap)r(ore,)f(Septem)n(b)r(er)h(1996.)482 2353 y([5])41
b(T.B.)29 b(Dinesh,)i(Magne)e(Ha)n(v)n(eraaen,)f(and)i(Jan)f(Heering.)
43 b(An)30 b(algebraic)e(program-)611 2452 y(ming)e(st)n(yle)g(for)g(n)
n(umerical)g(soft)n(w)n(are)f(and)h(its)h(optimization.)34
b(CWI)27 b(Rep)r(ort)g(SEN-)611 2552 y(R9844,)f(CWI,)i(Amsterdam,)f
(The)h(Netherlands,)f(Decem)n(b)r(er)g(1998.)482 2718
y([6])41 b(Bas)h(Luttik)h(and)f(Eelco)g(Visser.)81 b(Sp)r
(eci\014cation)43 b(of)g(rewriting)f(strategies.)80 b(In)611
2818 y(M.)34 b(P)-7 b(.)34 b(A.)g(Sellink,)i(editor,)f
Fd(2nd)i(International)f(Workshop)h(on)f(the)g(The)l(ory)h(and)611
2917 y(Pr)l(actic)l(e)29 b(of)g(A)n(lgebr)l(aic)h(Sp)l(e)l(ci\014c)l
(ations)f(\(ASF+SDF'97\))p Fm(,)e(Electronic)e(W)-7 b(orkshops)611
3017 y(in)28 b(Computing,)f(Berlin,)g(No)n(v)n(em)n(b)r(er)g(1997.)e
(Springer-V)-7 b(erlag.)482 3183 y([7])41 b(P)-7 b(.)37
b(A.)h(Olivier)f(and)h(H.)g(A.)g(de)g(Jong.)66 b(E\016cien)n(t)38
b(annotated)f(terms.)67 b(T)-7 b(ec)n(hnical)611 3283
y(rep)r(ort,)32 b(Programming)e(Researc)n(h)g(Group,)j(Univ)n(ersit)n
(y)e(of)h(Amsterdam,)h(August)611 3382 y(1998.)482 3548
y([8])41 b(Eelco)c(Visser.)68 b Fd(Syntax)39 b(De\014nition)h(for)g(L)l
(anguage)h(Pr)l(ototyping)p Fm(.)70 b(PhD)38 b(thesis,)611
3648 y(Univ)n(ersit)n(y)26 b(of)i(Amsterdam,)f(Septem)n(b)r(er)h(1997.)
482 3814 y([9])41 b(Eelco)30 b(Visser.)48 b(Strategic)30
b(pattern)i(matc)n(hing.)48 b(In)31 b(P)-7 b(.)31 b(Narendran)g(and)g
(M.)h(Rusi-)611 3914 y(no)n(witc)n(h,)23 b(editors,)g
Fd(R)l(ewriting)i(T)-6 b(e)l(chniques)26 b(and)g(Applic)l(ations)h(\(R)
-6 b(T)g(A'99\))p Fm(,)24 b(v)n(olume)611 4013 y(1631)18
b(of)i Fd(L)l(e)l(ctur)l(e)i(Notes)h(in)h(Computer)f(Scienc)l(e)p
Fm(,)f(pages)d(30{44,)h(T)-7 b(ren)n(to,)21 b(Italy)-7
b(,)22 b(July)611 4113 y(1999.)j(Springer-V)-7 b(erlag.)440
4279 y([10])41 b(Eelco)28 b(Visser)g(and)h(Zine-el-Abidine)g(Benaissa.)
39 b(A)30 b(core)d(language)h(for)g(rewriting.)611 4379
y Fd(Ele)l(ctr)l(onic)h(Notes)f(in)h(The)l(or)l(etic)l(al)h(Computer)f
(Scienc)l(e)p Fm(,)e(15,)f(Septem)n(b)r(er)g(1998.)33
b(In)611 4478 y(C.)39 b(Kirc)n(hner)e(and)i(H.)g(Kirc)n(hner,)h
(editors,)h(Pro)r(ceedings)c(of)i(the)g(Second)g(In)n(ter-)611
4578 y(national)32 b(W)-7 b(orkshop)32 b(on)h(Rewriting)g(Logic)f(and)h
(its)g(Applications)g(\(WRLA'98\),)611 4677 y(P)n(on)n(t-\022)-42
b(a-Mousson,)24 b(F)-7 b(rance.)440 4844 y([11])41 b(Eelco)c(Visser,)k
(Zine-el-Abidine)d(Benaissa,)i(and)e(Andrew)g(T)-7 b(olmac)n(h.)68
b(Building)611 4943 y(program)36 b(optimizers)i(with)i(rewriting)d
(strategies.)69 b Fd(A)n(CM)40 b(SIGPLAN)g(Notic)l(es)p
Fm(,)611 5043 y(34\(1\):13{26,)21 b(Jan)n(uary)h(1999.)28
b(Pro)r(ceedings)22 b(of)h(the)h(In)n(ternational)f(Conference)g(on)611
5142 y(F)-7 b(unctional)27 b(Programming)e(\(ICFP'98\).)1810
5662 y(150)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
