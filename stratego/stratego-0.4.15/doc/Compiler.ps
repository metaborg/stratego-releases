%!PS-Adobe-2.0
%%Creator: (Omega) odvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: Compiler.dvi
%%Pages: 154
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: odvips Compiler.dvi -o Compiler.ps
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2000.06.25:0036
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (Compiler.dvi)
@start
%DVIPSBitmapFont: Fa cmbx12 24.88 19
/Fa 19 122 df<BA12F0B33C137DB74D>45 D[<BFFC1EFEF6FFE01FFCF7FF8020F020FC
20FF8DC7000392CA001F15E00B0181776C800C1F807814FF0C03818A78818E79808B8E8B
8E8B8EA27980A4791580AB551500A4555CA26A676A676A555C9CB65AA2545D5492C7FC54
5C5414F80C3F5C545C53B612800B0F4AC8FC0B7F14F80A1FB612E095BBC9FC1FF81F801F
F8F7FF8020F820FE95CBECFFC00C1F14F00C07807814FE0C006E7E798079807980798079
8079808E79158023C08B23E08C23F0A223F88CA223FCA38C23FEAB5614FCA55614F8A39D
B612F0A25515E06723C055158067551500555C555C9CB6FC545D0C075D0C1F15C09BB75A
0B0F93C7FCC212FC6921E021800EFCC8FC20F020800DF0C9FC0CFCCAFC>143
142 120 269 165 66 D[<0803B500C0EE01F00703B600FEEE03F8077FDBFFE015070607
B800FC150F063F05FF151F4DBA00E0143F050F07F8147F053F07FE14FF94BC5B04039326
F8000FECC003040F4BC86CEBF007043F03C0030F6D5A93B648C900036D5A4B03F0933900
7FFF3F030703C0051F90B5FC4B92CB7E033F02FC18034B02F08492B648844A0380193F4A
92CD7E4A4A864A4A864A02F0864A4A864A8991B65A494B874992CF7E4C885B494A885E49
8B494A88A2495C8D90B65A8D5A5E48217FA24892D1FC223FA25A5DA248211FA3485CFA0F
F09FC7FCA25AA45DA3B6FCB27EA381A47EA46C80FA07F0FA0FF87EA2817EA36C6F1D1F23
F07E827E223F6D6E1EE0A26D6E1D7F23C06D6E1DFF7F705213806D806D55130070646D6F
646D6F515A6E6E1B1F6E6E515A6E6E515A6E6E1BFF6E6E505B6E6E505B6E6F4F5B6E03E0
4F90C7FC6F6EF13FFE6F02FC4F5A030F02FF4E485A6F03C005075B030103F0051F5B6F03
FE057F1380043FDAFFE00303B5C8FC040F03FE033F13FC0403DBFFF80107B55A040093B8
12E0053F1A80050F4FC9FC050119F8DD003F18C0060795CAFCDE007F16F0070393CBFCDF
000314C0>141 146 115 271 168 I[<BD12FCF4FFFCF5FFE01EFCF6FFC01FF01FFE797E
20E0C700030380C86C15F80A0181E2003F14FF0B07810B0115E0776C8078807880788078
808A78818E7881A28E8B8EA37980A48EAA6AA3676AA26AA29CB65AA26A545D9FCAFC6654
5C545C545C545C9BB612C0535D0B074ACBFC0B3F5C52B612F00A7F15C095BBCCFC1FF81F
C054CDFC66F6FF801FE00680C7000315F8E1003F14FE0A0F800A0315C07681766C807780
778077808C7781898D898D898DA38A8DAD8DACA1EB1FC0A1EB3FE08D8AA37880A1137FA1
14C078817818FF7C1580785F786F1500BB00FE6F6F5B796E495A7902FEEB1FFC799139FF
C07FF80D0792B55A0D015F796C5E0E1F5E0E034BC7FCD4001F14F8E7003F13C0>163
144 120 269 173 82 D[<93260FFFF8163E4BB600E0153F031F03FE5D037FDBFFC05C02
03B800F05B020F05FC5B4A05FF5B027FF0C00F91B526FE000FECF01F010302C0D9007F6D
5A4991C800076D5A4901FC030090B6FC4901F0163F4949160F4901808290B5170192CBFC
4849844849181F87484984A2484984874886A248498588A24887A388A2B58680A36E85A2
80A26E8580A2818103F0725A6C6E96C7FC15FE8116E06C15FEEEFFE017FF6C17F0F0FF80
6C18F8F1FFC06C19FCF2FF806C1AE01BF86C1AFE6C747E6D1AE0886D866D866D1AFF6D87
6D87010087806E86020F86020386020086153F030F851501DB001F19801601DC000F18C0
EF007F060717E0F0003F070316F0F1003F1A0F080315F81A00871B1F877514FCA287007F
86486C85A288A388A36D86A31EF87FA37F1EF0A26D626D1CE0A27F6D5013C0A26E1B806E
96B5FC6E1B0002F8606E4E5B6E626E6C5F03E04D5B03F84D5B03FE057F5BDBFFC093B55A
04F803035C496CD9FF80021F91C7FCD9FC1F02FF49B55AD9F80792B75A496C19F049C661
49011F18804901074DC8FC90C817F848031F16C048030003FCC9FC007C04011480>102
146 115 271 129 I[<000FC312F8A6488EA304C0C7001F4AC7120103F8C8F0000F03C0
1C0192C9737E02FC1E1F4A1E0702E08A4A8A4A8A4890CA757EA249203F49201FA349200F
A2492007A4492003007F8EA4498CA848487A1380A6CC99C7FCB3B3B3B3AA030FBD12FCA9
>145 140 120 267 162 I<93B512FC037FECFFF00207B8FC023F17E091B912F84918FE
0107727E499126C0007F14E04901E0C7000F80496D020380496D020014FE6F6F7F90B570
806F6F8085486E6F807380A27380A28885886C5CA26D4982886D5B6D5B010713C0010190
CAFC90CCFCA90603B7FC050FB8FC0403B9FC167F0307BAFC153F4AB7EA807F020FEDE000
023F02FCC7FC91B612E0010392C8FC4914FC011F14F04914C0495C90B548C9FC485C485C
485C485C5A5D485CA24891CAFCA3B6FC5CA397B6FCA461806C60F107EF6C6E150F6F16CF
6C183F6FDB7F8F806C6EDBFF0F14E06C02FCDA03FE15FE6C6E91260FFC0791B5FC6C6E6C
D93FF817806C923AF803FFF003013F91B6487E010FEF8000010394C77E010004FC141F02
1F03F0140702010380DA007F1400DA000701F8CDFC695F79DD71>97
D<94387FFFF0041FB612E093B712FE0307707E031F17F092B97E4A18FE020784021F9126
F8000F14804A0280010014C04A49C74814E049B500F85C494A17F0494A5C495C494A4A14
F84991C8FC5D495B90B5FC5D5A485C7314F05A4B6F14E05A7314C0487214804B93383FFE
00F20FF84896C8FCA4485CA5B6FCB07EA281A37EA36C80A37E6F18FE6CF201FFA26C6E5F
1CFE6C801B076C6EEF0FFC6D7F70EE1FF86DF13FF06D6E167F6D6EEEFFE06D02F84B13C0
6D6E5D6D02FF030F13806D03C0023F1300023F02F0903801FFFC6E9126FF801F5B020792
B65A6E18C0020060033F4CC7FC030716F8030016C0041F4AC8FCDC007F13C0585F78DD67
>99 D<94387FFFC0040FB6FC93B712E0030716FC031F16FF037F17C04AB912F00207DAF8
0380021F912680003F13FE4A49C7000F7F4A01F802038049B5486E804902C06E6C7F494A
6F7F4991C9FC49727F4949707F4B84498490B548707F5A4B198048855D481CC086481CE0
5D5A871DF05AA25D5AA21DF887A2B6FCA392BBFCA51DF00380CDFCA77EA4817EA37EA281
7EA26CF307F06FF00FF87E816C1B1F6F19F06C1B3F6D6DF07FE06D7FF4FFC06D6E4C1380
6D6E5E6D02F04C13006D6EEE1FFE6D6E4C5A6D6C01FFEEFFF86E02E002035B6E02FC021F
5B02079126FFC003B55A6E92B7C7FC020060033F17F8030F17E003011780DB003F03FCC8
FC040315C0DC000F01F8C9FC5D5F7ADD6A>101 D[<EC3FC0ECFFF0010313FC497F497F49
8049804980A290B67EA24881A86C5DA26D5CA26D5C6D5C6D91C8FC6D5B6D5B010013F0EC
3FC091CAFCB3A3ED1FF0017FB5FCB7FCA9EA003F1307A27FB3B3B3B0B91280A9>49
144 119 271 65 105 D[<ED1FF0017FB5FCB7FCA9EA003F1307A27FB3B3B3B3B3B3ACB9
12C0A9>50 143 119 270 65 108 D<DB3FE0912601FFFC943801FFFC017FB5031FD9FF
E0041FEBFFE0B792B600FC93B612FC060303FF030315FF060F04C0020F16C0063F04F002
3F16F095B86C91B87E4DD9FC036E49D9FC03804DD9C0006E49D9C000804D48C7003F6D49
48C7003F7FDD0FF86EDB0FF880D8003F4B48714848830107DB3FC06E9126C03FC06E804D
484E5A6D4BC86F48C881DCE1FE6FDAE1FE814D61DCE3F8DEF3F884DCE7F0F0F7F04D6F4B
81DCEFC0F0FFC0A2DCFF804F84A294C993C9FCA24C61A34C61A44C61B3B3AFB900E090B9
00E090B912E0A9B35D77DCC2>I<DB3FE0913803FFFC017FB5033FEBFFE0B792B612F806
0715FE061F6F7E4E16E095B87E4DD9FC03804DD9C000804D48C76C7FDD0FF880D8003FDB
1FE08201074B486E804D5A6D03FEC881DCE1FC815F04E385EEE7F04D81EEEFC0A2DCFF80
84A294C9FCA25EA35EA45EB3B3AFB9D8E001B912C0A9725D77DC81>I<94381FFFF00407
B612C0047F15FC0303B87E030F17E0037F17FC4ABAFC4A9126FC007F80020F02C0010714
E04A49C880027F01F8033F13FC91B5486F7F4902C003077F494A6F804991C96C80494970
804949717F49874949717FA290B548717F48884B83481D80A2481DC04B83481DE0A2481D
F0A3484A7114F8A4481DFCA5B61BFEAF6C1DFCA56C6E4D14F8A36C1DF0A36C1DE06F5F6C
1DC0A26C6E4D1480A26C1D006F5F6C646D6D4D5B6F94B5FC6D636D6D4C5C6D6E4B5C6D6E
4B5C6D02F0031F5C6D6E4B91C7FC6D6C01FE92B512FC6ED9FFC001075C6E02FC017F5C02
0791B812C0020196C8FC6E6C17FC031F17F003031780DB007F03FCC9FC040715C0DC001F
01F0CAFC675F7ADD74>I<DB1FF091381FFFC0017FB50203B6FCB7021F15E095B712FC05
0316FF050F17C0053F17F094B912FC04F1DAC01F8004F79026FC00018093B500E06D6C14
C0D8003F93C86C8001074B030F8005F86F806D03E06F804D6F804D8194CA6C7F4C864C71
805E7680A27680A27680A28B88A28BA288A28BA4882080B0200064A467A26467A3525CA2
6764676467647062704D91C7FC7094B55AA2714B5C714B5C714B5C05F84B5C71033F5C05
FF4B91C8FC06C049B55A04FB01F001075C04F801FF017F14F07190B712C0051F94C9FC71
16FC050316F0DD007F1580060F02F8CAFC060049CBFC96CDFCB3ACB912E0A9718579DC81
>I<92261FFFF814F80203B638C001FC023FEDFC0791B8121F010317FF130F013F9038F8
001F4990C8FCD9FFF8153F4801E0150F484915034849814890CAFC197F4848173F191F48
5AA2007F180FA31907487EA27FA28002E0705A6E93C8FC14FC14FF15F06CECFF8016FCEE
FFF06CEEFF8018F06C17FE727E6C18E0856C18FC6C846C727E6C856D84011F846D841303
010084023F83140F020183EC001FDB007F16801603DC000F15C01700183F060F14E0007F
1703486C82727E857F85857FA2857F1BC07FA27F1B806D5F7F1B006E5E6E5F6E163F6E4C
5A02FC4C5A6E03035B6E6C4A5B03F0023F5B03FF0107B55A01F991B7C7FCD9F07F16FCD9
E01F16F0D9800716C0D9000193C8FC48D9003F14F8007C020349C9FC4B5F78DD5C>115
D[<ED03FEA81507A5150FA4151FA3153FA2157FA215FFA25CA25C5CA25C5C5C5C91B5FC
13035B131F017F91B712F00007BAFCBBFCA7C74AC9FCB3B3AAF101FFB1616E17FE82A219
076E17FC836EEE0FF871131F6E6EEB3FF071137F6E6EEBFFE06EDAFF0313C06E92B51280
6E1700033F5D6F5D03075D030015E0041F1480040001FCC7FC>72
132 124 258 90 I<DB0FF8F01FF0017FB594B6FCB74BB7FCA9D8003F94C77E0107190F
A26D85B3B3B063A463A263A27F6398B6FCA26DF001FB7015036EEF07F3E00FE3806E6D15
1FE07FC314FF6E6D6CDAFF83EDFFC06E6E010313036E02FCEB3FFE6E91B612FC020017F8
6F16E0031F16800303EDFE00DB007F14F8040102C093C8FC725E77DC81>I<007FB800C0
4AB71280A9D800034ACA000791C7FC6D080013F0775A6D6E4E5AA26E6E6064836E4F90C8
FC836E4F5A836E4F5AA26E6E4C5AA26E6E5F1C3F6E6E5F1C7F836E4F5A846F4D5B846F4D
90C9FCA26F6E4A5AA26F6E5D1B0F846F4D5A846F4D5A846F4D5AA26F6E4A5AA2706E5C62
7002C091CAFC6219E0704B5A19F0704B5AA2706E485AA2706E485AA27002FE5B1A7F19FF
704B5AA2715DA27192CBFCA2715CA2715CA3715CA2715CA2715CA2715CA2725BA27290CC
FCA3725AA2725AA24E5AA24E5AA261187FA24E5AA24D5B13FE2603FF804A90CDFC000F13
E0486D4A5A487F486D4A5AA260B56C141F4D5AA24D5A17FF604C5B4A4990CEFC6C5D4C5A
6C49EB3FFC4A495A6C4948485A9026FE80075B270FFFC03F5B6C90B6CFFC6C5D6C15F86C
6C5C011F14C0010749D0FC9038007FE071857CDB7B>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fb cmr9 9 37
/Fb 37 123 df<EC1FE0ECFFFC903803F01E90390FC00780EB1F8090393F000FC0017E13
1F5BA2485AED0F8092C7FCA9ED0FC0B7FCA33901F8001F150FB3A6486CEB1FE0267FFFC1
B5FCA328357FB42B>12 D<14C01301EB0380EB0F00130E5B133C5B5BA2485A485AA21207
5B120F90C7FC5AA2121E123EA3123C127CA55AB0127CA5123C123EA3121E121FA27E7F12
077F1203A26C7E6C7EA213787F131C7F130FEB0380EB01C01300124A79B71E>40
D<12C07E1270123C121C7E120F6C7E6C7EA26C7E6C7EA27F1378137C133C133EA2131E13
1FA37F1480A5EB07C0B0EB0F80A514005BA3131E133EA2133C137C137813F85BA2485A48
5AA2485A48C7FC120E5A123C12705A5A124A7CB71E>I<B512F0A514057F921A>45
D<123C127E12FFA4127E123C08087A8715>I<1530157815F8A215F01401A215E01403A2
15C01407A21580140FA215005CA2143EA2143C147CA2147814F8A25C1301A25C1303A25C
1307A2495AA291C7FC5BA2131E133EA2133C137CA2137813F8A25B1201A25B1203A2485A
A25B120FA290C8FC5AA2121E123EA2123C127CA2127812F8A25A12601D4B7CB726>I<00
7FB812C0B912E0A26C17C0CCFCAC007FB812C0B912E0A26C17C033147C9C3C>61
D<15E0A34A7EA24A7EA34A7EA3EC0DFE140CA2EC187FA34A6C7EA202707FEC601FA202E0
7FECC00FA2D901807F1507A249486C7EA301066D7EA2010E80010FB5FCA249800118C77E
A24981163FA2496E7EA3496E7EA20001821607487ED81FF04A7ED8FFFE49B512E0A33336
7DB53A>65 D<DA03FE130C91393FFF801C91B512E0903A03FE01F83C903A0FF0003C7CD9
1FC0EB0EFCD97F80130701FEC7120348481401000315005B4848157C485A173C485A171C
123F5B007F160CA390C9FC481600AB7E6D150CA3123F7F001F161C17186C7E17386C6C15
306C6C15706D15E012016C6CEC01C0D97F80EB0380D91FC0EB0F00D90FF0131ED903FE13
FC0100B512F0023F13C0DA03FEC7FC2E377CB437>67 D<B812C0A3D803FCC7127F000115
0FEE03E01601A21600A21760A403061330A41700150EA2151E157E90B512FEA39038FC00
7E151E150EA21506170CA3171892C7FCA41738A21770A217F01601160316070003157FB8
12E0A32E337DB234>69 D<B512FEA3000113006C5AB3B3A7487EB512FEA317337EB21C>
73 D<B512FEA3D803FEC9FC6C5AB3A9EE0180A416031700A45EA25E5E5E5E16FE000314
07B7FCA329337DB230>76 D<D8FFFC923801FFF86D5DA20003EFFE00D801BFED06FCA3D9
9F80140CA2D98FC01418A3D987E01430A2D983F01460A3D981F814C0A3D980FCEB0180A2
027EEB0300A36E1306A26E6C5AA36E6C5AA36E6C5AA26E6C5AA36E6C5AA3913800FD80A2
037FC7FCA3486C133ED80FF04B7EB5011C90387FFFF8A33D337CB246>I<90381FE00390
387FFC0748B5FC3907F01FCF390F8003FF48C7FC003E80814880A200788000F880A46C80
A27E92C7FC127F13C0EA3FF013FF6C13F06C13FF6C14C06C14F0C680013F7F01037F9038
003FFF140302001380157F153FED1FC0150F12C0A21507A37EA26CEC0F80A26C15006C5C
6C143E6C147E01C05B39F1FC03F800E0B512E0011F138026C003FEC7FC22377CB42B>83
D<007FB712FEA390398007F001D87C00EC003E0078161E0070160EA20060160600E01607
A3481603A6C71500B3AB4A7E011FB512FCA330337DB237>I<267FFFFC90B512C0A30001
01E090381FF80026007F80EB0FC0013F6E5A6E91C7FC6D6C130E010F140C6E5B6D6C1338
01035C6E13606D6C13E06D6C485A5EDA7F83C8FCEC3FC715C6EC1FECEC0FFC5D14076E7E
A26E7E815C6F7E9138063FC0140E4A6C7E9138180FF0EC380702707F91386003FCECC001
0101804A6C7E49C77E4981010E6E7E010C6E7E131C496E7E01786E7E13FCD807FEEC1FFE
B56C90B512F8A335337EB23A>88 D<B500F8ECFFFEA300030180EC3FE06C90C8EA1F806C
EE0E006D6C5C6D6C141817386D6C14305F6D6C14E06D6C5C16016D6C5C6D6C49C7FC5E6D
6C13065E91387F801C91383FC018163891381FE0306E6C5A16E06E6C5AEDF980EC03FF6E
90C8FC5D1400B14A7E91B512FCA337337FB23A>I<EB7F803803FFF0380F80FC381C003E
003F133F6D6C7E6E7EA26E7EEA1F00C7FCA4EB01FF131FEBFF873803FC07EA0FF0EA1FC0
EA3F80127F13004815C05AA3140FA26C131F6C133B3A3F8071F180391FC1E1FF2607FFC0
13003900FE003C22237DA126>97 D<EA03F012FFA312071203AEEC3F80ECFFE09038F3C0
F89038F7007E01FE7F49EB1F8049EB0FC05BED07E016F0A2150316F8AA16F0150716E0A2
ED0FC07F6DEB1F8001ECEB3F0001CF137C90388381F8903801FFE0C76CC7FC25357EB32B
>I<EB07F8EB3FFF9038FC07C03901F000E03903E003F03807C007120FEA1F80123F9038
0003E04890C7FCA2127E12FEAA127FA26C14187F001F14386D1330000F14706C6C13E039
03F001C03900FC0F8090383FFE00EB07F01D237EA122>I<153FEC0FFFA3EC007F81AEEB
07F0EB3FFCEBFC0F3901F003BF3907E001FF48487E48487F8148C7FCA25A127E12FEAA12
7E127FA27E6C6C5BA26C6C5B6C6C4813803A03F007BFFC3900F81E3FEB3FFCD90FE01300
26357DB32B>I<EB0FE0EB7FFCEBF83F3903F00F80D807E013C0390FC007E0381F800315
F0EA3F0014014814F8127EA212FEA2B6FCA248C8FCA5127E127FA26C1418A26C6C133800
0F14306D13706C6C13E03901F003C03900FC0F00EB3FFEEB07F01D237EA122>I<EB01FC
EB07FF90381F078090383E0FC0EB7C1F13FCEA01F8A20003EB070049C7FCACB512F0A3D8
03F0C7FCB3A7487E387FFFE0A31A357FB417>I<151F90391FC07F809039FFF8E3C03901
F07FC73907E03F033A0FC01F83809039800F8000001F80EB00074880A66C5CEB800F000F
5CEBC01F6C6C48C7FCEBF07C380EFFF8380C1FC0001CC9FCA3121EA2121F380FFFFEECFF
C06C14F06C14FC4880381F0001003EEB007F4880ED1F8048140FA56C141F007C15006C14
3E6C5C390FC001F83903F007E0C6B51280D91FFCC7FC22337EA126>I<EA03F012FFA312
071203AEEC1FC0EC7FF09038F1E0FC9038F3807C9038F7007E13FE497FA25BA25BB3486C
EB7F80B538C7FFFCA326347EB32B>I<EA0780EA0FC0EA1FE0A4EA0FC0EA0780C7FCAAEA
07E012FFA3120F1207B3A6EA0FF0B5FCA310337EB215>I<EA03F012FFA312071203AF91
3803FFE0A36E1300EC00F8EC01E05D4A5A020FC7FC141C5C5C14F0EBF3F8EBF7FC13FEEB
FC7EEBF87F496C7E141F6E7E8114076E7E8114016E7E81486CEBFF80B500C313F0A32434
7EB329>107 D<EA07E012FFA3120F1207B3B3A7EA0FF0B5FCA310347EB315>I<2703F01F
E013FF00FF90267FF80313C0903BF1E07C0F03E0903BF3803E1C01F02807F7003F387FD8
03FE1470496D486C7EA2495CA2495CB3486C496C487EB53BC7FFFE3FFFF0A33C217EA041
>I<3903F01FC000FFEB7FF09038F1E0FC9038F3807C3907F7007EEA03FE497FA25BA25B
B3486CEB7F80B538C7FFFCA326217EA02B>I<EB07F0EB3FFE9038FC1F803901F007C039
03C001E000078048486C7E48C7127CA248147E003E143E007E143FA300FE1580A8007E15
00A36C147EA26C147C6D13FC6C6C485A00075C3903F007E03900FC1F80D93FFEC7FCEB07
F021237EA126>I<3903F03F8000FFEBFFE09038F3C0F89038F7007ED807FE7F6C48EB1F
804914C049130F16E0ED07F0A3ED03F8A9150716F0A216E0150F16C06D131F6DEB3F8016
0001FF13FC9038F381F89038F1FFE0D9F07FC7FC91C8FCAA487EB512C0A325307EA02B>
I<3803E07C38FFE1FF9038E38F809038E71FC0EA07EEEA03ECA29038FC0F8049C7FCA35B
B2487EB512E0A31A217FA01E>114 D<EBFF06000713CE381F00FE003C133E48131E140E
5A1406A27EA200FE90C7FC6C7EEA7FFC383FFFC014F0000F7F6C7FC67FEB0FFF1300EC3F
8000C0131F140F6C1307A37E15006C5B6C130E6C5B38F7807838E1FFE038C07F8019237E
A11E>I<1330A51370A313F0A21201A212031207381FFFFEB5FCA23803F000AF1403A814
073801F806A23800FC0EEB7E1CEB1FF8EB07E0182F7FAD1E>I<D803F0133F00FFEB0FFF
A30007EB007F000380B35DA35D12016D4813800000903803BFFC90387E073FEB1FFED907
F8130026227EA02B>I<003FB512F0A2EB000F003C14E00038EB1FC00030EB3F80007013
7F1500006013FE495A13035CC6485A495AA2495A495A49C7FC153013FE485A12035B4848
1370485A001F14604913E0485A387F000348130F90B5FCA21C207E9F22>122
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fc cmti10 10 50
/Fc 50 122 df<EE3FFC4BB51280923907E007C092391F8001E0DB3F0013F0037E13034B
1307A24A5A18E04A48EB038094C7FCA314075DA4140F5DA3010FB7FCA25F903A001F8000
7EA217FE023F5C92C7FCA216015F5C147E16035FA214FE4A13075FA30101140F5F4AECC1
C0A2161F1783010316805CA2EF870013074A5CEE0F8EEE079EEE03FC010FEC00F04A91C7
FCA35C131FA2001C90CAFC127E5BEAFE3E133C137CEAF878EA78F0EA3FE0EA0F80344C82
BA2F>12 D<EA01E0EA07F0120F13F8121FA3120FEA07B0EA0030A21370136013E013C012
0113801203EA0700120E5A5A5A5A5A0D196EB919>39 D<150C151C153815F0EC01E0EC03
C0EC0780EC0F00141E5C147C5C5C495A1303495A5C130F49C7FCA2133EA25BA25BA2485A
A212035B12075BA2120F5BA2121FA290C8FCA25AA2123EA2127EA2127CA412FC5AAD1278
A57EA3121C121EA2120E7EA26C7E6C7EA212001E5274BD22>I<140C140E80EC0380A2EC
01C015E0A2140015F0A21578A4157C153CAB157CA715FCA215F8A21401A215F0A21403A2
15E0A21407A215C0140F1580A2141F1500A2143EA25CA25CA2495AA2495A5C1307495A91
C7FC5B133E133C5B5B485A12035B48C8FC120E5A12785A12C01E527FBD22>I<4B7E4B7E
A21507A25EA2150FA293C8FCA25DA2151EA2153EA2153CA2157CA21578A2007FB812E0B9
FCA27EC7D801F0C8FCA25DA21403A25DA21407A25DA2140FA292C9FCA25CA2141EA2143E
A2141C333275AD40>43 D<387FFFF8A2B5FCA214F0150579941E>45
D<120EEA3F80127F12FFA31300127E123C0909778819>I<EC03F8EC0FFE91383C0F8091
38F007C0903901E003E0D903C013F09038078001020013F8130E131E90391C6000FCEB38
70EC30011370A213F013E0EC70030001016013F813C014E0ECC00701C114F0903881800F
018314E09039C7001FC001FEEB3F80D80078140090C7127E5D4A5A4A5AEC07C0EC1F8002
3EC7FC14FCEB01F0EB07C0495A011EC8FC137C4914C0484813015B485A4848130348C713
80000E1407001E140F48EC1F00D83FF85B397FFFC07E39783FFFFCEA700FD8F0075BD8E0
015B6D13C0021FC7FC263A79B72A>50 D<D9707C130ED9F3FE131E496C133C48B5133816
784815F0EC0F019039FC0703E03A07F00307C001E0138F3A0FC001FF80497E48C7EA0F00
001E5C48141E153E48143C157C485C5A4A5AC7FC4A5AA24A5A140FA24A5AA24AC7FCA25C
147E14FE5C1301A25C1303A2495AA3130F5CA2131F5CA2133FA25C137FA391C8FC137E13
3C273A74B72A>55 D<EC01FCEC0FFF023F138091387E07C0903901F803E0EB03F0903907
E001F0EB0FC0EB1F80013F14F814005B137E13FEA2485AA2150312035BA2ED07F012075B
150FA216E00003141FA2153FED7FC0120115FF6C6C5A90397803BF8090383C0F3FD91FFC
1300903807F07F90C7FC157E15FE5D14015D4A5AA2003E495A007F495A5D4AC7FC00FE5B
48137E007013F8387803F0387C0FE0383FFF806C48C8FCEA03F8253A78B72A>57
D<EE01C01603A21607160FA2161F83163FA2167F16FF16EF150116CFED038FA2ED070FA2
150E151E151C1538A203707FA2EDE007A2EC01C014031580EC0700A2140EA25CA25C027F
B5FCA291B6FC9139E00007F849481303A2495A130791C7FC5B130E5BA25B1378137013F0
EA03F8486C4A7EB56C48B512F0A3343C7BBB3E>65 D<DB03FE130E92393FFF801E92B5EA
E03C913903FE01F0913A0FF000787CDA3FC0EB3CFC4AC7EA1FF802FE140FEB03FC494814
07494815F049481403495A5C49C813E05B485A5B000317C0485AA2485A1880485A94C7FC
A2485AA3127F5BA312FF90CBFCA41738A217784816707E17F06C5E16015F16036C6C4A5A
94C7FC001F150E6D141E000F5D6D5C6C6C495A6C6CEB03C0D801FEEB0F8027007F807EC8
FC6DB45A010F13E0010090C9FC373D74BA3B>67 D<0103B612FEEFFFC018F0903B0007F8
000FF84BEB03FCEF00FE020F157FF03F804B141F19C0021F150F19E05D1807143F19F05D
A2147FA292C8FCA25C180F5CA2130119E04A151FA2130319C04A153FA201071780187F4A
1600A2010F16FEA24A4A5A60011F15034D5A4A5D4D5A013F4B5A173F4A4AC7FC17FC017F
EC03F84C5A91C7EA1FC04949B45A007F90B548C8FCB712F016803C397CB83F>I<0107B8
FCA3903A000FF000034BEB007F183E141F181E5DA2143FA25D181C147FA29238000380A2
4A130718004A91C7FC5E13015E4A133E167E49B512FEA25EECF8000107147C163C4A1338
A2010F147818E04A13701701011F16C016004A14031880013F150718004A5CA2017F151E
173E91C8123C177C4915FC4C5A4914070001ED7FF0B8FCA25F38397BB838>I<0107B712
FEA3903A000FF000074B1300187C021F153CA25DA2143FA25D1838147FA292C8FCEE0380
4A130718004A91C7FCA201015CA24A131E163E010314FE91B5FC5EA2903807F800167C4A
1378A2130FA24A1370A2011F14F0A24A90C8FCA2133FA25CA2137FA291CAFCA25BA25B48
7EB6FCA337397BB836>I<DB03FE130E92393FFF801E92B5EAE03C913903FE01F0913A0F
F000787CDA3FC0EB3CFC4AC7EA1FF802FE140FEB03FC49481407494815F049481403495A
5C49C813E05B485A5B000317C0485AA2485A1880485A94C7FCA2485AA3127F5BA312FF90
CBFC0307B512E0A392390007FC00705A16075FA36C150F5FA36C6C141FA2001F5E6D143F
6C7E167F6C6C4A5A6C6CEB03EFD801FEEB07C73A007FC03F0790273FFFFC03C7FC010F01
F0C8FC01001380373D74BA40>I<0103B512F8A390390007F8005DA2140FA25DA2141FA2
5DA2143FA25DA2147FA292C7FCA25CA25CA21301A25CA21303A25CA21307A25CA2130FA2
5CA2131FA25CA2133FA25CA2137FA291C8FC497EB6FCA25C25397CB820>73
D<0107B512FCA25E9026000FF8C7FC5D5D141FA25DA2143FA25DA2147FA292C8FCA25CA2
5CA21301A25CA21303A25CA21307A25CA2130F170C4A141CA2011F153C17384A1478A201
3F157017F04A14E01601017F140317C091C71207160F49EC1F80163F4914FF0001020713
00B8FCA25E2E397BB834>76 D<902607FFF8923807FFF0614F13E0D9000FEFF0004F5AA2
021F167FF1EFC0141DDA1CFCEC01CF023C16DF9538039F800238ED071FA20278ED0E3F97
C7FC0270151CA202F04B5AF0707E14E0037E14E0010117FE4D485A02C0EC0380A20103ED
0701610280140EA20107ED1C0305385B14006F137049160705E05B010EEC01C0A2011E91
3803800F61011CEC0700A2013C020E131F4C5C1338ED1FB80178163F04F091C8FC01705C
A201F04A5B187E00015DD807F816FEB500C09039007FFFFC151E150E4C397AB84A>I<90
2603FFF891B512E0A281D90007923807F8006F6E5A61020F5E81DA0E7F5DA2021E6D1307
033F92C7FC141C82DA3C1F5C70130EEC380FA202786D131E0307141C147082DAF003143C
70133814E0150101016E1378030014705C8201036E13F0604A1480163F010715C1041F5B
91C7FC17E149EC0FE360010E15F31607011E15FF95C8FC011C80A2013C805F1338160013
785F01F8157CEA03FC267FFFE0143CB51538A243397CB83E>I<0107B612F817FF188090
3B000FF0003FE04BEB0FF0EF03F8141FEF01FC5DA2023F15FEA25DA2147FEF03FC92C7FC
A24A15F817074A15F0EF0FE01301EF1FC04AEC3F80EFFE0001034A5AEE0FF091B612C04C
C7FCD907F8C9FCA25CA2130FA25CA2131FA25CA2133FA25CA2137FA291CAFCA25BA25B12
01B512FCA337397BB838>80 D<0103B612F017FEEFFF80903B0007F8003FC04BEB0FF017
07020FEC03F8EF01FC5DA2021F15FEA25DA2143FEF03FC5DA2027FEC07F818F092C7120F
18E04AEC1FC0EF3F004A14FEEE01F80101EC0FE091B6128004FCC7FC9138FC003F0103EC
0F80834A6D7E8301071403A25C83010F14075F5CA2011F140FA25CA2133F161F4AECE007
A2017F160F180E91C7FC49020F131C007F01FE153CB5913807F078040313F0CAEAFFE0EF
3F80383B7CB83D>82 D<92383FC00E913901FFF01C020713FC91391FC07E3C91393F001F
7C027CEB0FF84A130749481303495A4948EB01F0A2495AA2011F15E091C7FCA34915C0A3
6E90C7FCA2806D7E14FCECFF806D13F015FE6D6D7E6D14E0010080023F7F14079138007F
FC150F15031501A21500A2167C120EA3001E15FC5EA3003E4A5AA24B5AA2007F4A5A4B5A
6D49C7FC6D133ED8F9F013FC39F8FC03F839F07FFFE0D8E01F138026C003FCC8FC2F3D7A
BA2F>I<0007B812E0A25AD9F800EB001F01C049EB07C0485AD900011403121E001C5C00
3C17801403123800785C00701607140700F01700485CA2140FC792C7FC5DA2141FA25DA2
143FA25DA2147FA292C9FCA25CA25CA21301A25CA21303A25CA21307A25CA2130FA25CEB
3FF0007FB512F8B6FCA2333971B83B>I<B5D8F80FB590381FFFF06102F018E0D807FEC7
D87FE0903803FE00D803F8DA3F806D5AF100F0A24F5A621903621907047F92C7FC190E16
FF4B5DA2DB03BF5C7F0001DA073F5CA2030E5D83DB1C1F495A180303385D4EC8FC157003
F0140E15E0DA01C05CA2DA03805CA2DA07005CA2020E5D17C14A5DEFC3805C027802C7C9
FC14704A14CE13FE6C6C4814DCA24A14F8A291C75B160F495D5F5B5F5B4992CAFCA24914
0E4C3B6FB853>87 D<14F8EB07FE90381F871C90383E03FE137CEBF801120148486C5A48
5A120FEBC001001F5CA2EA3F801403007F5C1300A21407485C5AA2140F5D48ECC1C0A214
1F15831680143F1587007C017F1300ECFF076C485B9038038F8E391F0F079E3907FE03FC
3901F000F0222677A42A>97 D<133FEA1FFFA3C67E137EA313FE5BA312015BA312035BA3
1207EBE0F8EBE7FE9038EF0F80390FFC07C013F89038F003E013E0D81FC013F0A21380A2
123F1300A214075A127EA2140F12FE4814E0A2141F15C05AEC3F80A215005C147E5C3878
01F8007C5B383C03E0383E07C0381E1F80D80FFEC7FCEA01F01C3B77B926>I<147F9038
03FFC090380FC1E090381F0070017E13784913383901F801F83803F003120713E0120FD8
1FC013F091C7FC485AA2127F90C8FCA35A5AA45AA3153015381578007C14F0007EEB01E0
003EEB03C0EC0F806CEB3E00380F81F83803FFE0C690C7FC1D2677A426>I<ED01F815FF
A3150316F0A21507A216E0A2150FA216C0A2151FA21680A2153FA202F81300EB07FE9038
1F877F90383E03FF017C5BEBF80112013803F00048485B120FEBC001121F5DEA3F801403
127F01005BA214075A485CA2140FA248ECC1C0A2141F15C3ED8380143F1587007C017F13
00ECFF076C485B9038038F8E391F0F079E3907FE03FC3901F000F0253B77B92A>I<147F
903803FFC090380FC1E090383F00F0017E13785B485A485A485A120F4913F8001F14F038
3F8001EC07E0EC1F80397F81FF00EBFFF891C7FC90C8FC5A5AA55AA21530007C14381578
007E14F0003EEB01E0EC03C06CEB0F806CEB3E00380781F83803FFE0C690C7FC1D2677A4
26>I<ED07C0ED1FF0ED3E38ED7C3CEDF8FC15F9140115F1020313F8EDF0F0160014075D
A4140F5DA4141F5D010FB512C05B16809039003F800092C7FCA45C147EA414FE5CA41301
5CA413035CA413075CA4130F5CA3131F5CA391C8FC5B121CEA7E3EA2EAFE3C137C1378EA
F8F01278EA3FC0EA0F80264C82BA19>I<EC07C0EC3FF09138FC38E0903901F01FF0EB03
E0903807C00FEB0F80011F1307D93F0013E05B017E130F13FE4914C01201151F12034914
80A2153F1207491400A25DA249137EA215FEA25D00031301140314076C6C485A0000131F
EB787BEB3FF390380FC3F0EB00031407A25DA2140F5D121C007E131F5D00FE49C7FC147E
5C387801F8387C07E0381FFF80D803FEC8FC24367CA426>I<EB03F0EA01FFA3EA00075C
A3130F5CA3131F5CA3133F91C8FCA35B90387E07F0EC1FFCEC783E9038FFE01F02C01380
EC800F1400485A16C05B49EB1F8012035BA2153F000715005BA25D000F147E5B15FE5D12
1FD98001131C15F8163C003F01031338010013F0A216704814E0007E15F016E0EDE1C000
FE903801E38048903800FF000038143C263B7BB92A>I<EB01C0EB07E014F0130F14E013
07EB038090C7FCAB13F0EA03FCEA071EEA0E1F121CA212385B1270A25BEAF07E12E013FE
C65AA212015B1203A25B12075BA2000F13E013C013C1001F13C01381A2EB83801303EB07
00A2130E6C5AEA07F8EA01E0143879B619>I<150E153F157FA3157E151C1500ABEC1F80
EC7FC0ECF1F0EB01C090380380F813071401130F130E131EEB1C03133C013813F0A2EB00
07A215E0A2140FA215C0A2141FA21580A2143FA21500A25CA2147EA214FEA25CA21301A2
5CA213035C121C387E07E0A238FE0FC05C49C7FCEAF83EEA787CEA3FF0EA0FC0204883B6
19>I<EB03F0EA01FFA3EA00075CA3130F5CA3131F5CA3133F91C8FCA35B017EEB0F80ED
3FE015F09039FE01C1F09038FC0387EC0707140E0001011C13E0EBF83891383003800270
C7FC00035BEBF1C0EBF38001FFC8FCEA07FC7FEBFFC0EBE7F8380FE1FCEBC07E147F8000
1F809039801F81C0A21583003F013F138001001303A21507481500007E133EEC1E0E151E
00FE6D5A48EB07F80038EB01E0243B7BB926>I<EB0FC0EA07FFA3EA001F1480A2133FA2
1400A25BA2137EA213FEA25BA21201A25BA21203A25BA21207A25BA2120FA25BA2121FA2
5BA2123FA290C7FCA25AA2EA7E0EA212FE131EEAFC1CA2133C133812F81378EA7870EA7C
E0121FEA0F80123B79B915>I<D801E001FEEB07F03C07F803FF801FFC3C0E3C0F07C078
3E3C1E3E3C03E1E01F261C1F78D9F3C013803C383FF001F7800F02E01400007801C013FE
007018C002805B4A4848EB1F80EAF07FD8E07E5CA200000207143F01FE1700495CA2030F
5C0001177E495C18FE031F5C120349DA8001131C18F8033F153C00070403133849020013
F0A24B1570000F17E049017E15F019E003FEECE1C0001FEE01E34949903800FF000007C7
0038143C3E2679A444>I<D801E013FE3A07F803FF803A0E3C0F07C03A1E3E3C03E0261C
1F787F39383FF00114E0007813C000708114804A485AEAF07FEAE07EA20000140701FE5C
5BA2150F00015D5B151F5E12034990383F8380160316070007027F130049137EA2160E00
0F147C49141E161C5E001FEC3C7849EB1FE00007C7EA0780292679A42F>I<147F903803
FFC090380FC1F090381F00F8017E137C5B4848137E4848133E0007143F5B120F485AA248
5A157F127F90C7FCA215FF5A4814FEA2140115FC5AEC03F8A2EC07F015E0140F007C14C0
007EEB1F80003EEB3F00147E6C13F8380F83F03803FFC0C648C7FC202677A42A>I<9039
078007C090391FE03FF090393CF0787C903938F8E03E9038787FC00170497EECFF00D9F0
FE148013E05CEA01E113C15CA2D80003143FA25CA20107147FA24A1400A2010F5C5E5C4B
5A131F5EEC80035E013F495A6E485A5E6E48C7FC017F133EEC70FC90387E3FF0EC0F8001
FEC9FCA25BA21201A25BA21203A25B1207B512C0A3293580A42A>I<ECF803903807FE07
90381F871F90383E03BF017C13FEEBF80112013803F000484813FC120F5B001F130115F8
EA3F80A2007F1303010013F0A34813074814E0A3140F4814C0A3141F1580143FA2007C13
7FECFF006C5AEB03BF381F0F7F3807FE7EEA01F0C7FC14FE5CA313015CA313035C130748
B512C0A3203577A426>I<3903C003F0390FF01FFC391E783C0F381C7C703A3C3EE03F80
38383FC0EB7F800078150000701300151CD8F07E90C7FCEAE0FE5BA2120012015BA31203
5BA312075BA3120F5BA3121F5BA3123F90C9FC120E212679A423>I<14FE903807FF8090
380F83C090383E00E04913F00178137001F813F00001130313F0A215E00003EB01C06DC7
FC7FEBFFC06C13F814FE6C7F6D13807F010F13C01300143F141F140F123E127E00FE1480
A348EB1F0012E06C133E00705B6C5B381E03E06CB45AD801FEC7FC1C267AA422>I<EB03
80EB07C0130FA4131F1480A3133F1400A35B137E007FB5FCA2B6FC3800FC00A312015BA3
12035BA312075BA3120F5BA3121FEB801CA2143C003F1338EB0078147014F014E0EB01C0
EA3E03381F0780380F0F00EA07FCEA01F0183579B31C>I<13F8D803FEEB01C0D8078FEB
03E0390E0F8007121E121C0038140F131F007815C01270013F131F00F0130000E015805B
D8007E133FA201FE14005B5D120149137EA215FE120349EBFC0EA20201131E161C15F813
E0163CD9F003133814070001ECF07091381EF8F03A00F83C78E090393FF03FC090390FC0
0F00272679A42D>I<01F0130ED803FC133FD8071EEB7F80EA0E1F121C123C0038143F49
131F0070140FA25BD8F07E140000E08013FEC6485B150E12015B151E0003141C5BA2153C
000714385B5DA35DA24A5A140300035C6D48C7FC0001130E3800F83CEB7FF8EB0FC02126
79A426>I<01F01507D803FC903903801F80D8071E903907C03FC0D80E1F130F121C123C
0038021F131F49EC800F00701607A249133FD8F07E168000E0ED000313FEC64849130718
000001147E5B03FE5B0003160E495BA2171E00070101141C01E05B173C1738A217781770
020314F05F0003010713016D486C485A000190391E7C07802800FC3C3E0FC7FC90393FF8
1FFE90390FE003F0322679A437>I<903907E007C090391FF81FF89039787C383C9038F0
3E703A01E01EE0FE3803C01F018013C0D8070014FC481480000E1570023F1300001E91C7
FC121CA2C75AA2147EA214FEA25CA21301A24A1370A2010314F016E0001C5B007E140101
0714C000FEEC0380010F1307010EEB0F0039781CF81E9038387C3C393FF03FF03907C00F
C027267CA427>I<13F0D803FCEB01C0D8071EEB03E0D80E1F1307121C123C0038140F49
14C01270A249131FD8F07E148012E013FEC648133F160012015B5D0003147E5BA215FE00
075C5BA214015DA314035D14070003130FEBF01F3901F87FE038007FF7EB1FC7EB000F5D
A2141F003F5C48133F92C7FC147E147C007E13FC387001F8EB03E06C485A383C1F80D80F
FEC8FCEA03F0233679A428>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fd cmtt9 9 60
/Fd 60 126 df<123C127E12FFAF127EAE123C1200A7123C127E12FFA4127E123C082F71
AE27>33 D<00101320007C13F838FE01FCAAEAFC00007C13F8A900381370161778AE27>
I<EB01C0EB03E0130F131FEB3FC0EB7F80EBFE00485A5B1203485A5B485AA2485AA248C7
FCA3127EA45AAC127EA47EA36C7EA26C7EA26C7E7F6C7E12017F6C7EEB7F80EB3FC0EB1F
E0130F1303EB01C0133A73B327>40 D<127012F812FE7E6C7E6C7EEA0FE06C7E12037F6C
7E1200137EA27FA2EB1F80A3EB0FC0A4EB07E0ACEB0FC0A4EB1F80A3EB3F00A2137EA25B
1201485A5B1207485AEA3FC0485A48C7FC5A12F81270133A7AB327>I<130F497EA60078
EB81E000FEEB87F000FF138FEBDFBF6CB512E06C14C0000F1400000313FCC613F0A20003
13FC000F13FF003F14C04814E039FFDFBFF0EB1F8F00FE13870078EB81E00000EB8000A6
6DC7FC1C207BA627>I<EB03C0497EAD007FB512FEB7FCA46C14FE390007E000AD6D5A20
227DA727>I<120FEA3FC013E0EA7FF0A213F8A2123FA2120F120113F01203EA07E0121F
EA7FC0EAFF8013005A12700D14738927>I<007FB512F8B612FCA46C14F81E067C9927>I<
121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A0A728927>I<EB07E0EB3FFC497E90B5FC48
14803903FC3FC03907F00FE0390FE007F0EBC003391F8001F8A248C712FCA2003E147C00
7E147EA3007C143E00FC143FAC007E147EA46C14FCA2EB8001001F14F8EBC003000F14F0
EBE0073907F00FE03903FC3FC06CB512806C14006D5A6D5AEB07E020307DAE27>48
D<130E131FA25B5BA25B5A5A127FB5FCA213BFEA7E3F1200B3AA003FB512805A15C01580
A21A2F79AE27>I<EB3FE03801FFF84813FE000FEBFF804814C0393FE07FE0EB800F397F
0007F0007EEB03F800FE13015A6C14FC1400A3127CC8FCA2140115F8A2140315F01407EC
0FE0EC1FC0143FEC7F80ECFF00495A495A495A495A495A495A495A01FEC7FC485AD807F8
1378484813FC485A485A48B5FCB6FCA36C14F81E2F7CAE27>I<121EEA7F80A2EAFFC0A4
EA7F80A2EA1E00C7FCAC121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A20729F27>58
D<120FEA3FC0A2EA7FE0A4EA3FC0A2EA0F00C7FCAC120FEA3F8013C0127F13E0A3123FA2
120F120713C0120FA2EA3F80EA7F005A5A12F812700B2A739F27>I<153815FC14011407
140FEC3FF8EC7FE0ECFFC001031300495AEB1FF8495A495A3801FF804890C7FCEA0FFC48
5AEA7FF0EAFFC05BA27FEA7FF0EA1FF86C7EEA03FF6C7F38007FE06D7E6D7EEB07FE6D7E
010013C0EC7FE0EC3FF8EC0FFC14071401140015381E287CAA27>I<007FB512FEB7FCA4
003F14FEC9FCA6003FB512FEB7FCA46C14FE20127D9F27>I<127012FC7E6C7E7FEA7FF0
EA1FF86C7EEA03FF6C7F38007FE06D7E6D7EEB07FE6D7E010013C0EC7FE0EC3FF8EC0FFC
1407A2140FEC3FF8EC7FE0ECFFC001031300495AEB1FF8495A495A3801FF804890C7FCEA
0FFC485AEA7FF0EAFFC05B48C8FC5A12701E287CAA27>I<EBFFF8000313FF000F14C000
3F14E04814F09038C01FF839FF0003FC4813011400A21401007C1303C7EA0FF8EC1FF0EC
7FE0ECFFC0491300EB03FC495A5C495A5C131F5CA76DC7FC90C8FCA7130F497E497EA46D
5A6DC7FC1E2E7CAD27>I<EB03F0497EA2497EA4143CEB1F3EA5EB3F3FA3EB3E1FA2017E
7FA4496C7EA548486C7EA390B5FCA24880A3EBF003A248486C7EA4000F803A7FFC0FFF80
00FF15C06D5A497E007F1580222F7EAE27>65 D<007FB5FCB612C08115F87E3907E003FC
EC00FE157E157F81A6157EA25D1403EC0FF890B55A15C015F081819038E000FE157FED3F
80151FA2ED0FC0A6151F1680153FED7F004A5A007FB55AB65A5D15E06C1480222E7FAD27
>I<903803F80E90381FFE1F90383FFFBF90B6FC5A3803FE0F3807F803497E48487E485A
49137FA248C7123FA25A127E151E150012FE5AAA7E127EA2151E007F143F7EA26C7E157F
6D137E6C6C13FE3907F001FCEBF8033903FE0FF86CB512F06C14E0013F13C06D1300EB03
F820307DAE27>I<387FFFFC14FFB612C06C80813907E00FF81407EC01FC6E7EA2157E15
7F811680151FA316C0150FABED1F80A3153F1600A25D15FEA24A5A4A5A140F007FB55A5D
B65A6C91C7FC14FC222E7FAD27>I<007FB61280B712C0A37E3907E0000FA6ED078092C7
FCA4EC07804A7EA390B5FCA5EBE00FA36E5A91C8FCAC387FFF80B57EA36C5B222E7EAD27
>70 D<007FB512E0B612F0A36C14E039001F8000B3B2007FB512E0B612F0A36C14E01C2E
7BAD27>73 D<387FFFC080B5FC7E5CD803F0C8FCB3AAED0780ED0FC0A7007FB6FCA2B7FC
7E1680222E7FAD27>76 D<D87FE0EB7FE0486CEBFFF0A26D5A007F15E0000F150001B813
DFEBBC03A3EBBE07019E139FA3EB9F0FA2018F131FA2149FA2EB879EA4EB839C14FCA3EB
81F8A2EB80F01400AAD87FF0EBFFE0486C4813F0A36C486C13E0242E7FAD27>I<3A7FF0
03FFE0486C4813F0A213FC007F6D13E000079038003E0013DEA313CFA3148013C714C0A2
13C314E0A213C114F0A3EBC0F8A31478147CA2143C143EA2141E141F140FA3EC07BEA3EC
03FEEA7FFCEAFFFE1401A26C486C5A242E7FAD27>I<EBFFFC0007EBFF80001F14E0A248
14F0EBC00F397F8007F8EB0003007E1301A348EB00FCB3A76C1301007E14F8A3007F1303
EB8007393FE01FF090B5FC6C14E0A200071480C6EBFC001E307CAE27>I<007FB5FCB612
E081816C803907E003FEEC00FF81ED3F80151F16C0150FA6151F1680153FED7F005DEC03
FE90B55A5D5D5D92C7FC01E0C8FCADEA7FFEB5FCA36C5A222E7FAD27>I<387FFFF0B512
FE6E7E816C803907E01FF014076E7E1401811400A514015D14034A5A141F90B55A5D5DA2
81EBE01F6E7E14076E7EA816F0EDF1F8A4397FFE01FBB5EBFFF08016E06C48EB7FC0C8EA
1F00252F7FAD27>82 D<90387FC0E03901FFF1F0000713FF5A5AEA3FE0EB801F387F000F
007E130712FE5A1403A3EC01E06C90C7FC127E127FEA3FC013F86CB47E6C13F86C13FE6C
EBFF80C614C0010F13E0010013F0140FEC07F81403140115FC1400127812FCA46CEB01F8
A26C130390388007F09038F01FE090B5FC15C0150000F85B38701FF81E307CAE27>I<00
7FB61280B712C0A439FC03F00FA60078EC0780000091C7FCB3AB90B512C04880A36C5C22
2E7EAD27>I<3A7FFC03FFE06D5A00FF15F0007F15E0497E3A07E0007E00A46C6C5BA4EB
F80100015CA46C6C485AA490387E07E0A56D485AA4011F5B149FA3010F90C7FCA5EB07FE
A46D5AA26D5A242F7FAD27>86 D<D87FE0EB7FE0486CEBFFF0A36C48EB7FE0001FC7EA0F
80A76C6CEB1F00A614F0EB81F83907C3FC3EA4149CEBC79EA30003143CA301E7137CEBEF
9FA2140FA200011478A49038FE07F8A300005CA2EBFC0390387801E0242F7FAD27>I<00
7FB512F8B612FCA46C14F81E067C7E27>95 D<3803FFC0000F13F04813FC4813FF811380
EC1FC0381F000F000480C71207A2EB0FFF137F0003B5FC120F5A383FFC07EA7FC0130012
FE5AA46C130F007F131FEBC0FF6CB612806C15C07E000313F1C69038807F8022207C9F27
>97 D<EA7FE0487EA3127F1203A914FF01F313C090B512F08181EC81FE49C67E49EB3F80
49131F16C049130FA216E01507A6150F16C07F151F6DEB3F80157F6DEBFF009038FF83FE
ECFFFC5D5D01F313C02601E0FEC7FC232E7FAD27>I<EB0FFF017F13C048B512E04814F0
5A380FF807EA1FE0393FC003E0903880008048C8FC127EA212FE5AA67E127EA2007F14F0
393F8001F813C0381FE003390FF80FF06CB5FC6C14E06C14C06C6C1300EB0FF81D207B9F
27>I<EC3FF04A7EA3143F1401A9EB0FE1EB7FFD48B5FC5A5A380FF83F381FE00F383FC0
07EB8003EA7F00007E1301A212FE5AA67E007E1303A2127F6C1307EB800F381FE01F380F
F03F6CB612C06C15E06C13FD38007FF9D91FE013C0232E7EAD27>I<EB0FF8EB3FFE90B5
1280000314C04814E0390FFC0FF0391FE003F8EBC001D83F8013FC48C7FC127E157E12FE
B612FEA415FC00FCC8FC7E127E127F6C143C6D137E6C7E01F013FE390FFC07FC6CB5FC00
0114F86C14F0013F13C0903807FE001F207D9F27>I<EC1FF0ECFFF84913FC4913FE5BEB
0FF014C0011F137CEC8000A6007FB512F0B612F8A36C14F039001F8000B3A4003FB512C0
4814E0A36C14C01F2E7EAD27>I<153F90391FC0FF80D97FF313C048B612E05A4814EF39
0FF07F873A1FC01FC3C0EDC000EB800F48486C7EA66C6C485AEBC01FA2390FF07F8090B5
C7FC5C485BEB7FF0EB1FC090C9FCA27F6CB5FC15E015F84814FE4880EB8001007EC7EA3F
80007C140F00FC15C0481407A46C140F007C1580007F143F6C6CEB7F009038F807FF6CB5
5A000714F86C5CC614C0D90FFCC7FC23337EA027>I<EA7FE0487EA3127F1203A9147F90
38F1FFC001F713F090B5FC8114C1EC01FCEBFE005B5BA25BB03A7FFF83FFE0B500C713F0
A36C018313E0242E7FAD27>I<130F497E497EA46D5A6DC7FC90C8FCA7383FFF80487FA3
7EEA000FB3A4007FB512F0B6FC15F815F07E1D2F7BAE27>I<387FFF80B57EA37EEA000F
B3B2007FB512F8B612FCA36C14F81E2E7CAD27>108 D<397F07C01F3AFF9FF07FC09039
FFF9FFE091B57E7E3A0FFC7FF1F89038F03FC001E0138001C01300A3EB803EB03A7FF0FF
C3FF486C01E3138001F913E701F813E36C4801C313002920819F27>I<387FE07F39FFF1
FFC001F713F090B5FC6C80000313C1EC01FCEBFE005B5BA25BB03A7FFF83FFE0B500C713
F0A36C018313E024207F9F27>I<EB1FE0EB7FF83801FFFE487F481480390FF03FC0391F
C00FE0393F8007F0EB00034814F8007E1301A248EB00FCA76C1301007E14F8A2007F1303
393F8007F0A2391FE01FE0390FF03FC06CB512806C14006C5B38007FF8EB1FE01E207C9F
27>I<387FE0FFD8FFF313C090B512F0816C800003EB81FE49C67E49EB3F8049131F16C0
49130FA216E01507A6150F16C07F151F6DEB3F80157F6DEBFF009038FF83FEECFFFC5D5D
01F313C0D9F0FEC7FC91C8FCAC387FFF80B57EA36C5B23317F9F27>I<90380FF03C9038
3FFE7E90B5FC000314FE5A380FFC1F381FE007EBC003383F800148C7FC127EA200FE147E
5AA67E007E14FEA2007F1301EA3F80EBC003381FE007380FF81F6CB5FC7E6C147E38007F
FCEB0FF090C7FCAC91381FFFF8A24A13FC6E13F8A226317E9F27>I<397FFC03FC39FFFE
0FFF023F13804A13C0007F90B5FC39007FFE1F14F89138F00F809138E002004AC7FC5CA2
91C8FCA2137EAD007FB57EB67EA36C5C22207E9F27>I<9038FFF3800007EBFFC0121F5A
5AEB803F38FC000F5AA2EC07806C90C7FCEA7F8013FC383FFFF06C13FC000713FF000114
80D8000F13C09038003FE014070078EB03F000FC1301A27E14036CEB07E0EBE01F90B512
C01580150000FB13FC38707FF01C207B9F27>I<133C137EA8007FB512F0B612F8A36C14
F0D8007EC7FCAE1518157EA415FE6D13FC1483ECFFF86D13F06D13E0010313C001001300
1F297EA827>I<397FE01FF8486C487EA3007F131F00031300B21401A21403EBFC0F6CB6
12E016F07EEB3FFE90390FF87FE024207F9F27>I<3A7FFC0FFF80486C4813C0A36C486C
13803A07C000F800EBE00100035CA2EBF00300015CA2EBF80700005CA390387C0F80A36D
48C7FCA3EB3F3FEB1F3EA214FE6D5AA36D5AA26D5A22207E9F27>I<3A7FFE07FFE000FF
15F06D5A497E007F15E03A0F80001F00A36D5B0007143EA414F0EBC1F83903E3FC7CA4EB
E79EA200011478A301F713F8A2EBFF0F6C5CA3EBFE0790387C03E024207F9F27>I<393F
FC1FFF486C5A168016006C487E3901F807E06C6C485A4A5A017E90C7FC6D5AEB1F7E5C6D
5A13076D5A5C80497E130F497E143EEB3E3FEB7E1F90387C0F8001F87F00016D7E3803F0
033A7FFE1FFF80A2B54813C06C486C1380A222207E9F27>I<3A7FFC0FFF80486C4813C0
A36C486C13803A07E000F800000313015D13F00001130301F85B1200A26D485A137CA290
387E0F80133EA2011F90C7FC5CA2130F149E14BE130714FC1303A25C1301A25CA213035C
A213075C1208EA3E0F007F5B131FD87E7FC8FCEA7FFE6C5A5B6C5AEA07C022317E9F27>
I<EC07F8EC3FFC14FF130315F8903807FE00EB0FF05C5CB0131FEB7F80EA3FFFB5C7FC5B
A27F003F7FEA007FEB1FC0130FB08080EB07FE903803FFF815FC1300143FEC07F81E3A7C
B327>123 D<EA7F80EAFFF013FC13FF7E00017F38003FC0131F130FB080EB07F8ECFFF0
6D13FC7FA25B4913F0ECF800EB0FE05CB0131F133F48B45A007F90C7FCB5FC13FC13F0EA
7F801E3A7CB327>125 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fe cmtt10 10 93
/Fe 93 126 df<121C127FEAFF80B1EA7F00AF123EC7FCA8121C127FA2EAFF80A3EA7F00
A2121C09346FB32C>33 D<003C131E007F137F481480A66C1400A6007E7FA6003E133EA3
003C131E001C131C191977B32C>I<010F133C90381F807EA8013F13FE4A5AA4007FB612
F0B712F8A4003F15F03A007E01F800A5EBFE0301FC5BA6003FB612F0B712F8A46C15F03A
01F807E000A30003130F01F05BA86C486C5A25337DB22C>I<EB01C0497EA6EB0FFC9038
7FFF8048B512E00007804880391FFBEFFC393FC3E1FE903803E07F007E80127C00FC1580
12F8157FA300FCEC3F00A2007E91C7FC127FEA3FC313FBEA1FFF6C13FC6C13FF000114C0
6C6C7F011F13F801037F14E7ECE1FEECE07F81001880007E1580150F12FFA312FE151F16
00007E5C007F143ED83F8313FE9038C3E1FC391FFBEFF86CB55A6C5C6C5CC691C7FCEB1F
F8EB03E0A66D5A21417BB92C>I<D807801307D81FE0EB0F80151F487E486C133F160000
7C5CD8FCFC137EEAF87C15FE5D14015DA21403D8FCFC5BEA7CF8007F13075D383FF00FD8
1FE05BA23807801FC75B143F92C7FCA25C147E14FE5CA213015CA213035C13075CA2130F
5C131FEC800FED3FC0013FEB7FE0140049EBFFF0017E13F9A2D9FE0113F801FC13F0A212
0113F8120313F015F90007010013F05B000F14FF49EB7FE0A20007EC3FC06C48EB0F0025
417DB92C>I<EB0FC0EB3FE0497E497E80EA01F8EBF07C147E0003133E13E0A5147E147C
9138FC3FF89039F0F87FFCEA01F1EBF3F001F7EB3FF89138E01F009038FFC03F6CEB803E
A2EC007E49137C485A486C13FC00075CEBFF01D80FDF5B381F9F81383F8F8390380FC3E0
387E07E75D38FC03F7EB01FF5D6D1410ED007C80A26CEBFF80D87E0113C0D87F03EBE0FC
3A3F87F7F1F89038FFE3FF6C01C113F06C13806C9038007FC0D801FCEB1F8026357EB32C
>I<EA0F80EA1FC0EA3FE013F0A213F8A2121F120F1200A4120113F0A2120313E01207EA
0FC0121FEA3F80EA7F0012FE5A5A12700D1B71B22C>I<143814FC13011303EB07F8EB0F
F0EB1FC0EB3F80EB7F0013FE485A485A5B12075B120F5B485AA2123F90C7FCA25A127EA3
12FE5AAC7E127EA3127F7EA27F121FA26C7E7F12077F12037F6C7E6C7E137FEB3F80EB1F
C0EB0FF0EB07F8EB03FC130113001438164272B92C>I<127012FC7E7E6C7E6C7EEA0FE0
6C7E6C7E6C7E6C7E137F7F1480131F14C0130FEB07E0A214F01303A214F81301A314FC13
00AC130114F8A3130314F0A2130714E0A2EB0FC0131F1480133F14005B13FE485A485A48
5A485AEA3FC0485A48C7FC5A5A1270164279B92C>I<EB0380497EA60020140800F8143E
00FE14FE00FF13C1EBC7C7EBE7CF003FB512F8000F14E0000314806C140038007FFCA248
B5FC481480000F14E0003F14F839FFE7CFFEEBC7C7EB07C100FE13C000F8143E00201408
00001400A66D5A1F247AAA2C>I<147814FCAF007FB612F0B712F8A46C15F0C700FCC7FC
AF147825267DAB2C>I<EA0F80EA1FE0EA3FF0EA7FF8A213FCA3123F121F120F120013F8
A21201EA03F01207EA1FE0EA7FC0EAFF80130012FC12700E17718A2C>I<007FB6FCB712
80A46C150021067B9B2C>I<121FEA3F80EA7FC0EAFFE0A5EA7FC0EA3F80EA1F000B0B70
8A2C>I<1507ED0F80151FA2153F16005D157E15FE5D14015D14035DA214075D140F5D14
1F5D143F92C7FC5C147E14FE5CA213015C13035C13075C130F5C131F5CA2133F91C8FC5B
137E13FE5B12015B12035B12075BA2120F5B121F5B123F90C9FC5A127E12FE5AA25A1278
21417BB92C>I<EB03F8EB0FFE90383FFF80497F90B57E3901FE0FF03903F803F848486C
7EEBE0004848137EA248487FA248C7EA1F80A2003E140F007E15C0A3007C140700FC15E0
AC6C140F007E15C0A46CEC1F80A36C6CEB3F00A26C6C137E6D13FE00075CEBF0016C6C48
5A3901FE0FF06CB55A6D5B6D5BD90FFEC7FCEB03F823357CB32C>I<1307497EA2131FA2
133F137F13FF5A1207127FB5FC13DF139FEA7C1F1200B3AE007FB512E0B612F0A36C14E0
1C3477B32C>I<EB0FF890387FFF8048B512E00007804814FC391FF80FFE393FE001FF90
3880007F48C7EA3F80007E141F00FE15C0150F6C15E01507A3127E123CC8FCA2150F16C0
151F1680153F16005D15FE4A5A14034A5A4A5A4A5A4A5AECFF804948C7FC495A495A495A
EB3FE0EB7F8049C8FC485A4848EB03C04848EB07E0EA1FE0485A48B6FCB7FCA36C15C023
347CB32C>I<EB0FFC90387FFF8048B512E0000714F84880391FF807FEEBC0004848137F
6D7F1680151FA26C5A6CC7FCC8FC153F16005D15FE14014A5AEC1FF890381FFFF0495BA2
15F86D7F90380007FEEC00FF81ED3F80ED1FC0150FA216E01507A2123C127EB4FC150F16
C0A248141F007FEC3F806DEB7F006C6C5B391FF807FE6CB55A6C5C6C14E0C66C1380D90F
FCC7FC23357CB32C>I<EC07F04A7E141F143FA2147EA214FCEB01F8A2EB03F0EB07E0A2
EB0FC0EB1F80A2EB3F00137EA25B485AA2485A5B1207485AA2485A48C7FCA2127E5AB712
FC16FEA36C15FCC8EAF800AA91387FFFF091B512F8A36E13F027347EB32C>I<000FB512
FE4880A35D0180C8FCADEB83FE90389FFF8090B512E015F8819038FE03FE9038F000FF01
C07F49EB3F8090C7121F6C15C0C8120FA2ED07E0A4123C127EB4FC150F16C0A248141F00
7EEC3F80007FEC7F006C6C5B6D485A391FF80FFC6CB55A6C5C000114C06C6C90C7FCEB0F
F823347CB22C>I<EC3FC0903801FFF801077F011F7F497F90387FE07F9039FF003F8048
48137FEA03F8485A5B000FEC3F004848131E4990C7FC123F90C9FCA25A127EEB03FE9038
1FFF80D8FC7F13E000FDB57EB67E9038FE07FC9038F001FE9038C0007F49EB3F8090C712
1F16C048140F16E01507A3127EA47E150F6D14C0001F141F6D1480000F143F6DEB7F0039
07F801FE3903FE07FC6CB55A6C5C6D5B011F1380D907FCC7FC23357CB32C>I<1278B712
C016E0A316C000FCC7EA3F80ED7F0015FE00785CC712014A5A4A5A5D140F5D4A5A143F92
C7FC5C147E14FE5C13015CA2495AA213075CA3495AA4495AA5133F91C8FCAA131E23357C
B32C>I<EB07FC90383FFF8090B512E0000314F84880390FFC07FE391FF001FF9038C000
7F4848EB3F8090C7121F4815C0007E140FA56CEC1F80A26C6CEB3F006D5B390FF001FE39
03FC07F86CB55A6C6C13C0D907FCC7FC90387FFFC048B512F03903FC07F8390FF001FE39
1FC0007F497F48C7EA1F80007EEC0FC0A248EC07E0A7007EEC0FC0A2007F141F6C6CEB3F
806C6CEB7F009038F001FF390FFC07FE6CB55A6C5CC614E0013F1380D907FCC7FC23357C
B32C>I<EB07FCEB3FFF90B512C0488048803907FC07F8390FF001FC48486C7ED83F8013
7E157F48C77E007EEC1F8012FE5AED0FC0A416E0A37E127E007F141F7E6D133F6C6C137F
390FF001FF3807FC0F6CB6FC6C14F76C14C7013F130FD90FF813C090C7FCA2151F168015
3F1600000F5C486C137E486C13FE4A5A4A5A14079038801FF0391FE07FE090B55A6C91C7
FC6C5B000113F838007FC023357CB32C>I<121FEA3F80EA7FC0EAFFE0A5EA7FC0EA3F80
EA1F00C7FCAE121FEA3F80EA7FC0EAFFE0A5EA7FC0EA3F80EA1F000B2470A32C>I<EA0F
80EA1FC0EA3FE0EA7FF0A5EA3FE0EA1FC0EA0F80C7FCAEEA0F80EA1FC0EA3FE0127F13F0
A4123F121F120F1201120313E01207EA0FC0A2EA3F80EA7F005A5A12F812700C3071A32C
>I<1507ED1F80153F15FF14034A1300EC1FFC4A5AECFFE0491380010790C7FCEB0FFCEB
3FF8EB7FE048485A4890C8FCEA0FFEEA1FF8EA7FF0EAFFC05BA27FEA7FF0EA1FF8EA0FFE
EA03FF6C13C06C6C7EEB3FF8EB0FFC6DB4FC01017F6D13E0EC3FF86E7EEC07FF6E138014
00153F151FED0700212A7BAD2C>I<007FB612F0B712F8A4003F15F0CAFCA8003FB612F0
B712F8A46C15F025147DA22C>I<127012FC7E6C7E13E06C7EEA1FFC6C7E3803FF80C67F
EB7FF0EB1FF8EB0FFEEB03FF6D13C06D6C7EEC3FF8EC0FFC6EB4FC0201138080A25C0207
1300EC0FFCEC3FF8EC7FE049485A4990C7FCEB0FFEEB1FF8EB7FF0EBFFC000035BD80FFE
C8FC485AEA7FF0485A138048C9FC5A1270212A7BAD2C>I<EB3FFE0003B512C0000F14F0
4814FC4880397FE007FF90C7FC00FEEC3F806C141FA3153F007EEC7F00003C5CC7EA03FE
EC0FFC4A5AEC3FE04A5A4AC7FC495A495A5C13075C130F5CA76D5A90C9FCA8EB0380EB0F
E0A2497EA36D5AA2EB038021337BB22C>I<EC7F80903803FFE0010F7F013F7F497F9038
FFC0FE3901FE007FD803F87F4848EB1F809038E00FCF390FC03FFF48484813C091B5FCEA
3F01393E03F87F903907F03FE0007EEBE01F397C0FC00FEC8007A2EAFC1F00F8EB0003A9
00FCEB8007D87C0F14C0A2ECC00F3A7E07E01F80003EEBF03F903903F87F00393F01FFFE
D81F805B6E5A6C6C6C5A3907E00FC09039F00007C06C6CEB0FE0D801FE131F3900FFC0FF
6DB512C06D1480010FEBFE00010313F89038007FC023337CB22C>I<14FE497EA4497FA2
14EFA2130781A214C7A2010F7FA314C390381F83F0A590383F01F8A490387E00FCA54913
7E90B512FEA34880A29038F8003FA34848EB1F80A4000715C049130FD87FFEEBFFFC6D5A
B514FE6C15FC497E27347EB32C>I<007FB512E015F8B612FE6C8016C03903F0003FED0F
E0ED07F01503A2ED01F8A6ED03F0A21507ED0FE0ED1FC0EDFF8090B612005D5D15FF16C0
9039F0001FE0ED07F0ED03F81501ED00FCA216FE167EA616FE16FC1501ED03F8150FED3F
F0007FB612E016C0B712806CECFE0015F027337FB22C>I<02FF13700107EBE0F84913F9
013F13FD4913FFEBFF813901FE007F4848131FD807F0130F1507485A491303485A150148
C7FCA25A007EEC00F01600A212FE5AAB7E127EA3007F15F06CEC01F8A26C7EA26C6C1303
6D14F06C6C130716E0D803FC131F6C6CEB3FC03A00FF81FF806DB512006D5B010F5B6D13
F00100138025357DB32C>I<007FB5FCB612C015F0816C803907E003FEEC00FFED7F8015
3FED1FC0ED0FE0A2150716F0150316F81501A4ED00FCACED01F8A3150316F0A2150716E0
150FED1FC0153FED7F80EDFF00EC03FE007FB55AB65A5D15C06C91C7FC26337EB22C>I<
007FB612F0B712F8A37E3903F00001A7ED00F01600A4EC01E04A7EA490B5FCA5EBF003A4
6E5A91C8FCA5163C167EA8007FB612FEB7FCA36C15FC27337EB22C>I<007FB612F8B712
FCA37ED803F0C7FCA716781600A515F04A7EA490B5FCA5EBF001A46E5A92C7FCAD387FFF
E0B5FC805C7E26337EB22C>I<903901FC038090390FFF87C04913EF017F13FF90B6FC48
13073803FC01497E4848137F4848133F49131F121F5B003F140F90C7FCA2127EED078092
C7FCA212FE5AA8913803FFF84A13FCA27E007E6D13F89138000FC0A36C141FA27F121F6D
133F120F6D137F6C7E6C6C13FF6D5A3801FF076C90B5FC6D13EF011F13CF6DEB0780D901
FCC7FC26357DB32C>I<D87FFEEBFFFCB54813FEA36C486C13FCD807E0EB0FC0B190B6FC
A59038E0000FB3D87FFEEBFFFCB54813FEA36C486C13FC27337EB22C>I<007FB512F8B6
12FCA36C14F839000FC000B3B3A5007FB512F8B612FCA36C14F81E3379B22C>I<0107B5
12804914C0A36D148090390003F000B3AF1218127EA2B4FCA24A5A48130F007F131F9038
C07FC06CB55A6C91C7FC6C5B000313F838007FC022347BB22C>I<D87FFCEB7FF8486CEB
FFFCA36C48EB7FF8D807C0EB1F80153FED7F00157E5D4A5A14034A5A5D4A5A4A5A143F4A
C7FC147E5CEBC1F813C3EBC7FCA2EBCFFEEBDFBEEBFFBF141F01FE7F496C7E13F86E7EEB
F00301E07FEBC001816E7EA2157E153E153F811680ED0FC0A2ED07E0D87FFCEB1FFC486C
EB3FFEA36C48EB1FFC27337EB22C>I<387FFFE0B57EA36C5BD803F0C8FCB3AE16F0ED01
F8A8007FB6FCB7FCA36C15F025337DB22C>I<D87FE0EB0FFC486CEB1FFEA26D133F007F
15FC000F15E001BC137BA4019E13F3A3EB9F01A2018F13E3A21483A2018713C314C7A201
831383A214EFA201811303A214FFEB80FEA3147C14381400ACD87FF0EB1FFC486CEB3FFE
A36C48EB1FFC27337EB22C>I<D87FF0EB7FFC486CEBFFFEA27F007FEC7FFCD807FEEB07
C013DEA213DF13CFA2148013C714C0A213C314E0A213C114F0A213C014F8A2147CA3143E
A2141E141FA2140F1587A2140715C7A2140315E71401A215F71400A215FFD87FFC137F48
7E153FA26C48EB1F8027337EB22C>I<EB7FFF0003B512E0000F14F848804880EBE003EB
800048C7127FA2007E80A300FE158048141FB3A86C143FA2007E1500A3007F5CA26C6C13
FEEBF00790B5FC6C5C6C5C000314E0C66C90C7FC21357BB32C>I<007FB512C0B612F881
15FF6C15802603F00013C0153FED0FE0ED07F0A2150316F81501A6150316F01507A2ED0F
E0ED3FC015FF90B61280160015FC5D15C001F0C8FCB0387FFF80B57EA36C5B25337EB22C
>I<EB7FFF0003B512E0000F14F848804880EBF007EB800048C7127FA2007E80A300FE15
8048141FB3A7EB01F0EB03F800FE143F267E01FC1300A2EB00FE007F5C147FD83F8013FE
EBF03F90B5FC6C5C6C5C000314E0C67E90380007F0A26E7EA26E7EA26E7EA2157FA2153E
21407BB32C>I<387FFFFCB67E15E015F86C803907E007FE1401EC007F6F7E151FA26F7E
A64B5AA2153F4BC7FCEC01FE140790B55A5D15E081819038E007FCEC01FE1400157F81A8
160FEE1F80A5D87FFEEB1FBFB5ECFF00815E6C486D5AC8EA01F029347EB22C>I<90381F
F80790B5EA0F804814CF000714FF5A381FF01F383FC003497E48C7FC007E147F00FE143F
5A151FA46CEC0F00007E91C7FC127F7FEA3FE0EA1FFCEBFFC06C13FC0003EBFFC06C14F0
6C6C7F01077F9038007FFEEC07FF02001380153FED1FC0A2ED0FE0A20078140712FCA56C
EC0FC0A26CEC1F806D133F01E0EB7F009038FE01FF90B55A5D00F914F0D8F83F13C0D870
0790C7FC23357CB32C>I<007FB612FCB712FEA43AFC007E007EA70078153CC71400B3AF
90383FFFFCA2497F6D5BA227337EB22C>I<3B7FFF803FFFC0B56C4813E0A36C496C13C0
3B03F00001F800B3AF6D130300015DA26D130700005D6D130F017F495A6D6C485AECE0FF
6DB5C7FC6D5B010313F86D5B9038003F802B3480B22C>I<D87FFCEB7FFC486CEBFFFEA3
6C48EB7FFCD80FC0EB07E06D130F000715C0A36D131F00031580A36D133F00011500A36D
5B0000147EA4017E5BA46D485AA490381F83F0A4010F5B14C7A301075BA214EFA201035B
A214FFA26D90C7FCA46D5A27347EB22C>I<D87FF0EB07FF486C491380A36C486D130000
1FC8127CA46C6C5CA76C6C495AA4143E147FA33A03E0FF83E0A214F7A201E113C3A30001
01E35BA201F113C701F313E7A314C1A200005DA201F713F71480A301FF13FF017F91C7FC
4A7EA4013E133E29347FB22C>I<3A3FFF03FFE0484913F0148714076C6D13E03A01F800
FE007F0000495A13FE017E5BEB7F03013F5B1487011F5B14CF010F5B14FF6D5BA26D90C7
FCA26D5AA26D5AA2497EA2497EA2497F81EB0FCF81EB1FC7EC87F0EB3F83EC03F8EB7F01
017E7FEBFE00497F0001147E49137F000380491480151FD87FFEEBFFFC6D5AB514FE6C15
FC497E27337EB22C>I<D87FFCEB7FFC486CEBFFFEA36C48EB7FFCD807F0EB0FC0151F00
0315806D133F12016DEB7F0012006D137E017E13FE017F5BEB3F01EC81F8131FEC83F0EB
0FC314C7903807E7E0A201035B14EF6DB45AA292C7FC7F5C147EB0903807FFE0497FA36D
5B27337EB22C>I<003FB612C04815E0A4007EC7EA1FC0ED3F80A2ED7F00157E15FE4A5A
003C5CC712034A5AA24A5A4A5AA24A5A4AC7FCA214FE495AA2495A495AA2495A495AA249
5A49C8FCA213FE485AA24848EB03C049EB07E01207485A5B121F485AA248C7FCB7FCA46C
15C023337CB22C>I<387FFFFCB512FEA314FC00FCC7FCB3B3B3B512FC14FEA36C13FC17
416FB92C>I<127812F87EA27E127E127F7E7F121F7F120F7F1207A27F12037F12017F12
007F137E137F7F80131FA280130F801307801303801301801300A280147E147F8081141F
81140F811407811403A281140181140081157E157F811680151FA2150FED070021417BB9
2C>I<387FFFFCB512FEA37EC7127EB3B3B3387FFFFEB5FCA36C13FC17417DB92C>I<130E
EB3F80EBFFE0000313F8000F13FE487FD87FF113C0D8FFE013E0EB803F38FE000F007CEB
07C00030EB01801B0C78B22C>I<007FB6FCB71280A46C150021067B7D2C>I<137013F812
011203EA07F0EA0FE0EA1FC01380EA3F00123E127E127CA212FC5AA4EAFF8013C013E0A2
127FA2123FEA1FC0EA0F800D1B71B82C>I<3801FFF0000713FE001F6D7E15E048809038
C01FF81407EC01FC381F80000006C77EC8127EA3ECFFFE131F90B5FC1203120F48EB807E
383FF800EA7FC090C7FC12FE5AA47E007F14FEEB8003383FE01F6CB612FC6C15FE6C14BF
0001EBFE1F3A003FF007FC27247CA32C>I<EA7FF0487EA3127F1201AAEC1FE0ECFFF801
FB13FE90B6FC16809138F07FC09138801FE091380007F049EB03F85BED01FC491300A216
FE167EA816FE6D14FCA2ED01F86D13036DEB07F0150F9138801FE09138E07FC091B51280
160001FB5B01F813F83900F03FC027337FB22C>I<903803FFE0011F13F8017F13FE48B5
FC48804848C6FCEA0FF0485A49137E4848131890C9FC5A127EA25AA8127EA2127F6C140F
6DEB1F806C7E6D133F6C6CEB7F003907FE03FF6CB55A6C5C6C6C5B011F13E0010390C7FC
21247AA32C>I<EC0FFE4A7EA380EC003FAAEB07F8EB3FFE90B512BF4814FF5A3807FC0F
380FF00348487E497E48487F90C7FC007E80A212FE5AA87E007E5CA2007F5C6C7E5C6C6C
5A380FF0073807FC1F6CB612FC6CECBFFE6C143FEB3FFC90390FF01FFC27337DB22C>I<
EB03FE90381FFFC0017F13F048B57E48803907FE03FE390FF800FFD81FE0EB3F805B4848
EB1FC090C7120F5A007E15E015075AB7FCA416C000FCC9FC7E127EA2127F6CEC03C06DEB
07E06C7ED80FF0130F6C6CEB3FC001FF13FF000190B512806C1500013F13FC010F13F001
01138023247CA32C>I<EC0FF8EC3FFE91B5FC4914805B903807FC7F14F090390FE03F00
14C092C7FCA6007FB512FEB7FCA36C5C26000FC0C7FCB3A8003FB512F04880A36C5C2133
7DB22C>I<ED03F8903907F80FFC90391FFE3FFE017FB6FC48B7FC48ECFE7F9038FC0FF8
2607F003133E3A0FE001FC1CD9C0001300001F8049137EA66D13FE000F5CEBE0016C6C48
5A3903FC0FF048B5FC5D481480D99FFEC7FCEB87F80180C8FCA37F6C7E90B512F06C14FE
48ECFF804815E04815F03A3FC0001FF848C7EA03FC007E1400007C157C00FC157E48153E
A46C157E007E15FCD87F801303D83FE0EB0FF8D81FFCEB7FF06CB612E0000315806C1500
D8003F13F8010713C028387EA42C>I<EA7FF0487EA3127F1201AAEC1FE0EC7FFC9038F9
FFFE01FB7F90B6FC9138F03F80ECC01F02807FEC000F5B5BA25BB3267FFFE0B5FCB500F1
1480A36C01E0140029337FB22C>I<1307EB1FC0A2497EA36D5AA20107C7FC90C8FCA738
7FFFC080B5FC7EA2EA0007B3A8007FB512FCB612FEA36C14FC1F3479B32C>I<140EEC3F
80A2EC7FC0A3EC3F80A2EC0E0091C7FCA748B512804814C0A37EC7120FB3B3A2141F003C
1480007E133FB414005CEB01FEEBFFFC6C5B5C001F5B000790C7FC1A467CB32C>I<EA7F
E0487EA3127F1201AA91381FFFF04A13F8A36E13F0913800FE004A5A4A5A4A5A4A5A4A5A
4A5A4AC7FC14FEEBF1FC13F3EBF7FE90B5FCA2EC9F80EC0FC001FE7FEBFC07496C7E496C
7E811400157E811680151F3A7FFFC0FFFCB500E113FEA36C01C013FC27337EB22C>I<38
7FFFE0B57EA37EEA0003B3B3A5007FB61280B712C0A36C158022337BB22C>I<3A7F83F0
07E09039CFFC1FF83AFFDFFE3FFCD87FFF13FF91B57E3A07FE1FFC3E01FCEBF83F496C48
7E01F013E001E013C0A301C01380B33B7FFC3FF87FF0027F13FFD8FFFE6D13F8D87FFC49
13F0023F137F2D2481A32C>I<397FF01FE039FFF87FFC9038F9FFFE01FB7F6CB6FC0001
9038F03F80ECC01F02807FEC000F5B5BA25BB3267FFFE0B5FCB500F11480A36C01E01400
29247FA32C>I<EB07FCEB1FFF017F13C048B512F048803907FC07FC390FF001FE48486C
7E0180133F003F158090C7121F007EEC0FC0A348EC07E0A76C140F007E15C0A2007F141F
6C15806D133F6C6CEB7F006D5B6C6C485A3907FC07FC6CB55A6C5C6C6C13C0011F90C7FC
EB07FC23247CA32C>I<397FF01FE039FFF8FFF801FB13FE90B6FC6C158000019038F07F
C09138801FE091380007F049EB03F85BED01FC491300A216FE167EA816FE6D14FCA2ED01
F86D13036DEB07F0150F9138801FE09138E07FC091B51280160001FB5B01F813F8EC3FC0
91C8FCAD387FFFE0B57EA36C5B27367FA32C>I<903903FC078090391FFF0FC0017F13CF
48B512EF4814FF3807FE07380FF00148487E49137F4848133F90C7FC48141F127E150F5A
A87E007E141FA26C143F7F6C6C137F6D13FF380FF0033807FC0F6CB6FC6C14EF6C6C138F
6D130FEB07F890C7FCAD0203B5FC4A1480A36E140029367DA32C>I<D87FFEEB3FC0B538
01FFF0020713F8021F13FC6C5B39003F7FE1ECFF019138FC00F84A13704A13005CA25C5C
A391C8FCAF007FB512E0B67EA36C5C26247EA32C>I<90387FF8700003B512F8120F5A5A
387FC00F387E00034813015AA36CEB00F0007F140013F0383FFFC06C13FE6CEBFF800003
14E0C66C13F8010113FCEB0007EC00FE0078147F00FC143F151F7EA26C143F6D133E6D13
FE9038F007FC90B5FC15F815E000F8148039701FFC0020247AA32C>I<131E133FA9007F
B6FCB71280A36C1500D8003FC8FCB1ED03C0ED07E0A5EC800F011FEB1FC0ECE07F6DB512
80160001035B6D13F89038003FE0232E7EAD2C>I<3A7FF003FF80486C487FA3007F7F00
01EB000FB3A3151FA2153F6D137F3900FE03FF90B7FC6D15807F6D13CF902603FE071300
29247FA32C>I<3A7FFF01FFFCB514FE148314016C15FC3A03E0000F80A26D131F000115
00A26D5B0000143EA26D137E017C137CA2017E13FC013E5BA2EB3F01011F5BA21483010F
5BA214C701075BA214EF01035BA214FF6D90C7FCA26D5A147C27247EA32C>I<D87FFFEB
7FFF6EB5FCB515806C16004A7ED807C0EB01F0A66C6C495AA3143E147FA2D801F0495AEC
FF87A214F7A201F113C700005D9038F9E3CFA201FB13EFA3D97BC190C7FC017F13FFA214
80A2013F5B90381F007C29247FA32C>I<3A3FFF03FFF048018713F8A36C010313F03A00
FC007E005D90387E01F8013F5BEB1F83EC87E090380FCFC0903807EF80EB03FF6D90C7FC
5C6D5A147C14FE130180903803EF80903807CFC0EB0FC7EC83E090381F01F0013F7FEB7E
00017C137C49137E0001803A7FFF01FFFC1483B514FE6C15FC140127247EA32C>I<3A7F
FF01FFFCB5008113FE148314816C010113FC3A03E0000F806C7E151F6D140012005D6D13
3E137C017E137E013E137CA2013F13FC6D5BA2EB0F815DA2EB07C1ECC3E0A2EB03E3ECE7
C0130114F75DEB00FFA292C7FC80A2143EA2147E147CA214FC5CA2EA0C01003F5BEA7F83
EB87E0EA7E0F495A387FFF806C90C8FC6C5A6C5AEA07E027367EA32C>I<003FB612E048
15F0A4007EC7EA1FE0ED3FC0ED7F80EDFF004A5A003C495AC7485A4A5A4A5A4A5A4A5A4A
C7FCEB01FC495AEB0FF0495A495A495A49C8FC4848EB01E04848EB03F0485A485A485A48
5A485AB7FCA46C15E024247DA32C>I<15FF02071380141F147F91B512004913C04AC7FC
EB03F85CB31307EB1FE013FF007F5BB55A49C8FC6D7E6C7FC67F131FEB07F01303B380EB
01FEECFFC06D13FF6E1380141F14070200130021417BB92C>I<127812FCB3B3B3A91278
06416DB92C>I<EA7FC0EAFFF813FE6D7E6C7FC67F131FEB07F01303B380EB01FEECFFC0
6D13FF6E1380141F147F91B512004913C04AC7FCEB03F85CB31307EB1FE013FF007F5BB5
5A49C8FC13F8EA7FC021417BB92C>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Ff cmbx12 12 21
/Ff 21 90 df<B612F8A91D097F9A25>45 D<EC3FF849B5FC010F14E0013F14F890397F
F01FFC9039FFC007FE4890380001FF48486D1380000716C049147F000F16E049143F001F
16F0A2003F16F8A249141F007F16FCA600FF16FEB3A3007F16FCA56C6CEC3FF8A3001F16
F0A2000F16E06D147F000716C06D14FF6C6C4913806C6D4813006C6D485A90397FF01FFC
6DB55A010F14E0010314809026003FF8C7FC2F427CC038>48 D<EC03C01407141F147FEB
03FF133FB6FCA413C3EA0003B3B3ADB712FCA5264177C038>I<ECFFE0010F13FE013F6D
7E90B612E0000315F82607FC0313FE3A0FE0007FFFD81F806D138048C7000F13C0488001
C015E001F07F00FF6E13F07F17F881A46C5A6C5A6C5AC9FC17F05DA217E05D17C04B1380
4B1300A2ED1FFC4B5A5E4B5A4B5A4A90C7FC4A5A4A5AEC0FF04A5AEC3F804AC7127814FE
495A494814F8D907E014F0495A495A49C8FC017C140149140348B7FC4816E05A5A5A5A5A
B8FC17C0A42D417BC038>I<0007150301E0143F01FFEB07FF91B6FC5E5E5E5E5E16804B
C7FC5D15E092C8FC01C0C9FCAAEC3FF001C1B5FC01C714C001DF14F09039FFE03FFC9138
000FFE01FC6D7E01F06D13804915C0497F6C4815E0C8FC6F13F0A317F8A4EA0F80EA3FE0
487E12FF7FA317F05B5D6C4815E05B007EC74813C0123E003F4A1380D81FC0491300D80F
F0495AD807FEEBFFFC6CB612F0C65D013F1480010F01FCC7FC010113C02D427BC038>53
D<4AB47E021F13F0027F13FC49B6FC01079038807F8090390FFC001FD93FF014C0494813
7F4948EBFFE048495A5A1400485A120FA248486D13C0EE7F80EE1E00003F92C7FCA25B12
7FA2EC07FC91381FFF8000FF017F13E091B512F89039F9F01FFC9039FBC007FE9039FF80
03FF17804A6C13C05B6F13E0A24915F0A317F85BA4127FA5123FA217F07F121FA2000F4A
13E0A26C6C15C06D4913806C018014006C6D485A6C9038E01FFC6DB55A011F5C010714C0
010191C7FC9038003FF02D427BC038>I<EE1F80A24C7EA24C7EA34C7EA24B7FA34B7FA2
4B7FA34B7F169F031F80161F82033F80ED3E07037E80157C8203FC804B7E02018115F082
0203814B137F0207815D173F020F814B7F021F8292C77EA24A82023E80027E82027FB7FC
A291B87EA2498302F0C8FCA20103834A157F0107834A153FA249488284011F8491C97E49
84133E017E82B6020FB612F0A54C457CC455>65 D<B9FC18F018FE727E19E026003FFCC7
00077F05017F716C7E727E727EA2721380A37213C0A74E1380A24E1300A24E5A4E5A4E5A
4D5B05075B94B5128091B700FCC7FC18F018FF19E002FCC7000113F8716C7EF01FFE727E
7213801AC07213E0A27213F0A31AF8A71AF0A2601AE0604E13C0604E138095B512000507
5BBA12F86119C04EC7FC18E045447CC350>I<DCFFF01470031F01FF14F04AB6EAE00102
07EDF803023FEDFE0791B539E001FF0F4949C7EA3F9F010701F0EC0FFF4901C0804990C8
7E4948814948814948167F4849163F4849161F5A4A160F485B19074890CAFC19035A5BA2
007F1801A34994C7FC12FFAE127F7F1AF0A2123FA27F6C18011AE06C7F19036C6D17C06E
16077E6C6DEE0F806C6DEE1F006D6C5E6D6C167E6D6C6C5D6D6D4A5A6D01F0EC07F00101
01FEEC1FE06D903AFFF001FF80023F90B6C7FC020715FC020115F0DA001F1480030001F8
C8FC44467AC451>I<BA12F8A485D8001F90C71201EF003F180F180318011800A2197E19
3EA3191EA21778A285A405F890C7FCA316011603161F92B5FCA5ED001F160316011600A2
F101E01778A2F103C0A494C7FC1907A21A80A2190FA2191FA2193FF17F0061601807181F
4DB5FCBBFC61A443447DC34A>69 D<B712E0A5D8001F90C7FCB3B3B3A4B712E0A523447D
C32A>73 D<B712F0A526003FFECAFCB3B1F00780A4180F1900A460A360A2187EA218FE17
0117031707171F177FEE03FFB95AA539447CC343>76 D<B500FE067FB512806E95B6FCA2
6F5EA2D8003F50C7FC013D6DEE03DFA2013C6DEE079FA26E6CEE0F1FA26E6C161EA26E6C
163CA36E6C1678A26E6C16F0A26E6DEC01E0A26E6DEC03C0A36E6DEC0780A26F6CEC0F00
A26F6C141EA26F6C5CA36F6C5CA26F6C5CA26F6D485AA26F6D485AA26F6D485AA3706C48
C7FCA293383FF81EA2706C5AA2706C5AA3706C5AA2705BA2705BA2705BA2B6057FB61280
71C7FCA2173E171C61447CC36A>I<B64BB512FE8181A281D8003F6D91C7EA780081013D
7F81133C6E7E6E7F6E7F6E7F6E7F82806E7F6E7F6F7E6F7F83816F7F6F7F6F7F6F7F6F7F
8382707F707F707F707F8482707F707F717E7113807113C019E0837113F07113F87113FC
7113FE19FF847213F884848484A28484197F193F191FA2190F1907B61603190119001A78
A24F447CC358>I<923807FFC092B512FE0207ECFFC0021F15F091267FFE0013FC902601
FFF0EB1FFF01070180010313C04990C76C7FD91FFC6E6C7E49486F7E49486F7E01FF8348
496F7E48496F1380A248496F13C0A24890C96C13E0A24819F04982003F19F8A3007F19FC
49177FA400FF19FEAD007F19FC6D17FFA3003F19F8A26D5E6C19F0A26E5D6C19E0A26C6D
4B13C06C19806E5D6C6D4B13006C6D4B5A6D6C4B5A6D6C4B5A6D6C4A5B6D01C001075B6D
01F0011F5B010101FE90B5C7FC6D90B65A023F15F8020715C002004AC8FC030713C04746
7AC454>I<B9FC18F018FE727E19E0D8001F90C7000F7F05017F716C7E727E727E721380
A21AC084A21AE0A91AC0A24E1380A21A00604E5A4E5A4D485A050F5B92B712C096C7FC18
FC18C092CBFCB3A7B712E0A543447DC34D>I<B812F8EFFFC018F818FE727ED8001F90C7
003F13E005037F05007F727E727E727EA28684A286A762A24E90C7FCA24E5A61187F9438
01FFF005075B053F138092B7C8FC18F818E018F892C77FEF3FFF050F7F717F717FA2717F
A2717FA785A61B0F85A2187F73131F72141EB700E06DEB803E72EBE0FC72EBFFF8060114
F0726C13E0CC0007138050457DC354>82 D<DAFFE0131C010701FE133C013F9038FF807C
90B6EAE0FC4815F9489038801FFF3907FC00014848EB007F4848143F4848140F49140700
7F15035B1601160012FF177CA27FA26D153C7F7F6D92C7FC6C7EEBFFE014FE6CEBFFF015
FF6C15E016FC6C816C6F7E6C826C826C6C81011F810107811300020F80140003077FED00
7F82040F1380828212F082A282A27EA218007EA26C5D6C5E6D14036D5D6D140701F84A5A
01FFEC3FF002F8EBFFE0486CB65AD8FC1F92C7FCD8F80714FC48C614F048010713803146
7AC43E>I<003FBA12E0A59026FE000FEB8003D87FE09338003FF049171F90C71607A200
7E1803007C1801A300781800A400F819F8481978A5C81700B3B3A20107B8FCA545437CC2
4E>I<B76C010FB512F8A526003FFEC93803E000B3B3A9011F17076280190F6D606F151F
6D95C7FC6D6D5D197E6D6D5D6D6D1403DA7FFC4A5A6EB4EC3FF0020F9039F003FFE06E90
B61280020193C8FC6E6C14FC030F14E09226007FFEC9FC4D457CC356>I<B76C027FB5FC
A5D8003F0180C9EAFC006D6D4B5AA26D6D4B5A6D6D4B5A816D4D5A6D6D4B5A816D4DC7FC
6E6C157E826E5E6E6D495A826E4B5A6E6D495A6E7F4E5A6E6D495A6E7F4EC8FC6F6C137E
6F1380606FEBC1F86F13E1EFF3F06FEBF7E06F13FF606F5C8195C9FC705A163FB3A592B7
7EA550447EC355>89 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fg cmcsc10 10 34
/Fg 34 123 df<141FEC7FC0903801F0E0903803C0600107137090380F8030EC00384913
18A25BA2133EA2133F153815301570156015E04A5A90381F818014830287CAFC148E02DC
91387FFFE0EB0FF85C4A91380FFE000107ED03F06E5D6060496C92C7FCD91DFC5C013915
0ED970FE140C01E0151C2601C07F5CD803806D13300007013F1470D80F006D1360486D6C
13E048010F495A007E6E485AEC07F800FE010349C8FC913801FC0E6F5AEC00FFED7FB86C
DA3FF014C06F5A150F6C6C6D6CEB0180826C6CD91FFC1303001FDA3CFFEB07006C6C9039
F87F800E3C07F80FE01FE07E6CB5398007FFF8C69026FE00015BD91FF09038003FC03B3E
7BBB46>38 D<121C127FEAFF80A213C0A3127F121C1200A412011380A2120313005A1206
120E5A5A5A12600A1977881B>44 D<B512FCA516057E941F>I<EB03FE90381FFFC09038
3E03E09038F800F84848137C48487F48487F497F000F1580001F15C090C71207A24815E0
A3007EEC03F0A500FE15F8B2007E15F0A4007F14076C15E0A46C15C06D130F000F15806C
6CEB1F00A26C6C133E6C6C5B6C6C5B90383E03E06DB45AD903FEC7FC253A7CB72E>48
D<EB01C013031307131F13FFB5FCA2131F1200B3B3A8EB7FF0B612F8A31D3877B72E>I<
EB0FF8EB3FFF90B512C03903E01FF039078007FC390E0001FE486D7E5A0030EC7F800070
EC3FC0126012FCB4EC1FE07FA56CC7FC121CC8FCED3FC0A3ED7F8016005D5D4A5A4A5A4A
5A5D4A5A4A5A4AC7FC147E14F8495A495A495A495A91C71260131E13384914E04914C048
5A485A48C7120148B6FC5A5A481580B7FCA323387BB72E>I<EB07F890383FFF8090B512
E03903F00FF039078003FC48486C7E001E130081EA3FC06DEB7F80A56C5A6C5AC8EAFF00
A34A5A5D4A5A5D4A5A4A5A027FC7FCEB3FF814FF9038000FE06E7EEC03FC6E7E6E7E1680
157F16C0A2153F16E0A2121EEA7F80487EA4ED7FC05B007F1580007EC712FF007015006C
495A001E495A6C6C485A3907F00FF00001B512C06C6C90C7FCEB0FF8233A7BB72E>I<12
1C127FEAFF80A5EA7F00121CC7FCB2121C127FEAFF80A5EA7F00121C092477A31B>58
D<1407A24A7EA34A7EA3EC37E0A2EC77F01463A2ECC1F8A201017F1480A2903803007EA3
01067FA2010E80010C131FA2496D7EA2013FB57EA29038300007496D7EA3496D7EA20001
8149130012036D801207D81FE0903801FF80D8FFF8010F13F8A22D2C7DAB33>97
D<B612F015FE3A07F8003F806C48EB0FC0ED07E0ED03F016F8150116FCA516F8A2ED03F0
1507ED0FE0ED3F80913801FF0090B512F815FF9039F0001FC0ED07E0ED03F0ED01F816FC
150016FEA616FC1501A2ED03F8ED07F0ED0FE0486CEB3FC0B7120015F8272B7CAA30>I<
91383FC006903901FFF80E90390FE03E1E90381F0007017EEB03BE01F8EB01FE48481300
4848147E0007153E485A001F151E5B003F150E90C8FC5A1606A212FE1600AA007F1506A3
7E6D140E001F150C7F000F151C6C6C1418000315386C6C14706C6C14E0017EEB01C0011F
EB078090390FE03E00903801FFF89038003FC0272D7BAB31>I<B612F015FE3907F8007F
6C48EB0FC0ED03E06F7E6F7E167C167E82A2EE1F80A217C0160FA317E0AA17C0A3EE1F80
A217005E163E5E16FC4B5A4B5AED0FC0486CEB7F80B600FEC7FC15F02B2B7CAA34>I<B7
12E0A23907F8000F6C481303ED00F01670A21630A41618A215C01600A31401A2140790B5
FCA2EBF0071401A21400A21606A21500A2160CA4161CA2163C167C16F8486C1307B7FCA2
272B7CAA2E>I<B712C0A23907F8001F6C481303ED01E01500A21660A41630A215C01600
A31401A2140790B5FCA2EBF0071401A21400A492C7FCAB487EB512E0A2242B7CAA2C>I<
91383FE003903901FFF807903907E01E0F90391F00078F017EEB01DF496DB4FC48488048
4880484880485A001F815B003F8190C8FC5A82A212FE93C7FCA892383FFFF8A2007F0200
1380EE3F00A27E7F121F7F120F6C7E6C7E6C6C5C6C7E017E5C011FEB01CF903907E00F87
903901FFFE039026003FF0C7FC2D2D7BAB35>I<B539C07FFFE0A23B07F80003FC006C48
6D5AB190B6FCA29038F00001B2486C497EB539C07FFFE0A22B2B7CAA33>I<B512C0A238
07F8006C5AB3B3487EB512C0A2122B7CAA19>I<90B512C0A2903801FE006D5AB3AB1210
127C12FEA3495A12FC387003F06C485A381E0FC06CB4C7FCEA01FC1A2C7CAA23>I<B500
C0EBFFF8A2D807F8C7EA7FC06C481500167C167816E04B5A4B5A4BC7FC150E5D5D15F0EC
01C04A5A4AC8FC5C4A7E4A7E4A7EEBF1E79038F387F09038F703F89038FE01FC13FC496C
7E49137F6F7EA26F7E6F7E1507826F7E6F7EA26F7E82EE7F80486CECFFC0B5D8C00313FC
A22E2B7CAA35>I<B512E0A2D807F8C8FC6C5AB3A61660A416C0A31501A21503A21507ED
1F80486C13FFB7FCA2232B7CAA2B>I<D8FFF0ED3FFC6D157F0007178000031700017C15
DFA26DEC019FA36DEC031FA26D6C1306A36D6C130CA26D6C1318A26D6C1330A36D6C1360
A2027C13C0A391383E0180A291381F0300A3EC0F86A2EC07CCA3EC03F8A2486C6C5AA2D8
1FE0ED3F803CFFFC00E007FFFCA2362B7CAA3E>I<D8FFF0903807FFE07F000702001300
6C6C143C7F017F14187F806D7E130F806D7E6D7EA26D7E6D7E147E147FEC3F80141F15C0
EC0FE0EC07F0140315F8EC01FC140015FE157FED3F98151F16D8ED0FF81507A215031501
A2486C13001678D81FE01438EAFFFC16182B2B7CAA33>I<EC7FC0903803FFF890380FC0
7E90393F001F80017CEB07C04848EB03F048486D7E4913004848147C000F157E484880A2
48C8EA1F80A24816C0A2007E150FA200FE16E0AA007FED1FC0A36C16806D143F001F1600
A26C6C147E6C6C5CA26C6C495A6C6C495AD8007CEB07C0013FEB1F8090260FC07EC7FC90
3803FFF89038007FC02B2D7BAB35>I<B612E015FC3907F800FE6C48EB1F80ED0FC0ED07
E016F01503A216F8A516F0A2150716E0ED0FC0ED1F80EDFE0090B55A15E001F0C8FCB148
7EB512C0A2252B7CAA2E>I<EC7FC0903803FFF890380FC07E90393F001F80017CEB07C0
4848EB03F048486D7E4913004848147C000F157E484880A2003F168090C8121F4816C0A2
007E150FA200FE16E0AA007E16C0007F151FA26C1680A26C6CEC3F00141F3A0FC03FC07E
0007903870E07C9039E0E060FC3A03F0C071F8D801F8EB3BF0D8007CEB3FC090393FE01F
8090260FF07EC7FC902603FFFC13609038007FDEEC001E6F13E016011683EEFFC0A28117
806F13006F5AED00782B387BAB35>I<B67E15F03907F800FE6C48133FED0FC06F7EA26F
7E82A65E4B5AA24B5A033FC7FC15FE90B512F05D9038F001F8EC007E816F7EA26F7EA582
A4171816F015071738486C903803F830B5D8C00113709238007FE0C9EA1F802D2C7CAA32
>I<017F13603901FFE0E0380780F9380E001F48130748130312780070130100F01300A3
15607EA26C14007E127F13C0EA3FFEEBFFE06C13F8000713FE6C7FC61480010F13C01300
EC0FE01407EC03F01401A212C01400A37E15E06C1301A26CEB03C06CEB0780B4EB0F0038
F3E01E38E0FFF838C01FE01C2D7BAB26>I<007FB712C0A23A7E003FC00F007890381F80
03007015011600126000E016E0A2481660A5C71500B3A8EC7FE0011FB57EA22B2B7DAA31
>I<B539C007FFE0A2D807F8C713006C48143CA21618B3A916386C6C1430A2000015706D
5C017C5C6D13016D495A90260F800FC7FC903803E03C903800FFF8EC3FC02B2C7CAA33>
I<B56CEB3FFEA2D80FFCC7EA0FF06C48EC07E00003ED03C01780000116006D5C00001506
A2017E5CA2017F141C6D141880011F5CA26D6C5BA28001075CA26D6C485AA2ECF8030101
91C7FCA2903800FC06A2ECFE0EEC7E0C147F6E5AA2EC1FB0A215F06E5AA26E5AA36E5AA2
2F2C7EAA33>I<B5903B7FFF800FFF80A2D80FF8903B07FC0003FC006C486D486D5A725A
000302015DA26C6C8061A26C6C496C495A167EA2017ED9077F49C7FCED063FA26D010EEB
8006ED0C1FA26D6C486C6C5AA36D6C486C6C5AA36D6C486C6C5AA21870903B03F0C001F8
60A202F815E0903B01F98000FCC0A202FD14FD6DB4C7EA7F80A3027E6EC8FCA3023C141E
A30218140C412C7EAA45>I<3B7FFF800FFFC0A2000790390003FE006C48EB01F800015D
000015C0017F13036D5C6E48C7FC90381FC0066D6C5A151C6D6C5A903803F83001015BEC
FCE06D6C5AEC7F80A2143F6E7E140F4A7E4A7E1433EC63F8ECE1FCECC0FE903801807E01
03137F49486C7E0106131F4980011C6D7E496D7E0130130301708001F06D7E0001810007
81D81FF8491380B46C4913F8A22D2B7DAA33>I<B56CEB1FFEA2D80FFCC7EA0FF00003ED
07C01780000116006C6C1406017F140E160C6D6C5B6D6C133816306D6C5B6D6C13E05E6D
6C485A903801FC0393C7FC903800FE06EC7F0E150CEC3F9CEC1FF85D140F6E5AAF4A7E49
B57EA22F2B7EAA33>I<003FB6FCA29038E0007F90C712FE003E495A123C0038495A4849
5AA24A5A00605C141F4A5AA2C748C7FC14FEA2495A495AA2495A5C130F495AA2495A49C8
FCED018013FE485AA2485A4913031207485AED0700485A48485B5D48C75A00FE49B4FCB7
FCA2212B7BAA2A>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fh cmbx10 10 51
/Fh 51 123 df<B61280A819087F9620>45 D<EA0F80EA3FE0EA7FF0A2EAFFF8A5EA7FF0
A2EA3FE0EA0F800D0D798C1B>I<49B4FC010F13E0017F13FC9038FF83FE4848C67E4848
EB7F804848EB3FC04848EB1FE0A2001F15F0A24848EB0FF8A3007F15FCA500FF15FEB300
7F15FCA4003F15F8A26D131F001F15F0A2000F15E06D133F000715C06C6CEB7F806C6CEB
FF003900FF83FE6DB45A011F13F0010190C7FC27387CB630>48 D<141E143E14FE130713
3FB5FCA313CFEA000FB3B3A6007FB61280A4213779B630>I<EB0FFC90387FFFC048B512
F0000714FC390FF03FFF261F800F1380263F000313C05AD9C00113E0486C6C13F07FA2ED
7FF8A46C5A6C5A000FC7FCC8FCEDFFF0A216E05C16C04A138016004A5A5D4A5A4A5A4A5A
EC7F8092C7FC14FEEB01F849481378495A495A495A013EC712F84914F05B4848130148B6
FCA25A5A5A5A4815E0B7FCA425377BB630>I<EB03FF011F13F0017F13FC3901FC07FF26
03F003138048486C13C0496C13E0EA0FF001FC14F0121F7FA56C4814E0A23803F001C714
C04A138016004A5A4A5AEC3FF090380FFFC092C7FC15F090380007FE913801FF806E13C0
16E0ED7FF016F816FC153FA216FEEA1FC0487E487E487EA416FCA249EB7FF8127F01C0EB
FFF06C4814E06C6C4813C0260FFC0713806CB61200000114FC6C6C13F0010790C7FC2738
7CB630>I<EA0F80EA3FE0EA7FF0A2EAFFF8A5EA7FF0A2EA3FE0EA0F80C7FCABEA0F80EA
3FE0EA7FF0A2EAFFF8A5EA7FF0A2EA3FE0EA0F800D2579A41B>58
D<EB1FFE48B512E0000714F8390FE00FFE393F0003FF4815806D7ED8FFC014C013E0A5EA
7FC06C48481380EA1F00C7481300EC0FFC4A5AEC3FE04A5A92C7FC14FE5C495AA25C495A
A25CA990C9FCA7EB07C0EB1FF0497EA2497EA56D5AA26D5AEB07C0223A7BB92D>63
D<ED03E04B7EA24B7EA34B7EA24B7EA34B7EA292B57EA34A8015F302038015E1A2020780
15C0020F80ED807FA2021F80ED003F4A80023E131FA2027E80027C7F02FC814A7FA20101
824A7F49B77EA3498202C0C7FC010F824A147FA2011F8291C8123F4982013E151FA2017E
82017C8101FE83B500F80107B61280A4413A7DB948>65 D<B812C017FC17FF18C028007F
F000037F04007F717E717E171F84A2717EA74D5AA260173F4D5A4D5A4C13C0040F5B91B6
00FCC7FCA2EFFF8002F0C713F0EF3FF8717E717E717E19807113C0A319E0A719C0A25F4D
138019005FEF7FFE4C485AB912F018C095C7FC17F03B397DB844>I<DB3FFCEB01C00203
B5EAC003021FECF00791B6EAFC0F01039039FC00FF3F4901C0EB1FFFD91FFEC77E494814
03D97FF080494880485B48177F4849153F4890C9FC181F485A180F123F5B1807127FA249
93C7FC12FFAD127F7FF003C0123FA27F001F1707A26C6C1780180F6C6D16006C6D5D6C17
3E6C6D157ED97FF85D6D6C4A5A6DB44A5A010701C0EB0FE06D01FCEBFF80010090B548C7
FC021F14F8020314E09126003FFEC8FC3A3B7BB945>I<B87E17F817FF18C028007FF800
0713F09338007FF8EF1FFE717E050313807113C0A27113E0F07FF0A2F03FF8A219FC181F
A219FEA419FFAC19FEA419FC183FA219F8187F19F0F0FFE0A24D13C04D13804D1300EF1F
FEEF7FFC933807FFF0B912C095C7FC17FC178040397DB849>I<B912F0A426007FF8C7FC
EF1FF8170717031701A21700A21878A3043C137C183CA41800167CA216FC150391B5FCA4
ECF8031500167CA2163C180FA3181EA293C7FCA2183EA2183C187CA218FCA2EF01F81703
170F173FEE01FFB9FC18F0A338397DB83F>I<B912C0A43A007FF800039338007FE0171F
170F1707A21703A21701A318F0EE7800A41800A216F8A21501150791B5FCA4ECF8071501
1500A21678A693C8FCADB7FCA434397DB83C>I<DB3FFCEB01C00203B5EAC003021FECF0
0791B6EAFC0F01039039FC00FF3F4901C0EB1FFFD91FFEC77E49481403D97FF080494880
485B48177F4849153F4890C9FC181F485A180F123F5B1807127FA24993C8FC12FFAB043F
B61280A2127F7FDC0003EBC000123FA27F121FA26C7EA26C7F6C7F6C7F7ED97FF85C6D7E
6DB45C010701C05B6D01FCEBFF3F010090B5EAFE0F021FECF8030203ECE0009126003FFE
C9FC413B7BB94B>I<B6D8FC03B612F0A426007FF8C70001EBE000B3A391B8FCA402F8C7
1201B3A6B6D8FC03B612F0A444397DB84B>I<B612FCA439007FF800B3B3ADB612FCA41E
397DB824>I<B600FC0103B512C0A426007FF8C8381FE00019804EC7FC18FEEF01F84D5A
4D5A4D5AEF3F80057EC8FC5F4C5A4C5AEE0FE0EE1F804CC9FC167E5EED03F84B7E4B7E4B
7E4B7F5D02F9B57EDAFBF77FDAFFE37F15C103807F4A487F4A6D7E4A133F707E707F8482
707F707F8482717E717E8483717F717F858385B600FC017FEBFFE0A443397DB84B>75
D<B7FCA426007FF8C9FCB3ACEF0780A5170F1800A35FA25FA25F5F5E5EEE0FFE167FB8FC
A431397DB839>I<B500F80403B512F06E5EA26E5ED8007FF1E000A2D97BFF161EA20179
6D5DA201786D5DA26E6C5DA36E6C4A5AA26E6C4A5AA26E6C4A5AA26E6C4A5AA26E6C141E
A36E6D5BA26E6D5BA26F6C5BA26F6C485AA36F6C485AA26F6C485AA26F6C48C7FCA29238
03FF1EA36F13BCA26F13F8A2705AA2705AA213FCB500FC6D4848B612F0A2EE0F80EE0700
54397DB85B>I<B500FC0203B512F0A28080C66C6D90390003F0006F6E5A81017B7F1379
8101787F6E7E6E7E6E7F6E7FA26E7F6E7F6E7F6E7F6F7E153F826F13806F13C06F13E06F
13F06F13F88117FCEE7FFEEE3FFF7013817013C17013E18218F17013F97013FDEF7FFF83
83A28383838383187FA2183F181F01FC160FB500FC150718031801A244397DB84B>I<ED
FFF8020FEBFF80027F14F0903A01FFC01FFC010790380007FFD91FFC010113C0D93FF06D
6C7E49486E7E49486E7E48496E7E48834890C86C7EA248486F1380A248486F13C0A2003F
18E0A348486F13F0A400FF18F8AC007F18F06D5DA3003F18E0A26D5D001F18C0A26C6C4B
13806C18006E5C6C6D4A5A6C5F6C6D4A5A6D6C4A5AD93FFC49485A6DB401075B0107D9C0
1F90C7FC010190B512FC6D6C14F0020F1480020001F8C8FC3D3B7BB948>I<B8FC17F017
FEEFFF8028007FF8000F13C0040113E07013F0EF7FF8EF3FFCA2EF1FFEA218FFA818FEA2
EF3FFCA2EF7FF8EFFFF04C13E0040F13C091B7120017FC17E002F8C9FCB3A4B612FCA438
397DB841>I<B712FCEEFFE017FC17FF28007FF8000F13C004017F707F717E717EA2717E
A284A760A24D5A604D5A4D5A04035B041F90C8FC91B612FC17E0839139F8003FFCEE0FFF
707F707F8284A2707FA584A51A601AF084177F1901DD3FFE13E0B600FC011F130394390F
FF87C071EBFF8005011400CBEA1FFC443A7DB848>82 D<D907FF130E013FEBE01E90B5EA
F83E0003ECFE7E3A07FC01FFFE390FF0001F4848130F48481303491301007F140090C8FC
167E5A163EA27F161E7F7F6D91C7FC13FC387FFFE014FEECFFF06C14FE6F7E6C816C15F0
6C816C81C681133F010F801301D9000F1480EC007F030F13C01503818100F0157FA3163F
A27E17807E167F6C16007E6D14FE01E0495A01F813039039FF801FF800FC90B512E0D8F8
3F5CD8F00749C7FC39E0007FF02A3B7BB935>I<003FB91280A4D9F800EBF003D87FC092
38007FC049161F007EC7150FA2007C1707A200781703A400F818E0481701A4C892C7FCB3
AE010FB7FCA43B387DB742>I<B600FC011FB512C0A426007FF8C8381FC000725AB3B318
1F013F94C7FC8060011F163E6D6C157E187C6D6C15FC6D6D495A6D6DEB07F06D01F0EB1F
E0DA7FFEEBFFC0021FB6C8FC02075C020014F0030F1380423A7DB849>I<007FB5D8F803
B512F8A4C66C48C7D80FF0C7FC6D6C5D6D5E6F495A6D6D49C8FC7F6D6D137E6F5B6DEBF8
016D5D6F485A6E6C485A023F130FDA1FFF5BEE9F806E01FFC9FC805E6E5B6E5B80826F7E
153F826F7F5D4B7F92B57EA2DA01F97FDA03F17F03F07F913807E07FDA0FC07F021F6D7E
4B7E4A486C7F027E8102FE6D7F4A7F49488149486D7F0107804A6E7E49488149486E7E01
3F81017F83B60107B61280A441397DB848>88 D<B600F049B512E0A4C601FCC8380FF000
017F705A6E4B5A6D6C4B5A6D7F4EC7FC6D6D147E6D7F606D6D495A6D7F4D5A6D6D495A6E
7E4D5A6E6C495A6E13804DC8FC6EEBC07E6E13E05F6EEBF1F86E13F9EEFBF06EEBFFE081
5F6F5B816F90C9FCB3A2021FB6FCA443397EB848>I<003FB712FEA4913980007FFC01FC
C7EAFFF801F05B01C015F0494913E090C75A4816C0007E4A13805D007C16004B5A157F00
785D4B5A5C5EC7485B5C5E5C4A5B93C7FC5C4A5A5D14FF495B5D5B495B4B131E5B5D4990
C7FC5B5C4948143E13FF5C485B48167E4A147C484914FC5A4A13014890C7120348150F49
143F4848EB01FFB8FCA42F397BB83A>I<EB3FFE0003B512E0000F14F8391FF00FFE003F
EB03FF6D6C7F6E7FA26F7EA26C5A6C5AEA0380C8FCA2EC3FFF010FB5FC137F3901FFF87F
00071380380FFE00EA3FF85B485A12FF5BA415FF6D5A127F263FF00713F83B1FFC1FBFFF
C0390FFFFE1F0003EBF80F39003FE0032A257DA42E>97 D<13FFB5FCA412077EAF4AB47E
020F13F0023F13FC9138FE03FFDAF00013804AEB7FC00280EB3FE091C713F0EE1FF8A217
FC160FA217FEAA17FCA3EE1FF8A217F06E133F6EEB7FE06E14C0903AFDF001FF80903AF8
FC07FE009039F03FFFF8D9E00F13E0D9C00390C7FC2F3A7EB935>I<903801FFC0010F13
FC017F13FFD9FF8013802603FE0013C048485AEA0FF8121F13F0123F6E13804848EB7F00
151C92C7FC12FFA9127FA27F123FED01E06C7E15036C6CEB07C06C6C14806C6C131FC690
38C07E006DB45A010F13F00101138023257DA42A>I<EE7F80ED7FFFA4150381AF903801
FF81010F13F1013F13FD9038FFC07F0003EB001FD807FC1307000F8048487F5B123FA248
5AA312FFAA127FA27F123FA26C6C5B000F5C6C6C5B6C6C4913C02701FF80FD13FE39007F
FFF9011F13E1010313012F3A7DB935>I<903803FF80011F13F0017F13FC3901FF83FE3A
03FE007F804848133F484814C0001FEC1FE05B003FEC0FF0A2485A16F8150712FFA290B6
FCA301E0C8FCA4127FA36C7E1678121F6C6C14F86D14F000071403D801FFEB0FE06C9038
C07FC06DB51200010F13FC010113E025257DA42C>I<161FD907FEEBFFC090387FFFE348
B6EAEFE02607FE07138F260FF801131F48486C138F003F15CF4990387FC7C0EEC000007F
81A6003F5DA26D13FF001F5D6C6C4890C7FC3907FE07FE48B512F86D13E0261E07FEC8FC
90CAFCA2123E123F7F6C7E90B512F8EDFF8016E06C15F86C816C815A001F81393FC0000F
48C8138048157F5A163FA36C157F6C16006D5C6C6C495AD81FF0EB07FCD807FEEB3FF000
01B612C06C6C91C7FC010713F02B377DA530>103 D<13FFB5FCA412077EAFED7FC09138
03FFF8020F13FE91381F03FFDA3C01138014784A7E4A14C05CA25CA291C7FCB3A3B5D8FC
3F13FFA4303A7DB935>I<EA01F0EA07FC487EA2487EA56C5AA26C5AEA01F0C8FCA913FF
127FA412077EB3A9B512F8A4153B7DBA1B>I<13FFB5FCA412077EB3B3ACB512FCA4163A
7DB91B>108 D<01FED97FE0EB0FFC00FF902601FFFC90383FFF80020701FF90B512E0DA
1F81903983F03FF0DA3C00903887801F000749DACF007F00034914DE6D48D97FFC6D7E4A
5CA24A5CA291C75BB3A3B5D8FC1FB50083B512F0A44C257DA451>I<01FEEB7FC000FF90
3803FFF8020F13FE91381F03FFDA3C011380000713780003497E6D4814C05CA25CA291C7
FCB3A3B5D8FC3F13FFA430257DA435>I<903801FFC0010F13F8017F13FFD9FF807F3A03
FE003FE048486D7E48486D7E48486D7EA2003F81491303007F81A300FF1680A9007F1600
A3003F5D6D1307001F5DA26C6C495A6C6C495A6C6C495A6C6C6CB45A6C6CB5C7FC011F13
FC010113C029257DA430>I<9039FF01FF80B5000F13F0023F13FC9138FE07FFDAF00113
800007496C13C06C0180EB7FE091C713F0EE3FF8A2EE1FFCA3EE0FFEAA17FC161FA217F8
163F17F06E137F6E14E06EEBFFC0DAF00313809139FC07FE0091383FFFF8020F13E00203
90C7FC91C9FCACB512FCA42F357EA435>I<9038FE03F000FFEB0FFEEC3FFF91387C7F80
9138F8FFC000075B6C6C5A5CA29138807F80ED3F00150C92C7FC91C8FCB3A2B512FEA422
257EA427>114 D<90383FF0383903FFFEF8000F13FF381FC00F383F0003007E1301007C
130012FC15787E7E6D130013FCEBFFE06C13FCECFF806C14C06C14F06C14F81203C614FC
131F9038007FFE140700F0130114007E157E7E157C6C14FC6C14F8EB80019038F007F090
B512C000F8140038E01FF81F257DA426>I<130FA55BA45BA25B5BA25A1207001FEBFFE0
B6FCA3000390C7FCB21578A815F86CEB80F014816CEBC3E090383FFFC06D1380903803FE
001D357EB425>I<01FFEC3FC0B5EB3FFFA4000714016C80B3A35DA25DA26C5C6E4813E0
6CD9C03E13FF90387FFFFC011F13F00103138030257DA435>I<B539F001FFF8A4000390
C7EA3F00161E6E133E6C153C6E137C6C15786E13F8017F5CECF001013F5C14F8011F495A
A2ECFC07010F5CECFE0F010791C7FC6E5A6D131E15BE6D13BC15FC6D5BA36E5AA26E5AA2
6E5AA26E5AA22D257EA432>I<B539F01FFFF0A4000390398003F8006C01C013E06C1407
D97FE05B6D6C485A6E48C7FC90381FFC3E010F5B903807FEFC6D6C5A5D6D5B6D5B6E7E6E
7E814A7EA24A7E903801F3FFD903E37FD907C17FEB0FC049486C7E4A6C7E013E80496D7E
49130F00016E7EB590383FFFF8A42D257EA432>120 D<B539F001FFF8A4000390C7EA3F
00161E6E133E6C153C6E137C6C15786E13F8017F5CECF001013F5C14F8011F495AA2ECFC
07010F5CECFE0F010791C7FC6E5A6D131E15BE6D13BC15FC6D5BA36E5AA26E5AA26E5AA2
6E5AA292C8FCA25C141E003F133E387F803C38FFC07C147814F8EBC1F0EBC3E06C485A38
7D1F80D83FFFC9FCEA1FFCEA07F02D357EA432>I<003FB612C0A3D9F0031380EB800749
481300003E5C003C495A007C133F5D0078495A14FF5D495B5BC6485B92C7FC495A131F5C
495A017FEB03C0EBFFF014E04813C05AEC80074813005A49EB0F80485A003F141F484813
3F9038F001FFB7FCA322257DA42A>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fi cmr12 14.4 9
/Fi 9 116 df<BB1280A426007FFCC8123F6D48030313C0011F1600193F191F190F1907
A21903A2F101E0A31900A6050E1470A41A00A3171EA3173E177E17FE160791B6FCA49138
F800071600177E173E171EA3170EA31A0EA31A1C94C8FCA41A3C1A38A31A78A31AF0A219
01A21903A21907F10FE0193F19FF013F1603496C153FBBFC1AC0A347527BD150>69
D<B600FC030FB512E0A4C691CAEBFC00D97FFCEF3FF06D48EF1FC0011F616E71C7FC130F
1A0E6E171E0107181CA26E173C6D1838816D60A26F16F06D6081027F4C5AA281023F4C5A
A26F1507021F94C8FC81020F160EA26F151E0207161CA26F153C6E1638826E5EA27014F0
6E5E821801037F5D82033F4A5AA2701307031F92C9FC82030F140EA270131E0307141CA2
70133C6F143817806F5CA2EFC0F06F5C17E017E1047F5B17F193383FF380A217FF7090CA
FCA2705AA3705AA3705AA2705AA3705A53547ED158>86 D<EC0FFE91387FFFE049B512F8
903907F801FE90391FE0001FD93F80EB078049C7EA0FC001FE143F484815E00003157F48
5A485AA2485AEE3FC0003FED0F004991C7FCA2127FA35B12FFAB127F7FA3123F6D157012
1F6D15F0000F16E06D140112076C6CEC03C06D15806C6C14076C6DEB0F00D93FC0131E6D
6C137C903907FC03F06DB55AD9007F1380DA0FF8C7FC2C367CB434>99
D<EC0FF891B5FC010314C090390FF80FF090391FC003FC90397F8001FE49C77E4848EC7F
804848143F49EC1FC0485A000FED0FE05B001F16F01607485AA2007F16F8A25B160312FF
90B7FCA30180C9FCA8127F7FA2123FA26D1538121F17786C6C1570000716F06D15E06C6C
14016C6CEC03C06C6C15806D6C130F6D6CEB1F00D90FF0133C903907FE01F80101B512E0
6D6C1380DA07FCC7FC2D367DB434>101 D<1378EA01FE487E487FA66C90C7FC6C5AEA00
7890C8FCB0EB7F80B5FCA41203C6FC137FB3B3A43801FFE0B61280A419507CCF21>105
D<EB7F80B5FCA41203C6FC137FB3B3B3B13801FFE0B612C0A41A537CD221>108
D<EC0FFC91387FFF8049B512E0903907F807F890391FE001FE90393F80007F017EC7EA1F
80496E7E48486E7E00038248486E7EA248486E7EA248486E7EA2003F82A24848ED7F80A4
00FF17C0AB007F1780A26D15FFA2003F1700A2001F5E6D1401000F5E6D140300075E6C6C
4A5A6C6C4A5AA2D8007FEC3F806D6C49C7FC90391FE001FE903907F807F86DB55AD9007F
1380DA0FFCC8FC32367CB43B>111 D<01FFEB1F80B5EB7FF0913801FFF8913803E1FC91
380783FE0003EB0F07C6131EEB7F1C1438143091387003FC91386000F0160014E05CA45C
B3AA8048487EB612F0A427347DB32E>114 D<D907FE13C090387FFF8148B512E33907F8
03FF390FC0007F4848133F48C7121F003E140F007E1407127C00FC1403A315017EA27E7F
6C6C90C7FC13F013FF6C13F86CEBFF806C14E06C14F86C14FEC680013F1480010714C0D9
003F13E014039138007FF0151F00E0140FED07F8A26C1403A215017EA36C15F0A26C1403
6C15E015076DEB0FC06DEB1F80D8FDF0EB3F0039F8FC01FE39F07FFFF8D8E01F13E0D8C0
0390C7FC25367CB42E>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fj cmsy10 10 3
/Fj 3 25 df<923803FFC0033F13FC4AB67E020715E0913A1FFE007FF8DA7FE0EB07FE4A
C87ED903FCED3FC0D907F0ED0FE0D90FC0ED03F049486F7E49CA7E017E177E4983498348
48EF0F80000319C04917074848EF03E0000F19F049170148CC12F8A2001E1978003E197C
A2003C193C007C193EA20078191EA300F8191FA248190FAA6C191FA20078191EA3007C19
3EA2003C193C003E197CA2001E1978001F19F8A26C6CEF01F06D1703000719E06C6CEF07
C06D170F000119806C6CEF1F006D5F017E177E6D5F6D6C4B5A6D6C4B5AD907F0ED0FE0D9
03FCED3FC0D900FF03FFC7FCDA7FE0EB07FEDA1FFEEB7FF80207B612E002011580DA003F
01FCC8FC030313C0484E7BBB53>13 D<EB1FF0EBFFFE487F000714C04814E04814F04814
F8A24814FCA3B612FEA96C14FCA36C14F8A26C14F06C14E06C14C0000114006C5BEB1FF0
1F1F7BA42A>15 D<D93F801508D9FFF0151C00037F4813FE487F4814C09026C07FE0143C
273F000FF01438003CD907FC147848EB01FE6E6C6C13F0007091383FC00300F091391FF8
0FE0486EB5FC030314C06F14806F6C1300EE3FFC0040ED07F036137B9D41>24
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fk cmr12 12 31
/Fk 31 120 df<121EEA7F8012FF13C0A213E0A3127FEA1E601200A413E013C0A3120113
80120313005A1206120E5A5A5A12600B1D78891B>44 D<B612C0A61A067F9721>I<121E
EA7F80A2EAFFC0A4EA7F80A2EA1E000A0A78891B>I<14FF010713E090381F81F890383E
007C01FC133F4848EB1F8049130F4848EB07C04848EB03E0A2000F15F0491301001F15F8
A2003F15FCA390C8FC4815FEA54815FFB3A46C15FEA56D1301003F15FCA3001F15F8A26C
6CEB03F0A36C6CEB07E0000315C06D130F6C6CEB1F806C6CEB3F00013E137C90381F81F8
903807FFE0010090C7FC28447CC131>48 D<EB03FE90381FFFC0017F13F03901F80FFC39
03C001FE48486C7E000EC7EA7F8048EC3FC0ED1FE04815F00030140F007015F800601407
126CB415FC7F7F1503A46C4813076CC7FCC8FC16F8A2150F16F0151F16E0A2ED3FC0ED7F
8016005D5D4A5A4A5A4A5A5D4A5A4A5A4AC7FC147C5C5C495A495A495A49C7120C131E5B
013814185B5B485A4848143848C81230000E1570001FB612F0A25A5AB712E0A326427BC1
31>50 D<000615C0D807C0130701FCEB7F8090B612005D5D5D15E0158026063FFCC7FC90
C9FCAE14FF010713C090381F01F090383800FC01F0137ED807C07F49EB1F8016C090C712
0F000615E0C8EA07F0A316F81503A216FCA5123E127F487EA416F890C712075A006015F0
A20070140F003015E00038EC1FC07E001EEC3F806CEC7F006C6C13FE6C6C485A3901F807
F039007FFFE0011F90C7FCEB07F826447BC131>53 D<DB0FFE146092B500C013E0020314
F0913A0FFC01FC0191393FC0003E02FFC7EA0F83D903FCEC03C74948EC01E74948EC00FF
4948157F4948153F4948151F49C9120F485A491607120348481603A248481601A2484816
00A2123FA2491760127FA31900485AAE6C7EA21960A2123F7FA2001F18E07F000F18C0A2
6C6C160119806C6C160312016DEE07006C6C16066D6C150E6D6C5D6D6C5D6D6C15786D6C
5D6D6C4A5AD900FFEC0780DA3FC0011FC7FCDA0FFC13FC0203B512F0020014C0DB0FFEC8
FC3B487BC546>67 D<B8FC17F017FC00019039C00007FF6C499038007FC0017FED1FE0EF
07F0EF03FC717E717E84727E727E727EA2727E85180385A2180185A38584A31A80AD1A00
A36061A361180361180761180F614E5A183F614EC7FC18FEEF03FC4D5AEF1FE001FFED7F
C0486DD907FFC8FCB812FC17F094C9FC41447CC34B>I<B612F0A3C6EBF0006D5A6D5AB3
B3B3A4497E497EB612F0A31C447DC323>73 D<010FB512FEA3D9000313806E130080B3B3
AB123F487E487EA44A5A13801300006C495A00705C6C13076C5C6C495A6CEB1F802603E0
7FC7FC3800FFFCEB1FE027467BC332>I<49B41303010FEBE007013F13F89039FE00FE0F
D801F8131FD807E0EB079F49EB03DF48486DB4FC48C8FC4881003E81127E82127C00FC81
A282A37E82A27EA26C6C91C7FC7F7FEA3FF813FE381FFFE06C13FE6CEBFFE06C14FC6C14
FF6C15C0013F14F0010F80010180D9001F7F14019138001FFF03031380816F13C0167F16
3F161F17E000C0150FA31607A37EA36C16C0160F7E17806C151F6C16006C5D6D147ED8FB
C05CD8F9F0495AD8F07C495A90393FC00FE0D8E00FB51280010149C7FC39C0003FF02B48
7BC536>83 D<B600C0010FB5FCA3000101E0C813F026007F80ED1F80F00F00A21806B3B3
A7180E6D6C150CA2181C131F6E1518010F163818306D6C1570606D6C14016D6C5D6D6CEC
0780027F4AC7FC6E6C131EDA1FE0137C913907FC03F00201B55A6E6C1380DB07FCC8FC40
467CC349>85 D<EB07FC90383FFF809038F80FE03903C003F048C66C7E000E6D7ED80FC0
137E486C137F6D6D7EA36F7EA26C5AEA0380C8FCA4EC0FFF49B5FC90380FFE1FEB3FC0EB
FF00EA03FC485A485A485A485A127F5B176048C7FCA3153FA36D137F007F14EF6D9038C7
E0C0003F13013A1FE00783F13B07F81E03FF802701FFFC0113003A001FE0007C2B2E7CAC
31>97 D<EC7F80903803FFF090380FC07C90383F000F01FCEB03804848EB01C00003140F
4848EB1FE049133F120F485AA2485AED1FC0007FEC070092C7FCA290C9FC5AAB7E7FA212
3F16307F001F15706C6C146016E06C6C14C06C6C13010001EC03806C6CEB0700013F131E
90381FC078903807FFF001001380242E7DAC2B>99 D<167FED3FFFA315018182B3EC7F80
903803FFF090380FC07C90383F000E017E1307496D5AD803F87F48487F5B000F81485AA2
485AA2127FA290C8FC5AAB7E7FA2123FA26C7EA2000F5D7F6C6C5B00035C6C6C9038077F
806C6C010E13C0013F011C13FE90380FC0F8903803FFE09026007F0013002F467DC436>
I<EB01FE903807FFC090381F03F090387E00FC49137E48487F485A4848EB1F80000F15C0
49130F121F484814E01507A2007F15F090C7FCA25AA390B6FCA290C9FCA67EA27FA2123F
16306C7E1670000F15606D14E06C6C14C0000314016C6CEB03806C6CEB0700013E131E90
381F80F8903803FFE0010090C7FC242E7DAC2B>I<EC0FE0EC7FF8903801F81E903803F0
3F90390FE07F8090381FC0FF5C133F495AA2ED7F0001FE131C92C7FCAFB67EA3C648C8FC
B3B2486C7E007F13FFA321467EC51E>I<EE0F80D901FCEB7FE0903A0FFF81F0F090393F
07E3819039FC01FF033A01F800FE014848017E13E00007027FC7FC497F000F8149131F00
1F81A9000F5D6D133F000792C7FC6D5B0003147E6C6C5B6D485A3903BF07E090380FFF80
260701FCC8FC90CAFCA25AA37F6C7E7F90B512F86C14FF16E06C15F86C6C8048B67E3A07
C0000FFF48481300003FC8EA3F80003E151F48ED0FC0A2481507A56C150F007C1680007E
151F003E16006C153E6C6C5CD807E0495AD801F8EB07E0D8007FEB3F8090261FFFFEC7FC
010113E02C427DAC31>I<EA01FC12FFA3120712031201B3EC01FE913807FFC091381E07
F091383801F802707FECE000D9FDC07F5C01FF147F91C7FCA25BA35BB3A8486CECFF80B5
D8F83F13FEA32F457DC436>I<EA01E0EA07F8A2487EA46C5AA2EA01E0C8FCADEA01FC12
FFA3120712031201B3B0487EB512F8A315437DC21C>I<EA01FC12FFA3120712031201B3
B3B3A5487EB512F8A315457DC41C>108 D<D801FC01FFEC1FE000FF010701E0EBFFFC91
3B0F03F801E07F913C3C01FC07803F800007903C7000FE0E001FC0000349D97E1C130F26
01FDC0D97F38804A143001FFDA3FF06D7E91C75BA2495DA3495DB3A8486C4A6C497EB5D8
F81FB50003B512E0A34B2C7DAB52>I<3901FC01FE00FF903807FFC091381E07F0913838
01F8000701707F0003EBE0002601FDC07F5C01FF147F91C7FCA25BA35BB3A8486CECFF80
B5D8F83F13FEA32F2C7DAB36>I<EC7F80903803FFF090380FC0FC90383E001F496D7E49
6D7E48486D7E48486D7E48486D7E000F81A24848147E003F157FA290C87E481680A44816
C0AA6C1680A26D147F003F1600A2001F157E6D14FE000F5D6D130100075D6C6C495A6C6C
495A6C6C495A013E49C7FC90381FC0FE903807FFF89038007F802A2E7DAC31>I<3901FC
03FC00FF90380FFF8091383C07E091387001F83A07FDE000FE00030180137FD801FFEC3F
8091C7EA1FC04915E049140F17F0160717F8160317FCA3EE01FEABEE03FCA3EE07F8A217
F0160F6D15E0EE1FC06D143F17806EEB7E00D9FDC05B9039FCF003F891383C0FE091381F
FF80DA03FCC7FC91C9FCAE487EB512F8A32F3F7DAB36>I<3903F803F000FFEB1FFCEC3C
3EEC707F0007EBE0FF3803F9C000015B13FBEC007E153C01FF13005BA45BB3A748B4FCB5
12FEA3202C7DAB26>114 D<90383FE0183901FFFC383907E01F78390F0003F8001E1301
481300007C1478127800F81438A21518A27EA27E6C6C13006C7E13FC383FFFE06C13FC6C
13FF6C14C06C14E0C614F0011F13F81300EC0FFC140300C0EB01FE1400157E7E153EA27E
A36C143C6C147C15786C14F86CEB01F039F38003E039F1F00F8039E07FFE0038C00FF01F
2E7DAC26>I<1306A5130EA4131EA3133E137EA213FE12011207001FB512F0B6FCA2C648
C7FCB3A4150CAA017E131C017F1318A26D133890381F8030ECC070903807E0E0903801FF
C09038007F001E3E7EBC26>I<D801FC147F00FFEC3FFFA300071401000380000181B3A8
5EA35DA212006D5B017E9038077F80017F010E13C06D011C13FE90380FC078903803FFF0
9026007F8013002F2D7DAB36>I<B539F001FFFCA3000790C7EA7FE06C48EC1F80000116
00160E1200160C017F5CA280013F5CA26E1370011F146080010F5CA2ECF00101075CA26D
6C48C7FCA26E5A01011306A26D6C5AA214FF6E5AA215B8EC3FB015F06E5AA36E5AA26E5A
A36EC8FC2E2C7EAA33>I<B500E0B539E03FFF80A30007903C000FFE000FFC00D803FCD9
03F8EB03F8F001E0120103015D6D80000060A26D6E13036DD9037E91C7FCA20280017F5B
013FD9063F1306A2D91FC06E5AED0C1FA2D90FE06E5AED180FA2D907F06E5AED3007A2D9
03F86E5AED6003A2902601FCE06D5AEDC00117FCD900FFECFD80ED800017FF027F92C8FC
92C77EA26E147E023E143EA2021E143C021C141CA2412C7EAA46>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fl cmr10 10 85
/Fl 85 125 df<DA0FF813FC91397FFF07FF903B01F807DF83C0903A07E001FF0F903B1F
8007FE1FE090393F000FFC137E16F85B9338F007804848010790C7FC1503ACB812F8A328
01F80003F0C7FCB3AB486C497E267FFFE0B512F0A3333B7FBA30>11
D<EC0FF8EC7FFE903901F80780903907E001C090391F8000E090383F0007017E497EA25B
A2485A6F5AED018092C8FCA9ED03F0B7FCA33901F8000F1503B3AA486C497E267FFFE0B5
12C0A32A3B7FBA2E>I<EC0FFC91387FFF70903901F803F0903807E00790381F800FEB3F
00137EA25B150748481303ADB7FCA33901F80003B3AB486C497E267FFFE0B512C0A32A3B
7FBA2E>I<DA0FF0EB1FF0DA7FFEEBFFFC903B01F80F83F00F903C07E001CFC00380903C
1F8000FF0001C090273F0007FE130F017E4948497EA2495CA248485C03076E5A03030203
C7FC95C8FCA9F007E0BAFCA33C01F80003F0001F1807B3AA486C496C497E267FFFE0B500
C1B51280A3413B7FBA45>I<127812FCA27E7EEA7F80121FEA0FC0EA07E0EA03F0120013
78133C131E13060F0F77B92A>18 D<133C137EA213FE1201EA03FC13F0EA07E0EA0FC0EA
1F80EA1E005A5A5A12C00F0F6FB92A>I<121C127FEAFF80A8EA7F00AB123EAB121CABC7
FCA8121C127FEAFF80A5EA7F00121C093C79BB17>33 D<121C127FEAFF80A213C0A3127F
121C1200A412011380A2120313005A1206120E5A5A5A12600A1979B917>39
D<146014E0EB01C0EB0380EB0700130E131E5B5BA25B485AA2485AA212075B120F90C7FC
A25A121EA2123EA35AA65AB2127CA67EA3121EA2121F7EA27F12077F1203A26C7EA26C7E
1378A27F7F130E7FEB0380EB01C0EB00E01460135278BD20>I<12C07E12707E7E7E120F
6C7E6C7EA26C7E6C7EA21378A2137C133C133E131EA2131F7FA21480A3EB07C0A6EB03E0
B2EB07C0A6EB0F80A31400A25B131EA2133E133C137C1378A25BA2485A485AA2485A48C7
FC120E5A5A5A5A5A13527CBD20>I<EB0380497EA7397803803C00FC147E00FE14FE397F
8383FC393FC387F8390FE38FE03903FBBF803900FFFE00EB3FF8EB0FE0A2EB3FF8EBFFFE
3903FBBF80390FE38FE0393FC387F8397F8383FC39FE0380FE00FC147E0078143C390007
C000A76D5A1F247BBD2A>I<15301578B3A6007FB812F8B912FCA26C17F8C80078C8FCB3
A6153036367BAF41>I<121C127FEAFF80A213C0A3127F121C1200A412011380A2120313
005A1206120E5A5A5A12600A19798817>I<B512FCA516057F941C>I<121C127FEAFF80A5
EA7F00121C0909798817>I<150C151E153EA2153C157CA2157815F8A215F01401A215E0
1403A215C01407A21580140FA215005CA2141E143EA2143C147CA2147814F8A25C1301A2
5C1303A2495AA25C130FA291C7FC5BA2131E133EA2133C137CA2137813F8A25B1201A25B
1203A25B1207A25B120FA290C8FC5AA2121E123EA2123C127CA2127812F8A25A12601F53
7BBD2A>I<EB03F8EB1FFF90387E0FC09038F803E03901E000F0484813780007147C4848
7FA248C77EA2481580A3007EEC0FC0A600FE15E0B3007E15C0A4007F141F6C1580A36C15
006D5B000F143EA26C6C5B6C6C5B6C6C485A6C6C485A90387E0FC0D91FFFC7FCEB03F823
3A7DB72A>I<EB01C013031307131F13FFB5FCA2131F1200B3B3A8497E007FB512F0A31C
3879B72A>I<EB0FF0EB7FFE48B57E3903E03FE0390F000FF0000E6D7E486D7E486D7E12
3000706D7E126012FCB4EC7F807FA56CC7FC121CC8FCEDFF00A34A5A5D14035D4A5A5D14
0F4A5A4A5A92C7FC147C5C495A495A495A495A91C8FC011EEB01805B5B49130348481400
485A485A000EC75A000FB6FC5A5A485CB6FCA321387CB72A>I<EB07F8EB3FFF4913C039
01F80FF03903C007F848486C7E380E0001000F80381FE0006D7FA56C5A6C5AC85A1401A2
5D4A5AA24A5A5DEC0F80027EC7FCEB1FFCECFF809038000FE06E7EEC01FC816E7EED7F80
A216C0A2153F16E0A2121EEA7F80487EA416C049137F007F1580007EC7FC0070ECFF006C
495A121E390F8003F83907F00FF00001B512C06C6C90C7FCEB0FF8233A7DB72A>I<1538
A2157815F8A2140114031407A2140F141F141B14331473146314C313011483EB03031307
1306130C131C131813301370136013C01201EA038013005A120E120C5A123812305A12E0
B712F8A3C73803F800AB4A7E0103B512F8A325397EB82A>I<0006140CD80780133C9038
F003F890B5FC5D5D158092C7FC14FC38067FE090C9FCABEB07F8EB3FFE9038780F803907
E007E090388003F0496C7E12066E7EC87EA28181A21680A4123E127F487EA490C7130048
5C12E000605C12700030495A00385C6C1303001E495A6C6C485A3907E03F800001B5C7FC
38007FFCEB1FE0213A7CB72A>I<EC3FC0903801FFF0010713FC90380FE03E90383F8007
90387E001F49EB3F804848137F485AA2485A000FEC3F0049131E001F91C7FCA2485AA312
7F90C9FCEB01FC903807FF8039FF1E07E090383801F0496C7E01607F01E0137E497FA249
148016C0151FA290C713E0A57EA56C7E16C0A2121FED3F807F000F15006C6C5B15FE6C6C
5B6C6C485A3900FE07F090383FFFC06D90C7FCEB03FC233A7DB72A>I<12301238123E00
3FB612E0A316C05A168016000070C712060060140E5D151800E01438485C5D5DC712014A
5A92C7FC5C140E140C141C5CA25CA214F0495AA21303A25C1307A2130FA3495AA3133FA5
137FA96DC8FC131E233B7BB82A>I<EB03F8EB1FFF017F13C09038FC07F03901E001F848
486C7E4848137C90C77E48141E000E141F001E80A3121FA27F5D01E0131E6C6C133E01FC
133C6D5B6C6C6C5AECC1E06CEBF3C06C01FFC7FC6C5BEB3FFF6D13C081017F13F801F07F
3903E07FFE3907801FFF48486C1380481303003E6D13C0003CEB007F007C143F0078EC0F
E000F814075A1503A21501A36C15C012781503007C15806CEC07006C5C6C6C131ED807E0
137C3903F803F0C6B55A013F1380D907FCC7FC233A7DB72A>I<EB03F8EB1FFF017F13C0
9038FC07E03903F803F048486C7E48486C7E49137E121F48487FA2007F158090C7FCA248
EC1FC0A616E0A56C143FA27F123F001F147FA26C6C13FF3907E001DF0003149F3801F003
3900FC0F1FD93FFC13C0EB07F090C7FC153F1680A316005D000F147E487E486C5BA24A5A
4A5A49485A6C48485A001C495A260F807FC7FC3807FFFC000113F038003FC0233A7DB72A
>I<121C127FEAFF80A5EA7F00121CC7FCB2121C127FEAFF80A5EA7F00121C092479A317>
I<121C127FEAFF80A5EA7F00121CC7FCB2121C127F5A1380A4127F121D1201A412031300
A25A1206A2120E5A121812385A1260093479A317>I<EB3FE03801FFFE3907C03F80390E
000FC0003CEB07F000301303007014F8007C130100FE14FC7EA4127E003CEB03F8C7FCEC
07F0A2EC0FE0EC1F80EC3F00147E147C5C495A5C495A5CA249C7FCA31306AA90C8FCA813
0EEB3F80497EA56D5A010EC7FC1E3B7CBA27>63 D<EC03FF021F13E09138FC00FCD901E0
131ED90780EB0780011EC7EA01E00138EC00704981498148488148488190C97E48D901FC
1480000ED907FFEB01C0000C90391F03C000001C90267E00E013E0001849017013602638
01F86D13700030496D13300103EC0FE0267007E00107133800601718495AA200E0171C48
4848150CAA6C6C7E1260A26D6C151C00701718263003F0130F0101141F00386D013F1338
261800FC01771330001C017E9038E3F070000C90261F03C113E0000E903A07FF00FFC06C
D901FCEB3F006C90CAFC7F6C7E6C7E13706D167C011EED03FCD90780EC1FF0D901E0ECFF
80D900FC90383FFC00021FB51280020301E0C7FC363C7BBA41>I<1538A3157CA315FEA3
4A7EA34A6C7EA202077FEC063FA2020E7FEC0C1FA2021C7FEC180FA202387FEC3007A202
707FEC6003A202C07F1501A2D901807F81A249C77F167FA20106810107B6FCA24981010C
C7121FA2496E7EA3496E7EA3496E7EA213E0707E1201486C81D80FFC02071380B56C90B5
12FEA3373C7DBB3E>I<B712E016FC16FF0001903980007FC06C90C7EA1FE0707E707E70
7EA2707EA283A75F16035F4C5A4C5A4C5A4C5AEEFF8091B500FCC7FCA291C7EA7F80EE1F
E0EE07F0707E707E83707EA21880177F18C0A7188017FFA24C13005F16034C5AEE1FF848
6DEB7FF0B812C094C7FC16F832397DB83B>I<913A01FF800180020FEBE003027F13F890
3A01FF807E07903A03FC000F0FD90FF0EB039F4948EB01DFD93F80EB00FF49C8127F01FE
153F12014848151F4848150FA248481507A2485A1703123F5B007F1601A35B00FF93C7FC
AD127F6DED0180A3123F7F001F160318006C7E5F6C7E17066C6C150E6C6C5D0000161801
7F15386D6C5CD91FE05C6D6CEB03C0D903FCEB0F80902701FF803FC7FC9039007FFFFC02
0F13F002011380313D7BBA3C>I<B712C016F816FE000190398001FF806C90C7EA3FE0EE
0FF0EE03F8707E707E177FA2EF3F8018C0171F18E0170F18F0A3EF07F8A418FCAC18F8A4
EF0FF0A218E0A2171F18C0EF3F80A2EF7F0017FE4C5A4C5AEE0FF0EE3FE0486DEBFF80B8
C7FC16F816C036397DB83F>I<B812FCA30001903880000F6C90C71201EE007E173E171E
170EA31706A317078316C0A394C7FCA31501A21503150F91B5FCA3EC000F15031501A215
00A21860A318E093C712C0A41701A3EF0380A21707A2170F173F177F486D903807FF00B9
FCA333397DB839>I<B812F8A30001903880001F6C90C71201EE00FC177C173C171CA217
0CA4170E1706A2ED0180A21700A41503A21507151F91B5FCA3EC001F15071503A21501A6
92C8FCAD4813C0B612C0A32F397DB836>I<DBFF8013C0020FEBF001023F13FC9139FF80
3F03903A03FC000787D90FF0EB03CF4948EB00EF4948147F4948143F49C8121F485A4848
150F48481507A248481503A2485A1701123F5B007F1600A448481600AB93B6FCA26C7E93
38007FE0EF3FC0A2123F7F121FA26C7EA26C7EA26C7E6C7E6C6C157F6D7E6D6C14FF6D6C
14EFD90FF8EB03C7D903FEEB0783903A00FFC03F0191393FFFFC00020F01F01300020013
80383D7CBA41>I<B648B512FEA30001902680000313006C90C76C5AB3A491B6FCA391C7
1201B3A6486D497EB648B512FEA337397DB83E>I<B612C0A3C6EBC0006D5AB3B3AD497E
B612C0A31A397EB81E>I<013FB512E0A39039001FFC00EC07F8B3B3A3123FEA7F80EAFF
C0A44A5A1380D87F005B0070131F6C5C6C495A6C49C7FC380781FC3801FFF038007F8023
3B7DB82B>I<B649B5FCA3000101809038007FF06C90C8EA3F80053EC7FC173C17385F5F
4C5A4C5A4CC8FC160E5E5E5E5E4B5AED0780030EC9FC5D153E157E15FF5C4A7F4A6C7E14
0E4A6C7E4A6C7E14704A6C7E4A6C7E14804A6C7E6F7EA26F7F707EA2707E707EA2707EA2
707E707EA2707E707F8484486D497FB6011FEBFF80A339397DB841>I<B612E0A3000101
C0C8FC6C90C9FCB3AD1718A517381730A31770A317F0A216011603160FEE1FE0486D13FF
B8FCA32D397DB834>I<B5933807FFF86E5DA20001F0FC002600DFC0ED1BF8A2D9CFE015
33A3D9C7F01563A3D9C3F815C3A2D9C1FCEC0183A3D9C0FEEC0303A2027F1406A36E6C13
0CA36E6C1318A26E6C1330A36E6C1360A26E6C13C0A3913901FC0180A3913900FE0300A2
ED7F06A3ED3F8CA2ED1FD8A3ED0FF0A3486C6D5A487ED80FFC6D48497EB500C00203B512
F8A2ED018045397DB84C>I<B5913807FFFE8080C69238007FE06EEC1F80D9DFF0EC0F00
1706EBCFF8EBC7FCA2EBC3FEEBC1FFA201C07F6E7EA26E7E6E7E81140F6E7E8114036E7E
168080ED7FC016E0153FED1FF0ED0FF8A2ED07FCED03FEA2ED01FF6F1386A2EE7FC6EE3F
E6A2EE1FF6EE0FFEA216071603A216011600A2177E486C153E487ED80FFC151EB500C014
0EA2170637397DB83E>I<EC03FF021F13E09138FE01FC903901F8007ED907E0EB1F8049
486D7ED93F80EB07F049C76C7E01FE6E7E48486E7E49157E0003167F4848ED3F80A24848
ED1FC0A2001F17E049150F003F17F0A3007F17F8491507A300FF17FCAC007F17F86D150F
A3003F17F0A26C6CED1FE0A36C6CED3FC0000717806D157F000317006C6C15FEA26C6C4A
5A017F4A5A6D6C495A6D6C495AD907E0EB1F80D903F8017FC7FC903900FE01FC91381FFF
E0020390C8FC363D7BBA41>I<B712C016F816FE000190398001FF806C90C7EA3FC0EE0F
E0EE07F0EE03F817FC17FE1601A217FFA717FEA2EE03FCA2EE07F817F0EE0FE0EE3FC092
3801FF0091B512FC16F091C9FCB3A5487FB6FCA330397DB839>I<B612FEEDFFE016F800
0190388007FE6C90C76C7EEE3FC0707E707E707EA2707EA283A65FA24C5AA24C5A4C5AEE
3F8004FFC8FCED07FC91B512E05E9138000FF0ED03F8ED00FE82707E707EA2161F83A583
A6F00180A217F8160F1803486D01071400B66D6C5A04011306933800FE0ECAEA3FFCEF07
F0393B7DB83D>82 D<D90FF813C090383FFE0190B512813903F807E33907E000F7484813
7F4848133F48C7121F003E140F007E1407A2007C140312FC1501A36C1400A37E6D14006C
7E7F13F86CB47E6C13F8ECFF806C14E06C14F86C14FEC680013F1480010714C0EB007F02
0713E0EC007FED3FF0151F150FED07F8A200C01403A21501A37EA216F07E15036C15E06C
14076C15C06C140F6DEB1F80D8FBF0EB3F00D8F0FE13FE39E03FFFF8010F13E0D8C00190
C7FC253D7CBA2E>I<003FB812E0A3D9C003EB001F273E0001FE130348EE01F000781600
00701770A300601730A400E01738481718A4C71600B3B0913807FF80011FB612E0A33539
7DB83C>I<B6903807FFFEA3000101809038007FE06C90C8EA1F80EF0F001706B3B2170E
6D150C80171C133F17186D6C14385F6D6C14F06D6C5C6D6C495A6D6CEB07806D6C49C7FC
91387F807E91381FFFF8020713E09138007F80373B7DB83E>I<B500FC91387FFF80A300
03018091380FFC006C90C8EA07E0715A6C705A6E1403017F93C7FCA280013F1506A26E14
0E011F150C80010F5DA28001075DA26E147001031560A26D6C5CA2806D4A5AA2ED800302
7F91C8FCA291383FC006A215E0021F5BA2EDF01C020F1318A26E6C5AA215FC02035BA2ED
FEE002015BA26E6C5AA36FC9FCA3153EA2151CA3393B7EB83E>I<B5D8FC07B5D8F001B5
FCA30007902780001FFEC7EA1FF86C48C7D80FF8EC07E000010307ED03C01B807F6C6F6C
1500A26E5F017F6E6C1406A280013F4A6C5CA280011F4A6D5BEE067FA26D6C010E6D5BEE
0C3FA26D6C011C6D5BEE181FA26D6C6F5BEE300FA26D6C6F485AEE6007A26D6C4CC7FC93
38C003FCA203805D913B7F818001FE06A203C1150EDA3FC3C7EAFF0CA203E3151CDA1FE6
EC7F98A215F6DA0FFCEC3FF0A302075E4B141FA202035E4B140FA202015E4B1407A20200
93C8FC4B80503B7EB855>I<007FB590383FFFFCA3C601F801071380D97FE0D903FCC7FC
013FEC01F06D6C5C5F6D6C5C6D6C13034CC8FC6D6C1306160E6D6C5B6DEB801816389138
7FC0306E6C5A16E06E6C5A91380FF18015FB6EB4C9FC5D14036E7EA26E7F6F7EA24B7E15
DF9138019FF09138038FF8150F91380607FC91380E03FE140C4A6C7EEC38000230804A6D
7E14E04A6D7E49486D7E130391C76C7E01066E7E130E010C6E7E011C1401013C8101FE82
2607FF80010713E0B500E0013FEBFF80A339397EB83E>I<003FB7FCA39039FC0001FE01
C0130349495A003EC7FC003C4A5A5E0038141F00784A5A12704B5A5E006014FF4A90C7FC
A24A5A5DC712074A5AA24A5A5D143F4A5AA24A5A92C8FC5B495AA2495A5C130F4948EB01
80A2495A5C137F495A16034890C7FC5B1203485AEE0700485A495C001F5D48485C5E4848
495A49130FB8FCA329397BB833>90 D<EAFFF8A4EAF000B3B3B3B3A3EAFFF8A40D5378BD
17>I<EAFFF8A4EA0078B3B3B3B3A3EAFFF8A40D537FBD17>93 D<EA01801203EA070012
0E5A12181238123012701260A212E05AA412CEEAFF8013C0A3127FA2EA3F80EA0E000A19
7AB917>96 D<EB1FE0EBFFFC3803E03F3907000F80390F8007E0486C6C7E13E06E7EA26E
7E6C5A6C5AC8FCA4147FEB07FFEB3FE0EBFE00EA03F8EA0FF0EA1FC0123F485A90C7FC16
0C12FEA31401A26C13036CEB077C903980063E18383FC01E3A0FE0781FF03A03FFF00FE0
3A007F8007C026277DA52A>I<EA03F012FFA3120F1203B0EC1FE0EC7FF89038F1E03E90
39F3801F809039F7000FC001FEEB07E049EB03F049EB01F85BED00FCA216FEA2167E167F
AA167E16FEA216FC15016D14F8ED03F07F01EEEB07E001C6EB0FC09039C7801F00903881
E07E903800FFF8C7EA1FC0283B7EB92E>I<EB03FC90381FFF8090387E03E03901F80070
484813F83907E001FC380FC003A2EA1F80123F90380001F848EB00F01500A2127E12FEAA
127E127FA26C14067F001F140E6D130C000F141C6C6C13386C6C13706C6C13E039007C07
C090381FFF00EB07F81F277DA525>I<ED0FC0EC03FFA3EC003F150FB0EB03F8EB1FFF90
387E078F9038F801EF3903F0007F4848133F4848131FA24848130F123F90C7FC5AA2127E
12FEAA127E127FA27EA26C6C131FA26C6C133F6C6C137F6C6CEBEFF03A01F801CFFF3900
7C078F90381FFE0FD907F813C0283B7DB92E>I<EB07F8EB1FFF90387C0FC03901F803E0
3903F001F0D807E013F8380FC0004848137CA248C7127E153E5A153F127E12FEA3B7FCA2
48C8FCA5127EA2127FA26C14037F001F14076C6C13060007140E6D131CD801F013386C6C
137090387E03E090381FFF80903803FC0020277EA525>I<147E903803FF8090380FC1E0
EB1F8790383F0FF0137EA213FCA23901F803C091C7FCADB512FCA3D801F8C7FCB3AB487E
387FFFF8A31C3B7FBA19>I<ED03F090390FF00FF890393FFC3C3C9039F81F707C3901F0
0FE03903E007C03A07C003E010000FECF000A248486C7EA86C6C485AA200075C6C6C485A
6D485A6D48C7FC38073FFC38060FF0000EC9FCA4120FA213C06CB512C015F86C14FE6CEC
FF804815C03A0F80007FE048C7EA0FF0003E140348140116F8481400A56C1401007C15F0
6CEC03E0003F1407D80F80EB0F80D807E0EB3F003901FC01FC39007FFFF0010790C7FC26
387EA52A>I<EA03F012FFA3120F1203B0EC0FF0EC3FFCECF03F9039F1C01F809039F380
0FC0EBF70013FE496D7EA25BA35BB3A3486C497EB500C1B51280A3293A7EB92E>I<EA03
80EA0FE0487EA56C5AEA0380C8FCAAEA03F012FFA312071203B3AA487EB512C0A312387E
B717>I<EB01C0EB07F0EB0FF8A5EB07F0EB01C090C7FCAAEB01F813FFA313071301B3B3
A2123C127E00FF13F01303A214E038FE07C0127C383C0F00EA0FFEEA03F8154984B719>
I<EA03F012FFA3120F1203B1913801FFFCA39138007FC01600157C15705D4A5A4A5A4AC7
FC141E1438147814FC13F1EBF3FEEBF73F01FE7FEBF81F496C7E8114076E7E6E7E811400
157E157F811680ED1FC0486CEB3FF0B500C0B5FCA3283A7EB92C>I<EA03F012FFA3120F
1203B3B3AD487EB512C0A3123A7EB917>I<2703F00FF0EB1FE000FFD93FFCEB7FF8913A
F03F01E07E903BF1C01F83803F3D0FF3800FC7001F802603F70013CE01FE14DC49D907F8
EB0FC0A2495CA3495CB3A3486C496CEB1FE0B500C1B50083B5FCA340257EA445>I<3903
F00FF000FFEB3FFCECF03F9039F1C01F803A0FF3800FC03803F70013FE496D7EA25BA35B
B3A3486C497EB500C1B51280A329257EA42E>I<EB03FE90380FFF8090383E03E09038F8
00F84848137C48487F48487F4848EB0F80001F15C090C712074815E0A2007EEC03F0A400
FE15F8A9007E15F0A2007F14076C15E0A26C6CEB0FC0000F15806D131F6C6CEB3F006C6C
137EC66C13F890387E03F090381FFFC0D903FEC7FC25277EA52A>I<3903F01FE000FFEB
7FF89038F1E07E9039F3801F803A0FF7000FC0D803FEEB07E049EB03F04914F849130116
FC150016FEA3167FAA16FEA3ED01FCA26DEB03F816F06D13076DEB0FE001F614C09039F7
803F009038F1E07E9038F0FFF8EC1FC091C8FCAB487EB512C0A328357EA42E>I<D903F8
13C090381FFE0190387E07819038FC01C33903F000E3000714774848133749133F001F14
1F485A150F48C7FCA312FEAA127FA37E6D131F121F6D133F120F6C6C137F6C6C13EF3901
F801CF39007E078F90381FFE0FEB07F890C7FCABED1FE00203B5FCA328357DA42C>I<38
07E01F00FFEB7FC09038E1E3E09038E387F0380FE707EA03E613EE9038EC03E09038FC00
80491300A45BB3A2487EB512F0A31C257EA421>I<EBFF03000313E7380F80FF381E003F
487F487F00707F12F0A2807EA27EB490C7FCEA7FE013FF6C13E06C13F86C7F00037FC67F
01071380EB007F141F00C0EB0FC01407A26C1303A37E15806C13077EEC0F00B4131E38F3
C07C38E1FFF038C03F801A277DA521>I<1318A51338A31378A313F8120112031207001F
B5FCB6FCA2D801F8C7FCB215C0A93800FC011580EB7C03017E13006D5AEB0FFEEB01F81A
347FB220>I<D803F0EB07E000FFEB01FFA3000FEB001F00031407B3A4150FA3151F1201
6D133F0000EC77F86D9038E7FF8090383F03C790381FFF87903A03FC07E00029267EA42E
>I<B538803FFEA33A0FF8000FF06C48EB07E00003EC03C06D148000011500A26C6C1306
A26D130E017E130CA26D5BA2EC8038011F1330A26D6C5AA214E001075BA2903803F180A3
D901FBC7FCA214FF6D5AA2147CA31438A227257EA32C>I<B53A1FFFE03FFEA3260FF800
9038000FF86C48017EEB03E018C00003023EEB0180A26C6C013FEB0300A36C6CEC800615
6FA2017E9038EFC00C15C7A2D93F016D5A15830281EBF038D91F831430150102C3EBF870
90260FC6001360A2D907E66D5A02EC137CA2D903FCEB7F804A133FA2010192C7FC4A7FA2
0100141E4A130E0260130C37257EA33C>I<B538807FFFA33A03FE003FF00001EC1F8000
0092C7FC017E131C6D13186D6C5AECC070010F5B6D6C5AECF180EB03FB6DB4C8FC6D5AA2
147F804A7E8114CF903801C7E090380383F090380703F8EB0601496C7E011C137E49137F
01787F496D7E486C80000FEC3FF0D8FFFE90B51280A329247FA32C>I<B538803FFEA33A
0FF8000FF06C48EB07C00003EC03806C7E16007F00001406A2017E5BA2137F6D5BA26D6C
5AA2ECC070010F1360A26D6C5AA214F101035BA2D901FBC7FCA214FF6D5AA2147CA31438
A21430A214701460A25CA2EA7C0100FE5B130391C8FC1306EAFC0EEA701C6C5AEA1FF0EA
0FC027357EA32C>I<003FB512FCA2EB8003D83E0013F8003CEB07F00038EB0FE0123000
70EB1FC0EC3F800060137F150014FE495AA2C6485A495AA2495A495A495AA290387F0006
13FEA2485A485A0007140E5B4848130C4848131CA24848133C48C7127C48EB03FC90B5FC
A21F247EA325>I<B81280A2290280962A>I<BD12C0A25202809653>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fm cmss17 20.74 7
/Fm 7 85 df<EF7FFFA294B57EA34C80A24C80A34C80A34C487FA25F041F80A2187FDC3F
F87FA3047F6D7E17F0A204FF6D7FA217E04B828417C04B82844B018080A2844B010080A3
4B6E7F5EA2033F6E7F5EA2037F6F7E5EA203FF6F7F5EA24A707F5EA24A707F5EA24A707F
5E4A848593C8FC4A84855D023F84855D027F84865D02FF85865D498692BAFCA24986A349
86A24986A34990CA00037FA286494885A286494885A287494886A287484986A24A844888
875C4888875C4888874890CC80A287484887A287484887A28848481C80A28861787BF76C
>65 D<BC1280AB49CDFCB3B3A590BA12F8AB49CDFCB3B3A990BB12E0AC4B7872F761>69
D<943803FFFC057FEBFFF00403B7FC041F16E0047F16F84BB812FE0307EFFFC0031F18F0
4B18F85D4ABAFC4A9126FE000F14F04A02E0EB007F4A0280140F4A49C812014A01F8ED00
7F4A01E0163F91B548EE0FE0494A16034949CA1201494917004B1860494918005B495B5D
495BA290B5CDFC5C5A5C5A5C5A5C5A5CA25A5CA25A5CA35A91CEFCA6485AB06C7E060FB6
12FCA5807EA3807E95C8127F807EA2807E807E807E807E806D7FA26D7F816D7F7F6D7F81
6D7F6D6D7E6D806E7F6E13F86E13FE6E6D6CEC03FF6E02E0143F6E02FE010FB5FC6E91B8
FC6E7E816F18F8030718C0030118006F6C16FC041F16E004034BC7FCDC007F14E0050301
F8C8FC567A76F86C>71 D<EF0FFF4CB512F8040F14FF043F15C093B712F0030316FC030F
16FF033F17C04B8392B97E020318FC4ADAF801804A912680001F7F4A49C70007804A01F8
0201804A01E06E6C7F91B5486F7F4991C9000F7F4B824949707F4949707F4949707F4B83
4949717F49874B834990CB6C7FA24948727F4A8448884A8448884A8448884A197FA24888
4A85A2481D804A85A2481DC0A291CD7EA3481DE0A44986A200FF1DF0B16D626C1DE0A56E
61A26C1DC0A36E616C1D80A26E61A26C1D006E96B5FC6C64A26E606C646E606C646E606C
646E606D636F5F6D6D4D5B6F5F6D636D6D94B5C7FC6F5E6D6D4C5B6D6D4C5B6D6D4C5B70
5D6D6E4B5B6E01F092B55A6E6D4A5C6E01FE02075C6ED9FFC0013F91C8FC6EDAF801B55A
6E91B75A020018F06F5F6F5F030F94C9FC030316FC6F5EDB003F15C0040F92CAFC040114
F8DC000F90CBFC647E77FA77>79 D<B812FEEFFFF018FEF0FFC019F019FC19FF1AC08686
49C8000F80DD007F13FE060F7F0603801800737F071F7F737F85737FA2737FA2737FA21A
7FA28786A86263A21AFFA24F5BA24F5BA24F5B614F5B197F96B55A06035C060F91C7FC06
7F5B050FB55A90BA5A62621A8097C8FC19FC19F019C04EC9FC18F88449C8FC717E848385
83858385717FA2717F83858385187F85727FA2727F848684868486727FA2727F197F8685
87737FA2737FA2737FA2737F8587737FA2747EA2741380A27413C0861CE07413F0A27413
F8557872F768>82 D<923801FFFC031FEBFFF092B612FE0203EDFFC0020F16F8023F16FE
4A707E49B912E049845B5B496049EC80074901F8C7123F90B500E01407038014014891C9
127F4849EE1FC002F8160F4818034A16014849160097C7FC5C5A5CA34890CDFCA880A36C
7FA280A26C7F80A26C13FE806C8015E06C14F86C14FF16F06D14FF6D15F06D15FE6DEDFF
C06D16F06D16FC6D16FF6D6C16C06E82020F82020382020082031F81030181DB003F8104
0381DC003F801707050180717E727F180F727F848684848685A2851B80A385A94F1300A4
00304E5A1238003C18FF003E61003F5FD87FC05E6D6001F84C5B01FE5E6D6C4B5B02E015
7FB500FC4AB55ADAFF8001075C03FC013F91C7FC6C91B75A001F606C60000360C660013F
5F010F94C8FC01035ED9007F15F8020F15C0020092C9FC030313E0497E79FA5A>I<BF12
80ABCA6C90CBFCB3B3B3B3B3B261777AF66E>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fn cmr17 17.28 18
/Fn 18 117 df<DD7FF81560040FB56C14E0047F14E00303B600FC1301030F9038E003FE
DB3FFEC7383F8003DBFFF0EC07C04A01C0913803F007020790C9EAF80FDA0FFC167C4A48
EE1E1FDA7FE0160F4A48EE07BF4949EE03FF4990CAFC4948834948834A187F495A013F19
3F4948181F5C01FF190F485BA24890CC1207A248481903A2485A1B01121FA25B123F1B00
5BA2127F1C00A4485AB06C7EA5123F1CE07FA2121F7FA2000F1A011CC06C7EA26C7E1B03
6C6D19801B076C7F017F1A006E606D6C181E131F6D6C606E18386D6C18786D6C606D6D4C
5A6D6D4C5A6E6C1607DA1FF84C5A6E6C4CC7FC6EB4167C020101C04A5A6E01F0EC07F0DB
3FFEEC1FC092280FFFE001FFC8FC030390B512FCDB007F14F0040F14809326007FF8C9FC
53667AE360>67 D<BC1280A4C601FCC81201D93FF8DB001F13C0011F170319001A7F1A3F
1A1F1A0F1A07A21A03A21BE01A01A41A00A61B701870A41B00A418F0A417011703170717
0F177F91B7FCA402F8C7127F170F1707170317011700A41870A31B0EA41B1C95C8FCA51B
3C1B38A31B78A41BF0A31A01A21A031A07A2F20FE01A1F1A7F1AFF1903013F171FD9FFFC
0303B5FCBC12C0A44F6279E15A>69 D<DA07FF1403023F01F05B49B512FC010702FF5B90
260FFC0013C0D93FE090380FF01FD97F80EB03F801FEC86C5A4848157E4848ED1F7F4848
6F5A4848815B001F824981003F8290CAFC4883A2007E83A212FE84A384A27EA36D82A26C
7EA26D93C7FC6C7E7F7F6C7E6D7E6C13E06C13FCECFFC06C14F86CECFF806C15F86DECFF
80011F15E06D15F8010315FE01006F7E021F81020181DA003F80030380DB003F7F04037F
EE007FEF1FFF71138017037113C083A2F07FE0183FA2181F00E018F0180FA41807A27EA4
7E19E0180F7E19C07E6C171F19806D163F6D17006D5E6D16FE486C5E6D4B5AD8FC7F1503
D91F80EC0FF026F80FE04A5AD907FCEC7F8029F001FFE003FFC7FC6D6CB512FC48011F14
F0020314C0489026001FFEC8FC3C667AE349>83 D<003FBC12F8A49126C000039038C000
0301FCC76C49EB007F01F0190F01C019074848F103FC90C81701007E1A00007C1B7CA300
781B3CA400701B1CA600F01B1E481B0EA7C91800B3B3B3A54C7FA2041F13F84AB87EA457
627CE160>I<B600FC057FB5FCA4C60280050F13F0D93FFECB000313804A953801FE0001
1F62755A130F6E61010762806D4F5AA2816D4F5AA26F17076D97C7FC81027F180EA26F17
1E023F181C811B3C021F183881020F60A26F17F0020760811A016E60826E4D5AA2701507
6E95C8FC82037F160EA282033F5E821A3C031F163882030F5EA27015F003075E8219016F
5E836F4B5AA27113076F93C9FC83047F140EA283043F5CA271133C041F143883040F5CA2
7113F004075C831801705C188170EB8380A218C77091CAFC18E7EF7FEEA218FE715AA371
5AA2715AA3715AA3715AA260647FE163>86 D<EC3FF0903803FFFE010F6D7E90393FC03F
E090397E0007F801F86D7ED801E06D7E48486D7E48486E7E48C86C7E7F01F06E7E487E6D
6E7EA3707EA36C5AEA03E0C9FCA6167FED7FFF020FB5FC91387FF807903801FF80903807
FC00EB1FF0EB7FC0495AD803FEC7FC485A120F5B485A485AA2484817E0A312FF5BA2160F
A3161F6D141B007F153B16736D913971FC01C06C6C14E1001FEC01C1D80FFC903A0780FE
03806C6C903A0F00FF07002701FF807E6DB4FC27007FFFF86D5A011F01E0EB1FF8010190
C7EA07E03B417ABF42>97 D<4AB47E020F13F8023F13FE9139FF007F80D903FCEB07E0D9
07F0EB01F0D91FE0EB007849488049488049C87E48485D4915FF00034B138048485CA248
5AA2485AA2003F6F130049EC007C94C7FC127FA35B12FFAD127F7FA4123F7FA2001FEE01
C07F000F16036D168012076C6C15076D160000015E6C6C151E6D6C5C6D6C5C6D6C5CD90F
F8495AD903FCEB07C0903A00FF803F8091263FFFFEC7FC020F13F80201138032417CBF3A
>99 D<EC03FE91381FFFE091B512F8903901FE03FE903A07F0007F8049486D7ED93FC06D
7E49C76C7E496E7E49140348488148481401000782491400000F8283485A1880123F4915
3FA2007F17C0A35BA212FF90B8FCA30180CAFCA9127F7FA3123FA27F121FEF01C06C7E17
036C6C1680A26C6C15070001EE0F006D150E6C6C151E6D6C5C6D6C5C6D6C5CD907F0EB03
E0D903FC495A902700FF803FC7FC91383FFFFC020F13F00201138032417CBF3A>101
D<F03F80DA03FC903801FFE091273FFFC00713F091B539F01FC1F8903B03FC03FC3E0390
3A07F000FE784948EB7FE04948EB3FC04948011FEB01F049C76C6CC7FC01FE6E7EA24848
6E7EA2000382A2491401000782AA00035E6D1403A200015EA26C6C4A5AA2017F4A5A6D6C
495A6D6C495A496C49C8FCD937F013FE903973FC03FC0160B512F0D9E03F13C0DA03FCC9
FC4848CBFCA57FA27FA27F6C7E13FF91B512FE6DECFFF06D15FE6D6F7E6D16E084013F16
FC01FEC700017FD803F8EC001FD807E0ED03FF4848030013804848167F003FEF3FC090CA
121F127EF00FE012FE481707A66C170F007E18C0A2007F171F6C6CEE3F806C6CEE7F0000
0F177ED807F04B5A6C6C4B5A6C6C4B5AD8007FED1FC0D93FE0ECFF80D90FFED90FFEC7FC
0101B612F0D9003F1480020101F0C8FC3D5E7DBF42>103 D<EB03C0EA07FFB5FCA41201
EA007FA2133FB3AAEE7FE0923803FFFC030F13FFDB3F0013C00378EB1FE04B6D7EDAC1C0
6D7EDAC3808002C7C7120302CE81170114DC14D802F86E7E5CA35CA35CB3B3496C4A7F49
6C4A7FB6D8F003B612C0A442647DE349>I<133C13FF487F487FA66C5B6C90C7FC133C90
C8FCB3A2EB03C0EA07FF127FA41201EA007FA2133FB3B3AC497E497EB612E0A41B5F7DDE
23>I<EB03C0EA07FFB5FCA41201EA007FA2133FB3B3B3B3AD497E497EB612F0A41C647D
E323>108 D<D903C0D9FFC0EC07FED807FF010301F891381FFFC0B5010F01FE027F13F0
923D3F00FF8001F807FC0378903B3FC003C001FEDAC1E090261FE00FC77E0001D9C3C090
260FF01E6E7ED8007F49902607F81C6E7E02C7C75CD93FCE6E6C486E7E02CC166002DC16
E002D85E02F8DA01FF6F7E4A5EA24A93C8FCA44A5DB3B3496C4A6C4B7E496C4A6D4A7EB6
D8F007B6D8803FB512FCA4663F7CBE6F>I<EDFF80020F13F8023F13FE9139FF007F80D9
03FCEB1FE0D907F0EB07F0D90FC0EB01F8D93F80EB00FE49C8127F017E81496F7E48486F
7E00038349150700078348486F7EA2001F83491501A2003F83A348486F7EA400FF1880AC
007F1800A26D5DA2003F5FA36C6C4B5AA36C6C4B5A00075FA26C6C4B5A6C6C4B5AA26C6C
4B5A017F4BC7FC6D6C14FE6D6C495AD90FF0EB07F8D903FCEB1FE0D900FFEB7F806EB5C8
FC020F13F8020113C039417CBF42>111 D<D903C0EB7FC0D807FF903807FFFCB5011F13
FFDB7F0013C003F8EB1FF0DAC3E0EB07F80001D9C7806D7E26007FCFC76C7E02DE6E7ED9
3FFC6F7E4A6F7E4A82181F4A82727E5C727EA2727EA3727EA41A8084AC4E1300A54E5AA2
611807A24E5A6E5E181F6E4B5A6E5E187F6E4B5A02DE4A90C7FC02CF4A5ADAC780495ADA
C3C0EB0FF0DAC1F0EB3FE0913AC07E01FF806FB448C8FC030F13F80300138093CAFCB3A3
497E497EB612F0A4415B7DBE49>I<9039078003F8D807FFEB0FFFB5013F13C092387C0F
E0913881F01F9238E03FF00001EB838039007F8700148FEB3F8E029CEB1FE0EE0FC00298
EB030002B890C7FCA214B014F0A25CA55CB3B0497EEBFFF8B612FCA42C3F7CBE33>114
D<9139FFE00180010FEBFC03017FEBFF073A01FF001FCFD803F8EB03EFD807E0EB01FF48
487F4848147F48C8123F003E151F007E150F127CA200FC1507A316037EA27E7F6C7E6D91
C7FC13F8EA3FFE381FFFF06CEBFF806C14F86C14FF6C15C06C6C14F0011F80010714FED9
007F7F02031480DA003F13C01503030013E0167F00E0ED1FF0160F17F86C15071603A36C
1501A37EA26C16F016037E17E06D14076DEC0FC06D1580D8FDF0141FD8F8F8EC7F00013E
14FC3AF01FC00FF80107B512E0D8E001148027C0003FF8C7FC2D417DBF34>I<1438A714
78A414F8A31301A31303A21307130F131FA2137F13FF1203000F90B6FCB8FCA3260007F8
C8FCB3AE17E0AE6D6CEB01C0A316036D6C148016076D6C14006E6C5A91383FC01E91381F
F07C6EB45A020313E09138007F802B597FD733>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fo cmr17 20.74 14
/Fo 14 117 df<DE7FFCED01C0050FB512C094B600F81403040315FE041F6F6C1307047F
D9F00013E04B4848C7D80FF0130F030701F0EC03FC4B0180DA00FE131FDB3FFEC9123FDB
7FF893381F803F4A4848EE07E04A01C0933803F07F4A4916014A90CBEAF8FFDA1FFC187C
4A48183F4A48844A5A498649498449498492CCFC494885131F4A85495A017F1B7F5C01FF
1B3F5C5A4A1A1F5AA248491A0FA25A91CE1207A25A5BA2003F1C03A25BA2127F9AC7FCA4
5B12FFB2127F7FA5123FF501C07FA2121FA27F7E1D036E1B807EA26C7F1D076C1D00806C
6480017F1B0E6E1A1E013F1B1C6D6C1A3C6E1A38010F1B786D6C1A706F19F06D6D4E5A6D
7F6D505A6E6C4E5A6E6C180FDA1FFE4EC7FC6E6C183E6E6D5F6E6D5F6E01F04C5A6E6C6C
EE07E0DB3FFE4C5A92260FFF80ED3F806F01F003FEC8FC030101FEEC07FC9227007FFFF0
EBFFF0041F90B612C0040393C9FC040015FC050F14E09426007FFCCAFC627C78F873>67
D<DB3FF815E00203B512C0021F02F81301027F14FE49B7128049D9C007EBC003D90FFEC7
EA3FF0D91FF8913807F807D93FE0EC01FC4948913800FE0F4948153F4890C9EA1F9F4848
EE0FDF49EE07FF484882000F834982121F49177F003F183F5B191F127F190F5B190712FF
A21903A31901A27FA36D1700A2127F7F7F1A006C7E7F7F6C7F806C7F14F86C7F6CEBFF80
15F86CECFF806C15F86DECFF806D15F06D15FF6D16E0010316F86D16FE6D6C81021F16C0
020382DA003F81030781DB007F80040780DC007F7F050F14801700063F13C07213E01807
7213F084841AF8197F193F1AFC191FA2190F00E019FE1907A41903A27EA57E1AFCA27E19
077E1AF86C180FA26D18F0191F6D18E06D173F6D18C06DEF7F806D17FF017E4C13006D6C
5E486C6C4B5AD90FF0ED0FF826FC07FC4B5AD901FF4B5A486C01F0ECFFC091273FFF800F
5B48010F90B548C7FC020315F8020015E048020F14809226007FF8C8FC477C78F858>83
D<001FBE12F8A502F8C7000F01F0C7121F4801806E49020113FC01FCC86C49EC003F491B
1F01E01B07491B03491B0190C91800A2003E1D7CA2003C1D3CA3481D1EA500701D0EA848
1D07A6CA1900B3B3B3B14D7F4D7F057F13FE031FB812F8A568757BF473>I<913803FF80
021F13F891B512FE903A03FC01FF80903A07E0003FE0D91F80EB0FF8013EC76C7E496E7E
01F06E7E48486E7F717E4848153F4982D807A06F7E13FC487E6D6F7E80A2717EA46C90C8
FC6C5A6C5ACAFCA6EE07FF0303B5FC157F913903FFFE07021F138091387FF800903801FF
C0010790C7FCEB1FFCEB3FF0EBFFE0485B485B4890C8FC5B485A485AA2485A1A0E485AA3
12FF5B170FA4171FA26D153F007F163B177B6DDBF1FE131C003F16E16C6C14016C6C9126
03C0FF13386C6CEC0F806C6C6C903A1F007F80706C6D017CECE1E028007FF803F8EB3FFF
011FB500E06D1380010391C7000713009026003FF8EC01FC474D79CB4F>97
D<ED1FFC4AB512C0020714F091391FF00FFC91397F8001FFD901FEC7EA7FC049486E7E49
486E7E49486E7E49486E7E49486E7E4948140101FF824890C91380A24848EE7FC0A2485A
000FEF3FE05BA2001F18F0181F485AA3007F18F8A349160FA212FF90B9FCA301E0CBFCAB
127F7FA3123FA36C7EA219386C7E1978000718707F000318F06C6C17E018016C6DED03C0
6D6C1680013F16076D6CED0F006D6C151E6D6C5D6D6C5D6DB44A5A6D6C6C495ADA3FE0EB
1F80DA0FFE01FEC7FC0203B512F8DA007F13E0DB07FEC8FC3D4D7BCB46>101
D<F103F8F13FFEDB1FF891B5FC92B5903903FC078002079139E007E01F913D1FF00FF81F
803FC0913B3FC003FC3E0002FFC7B45A49486E5A49486E5A49486E48EB1F8049486E6CEB
060097C7FC49486E7E013F82A249486E7EA201FF82A24A80A24884AA6C95C8FCA26E5CA2
017F5EA26D6C4A5AA2011F5E6D6C4A5AA26D6C4A5A6D6C4A5A496C4A5A6E4AC9FC903A0F
3FC003FC903A1E1FF00FF80207B512E0D91C0091CAFC013CEB1FF892CCFCA25BA3137CA4
137EA27F8080EB1FF091B612FE6DEDFFF818FF6D17E06D17F8010017FE010383010F84D9
3FE0C7000114E001FFC9120FD801FC04017F48489338003FF84848171F4848717E484817
07003F727E49170148CBFC737EA200FE85A76C616C616D1701003F616D17036C6C4D5A6C
6C4D5A6C6C4D5A6C6C4D5A6C6C4D5A26007F80DB01FEC7FCD93FE0ED07FCD90FF8ED1FF0
D903FFEDFFC0010001F8011F90C8FC021FB612F802011580DA000F01F0C9FC4A707DCC4F
>103 D<14F8EA03FFB5FCA5C6FC133F131FA2130FB3B0933803FF80041F13F8047F13FE
923A01FC03FF80923A03E0007FE0DB0F80EB1FF0031EC76C7E5D4B6E7E4B6E7E5D14F9DA
FBC06E7E5D14FF92C9FC865CA35CA45CB3B3A8496C4B7FD97FFF030713F0B7D8800FB612
F8A54D787AF758>I<131EEB7F80497E487F487FA66C5B6C5B6D5A011EC7FC90C8FCB3A7
EB01F0EA07FFB5FCA51201EA007F133FA2131FB3B3B3A3497EEBFFFEB612FCA51E727AF1
2A>I<EB01F0EA07FFB5FCA51201EA007F133FA2131FB3B3B3B3B3AC497EEBFFFEB612FE
A51F787AF72A>108 D<D901F0902601FFC0ED0FFED807FF021F01FC92B512E0B5027F01
FF020314F8922601FC0101C090390FE00FFE922803E0003FE090391F0001FFDB0F80D91F
F8017C6D13C04BC7000F4A147FC6023C912707FC01E06E7E013F496E6C48486E7E011F01
70DA01FF496E7E03F0160790260FF1E04CC8FCDAF3C06E019E6F7E4B169C02F717BC92C9
13B802FFDC7FF86F7E4A5FA34A5FA44A5FB3B3A8496C4C6C4B7ED97FFF030301F8031F13
C0B7D88007B600FC013FB612E0A57B4B7ACA86>I<ED07FE92387FFFE00203B512FC9139
0FFC03FF913A3FC0003FC04AC7EA0FE0D901FEEC07F8D903F8EC01FC49486E7E4948157F
49486F7E49486F7E017F8349C96C7E4916070001844848707EA2000784491601000F84A2
4848701380A2003F19C0A349177F007F19E0A412FF1AF0AD007F19E0A26D17FFA2003F19
C0A46C6C4C1380A2000F1900A26C6C4C5AA26C6C4C5A0001606D160F6C606D6C4B5A6D6C
4B5AA26D6C4B5AD907F003FEC7FCD903FCEC03FC6D6C4A5A6D6C6CEB1FF0DA3FE0EB7FC0
91270FFC03FFC8FC0203B512FCDA007F13E0DB07FEC9FC444D7BCB4F>111
D<02F849B47ED803FF021F13F8B5027F13FE923A01FC01FF80923A07E0003FE0031FC76C
7E033EEC0FFCC60278EC03FE013F496E7E90261FF9E06E7FDAFBC0826DB4486F7E92C96C
7E737E5C4A707E864A160786851B80A2851BC0A2851BE0A5F27FF0AEF2FFE0A54F13C0A3
4F1380A21B0061626E160F626E161F626E4C5A4F5A6F5EDAFBC015FFDAF9E04A5BDAF8F0
4A48C7FC03784A5A6F4A5A031FEC3FF06F6CEBFFC0922603F80790C8FC0300B512FC043F
13E0DC07FEC9FC93CBFCB3A7497EEB7FFFB77EA54C6C7BCA58>I<D903E0EB1FE0D80FFF
ECFFFCB501037F923907E01F8092391F807FC092383E00FF4B4813E000011478D8007F13
F090383FE1E015C0EB1FE39126E7800013C0EF7F8092C7EA3F0002EF91C7FC14EE14FE5C
A45CA55CB3B3A480133F90B5FCB712C0A5334B7ACA3D>114 D<1407A85CA65CA35CA35C
A25CA25BA25B5B5B5B5B5B48B712FE120FB8FCA3D8000190C9FCB3B3A2EF01C0B0EF0380
6D7FA3027FEC0700815F6E6C130E021F141E6F131C6E6C5B6E6C13F8913901FF01F09139
007FFFC0031F5BDB03FCC7FC326B7EE93D>116 D E
%EndDVIPSBitmapFont
end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 1718 1281 a Fo(The)52 b(Stratego)g(Compiler)2605
2172 y Fn(Eelco)45 b(Visser)p 4 setlinewidth np 2854
2942 a 2444 3651 li st np 2854 2942 a 3263 3651 li st
np 3263 3651 a 2444 3651 li st np 2854 2942 a 2854 3415
li st 0.000 setgray np 2884 3374 a 2854 3415 li 2823
3374 li closepath fil 0 setgray np 2884 3374 a 2854 3415
li 2823 3374 li closepath st np 2854 3415 a 2717 3651
li st np 2854 3415 a 2990 3651 li st np 2717 3651 a 2581
3415 li st np 2854 2942 a 2581 3415 li st 0.000 setgray
np 2628 3395 a 2581 3415 li 2575 3364 li closepath fil
0 setgray np 2628 3395 a 2581 3415 li 2575 3364 li closepath
st np 2990 3651 a 3127 3415 li st np 2854 2942 a 3127
3415 li st 0.000 setgray np 3133 3364 a 3127 3415 li
3079 3395 li closepath fil 0 setgray np 3133 3364 a 3127
3415 li 3079 3395 li closepath st 2438 3792 a Fm(STRA)-13
b(TEGO)p np 2404 3835 a 3304 3835 li 3304 2902 li 2404
2902 li closepath st 2329 4136 a Fl(F)-7 b(or)27 b(Stratego)f(v)n
(ersion)g(0.4.15)2155 4882 y Fk(www.stratego-language.org)1067
5115 y(Departmen)m(t)32 b(of)g(Information)f(and)h(Computing)g
(Sciences)2453 5231 y(Univ)m(ersiteit)g(Utrec)m(h)m(t)2718
5463 y(June)h(25,)f(2000)p eop
%%Page: 1 2
1 1 bop 440 1674 a Fl(Cop)n(yrigh)n(t)853 1671 y(c)830
1674 y Fj(\015)28 b Fl(1998,)d(1999,)h(2000)g(Eelco)h(Visser)440
1843 y(P)n(ermission)f(is)h(gran)n(ted)g(to)g(mak)n(e)g(and)g
(distribute)h(v)n(erbatim)f(copies)g(of)g(this)h(man)n(ual)440
1943 y(pro)n(vided)f(the)h(cop)n(yrigh)n(t)d(notice)j(and)f(this)h(p)r
(ermission)f(notice)h(are)e(preserv)n(ed)g(on)h(all)440
2042 y(copies.)440 2212 y(P)n(ermission)f(is)h(gran)n(ted)g(to)g(cop)n
(y)g(and)g(distribute)h(mo)r(di\014ed)g(v)n(ersions)e(of)h(this)h(man)n
(ual)440 2311 y(under)f(the)h(conditions)g(for)f(v)n(erbatim)f(cop)n
(ying,)h(pro)n(vided)f(that)i(they)g(are)f(mark)n(ed)440
2411 y(clearly)f(as)h(mo)r(di\014ed)h(v)n(ersions,)e(that)i(the)g
(author's)f(names)g(and)g(title)i(are)d(unc)n(hanged)440
2510 y(\(though)i(subtitles)g(and)f(additional)g(authors')g(names)g(ma)
n(y)g(b)r(e)h(added\),)g(and)f(that)440 2610 y(other)g(clearly)f(mark)n
(ed)h(sections)g(held)h(under)f(separate)f(cop)n(yrigh)n(t)g(are)h
(repro)r(duced)440 2710 y(under)g(the)h(conditions)g(giv)n(en)e(within)
j(them,)f(and)f(that)h(the)g(en)n(tire)f(resulting)g(deriv)n(ed)440
2809 y(w)n(ork)d(is)i(distributed)g(under)g(the)g(terms)f(of)h(a)f(p)r
(ermission)g(notice)h(iden)n(tical)f(to)h(this)g(one.)440
2979 y(P)n(ermission)g(is)h(gran)n(ted)g(to)g(cop)n(y)g(and)g
(distribute)h(translations)e(of)i(this)g(man)n(ual)f(in)n(to)440
3078 y(another)g(language,)f(under)h(the)h(ab)r(o)n(v)n(e)e(conditions)
h(for)h(mo)r(di\014ed)g(v)n(ersions,)d(except)440 3178
y(that)j(this)g(p)r(ermission)f(notice)g(ma)n(y)g(b)r(e)h(stated)g(in)f
(a)h(translation)e(appro)n(v)n(ed)g(b)n(y)h(the)440 3278
y(F)-7 b(ree)27 b(Soft)n(w)n(are)g(F)-7 b(oundation.)440
3683 y(Address:)440 3783 y(Departmen)n(t)28 b(of)f(Computer)g(Science)
440 3882 y(Univ)n(ersiteit)g(Utrec)n(h)n(t)440 3982 y(P)-7
b(.O.Bo)n(x)26 b(80089)440 4082 y(3508)g(TB)h(Utrec)n(h)n(t)440
4181 y(email:)37 b(visser@acm.org)440 4281 y(h)n(ttp://www.cs.uu.nl/)p
Fj(\030)p Fl(visser/)p eop
%%Page: 1 3
1 2 bop 1211 1318 a Fn(The)44 b(Stratego)f(Compiler)1560
1704 y Fi(Eelco)38 b(Visser)1623 2039 y Fl(June)27 b(25,)g(2000)1671
2374 y Fh(Summary)648 2627 y Fl(This)20 b(rep)r(ort)g(do)r(cumen)n(ts)h
(the)g(sp)r(eci\014cation)g(of)g(the)g(compiler)f(for)g(the)i(strat-)
648 2726 y(egy)k(language)g(Stratego.)36 b(The)28 b(compiler)f(is)g(sp)
r(eci\014ed)h(in)g(Stratego)e(itself.)p eop
%%Page: 1 4
1 3 bop 440 531 a Fh(CONTENTS)440 686 y Fl(A)28 b(BOOTSTRAPPED)e
(COMPILER)g(F)n(OR)h(STRA)-7 b(TEGIES)769 b(3)523 815
y Fh(In)m(tro)s(duction)2214 b Fl(4)523 945 y Fh(The)32
b(Language)2150 b Fl(6)631 1074 y Fg(system)32 b(s)2278
b Fl(7)631 1204 y Fg(stra)-6 b(tego)2249 b Fl(9)631 1333
y Fg(librar)-6 b(y)2278 b Fl(11)535 1463 y Fh(The)33
b(Compiler)2102 b Fl(12)631 1592 y Fg(ar)n(chitecture)2026
b Fl(13)631 1722 y Fg(r)n(un-time)32 b(system)1911 b
Fl(15)535 1851 y Fh(Examples)2284 b Fl(16)631 1981 y
Fg(example)32 b(1:)40 b(pipelines)1734 b Fl(17)631 2110
y Fg(example)32 b(2:)40 b(desugaring)1630 b Fl(18)631
2240 y Fg(example)32 b(3:)40 b(compila)-6 b(tion)1599
b Fl(19)440 2584 y Ff(BASICS)2340 b(20)440 2714 y Fh(ABSTRA)m(CT)33
b(SYNT)-8 b(AX)1811 b Fl(21)631 2843 y Fg(terms)2345
b Fl(21)631 2973 y Fg(stra)-6 b(tegies)2151 b Fl(22)631
3102 y Fg(signa)-6 b(tures)2144 b Fl(24)631 3232 y Fg(synt)-6
b(a)n(ctic)32 b(sugar)1911 b Fl(25)631 3361 y Fg(l0)2501
b Fl(27)440 3491 y Fh(P)-8 b(ARSER)2392 b Fl(29)535 3620
y Fh(Lexical)33 b(Analyzer)1987 b Fl(29)535 3750 y Fh(P)m(arser)2418
b Fl(36)535 3879 y Fh(Mo)s(dule)31 b(Flattening)1904
b Fl(45)631 4009 y Fe(pack-stratego)2018 b Fl(45)440
4138 y Fh(LIBRAR)-8 b(Y)2340 b Fl(47)631 4268 y Fg(librar)-6
b(y)31 b(f)n(or)h(stra)-6 b(tegies)1631 b Fl(48)440 4612
y Ff(COMPILA)-9 b(TION)1927 b(51)440 4742 y Fh(FR)m(ONTEND)2228
b Fl(52)631 4871 y Fe(frontend)2238 b Fl(53)631 5001
y Fe(normalize-spec)1974 b Fl(54)631 5130 y Fe(use-def)2282
b Fl(57)631 5260 y Fg(specifica)-6 b(tion)33 b(to)e(list)g(of)h
(definitions)1105 b Fl(60)631 5389 y Fg(desugaring)2120
b Fl(64)1851 5662 y(1)p eop
%%Page: 2 5
2 4 bop 631 531 a Fg(needed)32 b(definitions)1806 b Fl(68)631
661 y Fg(inlining)2266 b Fl(71)440 790 y Fh(OPTIMIZER)2222
b Fl(74)631 920 y Fg(optimizer)2192 b Fl(74)631 1049
y Fg(simplifica)-6 b(tion)2010 b Fl(75)631 1179 y Fg(distribution)2074
b Fl(77)631 1308 y Fg(optimiza)-6 b(tion3)2019 b Fl(82)631
1438 y Fg(optimiza)-6 b(tion)2065 b Fl(83)440 1567 y
Fh(MA)-8 b(TCHING)32 b(A)m(UTOMA)-8 b(T)g(A)1633 b Fl(86)631
1697 y Fe(automaton)2194 b Fl(86)631 1826 y Fg(ma)-6
b(tching-tree)1983 b Fl(91)440 1956 y Fh(BA)m(CKEND)2289
b Fl(97)535 2086 y Fh(Abstract)34 b(Mac)m(hine)1935 b
Fl(97)631 2215 y Fg(instr)n(uction)31 b(simplifica)-6
b(tion)1490 b Fl(98)535 2345 y Fh(Compilation)2129 b
Fl(102)631 2474 y Fg(ba)n(ckend)2201 b Fl(103)631 2604
y Fg(compiler)2175 b Fl(104)631 2733 y Fg(special)32
b(p)-6 b(a)g(tterns)1851 b Fl(113)535 2863 y Fh(P)m(ostpro)s(ccesing)
2023 b Fl(117)631 2992 y Fg(postpr)n(ocess)2045 b Fl(118)440
3122 y Fh(OTHER)31 b(OPERA)-8 b(TIONS)1723 b Fl(119)535
3251 y Fh(Exp)s(erimen)m(ts)2116 b Fl(119)440 3381 y
Fh(COMPILER)2215 b Fl(120)535 3510 y Fh(Glue)2446 b Fl(121)631
3640 y Fe(sc)p Fg(:)40 b(stra)-6 b(tego)32 b(compiler)1605
b Fl(121)440 3984 y Ff(R)m(UN-TIME)37 b(SYSTEM)1600 b(126)440
4114 y Fh(R)m(UN-TIME)32 b(SYSTEM)1805 b Fl(127)535 4243
y Fh(stratego.h)2228 b Fl(128)535 4373 y Fh(aterm-extension.h)1892
b Fl(129)535 4502 y Fh(debug.h)2314 b Fl(131)535 4632
y Fh(util.h)2421 b Fl(132)535 4761 y Fh(options.h)2261
b Fl(134)535 4891 y Fh(svm.h)2396 b Fl(135)535 5020 y
Fh(stratego.c)2239 b Fl(143)631 5150 y Fg(bibliography)2005
b Fl(150)1851 5662 y(2)p eop
%%Page: 3 6
3 5 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)p 440 531 2865 4 v 440 758
a(Stratego)d(is)i(a)f(language)f(for)h(the)h(sp)r(eci\014cation)f(of)h
(program)e(transformation)g(based)h(on)440 858 y(rewriting)34
b(strategies.)57 b(The)36 b(Stratego)d(compiler)h(is)h(based)g(on)f
(program)f(transforma-)440 958 y(tion;)k(it)e(transforms)e(a)g
(high-lev)n(el)g(Stratego)g(sp)r(eci\014cation)h(via)f(sev)n(eral)g(in)
n(termediate)440 1057 y(represen)n(tations)28 b(to)j(C.)f(Sev)n(eral)f
(optimizations)h(are)f(p)r(erformed)h(on)g(the)h(in)n(termediate)440
1157 y(represen)n(tations.)52 b(The)34 b(compiler)e(is)i(b)r(o)r
(otstrapp)r(ed,)g(i.e.,)h(it)f(is)f(sp)r(eci\014ed)h(in)g(Stratego)440
1256 y(itself.)j(In)27 b(this)g(pap)r(er)f(w)n(e)g(giv)n(e)f(an)i(o)n
(v)n(erview)d(of)j(the)g(Stratego)e(compiler:)35 b(arc)n(hitecture;)440
1356 y(issues)24 b(in)h(the)g(compilation)f(of)g(strategies;)g(some)g
(high-ligh)n(ts)g(of)g(the)h(sp)r(eci\014cation;)h(and)440
1456 y(exp)r(erience)h(with)h(using)f(strategies)g(for)g(writing)g
(program)e(transformations.)p 440 1575 V 1851 5662 a(3)p
eop
%%Page: 4 7
4 6 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 299 y(Section:)37 b(In)n(tro)r
(duction)440 531 y(One)31 b(of)h(the)g(shortcomings)e(of)i(implemen)n
(ting)g(algebraic)e(sp)r(eci\014cations)h(b)n(y)g(means)g(of)440
631 y(term)i(rewriting)e(is)i(the)g(necessit)n(y)f(to)h(enco)r(de)f
(the)h(strategy)f(to)g(apply)h(`equations')f(b)n(y)440
731 y(means)g(of)g(functions.)52 b(This)33 b(obscures)e(the)i
(equational)e(nature)h(of)h(sp)r(eci\014cations)f(and)440
830 y(hamp)r(ers)25 b(their)h(mo)r(dularit)n(y)f(b)r(ecause)g(rules)g
(b)r(ecome)g(part)g(of)h(one)f(particular)g(strategy)-7
b(.)440 930 y(This)34 b(observ)-5 b(ation)32 b(w)n(as)h(done)g(in)h
(sev)n(eral)e(pro)5 b(jects)33 b(that)h(used)g(ASF+SDF)g([4])g(to)g
(de-)440 1029 y(\014ne)d(language)d(pro)r(cessors,)h(in)i(particular)e
(program)f(transformations.)44 b(F)-7 b(or)30 b(example:)440
1129 y(normalization)22 b(of)h(b)r(o)n(x)g(expressions)e(for)i(prett)n
(y-prin)n(ting)f([3];)i(normalization)e(of)h(syn)n(tax)440
1229 y(de\014nitions)28 b([9)o(];)g(transformation)e(of)i(C++)e
(programs)g([5)o(].)440 1398 y(Stratego)38 b(is)g(a)h(language)e(for)h
(the)h(sp)r(eci\014cation)g(of)f(program)f(transformations)g(that)440
1498 y(o)n(v)n(ercomes)26 b(this)i(shortcoming)f(b)n(y)g(pro)n(viding)g
(user-de\014nable)g(rewriting)g(strategies.)37 b(A)440
1597 y(rewriting)i(strategy)g(is)i(an)f(expression)f(in)i(a)e(language)
g(of)i(strategy)e(op)r(erators)f(that)440 1697 y(com)n(bine)27
b(rules)g(\(usually)g(via)g(their)h(lab)r(els\))f(in)h(a)f(program)e
(that)j(tra)n(v)n(erses)d(a)i(term)h(and)440 1797 y(applies)f(the)h
(rules.)440 1966 y(The)35 b(preliminary)f(ideas)h(for)f(the)i(strategy)
d(op)r(erators)g(in)j(Stratego,)f(inspired)g(b)n(y)g(the)440
2066 y(sp)r(eci\014cation)18 b(formalism)g(ELAN)g([2],)i(include)f(op)r
(erators)d(for)i(sequen)n(tial)g(non-deterministic)440
2165 y(programming,)i(data-t)n(yp)r(e)g(sp)r(eci\014c)h(and)g(generic)e
(term)i(tra)n(v)n(ersal.)32 b(In)21 b([7])g(an)f(implemen-)440
2265 y(tation)33 b(of)g(these)g(op)r(erators)f(in)h(ASF+SDF)h(is)f
(describ)r(ed.)54 b(That)33 b(in)n(terpretiv)n(e)f(imple-)440
2364 y(men)n(tation)22 b(st)n(yle)f(can)h(b)r(e)h(used)f(to)g(write)f
(strategies)g(for)h(ASF+SDF)h(equations)e(and)h(can)440
2464 y(b)r(e)32 b(applied)g(in)g(other)f(settings)g(as)g(w)n(ell;)j
(the)e(traditional)f(w)n(a)n(y)f(of)i(de\014ning)f(a)h(strategy)440
2564 y(with)c(functions)h(is)f(replaced)f(b)n(y)g(a)h(st)n(yle)f(in)i
(whic)n(h)f(an)f(ev)-5 b(aluation)28 b(function)g(in)n(terprets)440
2663 y(a)e(strategy)e(expression.)35 b(This)26 b(allo)n(ws)f(the)h
(concise)f(sp)r(eci\014cation)h(of)g(v)-5 b(arious)25
b(strategies)440 2763 y(and)i(the)h(use)g(of)f(one)h(rule)f(with)h(man)
n(y)f(di\013eren)n(t)h(strategies.)440 2932 y(These)g(preliminary)g
(ideas)f(are)h(further)g(dev)n(elop)r(ed)g(in)h([11)o(,)g(12)o(].)39
b(Rewrite)28 b(rules)g(are)g(no)440 3032 y(longer)i(primitiv)n(es,)i
(but)h(are)d(brok)n(en)g(do)n(wn)h(in)n(to)h(op)r(erations)e(for)h
(matc)n(hing,)h(building)440 3132 y(and)e(v)-5 b(ariable)28
b(scop)r(e.)43 b(System)30 b(S,)g(the)g(resulting)f(set)h(of)f
(strategy)g(op)r(erators,)f(pro)n(vides)440 3231 y(the)g(primitiv)n(e)g
(op)r(erations)e(for)h(de\014nining)h(b)r(oth)g(rewrite)f(rules)g(and)h
(strategies)e(for)h(ap-)440 3331 y(plying)36 b(them.)62
b(A)36 b(Stratego)f(sp)r(eci\014cation)h(pro)n(vides)e(syn)n(tactic)h
(abstractions)g(on)g(top)440 3430 y(of)i(System)f(S.)h(F)-7
b(or)36 b(example,)j(a)d(rewrite)g(rule)h(is)f(an)g(abstraction)g(for)g
(a)g(sequence)g(of)440 3530 y(op)r(erations)g(that)h(\014rst)f(matc)n
(hes)h(the)g(sub)5 b(ject)37 b(term)g(against)e(a)i(pattern,)i(then)e
(satis-)440 3630 y(\014es)i(a)g(condition)h(and)f(\014nally)g(builds)h
(the)g(instan)n(tiation)f(of)g(a)g(term)h(pattern.)72
b(The)440 3729 y(iden)n(ti\014cation)31 b(of)g(this)h(in)n(termediate)f
(lev)n(el)g(allo)n(ws)e(the)j(de\014nition)g(of)f(v)n(ery)f(expressiv)n
(e)440 3829 y(abstractions)c(suc)n(h)h(as)g(con)n(textual)g(rules)g
(and)h(o)n(v)n(erla)n(ys)c([10)o(].)440 3998 y(The)36
b(Stratego)e(compiler)i(\014rst)f(translates)g(a)g(high-lev)n(el)g
(Stratego)g(sp)r(eci\014cation)g(to)h(a)440 4098 y(System)h(S)h
(expresssion,)g(whic)n(h)f(is)g(then)h(translated)e(to)h(a)g(list)g(of)
h(abstract)e(mac)n(hine)440 4198 y(instructions)25 b(that)g(are)f
(implemen)n(ted)i(in)f(C.)h(The)f(\014rst)g(compiler)f(w)n(as)g
(written)i(in)f(SML.)440 4297 y(Based)39 b(on)g(the)h(\014rst)g(exp)r
(erience)f(with)h(that)g(compiler)f(an)g(impro)n(v)n(ed)f(compiler)h(w)
n(as)440 4397 y(sp)r(eci\014ed)21 b(in)h(Stratego)e(itself)h(and)g(b)r
(o)r(otstrapp)r(ed.)35 b(Bo)r(otstrapping)19 b(pro)n(v)n(es)h(to)h(b)r
(e)g(a)g(go)r(o)r(d)440 4496 y(approac)n(h)33 b(for)h(dev)n(eloping)g
(the)h(compiler)f(and)h(the)g(language)e(b)r(ecause)h(it)h(pro)n(vides)
f(a)440 4596 y(realistic)23 b(case)g(study)i(and)e(a)h(go)r(o)r(d)f
(test)i(case)e(for)g(the)i(compiler.)35 b(The)24 b(compiler)f(is)h(b)r
(eing)440 4696 y(used)38 b(in)g(sev)n(eral)d(program)h(transformation)g
(case)h(studies,)j(suc)n(h)d(as)g(a)h(sp)r(eci\014ciation)440
4795 y(of)33 b(an)f(optimizer)g(for)g(a)g(functional)h(language)e([12)o
(],)j(a)e(deforestation)f(algorithm)h(for)g(a)440 4895
y(functional)g(language)e([6)o(])i(and)f(a)h(transformation)d(to)r(ol)j
(to)f(sp)r(eed)h(up)g(C++)f(programs)440 4995 y(for)c(high-p)r
(erformance)f(computing.)440 5164 y(In)39 b(this)g(abstract)f(w)n(e)g
(giv)n(e)g(an)g(o)n(v)n(erview)f(of)h(System)h(S)g(and)g(Stratego,)h
(presen)n(t)e(the)440 5264 y(arc)n(hitecture)33 b(of)h(the)h(compiler)e
(and)h(sho)n(w)g(some)f(examples)h(of)g(the)h(use)f(of)g(strategies)440
5363 y(in)f(the)f(compiler.)51 b(In)32 b(the)h(full)g(pap)r(er)e(w)n(e)
h(will)h(further)f(elab)r(orate)f(the)i(application)e(of)1851
5662 y(4)p eop
%%Page: 5 8
5 7 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 299 y(Section:)37 b(In)n(tro)r
(duction)440 531 y(strategies)28 b(in)i(the)h(compiler)e(and)g(giv)n(e)
g(a)h(\014rst)f(ev)-5 b(aluation)29 b(of)h(the)g(use)g(of)g(strategies)
e(in)440 631 y(program)e(transformation.)1851 5662 y(5)p
eop
%%Page: 6 9
6 8 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y(This)h(section)f(in)n(tro)r(duces)g(System)h(S,)g
(a)g(calculus)f(for)g(the)i(de\014nition)f(of)g(tree)f(transfor-)440
631 y(mations,)23 b(and)g(Stratego,)f(a)g(sp)r(eci\014cation)h
(language)e(pro)n(viding)g(syn)n(tactic)h(abstractions)440
731 y(for)27 b(System)h(S)g(expressions.)35 b(F)-7 b(or)27
b(an)g(op)r(erational)f(seman)n(tics)h(see)g([11)o(,)h(12)o(].)1851
5662 y(6)p eop
%%Page: 7 10
7 9 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)p 440 452 2865 4 v 440 1386 4 934 v 468 522
a Fd(module)41 b(traversals)468 614 y(imports)g(lists)468
705 y(strategies)547 796 y(try\(s\))158 b(=)39 b(s)h(<+)g(id)549
b(map\(s\))158 b(=)40 b(rec)g(x\(Nil)g(+)g(Cons\(s,)g(x\)\))547
888 y(repeat\(s\))h(=)e(rec)h(x\(try\(s;)h(x\)\))197
b(list\(s\))119 b(=)40 b(rec)g(x\(Nil)g(+)g(Cons\(s,)g(x\)\))547
979 y(topdown)119 b(=)39 b(rec)h(x\(s;)g(all\(x\)\))198
b(alltd\(s\))80 b(=)40 b(rec)g(x\(s)g(<+)f(all\(x\)\))547
1070 y(bottomup)80 b(=)39 b(rec)h(x\(all\(x\);)i(s\))196
b(oncetd\(s\))41 b(=)f(rec)g(x\(s)g(<+)f(one\(x\)\))547
1161 y(downup\(s\))i(=)e(rec)h(x\(s;)g(all\(x\);)h(s\))79
b(sometd\(s\))41 b(=)f(rec)g(x\(s)g(<+)f(some\(x\)\))547
1253 y(onebu\(s\))80 b(=)39 b(rec)h(x\(one\(x\))h(<+)f(s\))118
b(somebu\(s\))41 b(=)f(rec)g(x\(some\(x\))h(<+)f(s\))547
1344 y(downup2\(s1,)h(s2\))f(=)g(rec)g(x\(s1;)g(all\(x\);)h(s2\))p
3301 1386 V 440 1389 2865 4 v 671 1538 a Fl(Figure)27
b(1:)36 b(Sp)r(eci\014cation)28 b(of)f(sev)n(eral)f(generic)h(term)g
(tra)n(v)n(ersal)e(strategies.)440 1803 y Fh(SYSTEM)32
b(S)440 1997 y Fl(System)e(S)f(is)h(a)f(hierarc)n(h)n(y)e(of)j(op)r
(erators)d(for)i(expressing)f(term)i(transformations.)40
b(The)440 2097 y(\014rst)26 b(lev)n(el)g(pro)n(vides)f(con)n(trol)g
(constructs)h(for)g(sequen)n(tial)g(non-deterministic)g(program-)440
2197 y(ming,)j(the)g(second)f(lev)n(el)g(in)n(tro)r(duces)h(com)n
(binators)e(for)h(term)g(tra)n(v)n(ersal)e(and)j(the)g(third)440
2296 y(lev)n(el)18 b(de\014nes)h(op)r(erators)e(for)h(binding)h(v)-5
b(ariables)17 b(and)i(for)f(matc)n(hing)g(and)h(building)g(terms.)440
2466 y(First-order)26 b(terms)h(are)g(expressions)f(o)n(v)n(er)f(the)j
(grammar)789 2701 y Fe(t)43 b(:=)g(x)g(|)g(C\(t1,...,tn\))c(|)k
([t1,...,tn])c(|)k(\(t1,...,tn\))440 2937 y Fl(where)30
b Fe(x)g Fl(ranges)e(o)n(v)n(er)h(v)-5 b(ariables)29
b(and)h Fe(C)g Fl(o)n(v)n(er)e(constructors.)43 b(The)31
b(arit)n(y)e(and)h(t)n(yp)r(es)g(of)440 3037 y(constructors)23
b(are)h(declared)g(in)h(signatures.)35 b(The)25 b(notation)f
Fe([t1,...,tn])d Fl(abbreviates)440 3136 y(the)h(list)f
Fe(Cons\(t1,...,Cons)o(\(t)o(n,N)o(il)o(\)\))p Fl(.)28
b(T)-7 b(ransformations)19 b(in)j(System)f(S)g(are)f(applied)440
3236 y(to)27 b(ground)g(terms,)g(i.e.,)h(terms)g(withouth)g(v)-5
b(ariables.)440 3405 y Fg(level)31 b(1:)41 b(sequential)31
b(non-deterministic)h(pr)n(ogramming)440 3575 y Fl(Strategies)h(are)f
(programs)g(that)i(attempt)g(to)f(transform)g(ground)g(terms)g(in)n(to)
g(ground)440 3674 y(terms,)24 b(at)e(whic)n(h)h(they)g(ma)n(y)f
(succeed)h(or)f(fail.)35 b(In)23 b(case)g(of)f(success)g(the)i(result)e
(of)h(suc)n(h)g(an)440 3774 y(attempt)31 b(is)f(a)g(transformed)e
(term.)45 b(In)30 b(case)f(of)i(failure)e(the)i(result)f(is)g(an)f
(indication)h(of)440 3874 y(the)c(failure.)36 b(Strategies)25
b(can)h(b)r(e)g(com)n(bined)f(in)n(to)h(new)g(strategies)e(b)n(y)i
(means)g(of)f(the)i(fol-)440 3973 y(lo)n(wing)j(op)r(erators:)41
b(The)31 b Fc(identity)39 b Fl(strategy)29 b Fe(id)h
Fl(lea)n(v)n(es)f(the)j(sub)5 b(ject)30 b(term)h(unc)n(hanged)440
4073 y(and)36 b(alw)n(a)n(ys)f(succeeds.)62 b(The)36
b Fc(failur)l(e)44 b Fl(strategy)35 b Fe(fail)g Fl(alw)n(a)n(ys)f
(fails.)63 b(The)36 b Fc(se)l(quential)440 4173 y(c)l(omp)l(osition)g
Fe(s1;)42 b(s2)27 b Fl(\014rst)h(attempts)g(to)g(apply)f
Fe(s1)g Fl(to)h(the)g(sub)5 b(ject)28 b(term)g(and,)g(if)g(that)440
4272 y(succeeds,)35 b(applies)f Fe(s2)g Fl(to)g(the)h(result.)56
b(The)35 b Fc(non-deterministic)h(choic)l(e)42 b Fe(s1)h(+)g(s2)34
b Fl(at-)440 4372 y(tempts)24 b(to)e(apply)h(either)g
Fe(s1)f Fl(or)g Fe(s2)p Fl(.)35 b(It)23 b(succeeds)f(if)i(either)e
(succeeds)h(and)f(it)i(fails)e(if)i(b)r(oth)440 4471
y(fail;)37 b(the)d(order)e(in)i(whic)n(h)f Fe(s1)g Fl(and)g
Fe(s2)g Fl(are)f(tried)i(is)f(unsp)r(eci\014ed.)56 b(The)33
b Fc(deterministic)440 4571 y(choic)l(e)e Fe(s1)43 b(<+)g(s2)22
b Fl(attempts)i(to)f(apply)g(either)g Fe(s1)g Fl(or)f
Fe(s2)p Fl(,)i(in)f(that)h(order.)34 b(The)23 b Fc(r)l(e)l(cursive)440
4671 y(closur)l(e)29 b Fe(rec)42 b(x\(s\))20 b Fl(attempts)j(to)e
(apply)h Fe(s)p Fl(,)h(where)e(at)h(eac)n(h)f(o)r(ccurence)h(of)f(the)i
(v)-5 b(ariable)21 b Fe(x)440 4770 y Fl(in)j Fe(s)p Fl(,)g(the)g
(strategy)e Fe(rec)43 b(x\(s\))22 b Fl(is)h(applied.)36
b(The)23 b Fc(test)31 b Fl(strategy)22 b Fe(test\(s\))f
Fl(tries)i(to)h(apply)440 4870 y Fe(s)p Fl(.)35 b(It)23
b(succeeds)f(if)h Fe(s)f Fl(succeeds,)h(and)f(rev)n(erts)f(the)i(sub)5
b(ject)23 b(term)g(to)f(the)h(original)e(term.)35 b(It)440
4970 y(fails)24 b(if)h Fe(s)f Fl(fails.)35 b(The)25 b
Fc(ne)l(gation)31 b Fe(not\(s\))22 b Fl(succeeds)i(\(with)h(the)f(iden)
n(tit)n(y)h(transformation\))440 5069 y(if)30 b Fe(s)f
Fl(fails)g(and)g(fails)g(if)h Fe(s)f Fl(succeeds.)41
b(Tw)n(o)28 b(examples)h(of)g(strategies)f(de\014ned)i(with)f(these)440
5169 y(op)r(erators)d(are)g Fe(try)h Fl(and)g Fe(repeat)e
Fl(in)j(Figure)f(1.)440 5338 y Fg(level)k(2:)41 b(term)31
b(tra)-7 b(versal)1851 5662 y Fl(7)p eop
%%Page: 8 11
8 10 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y(The)d(Lev)n(el)g(1)g(constructs)g(apply)g
(transformations)e(to)i(the)h(ro)r(ot)f(of)g(a)g(term.)36
b(In)25 b(order)f(to)440 631 y(apply)i(transformations)f(throughout)h
(a)g(term)h(it)g(is)f(necessary)f(to)i(tra)n(v)n(erse)d(it.)37
b(F)-7 b(or)26 b(this)440 731 y(purp)r(ose,)f(System)h(S)g(pro)n(vides)
e(the)i(follo)n(wing)f(op)r(erators:)33 b(F)-7 b(or)25
b(eac)n(h)g Fe(n)p Fl(-ary)f(constructor)440 830 y Fe(C)29
b Fl(the)g Fc(c)l(ongruenc)l(e)36 b Fl(op)r(erator)27
b Fe(C\(s1,...,sn\))d Fl(is)29 b(de\014ned.)42 b(It)29
b(applies)g(to)g(terms)g(of)g(the)440 930 y(form)f Fe(C\(t1,...,tn\))23
b Fl(and)29 b(applies)e Fe(si)h Fl(to)g Fe(ti)g Fl(for)g
Fe(1)43 b(<=)f(i)i(<=)e(n)p Fl(.)d(An)29 b(example)f(of)g(the)440
1029 y(use)34 b(of)h(congruences)e(is)h(the)h(op)r(erator)e
Fe(map\(s\))f Fl(in)j(Figure)f(1)g(that)g(applies)h Fe(s)f
Fl(to)g(eac)n(h)440 1129 y(elemen)n(t)28 b(of)f(a)g(list.)440
1298 y(Congruences)20 b(can)h(b)r(e)h(used)g(to)f(de\014ne)h(tra)n(v)n
(ersals)d(o)n(v)n(er)g(sp)r(eci\014c)j(data)f(structures.)34
b(Sp)r(ec-)440 1398 y(i\014cation)26 b(of)h(generic)f(tra)n(v)n(ersals)
e(\(e.g.,)j(pre-)f(or)g(p)r(ost-order)f(o)n(v)n(er)g(arbitrary)g
(structures\))440 1498 y(requires)i(more)h(generic)g(op)r(erators.)38
b(The)29 b(op)r(erator)e Fe(all\(s\))f Fl(applies)i Fe(s)h
Fl(to)f(all)h(c)n(hildren)440 1597 y(of)22 b(a)f(constructor)f
(application)h Fe(C\(t1,...,tn\))p Fl(.)30 b(In)21 b(particular,)h
Fe(all\(s\))d Fl(is)i(the)h(iden)n(tit)n(y)440 1697 y(on)28
b(constan)n(ts)f(\(constructor)g(applications)g(without)i(c)n
(hildren\).)38 b(The)28 b(strategy)f Fe(one\(s\))440
1797 y Fl(applies)e Fe(s)h Fl(to)f(one)g(c)n(hild)h(of)g(a)f
(constructor)f(application)h Fe(C\(t1,...,tn\))p Fl(;)d(it)k(is)f
(precisely)440 1896 y(the)34 b(failure)f(strategy)e(on)i(constan)n(ts.)
53 b(The)34 b(strategy)d Fe(some\(s\))g Fl(applies)i
Fe(s)g Fl(to)g(some)f(of)440 1996 y(the)25 b(c)n(hildren)e(of)h(a)g
(constructor)f(application)g Fe(C\(t1,...,tn\))p Fl(,)d(i.e.,)25
b(to)f(at)g(least)g(one)g(and)440 2095 y(as)j(man)n(y)g(as)g(p)r
(ossible.)36 b(Lik)n(e)27 b Fe(one\(s\))p Fl(,)f Fe(some\(s\))e
Fl(fails)k(on)f(constan)n(ts.)440 2265 y(Figure)42 b(1)g(de\014nes)g(v)
-5 b(arious)41 b(tra)n(v)n(ersals)e(based)j(on)g(these)h(op)r(erators.)
79 b(F)-7 b(or)42 b(instance,)440 2364 y Fe(oncetd\(s\))32
b Fl(tries)j(to)g(\014nd)h Fc(one)42 b Fl(application)35
b(of)h Fe(s)f Fl(somewhere)f(in)i(the)g(term)f(starting)440
2464 y(at)g(the)g(ro)r(ot)f(w)n(orking)f(its)i(w)n(a)n(y)f(do)n(wn;)k
Fe(s)43 b(<+)g(one\(x\))32 b Fl(\014rst)j(attempts)g(to)g(apply)f
Fe(s)p Fl(,)j(if)440 2564 y(that)25 b(fails)g(an)g(application)f(of)h
Fe(s)g Fl(is)g(\(recursiv)n(ely\))e(attempted)j(at)f(one)f(of)h(the)h
(c)n(hildren)e(of)440 2663 y(the)i(sub)5 b(ject)26 b(term.)36
b(If)26 b(no)g(application)f(is)h(found)g(the)g(tra)n(v)n(ersal)d
(fails.)36 b(Compare)24 b(this)i(to)440 2763 y(the)32
b(tra)n(v)n(ersal)d Fe(alltd\(s\))p Fl(,)g(whic)n(h)j(\014nds)f
Fc(al)t(l)42 b Fl(outermost)31 b(applications)f(of)i
Fe(s)f Fl(and)g(nev)n(er)440 2863 y(fails.)440 3032 y
Fg(level)g(3:)41 b(ma)-6 b(tch,)31 b(build)g(and)g(v)-7
b(ariable)31 b(binding)440 3201 y Fl(The)h(op)r(erators)d(in)n(tro)r
(duced)j(th)n(us)f(far)g(are)g(useful)h(for)f(rep)r(eatedly)g(applying)
g(transfor-)440 3301 y(mation)h(rules)h(throughout)f(a)g(term.)52
b(Actual)33 b(transformation)e(rules)h(are)g(constructed)440
3401 y(b)n(y)27 b(means)g(of)h(pattern)f(matc)n(hing)h(and)f(building)h
(of)f(pattern)h(instan)n(tiations.)440 3570 y(A)c(matc)n(h)g
Fe(?t)f Fl(succeeds)h(if)g(the)h(pattern)f(term)g Fe(t)f
Fl(matc)n(hes)h(the)g(sub)5 b(ject)24 b(term.)36 b(As)24
b(a)g(side-)440 3670 y(e\013ect,)f(an)n(y)e(v)-5 b(ariables)21
b(in)h Fe(t)f Fl(are)g(b)r(ound)h(to)g(the)g(corresp)r(onding)e
(subterms)h(of)h(the)g(sub)5 b(ject)440 3769 y(term.)38
b(If)29 b(a)f(v)-5 b(ariable)27 b(w)n(as)g(already)f(b)r(ound)j(b)r
(efore)f(the)g(matc)n(h,)g(then)h(the)f(binding)h(only)440
3869 y(succeeds)h(if)g(the)h(terms)f(are)f(the)h(same.)44
b(This)30 b(enables)g(non-linear)f(pattern)h(matc)n(hing,)440
3968 y(so)22 b(that)h(a)g(matc)n(h)f(suc)n(h)h(as)f Fe(?F\(x,)41
b(x\))22 b Fl(succeeds)g(only)h(if)g(the)g(t)n(w)n(o)f(argumen)n(ts)g
(of)g Fe(F)h Fl(in)g(the)440 4068 y(sub)5 b(ject)30 b(term)h(are)e
(equal.)44 b(This)31 b(non-linear)e(b)r(eha)n(viour)g(can)g(also)h
(arise)f(accross)f(other)440 4168 y(op)r(erations.)64
b(F)-7 b(or)36 b(example,)j(the)e(t)n(w)n(o)f(consecutiv)n(e)g(matc)n
(hes)h Fe(?F\(x,)k(y\);)i(?F\(y,)e(x\))440 4267 y Fl(succeed)c(exactly)
h(when)g(the)g(t)n(w)n(o)f(argumen)n(ts)f(of)i Fe(F)f
Fl(are)g(equal.)67 b(Once)37 b(a)h(v)-5 b(ariable)36
b(is)440 4367 y(b)r(ound)28 b(it)g(cannot)f(b)r(e)h(un)n(b)r(ound.)440
4536 y(A)36 b(build)h Fe(!t)e Fl(replaces)f(the)i(sub)5
b(ject)36 b(term)g(with)h(the)f(instan)n(tiation)f(of)h(the)g(pattern)g
Fe(t)440 4636 y Fl(using)26 b(the)h(curren)n(t)e(bindings)i(of)f(terms)
g(to)g(v)-5 b(ariables)26 b(in)g Fe(t)p Fl(.)36 b(A)27
b(scop)r(e)f Fe({x1,...,xn:)39 b(s})440 4736 y Fl(mak)n(es)34
b(the)i(v)-5 b(ariables)34 b Fe(xi)h Fl(lo)r(cal)g(to)g(the)h(strategy)
e Fe(s)p Fl(.)60 b(This)35 b(means)g(that)h(bindings)f(to)440
4835 y(these)d(v)-5 b(ariables)30 b(outside)h(the)h(scop)r(e)f(are)g
(undone)g(when)h(en)n(tering)f(the)h(scop)r(e)f(and)g(are)440
4935 y(restored)26 b(after)i(lea)n(ving)f(it.)38 b(The)28
b(op)r(eration)f Fe(where\(s\))d Fl(applies)k(the)g(strategy)f
Fe(s)g Fl(to)h(the)440 5034 y(sub)5 b(ject)33 b(term.)51
b(If)33 b(successful,)g(it)g(restores)d(the)j(original)e(sub)5
b(ject)33 b(term,)g(k)n(eeping)f(only)440 5134 y(the)c(newly)g
(obtained)f(bindings)g(to)h(v)-5 b(ariables.)1851 5662
y(8)p eop
%%Page: 9 12
9 11 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y Fh(STRA)-8 b(TEGO)440 726 y Fl(The)20
b(sp)r(eci\014cation)g(language)f(Stratego)g(pro)n(vides)g(syn)n
(tactic)g(abstractions)g(for)h(System)g(S)440 825 y(expressions.)43
b(A)30 b(sp)r(eci\014cation)g(consists)f(of)h(a)g(collection)f(of)h(mo)
r(dules)h(that)f(de\014ne)g(sig-)440 925 y(natures,)d(transformation)f
(rules)h(and)g(strategy)g(de\014nitions.)440 1094 y(A)j(signature)f
(declares)f(the)i(sorts)f(and)g(op)r(erations)g(\(constructors\))f
(that)i(mak)n(e)f(up)h(the)440 1194 y(structure)e(of)g(the)g
(language\(s\))f(b)r(eing)h(transformed.)38 b(Example)27
b(signatures)g(are)g(sho)n(wn)440 1293 y(in)c(the)h(mo)r(dules)f(in)h
(Figure)e(2.)35 b(A)24 b(strategy)e(de\014nition)h Fe(f\(x1,...,xn\))39
b(=)k(s)23 b Fl(in)n(tro)r(duces)440 1393 y(a)e(new)h(strategy)f(op)r
(erator)f Fe(f)i Fl(parameterized)e(with)i(strategies)f
Fe(x1)g Fl(through)g Fe(xn)g Fl(and)h(with)440 1493 y(b)r(o)r(dy)34
b Fe(s)p Fl(.)54 b(Suc)n(h)33 b(de\014nitions)h(cannot)f(b)r(e)h
(recursiv)n(e,)f(i.e.,)i(they)f(cannot)f(refer)f(\(directly)440
1592 y(or)h(indirectly\))h(to)g(the)g(op)r(erator)e(b)r(eing)i
(de\014ned.)56 b(All)35 b(recursion)d(m)n(ust)i(b)r(e)h(expressed)440
1692 y(explicitly)24 b(b)n(y)g(means)f(of)h(the)h(recursion)d(op)r
(erator)g Fe(rec)p Fl(.)35 b(Lab)r(eled)24 b(transformation)e(rules)440
1792 y(are)h(abbreviations)f(of)i(a)f(particular)f(form)i(of)f
(strategy)g(de\014nitions.)36 b(A)24 b(conditional)f(rule)440
1891 y Fe(L)43 b(:)g(l)h(->)e(r)h(where)f(s)25 b Fl(with)g(lab)r(el)g
Fe(L)p Fl(,)g(left-hand)g(side)f Fe(l)p Fl(,)i(righ)n(t-hand)d(side)i
Fe(r)p Fl(,)g(and)g(con-)440 1991 y(dition)33 b Fe(s)g
Fl(denotes)f(a)h(strategy)f(de\014nition)h Fe(L)43 b(=)g({x1,...,xn:)c
(?l;)k(where\(s\);)c(!r})p Fl(.)440 2090 y(Here,)31 b(the)f(b)r(o)r(dy)
h(of)f(the)h(rule)f(\014rst)g(matc)n(hes)g(the)g(left-hand)h(side,)g
(and)f(then)h(attempts)440 2190 y(to)25 b(satisfy)g(the)h(condition)g
Fe(s)p Fl(.)35 b(If)26 b(that)g(succeeds,)f(then)h(it)g(builds)g(the)g
(righ)n(t-hand)e(side)i Fe(r)p Fl(.)440 2290 y(The)h(rule)g(is)g
(enclosed)f(in)i(a)e(scop)r(e)h(that)h(mak)n(es)e(all)g(term)h(v)-5
b(ariables)26 b Fe(xi)h Fl(o)r(ccurring)e(in)j Fe(l)p
Fl(,)440 2389 y Fe(s)e Fl(and)g Fe(r)g Fl(lo)r(cal)f(to)h(the)h(rule.)
36 b(If)27 b(more)e(than)h(one)g(de\014nition)h(is)f(pro)n(vided)f
(with)h(the)h(same)440 2489 y(name,)d(e.g.,)f Fe(f\(xs\))42
b(=)h(s1)22 b Fl(and)g Fe(f\(xs\))42 b(=)h(s2)p Fl(,)23
b(this)g(is)g(equiv)-5 b(alen)n(t)23 b(to)f(a)h(single)f(de\014nition)
440 2589 y(with)28 b(the)g(sum)g(of)f(the)h(original)e(b)r(o)r(dies)i
(as)f(b)r(o)r(dy)-7 b(,)28 b(i.e.,)g Fe(f\(xs\))41 b(=)j(s1)e(+)i(s2)p
Fl(.)440 2758 y(The)32 b(follo)n(wing)f(de\014nitions)i(pro)n(vide)e(a)
g(useful)i(shorthand.)50 b(The)32 b(notation)f Fe(<s>)43
b(t)32 b Fl(de-)440 2858 y(notes)37 b Fe(!t;)43 b(s)p
Fl(,)d(i.e.,)g(the)e(strategy)f(that)h(builds)g(the)g(term)g
Fe(t)f Fl(and)h(then)g(applies)f Fe(s)g Fl(to)440 2957
y(it.)42 b(The)29 b(notation)f Fe(s)43 b(=>)g(t)29 b
Fl(denotes)f Fe(s;)43 b(?t)p Fl(,)29 b(i.e.,)g(the)h(strategy)d(that)j
(applies)e Fe(s)h Fl(to)g(the)440 3057 y(curren)n(t)20
b(sub)5 b(ject)21 b(term)f(and)h(then)g(matc)n(hes)f(the)h(result)f
(against)g Fe(t)p Fl(.)34 b(The)21 b(com)n(bined)f(nota-)440
3156 y(tion)k Fe(<s>)43 b(t)g(=>)g(t')23 b Fl(th)n(us)h(denotes)g
Fe(\(!t;)42 b(s\);)g(?t')p Fl(.)35 b(The)24 b Fe(<s>)43
b(t)23 b Fl(notation)h(can)g(also)f(b)r(e)440 3256 y(used)e(in)f(a)h
(build)g(expression.)33 b(F)-7 b(or)20 b(example,)h(the)g(strategy)f
(expression)f Fe(!F\(<s>)41 b(t,)i(t'\))440 3356 y Fl(corresp)r(onds)26
b(to)h Fe({x:)43 b(<s>)f(t)h(=>)g(x;)g(!F\(x,t'\)})p
Fl(,)24 b(where)j Fe(x)g Fl(is)g(a)h(new)f(v)-5 b(ariable.)1851
5662 y(9)p eop
%%Page: 10 13
10 12 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)p 440 787 2865 4 v 440 4909 4 4123 v 468 858
a Fd(module)41 b(terms)468 949 y(imports)g(list-cons)468
1040 y(signature)547 1132 y(sorts)f(Term)547 1223 y(operations)625
1314 y(Wld)g(:)942 b(Term)40 b(\(*)g(_)f(*\))625 1406
y(Var)h(:)g(String)550 b(->)40 b(Term)g(\(*)g(x)f(*\))625
1497 y(Int)h(:)g(Int)667 b(->)40 b(Term)g(\(*)g(0,)f(1,)h(2)f(...)h
(*\))625 1588 y(Str)g(:)g(String)550 b(->)40 b(Term)g(\(*)g("",)f("a",)
i(...)f(*\))625 1680 y(Op)79 b(:)40 b(String)g(*)g(List\(Term\))h(->)f
(Term)g(\(*)g(f\(t1,...,tn\))i(*\))468 1854 y(module)f(strategy)468
1945 y(imports)g(terms)468 2037 y(signature)547 2128
y(sorts)f(SVar)g(Strat)h(SDef)547 2219 y(operations)625
2311 y(Id)236 b(:)1334 b(Strat)40 b(\(*)g(id)g(*\))625
2402 y(Fail)158 b(:)1334 b(Strat)40 b(\(*)g(fail)g(*\))625
2585 y(Test)158 b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(test)g(s)g
(*\))625 2676 y(Not)197 b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(not)
g(s)f(*\))625 2858 y(Seq)197 b(:)39 b(Strat)i(*)e(Strat)668
b(->)40 b(Strat)g(\(*)g(s1)g(;)78 b(s2)40 b(*\))625 2950
y(Choice)80 b(:)39 b(Strat)i(*)e(Strat)668 b(->)40 b(Strat)g(\(*)g(s1)g
(+)78 b(s2)40 b(*\))625 3041 y(LChoice)h(:)e(Strat)i(*)e(Strat)668
b(->)40 b(Strat)g(\(*)g(s1)g(<+)f(s2)h(*\))625 3224 y(SVar)158
b(:)39 b(String)943 b(->)40 b(SVar)625 3315 y(Rec)197
b(:)39 b(String)i(*)e(Strat)629 b(->)40 b(Strat)g(\(*)g(rec)g(x)f
(\(s\))h(*\))625 3406 y(Let)197 b(:)39 b(SDef)i(*)e(Strat)707
b(->)40 b(Strat)g(\(*)g(let)g(sdef)g(in)g(s2*\))625 3498
y(SDef)158 b(:)39 b(String)i(*)e(List\(String\))j(*)e(Strat)g(->)g
(SDef)79 b(\(*)40 b(f\(xs\))g(=)g(s)f(*\))625 3589 y(Call)158
b(:)39 b(SVar)i(*)e(List\(Strat\))473 b(->)40 b(Strat)g(\(*)g(f\(ss\))g
(*\))625 3772 y(Path)158 b(:)39 b(Int)h(*)g(Strat)746
b(->)40 b(Strat)g(\(*)g(i\(s\))g(*\))625 3863 y(Cong)158
b(:)39 b(String)i(*)e(List\(Strat\))395 b(->)40 b(Strat)g(\(*)g
(f\(s1,...,sn\))i(*\))625 3954 y(One)197 b(:)39 b(Strat)982
b(->)40 b(Strat)g(\(*)g(one\(s\))h(*\))625 4046 y(Some)158
b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(some\(s\))h(*\))625
4137 y(All)197 b(:)39 b(Strat)982 b(->)40 b(Strat)g(\(*)g(all\(s\))h
(*\))625 4320 y(Match)158 b(:)40 b(Term)981 b(->)40 b(Strat)g(\(*)g(?t)
g(*\))625 4411 y(Build)158 b(:)40 b(Term)981 b(->)40
b(Strat)g(\(*)g(!t)g(*\))625 4594 y(Scope)119 b(:)39
b(List\(String\))j(*)e(Strat)393 b(->)40 b(Strat)g(\(*)g({xs:)g(s})g
(*\))625 4685 y(Where)119 b(:)39 b(Strat)982 b(->)40
b(Strat)g(\(*)g(where)g(s)g(*\))625 4868 y(Prim)158 b(:)39
b(String)i(->)f(Strat)p 3301 4909 V 440 4912 2865 4 v
746 5061 a Fl(Figure)27 b(2:)37 b(Abstract)27 b(syn)n(tax)g(of)g(terms)
h(and)f(System)h(S)g(expressions.)1831 5662 y(10)p eop
%%Page: 11 14
11 13 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Language)440 531 y Fh(LIBRAR)-8 b(Y)440 726 y Fl(The)24
b(language)f(comes)h(with)h(a)f(gro)n(wing)e(library)h(of)i(strategy)e
(op)r(erators)f(with)j(function-)440 825 y(alit)n(y)i(for)565
1061 y Fj(\017)41 b Fl(Simple)28 b(tra)n(v)n(ersals)c(\(suc)n(h)k(as)f
(in)h(Figure)f(1\))565 1227 y Fj(\017)41 b Fl(Fixed-p)r(oin)n(t)27
b(tra)n(v)n(ersals)565 1393 y Fj(\017)41 b Fl(List)27
b(op)r(erations)565 1559 y Fj(\017)41 b Fl(T)-7 b(uple)27
b(op)r(erations)565 1725 y Fj(\017)41 b Fl(Manipulation)31
b(of)h(expressions)e(with)j(\(b)r(ound\))g(v)-5 b(ariables,)31
b(suc)n(h)h(as)f(v)-5 b(ariable)31 b(re-)648 1825 y(naming,)c
(substitution,)h(collection)e(of)i(the)f(set)h(of)f(free)g(v)-5
b(ariables)26 b(etc.)37 b(These)27 b(op-)648 1924 y(erations)21
b(are)g(language)g(indep)r(enden)n(t)i(and)g(can)f(b)r(e)g(sp)r
(ecialized)h(to)f(a)g(language)f(b)n(y)648 2024 y(instan)n(tiation)33
b(of)h(generic)f(op)r(erations.)56 b(Note)34 b(that)g(this)h(concerns)d
Fc(obje)l(ct)43 b Fl(v)-5 b(ari-)648 2124 y(ables)38
b(in)i(the)g(language)e(b)r(eing)h(manipulated,)k(whic)n(h)c(are)f
(di\013eren)n(t)i(from)f(the)648 2223 y(meta-v)-5 b(ariable)26
b(used)h(in)h(rules.)1831 5662 y(11)p eop
%%Page: 12 15
12 14 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)440 531 y(A)g(Stratego)f(sp)r(eci\014cation)g(de\014nes)h(a)
g(transformation)e(on)i(terms.)37 b(The)28 b(Stratego)f(com-)440
631 y(piler)k(translates)e(a)h(sp)r(eci\014cation)h(to)g(an)f
(executable)g(program)f(that)i(reads)f(in)h(a)f(term,)440
731 y(transforms)37 b(it)j(according)c(to)j(the)g(sp)r(eci\014cation)g
(and)f(outputs)h(the)g(resulting)f(trans-)440 830 y(formed)24
b(term.)36 b(In)24 b(this)g(section)g(w)n(e)g(discuss)f(the)i(arc)n
(hitecture)e(of)h(the)h(compiler)e(and)h(the)440 930
y(run-time)32 b(system)g(used)h(in)f(the)h(generated)e(programs.)49
b(In)32 b(the)h(next)f(section)g(w)n(e)g(giv)n(e)440
1029 y(some)27 b(examples)g(of)h(the)f(sp)r(eci\014cation)h(of)f(the)h
(compiler)f(in)h(Stratego)e(itself.)1831 5662 y(12)p
eop
%%Page: 13 16
13 15 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)440 531 y Fh(AR)m(CHITECTURE)440 726 y Fl(The)36
b(o)n(v)n(erall)e(arc)n(hitecture)h(of)h(the)g(compiler)g(is)g(sho)n
(wn)f(in)h(Figure)g(3.)62 b(The)36 b(compiler)440 825
y(consists)k(of)i(four)f(main)g(comp)r(onen)n(ts:)64
b(fron)n(t-end,)44 b(optimizer,)g(matc)n(hing-tree,)g(and)440
925 y(bac)n(k-end.)440 1094 y(The)21 b(fron)n(t-end)f(tak)n(es)g(a)g
(Stratego)g(sp)r(eci\014cation)g(\(in)h(abstract)f(syn)n(tax)g(form\))h
(and)f(trans-)440 1194 y(lates)k(it)h(to)f(a)g(list)h(of)f(System)h(S)f
(expressions)f(\(SSE\).)i(The)f(fron)n(t-end)g(itself)h(is)f(comp)r
(osed)440 1293 y(of)29 b(\014v)n(e)g(stages:)40 b(joining)29
b(sections)f(of)i(the)g(same)e(kind)i(\(normalization\);)f(translation)
f(of)440 1393 y(rules)34 b(and)h(signatures)f(to)g(strategy)g
(de\014nitions;)39 b(extraction)34 b(of)h(the)g(de\014nitions)g(that)
440 1493 y(are)24 b(actually)g(needed)i(for)e(implemen)n(tation)h(of)g
(the)g(op)r(erator)f Fe(main)p Fl(;)g(elimination)h(of)g(the)440
1592 y(syn)n(tactic)f(abstractions)e(\(sugar\))h(of)i(the)f(Stratego)f
(lev)n(el;)i(and)f(\(selectiv)n(e\))g(inlining)g(de\014-)440
1692 y(nitions.)36 b(The)24 b(result)g(of)g(this)g(stage)f(is)i(a)e
(list)i(of)f(strategy)e(de\014nitions)j(for)e(parameterless)440
1792 y(op)r(erators.)440 1961 y(The)i(optimizer)f(simpli\014es)h(a)f
(System)g(S)h(expression)e(b)n(y)i(applying)f(algebraic)e(la)n(ws.)35
b(The)440 2061 y(matc)n(hing-tree)j(automaton)g(transformer)f(targets)g
(expressions)h(that)h(are)f(c)n(hoices)f(of)440 2160
y(strategies)e(starting)h(with)h(a)f(matc)n(h.)64 b(Common)36
b(pre\014xes)f(are)h(extracted)g(to)g(prev)n(en)n(t)440
2260 y(insp)r(ecting)f(a)f(term)g(more)g(than)g(once.)57
b(The)35 b(bac)n(k-end)e(translates)g(an)i(expression)d(to)440
2359 y(abstract)27 b(mac)n(hine)g(instructions.)1831
5662 y(13)p eop
%%Page: 14 17
14 16 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)p 440 667 2865 4 v 440 5020 4 4353 v 4 setlinewidth
np 1722 993 a 2142 993 li 2142 783 li 1722 783 li closepath
st 1791 859 a Fb(Stratego)1726 950 y(sp)r(eci\014cation)p
np 1932 993 a 1932 1113 li st 0.000 setgray np 1947 1053
a 1932 1113 li 1917 1053 li closepath fil 0 setgray np
1947 1053 a 1932 1113 li 1917 1053 li closepath st np
1932 1218 210 105 0.00 360.00 ellipse st 1791 1189 a(Stratego)1829
1280 y(parser)p np 1932 1323 a 1932 1443 li st 0.000 setgray
np 1947 1383 a 1932 1443 li 1917 1383 li closepath fil
0 setgray np 1947 1383 a 1932 1443 li 1917 1383 li closepath
st np 1722 1653 a 2142 1653 li 2142 1443 li 1722 1443
li closepath st 1791 1519 a(Stratego)1854 1610 y(AST)p
np 1932 1653 a 1932 1773 li st 0.000 setgray np 1947
1713 a 1932 1773 li 1917 1713 li closepath fil 0 setgray
np 1947 1713 a 1932 1773 li 1917 1713 li closepath st
np 1932 1878 210 105 0.00 360.00 ellipse st 1778 1894
a(fron)n(t-end)p np 1932 1983 a 1932 2103 li st 0.000 setgray
np 1947 2043 a 1932 2103 li 1917 2043 li closepath fil
0 setgray np 1947 2043 a 1932 2103 li 1917 2043 li closepath
st np 1722 2313 a 2142 2313 li 2142 2103 li 1722 2103
li closepath st 1863 2224 a(SSE)p np 1932 2313 a 1932
2433 li st 0.000 setgray np 1947 2373 a 1932 2433 li
1917 2373 li closepath fil 0 setgray np 1947 2373 a 1932
2433 li 1917 2373 li closepath st np 1932 2538 210 105
0.00 360.00 ellipse st 1774 2554 a(optimizer)p np 1932
2643 a 1932 2763 li st 0.000 setgray np 1947 2703 a 1932
2763 li 1917 2703 li closepath fil 0 setgray np 1947
2703 a 1932 2763 li 1917 2703 li closepath st np 1722
2973 a 2142 2973 li 2142 2763 li 1722 2763 li closepath
st 1863 2885 a(SSE)p np 1932 2973 a 1932 3093 li st 0.000 setgray
np 1947 3033 a 1932 3093 li 1917 3033 li closepath fil
0 setgray np 1947 3033 a 1932 3093 li 1917 3033 li closepath
st np 1932 3198 210 105 0.00 360.00 ellipse st 1777 3169
a(matc)n(hing)1868 3260 y(tree)p np 1932 3303 a 1932
3423 li st 0.000 setgray np 1947 3363 a 1932 3423 li
1917 3363 li closepath fil 0 setgray np 1947 3363 a 1932
3423 li 1917 3363 li closepath st np 1722 3633 a 2142
3633 li 2142 3423 li 1722 3423 li closepath st 1863 3544
a(SSE)p np 1932 3633 a 1932 3753 li st 0.000 setgray
np 1947 3693 a 1932 3753 li 1917 3693 li closepath fil
0 setgray np 1947 3693 a 1932 3753 li 1917 3693 li closepath
st np 1932 3858 210 105 0.00 360.00 ellipse st 1774 3874
a(optimizer)p np 1932 3963 a 1932 4083 li st 0.000 setgray
np 1947 4023 a 1932 4083 li 1917 4023 li closepath fil
0 setgray np 1947 4023 a 1932 4083 li 1917 4023 li closepath
st np 1722 4293 a 2142 4293 li 2142 4083 li 1722 4083
li closepath st 1863 4204 a(SSE)p np 1932 4293 a 1932
4413 li st 0.000 setgray np 1947 4353 a 1932 4413 li
1917 4353 li closepath fil 0 setgray np 1947 4353 a 1932
4413 li 1917 4353 li closepath st np 1932 4518 210 105
0.00 360.00 ellipse st 1783 4535 a(bac)n(k-end)p np 1932
4623 a 1932 4743 li st 0.000 setgray np 1947 4683 a 1932
4743 li 1917 4683 li closepath fil 0 setgray np 1947
4683 a 1932 4743 li 1917 4683 li closepath st np 1722
4953 a 2142 4953 li 2142 4743 li 1722 4743 li closepath
st 1741 4864 a(AMI)e(\(=)f(C\))p np 2832 1218 210 105
0.00 360.00 ellipse st 2657 1189 a(normalize-)2760 1280
y(sp)r(ec)p np 2832 1323 a 2832 1443 li st 0.000 setgray
np 2847 1383 a 2832 1443 li 2817 1383 li closepath fil
0 setgray np 2847 1383 a 2832 1443 li 2817 1383 li closepath
st np 2832 1548 210 105 0.00 360.00 ellipse st 2748 1519
a(sp)r(ec-)2705 1610 y(to-sdefs)p np 2832 1653 a 2832
1773 li st 0.000 setgray np 2847 1713 a 2832 1773 li
2817 1713 li closepath fil 0 setgray np 2847 1713 a 2832
1773 li 2817 1713 li closepath st np 2832 1878 210 105
0.00 360.00 ellipse st 2639 1894 a(needed-defs)p np 2832
1983 a 2832 2103 li st 0.000 setgray np 2847 2043 a 2832
2103 li 2817 2043 li closepath fil 0 setgray np 2847
2043 a 2832 2103 li 2817 2043 li closepath st np 2832
2208 210 105 0.00 360.00 ellipse st 2691 2179 a(desugar-)2760
2270 y(sp)r(ec)p np 2832 2313 a 2832 2433 li st 0.000 setgray
np 2847 2373 a 2832 2433 li 2817 2373 li closepath fil
0 setgray np 2847 2373 a 2832 2433 li 2817 2373 li closepath
st np 2832 2538 210 105 0.00 360.00 ellipse st 2740 2554
a(inline)p np 2562 2733 a 3102 2733 li 3102 1053 li 2562
1053 li closepath st np [ 30.74 ] 0 setdash 2080 1803
a 2562 1053 li st [] 0 setdash [] 0 setdash np [ 29.61
] 0 setdash 2080 1952 a 2562 2733 li st [] 0 setdash
[] 0 setdash np [ 25.71 ] 0 setdash 1722 1218 a 1542
1218 li st [] 0 setdash [] 0 setdash 0.000 setgray np
1662 1203 a 1722 1218 li 1662 1233 li closepath fil 0 setgray
np 1662 1203 a 1722 1218 li 1662 1233 li closepath st
np 1062 1323 a 1542 1323 li 1542 1113 li 1062 1113 li
closepath st 1116 1189 a(Stratego)i(in)1095 1280 y(LEX/Y)-6
b(A)n(CC)p np [ 25.71 ] 0 setdash 1722 1878 a 1542 1878
li st [] 0 setdash [] 0 setdash 0.000 setgray np 1662
1863 a 1722 1878 li 1662 1893 li closepath fil 0 setgray
np 1662 1863 a 1722 1878 li 1662 1893 li closepath st
np 1452 1878 90 105 0.00 360.00 ellipse st 1420 1894
a(sc)p np [ 25.71 ] 0 setdash 1362 1878 a 1182 1878 li
st [] 0 setdash [] 0 setdash 0.000 setgray np 1302 1863
a 1362 1878 li 1302 1893 li closepath fil 0 setgray np
1302 1863 a 1362 1878 li 1302 1893 li closepath st np
762 1983 a 1182 1983 li 1182 1773 li 762 1773 li closepath
st -678 w(fron)n(tend.r)p np [ 25.71 ] 0 setdash 1722
2538 a 1542 2538 li st [] 0 setdash [] 0 setdash 0.000 setgray
np 1662 2523 a 1722 2538 li 1662 2553 li closepath fil
0 setgray np 1662 2523 a 1722 2538 li 1662 2553 li closepath
st np 1452 2538 90 105 0.00 360.00 ellipse st 1420 2554
a(sc)p np [ 25.71 ] 0 setdash 1362 2538 a 1182 2538 li
st [] 0 setdash [] 0 setdash 0.000 setgray np 1302 2523
a 1362 2538 li 1302 2553 li closepath fil 0 setgray np
1302 2523 a 1362 2538 li 1302 2553 li closepath st np
762 2643 a 1182 2643 li 1182 2433 li 762 2433 li closepath
st -695 w(optimizer.r)p np [ 25.71 ] 0 setdash 1722 3198
a 1542 3198 li st [] 0 setdash [] 0 setdash 0.000 setgray
np 1662 3183 a 1722 3198 li 1662 3213 li closepath fil
0 setgray np 1662 3183 a 1722 3198 li 1662 3213 li closepath
st np 1452 3198 90 105 0.00 360.00 ellipse st 1420 3214
a(sc)p np [ 25.71 ] 0 setdash 1362 3198 a 1182 3198 li
st [] 0 setdash [] 0 setdash 0.000 setgray np 1302 3183
a 1362 3198 li 1302 3213 li closepath fil 0 setgray np
1302 3183 a 1362 3198 li 1302 3213 li closepath st np
642 3303 a 1182 3303 li 1182 3093 li 642 3093 li closepath
st -829 w(matc)n(hing-tree.r)p np [ 25.71 ] 0 setdash
1722 4518 a 1542 4518 li st [] 0 setdash [] 0 setdash
0.000 setgray np 1662 4503 a 1722 4518 li 1662 4533 li
closepath fil 0 setgray np 1662 4503 a 1722 4518 li 1662
4533 li closepath st np 1452 4518 90 105 0.00 360.00
ellipse st 1420 4535 a(sc)p np [ 25.71 ] 0 setdash 1362
4518 a 1182 4518 li st [] 0 setdash [] 0 setdash 0.000 setgray
np 1302 4503 a 1362 4518 li 1302 4533 li closepath fil
0 setgray np 1302 4503 a 1362 4518 li 1302 4533 li closepath
st np 762 4623 a 1182 4623 li 1182 4413 li 762 4413 li
closepath st -687 w(bac)n(k-end.r)p 3301 5020 V 440 5023
2865 4 v 930 5177 a Fl(Figure)27 b(3:)36 b(Arc)n(hitecture)27
b(of)h(the)g(Stratego)e(compiler)h(\(sc\))1831 5662 y(14)p
eop
%%Page: 15 18
15 17 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(The)28
b(Compiler)440 531 y Fh(R)m(UN-TIME)k(SYSTEM)440 726
y Fl(The)f(abstract)f(mac)n(hine)h(instructions)g(pro)r(duced)g(b)n(y)g
(the)g(compiler)g(are)f(implemen)n(ted)440 825 y(as)25
b(macros)g(or)g(pro)r(cedures)g(in)i(C.)f(These)g(pro)r(cedures)e(mak)n
(e)i(use)g(of)g(a)g(run-time)g(system)440 925 y(that)31
b(supp)r(orts)f(stac)n(k)g(and)g(term)h(managemen)n(t.)44
b(The)31 b(return-)f(and)g(c)n(hoice-stac)n(ks)e(are)440
1024 y(needed)34 b(for)f(con)n(trol.)55 b(The)34 b(term-stac)n(k)e(is)i
(used)g(to)g(deconstruct)f(terms)h(in)g(matc)n(hing)440
1124 y(and)c(term)h(tra)n(v)n(ersal.)43 b(F)-7 b(or)30
b(the)h(represen)n(tation)d(of)j(terms)f(the)h(A)-7 b(T)g(erms)30
b(pac)n(k)-5 b(age)29 b([8])h(is)440 1224 y(used.)36
b(This)25 b(pac)n(k)-5 b(age)23 b(pro)n(vides)g(an)i(implemen)n(tation)
f(of)h(terms)f(based)h(on)f(hash-consing)440 1323 y(and)j(supp)r(orts)h
(garbage)d(collection.)440 1493 y(The)37 b(run-time)f(system)h(is)f
(implemen)n(ted)h(in)g(C.)g(Therefore,)h(the)f(compiler)f(and)g(gen-)
440 1592 y(erated)f(transformation)f(programs)g(only)h(dep)r(end)i(on)e
Fe(gcc)p Fl(.)61 b(The)35 b(Stratego)g(compiler)440 1692
y(\(sc\))29 b(is)f(b)r(eing)h(dev)n(elop)r(ed)f(on)h(a)f(Lin)n(ux)g
(platform)h(and)f(is)g(also)g(used)h(on)f(Sun)h(mac)n(hines.)440
1792 y(Although)35 b(this)f(has)g(not)g(b)r(een)h(done,)h(there)e
(should)h(b)r(e)f(no)g(problem)g(in)h(p)r(orting)f(the)440
1891 y(compiler)27 b(to)g(Windo)n(ws)h(NT)g(platforms)f(with)h(GNU)g
(soft)n(w)n(are.)1831 5662 y(15)p eop
%%Page: 16 19
16 18 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(Examples)440
531 y(In)26 b(this)h(section)e(w)n(e)h(giv)n(e)f(some)h(examples)f(to)h
(illustrate)g(the)h(sp)r(eci\014cation)e(of)h(the)h(com-)440
631 y(piler)g(in)h(Stratego.)1831 5662 y(16)p eop
%%Page: 17 20
17 19 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(Examples)440
531 y Fh(EXAMPLE)32 b(1:)42 b(PIPELINES)440 726 y Fl(The)26
b Fe(main)f Fl(strategy)g(of)h(the)h(fron)n(t-end)f(de\014nes)g(a)g
(pip)r(eline)h(of)f(op)r(erations.)35 b(In)26 b(addition)440
825 y(to)31 b(the)h(op)r(erations)e(discussed)h(in)g(the)h(previous)e
(section,)i(use-def)f(analysis)f(is)h(used)g(to)440 925
y(determine)e(if)h(v)-5 b(ariables)28 b(are)h(used)g(in)h(builds)f
(without)h(b)r(eing)f(b)r(ound)h(in)g(matc)n(h)f(op)r(era-)440
1024 y(tions.)440 1194 y(Note)h(that)g(in)h(general)d(suc)n(h)i(a)g
(pip)r(eline)h(ma)n(y)e(fail)h(to)g(apply)g(to)g(a)f(term.)45
b(In)30 b(this)g(case,)440 1293 y(if)40 b(an)e(error)f(is)i(detected)h
(either)f(in)g(the)g Fe(use-def)e Fl(analysis)g(\(due)j(to)f
(undeclared)f(or)440 1393 y(unitialized)21 b(v)-5 b(ariables\))19
b(or)g(in)i(the)g Fe(needed-defs)16 b Fl(transformation)i(\(missing)j
(de\014nition\),)440 1493 y(the)28 b(pip)r(eline)g(fail.)37
b(In)28 b(these)g(cases)e(an)h(error)f(message)g(is)i(deriv)n(ed)f
(from)g(the)h(failure.)p 440 1612 2865 4 v 440 2709 4
1097 v 468 1687 a Fe(module)41 b(frontend)468 1787 y(imports)g
(normalize-spec)d(spec-to-sdefs)g(needed-defs)817 1887
y(desugar)j(inlining)f(use-def)468 1986 y(strategies)555
2186 y(main)i(=)i(normalize-spec;)861 2285 y(where\(spec-use-)o(de)o
(f\);)861 2385 y(spec-to-sdefs;)861 2484 y(needed-defs;)861
2584 y(desugar-spec;)861 2684 y(inline)p 3301 2709 V
440 2712 2865 4 v 1831 5662 a Fl(17)p eop
%%Page: 18 21
18 20 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 298 y(Section:)37 b(Examples)440
531 y Fh(EXAMPLE)32 b(2:)42 b(DESUGARING)440 726 y Fl(The)31
b(follo)n(wing)f(sp)r(eci\014cation)g(is)h(a)f(fragmen)n(t)g(from)h(mo)
r(dule)g Fe(desugar.r)c Fl(that)k(de\014nes)440 825 y(the)19
b(elimination)f(of)h(syn)n(tactic)f(abstractions)f(\(sugar\).)33
b(Rules)18 b Fe(Bapp2)f Fl(transforms)g(a)h(build)440
925 y(expression)28 b(suc)n(h)i(as)f Fe(!F\(<s>)41 b(G\(y\)\))28
b Fl(to)h Fe({x:)43 b(<s>)f(G\(y\))g(=>)h(x;)g(!F\(x\)})27
b Fl(in)j(order)e(to)440 1024 y(extract)f(the)h(strategy)e(application)
h(inside)h(the)g(build.)440 1194 y(Rule)k Fe(Bapp2)f
Fl(uses)g(a)h(con)n(textual)f(pattern)h Fe(t[App\(s,)41
b(t'\)])30 b Fl(to)i(reac)n(h)f(an)h(application)440
1293 y Fe(App\(s,)41 b(t'\))23 b Fl(at)h(an)f(arbitrary)f(depth)i
(inside)g(the)h(term)f(matc)n(hing)f Fe(t)p Fl(.)35 b(This)24
b(application)440 1393 y(is)k(replaced)f(with)h(the)g(newly)g
(generated)e(v)-5 b(ariable)27 b Fe(Var\(x\))e Fl(in)j(the)g(righ)n
(t-hand)f(side)h(b)n(y)440 1493 y(means)j(of)g(the)h(con)n(text)f
Fe(t[Var\(x\)])p Fl(.)45 b(The)31 b(righ)n(t-hand)f(side)i(replaces)e
(the)i(build)g(b)n(y)f(a)440 1592 y(scop)r(e)e(construct)f(that)h
(declares)f(a)g(new)h(lo)r(cal)g(v)-5 b(ariable)28 b
Fe(x)p Fl(.)40 b(Inside)29 b(the)h(scop)r(e)e(\014rst)h
Fe(s)f Fl(is)440 1692 y(applied)f(to)h Fe(t')f Fl(and)g(the)h(result)f
(matc)n(hed)g(against)g(the)g(new)h(v)-5 b(ariable)26
b Fe(x)p Fl(.)37 b(This)27 b(v)-5 b(ariable)440 1792
y(is)27 b(then)i(used)e(inside)h(the)g(term)f Fe(t)h
Fl(in)g(the)g(build.)440 1961 y(The)37 b(strategy)f Fe(desugar)f
Fl(desugars)h(an)h(expression)f(b)n(y)h(applying)f(a)h(set)h(of)f
(rules,)i(in-)440 2061 y(cluding)28 b Fe(Bapp2)p Fl(,)e(rep)r(eatedly)i
(in)g(a)f(top)r(do)n(wn)h(tra)n(v)n(ersal.)36 b(The)28
b(strategy)e Fe(desugar-spec)440 2160 y Fl(applies)h(this)h(strategy)e
(to)i(eac)n(h)f(de\014nition)h(b)r(o)r(dy)f(in)h(a)g(list)f(of)h
(de\014nitions.)p 440 2279 2865 4 v 440 3693 4 1415 v
468 2355 a Fe(module)41 b(desugar)512 2455 y(...)468
2554 y(rules)555 2753 y(Bapp2)h(:)h(Build\(t[App\(s,)38
b(t'\)]\))j(->)904 2853 y(Scope\([x],)f(Seq\(BAM\(s,)f(t',)j
(Var\(x\)\),)f(Build\(t[Var\(x\)])o(\)\)\))904 2953 y(where)h(new)g(=>)
h(x)468 3152 y(strategies)555 3351 y(desugar)e(=)i(topdown\(try\(desug)
o(ar)o(Rul)o(e\))o(;)1340 3451 y(repeat\(HL)d(+)j(\(Bapp0)e(<+)i(Bapp1)
e(<+)i(Bapp2\)\)\))555 3650 y(desugar-spec)c(=)k(map\(SDef\(id,)c(id,)j
(desugar\)\))p 3301 3693 V 440 3696 2865 4 v 1831 5662
a Fl(18)p eop
%%Page: 19 22
19 21 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 531 y Fh(EXAMPLE)32
b(3:)42 b(COMPILA)-8 b(TION)440 726 y Fl(The)25 b(bac)n(k-end)e(of)i
(the)g(compiler)f(translates)f(expressions)g(to)i(lists)g(of)f
(abstract)g(mac)n(hine)440 825 y(instructions.)40 b(F)-7
b(or)28 b(eac)n(h)f(language)g(construct)i(a)f(rule)g(de\014nes)h(the)g
(pattern)f(of)h(instruc-)440 925 y(tions)g(it)h(corresp)r(onds)d(to.)42
b(F)-7 b(or)29 b(example,)g(the)h(follo)n(wing)e(rules)h(de\014ne)h
(the)g(translation)440 1024 y(of)e(left)g(c)n(hoice)f
Fe(<+)f Fl(and)i(the)g(generic)e(tra)n(v)n(ersal)f(op)r(erator)h
Fe(all)p Fl(.)p 440 1144 2865 4 v 440 3049 4 1906 v 468
1219 a Fe(module)41 b(compiler)512 1319 y(...)468 1418
y(rules)555 1518 y(C)j(:)f(Instr\(LChoice\(s1)o(,)37
b(s2\),)42 b(env,)g(rcs\))g(->)730 1618 y(Block\([Cpush\(fc\))o(,)1035
1717 y(Instr\(s1,)e(env,)i(rcs\),)f(Cpop,)h(Goto\(sc\),)1035
1817 y(Label\(fc\),)d(Instr\(s2,)h(env,)i(rcs\),)1035
1917 y(Label\(sc\)]\))730 2016 y(where)f(new)i(=>)f(sc)h(;)g(new)g(=>)f
(fc)555 2215 y(C)i(:)f(Instr\(All\(s\),)38 b(env,)k(rcs\))g(->)730
2315 y(Block\([AllInit,)1035 2415 y(Label\(c1\),)1035
2514 y(AllNextSon\(c2\),)1035 2614 y(Instr\(s,)e(env,)i(rcs\),)1035
2714 y(Goto\(c1\),)1035 2813 y(Label\(c2\),)1035 2913
y(AllBuild]\))730 3012 y(where)f(new)i(=>)f(c1)h(;)g(new)g(=>)f(c2)p
3301 3049 V 440 3052 2865 4 v 440 3235 a Fl(These)37
b(rules)f(are)h(com)n(bined)g(in)g(the)h(compilation)e(strategy)g
Fe(compile)p Fl(.)63 b(The)37 b(default)440 3335 y Fe(C)31
b Fl(rules)g(are)g(applied)g(after)g(the)h(sp)r(ecialized)f
Fe(Cs)g Fl(rules.)48 b(After)32 b(translation)e(the)i(nested)440
3435 y(co)r(de)f(is)g(\015attened)h(to)f(a)f(single)h(list.)48
b(Some)31 b(simple)g(optimizations)g(are)f(p)r(erformed)h(b)n(y)440
3534 y Fe(peephole)24 b Fl(and)k(\014nally)-7 b(,)27
b(the)h(co)r(de)g(is)f(wrapp)r(ed)g(in)h(some)f(supp)r(ort)h(co)r(de)f
(b)n(y)g Fe(Assemble)p Fl(.)p 440 3656 V 440 4553 4 898
v 468 3731 a Fe(module)41 b(backend)555 3831 y(...)468
3931 y(strategies)555 4130 y(compile)g(=)i(map\(MkInstr;)1166
4229 y(topdown\(repeat\()o(Cs)37 b(<+)43 b(C\)\)\);)991
4329 y(flatten-blocks;)991 4429 y(peephole;)991 4528
y(Assemble)p 3301 4553 V 440 4556 2865 4 v 1831 5662
a Fl(19)p eop
%%Page: 20 23
20 22 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)1557 3132 y Fa(Basics)1831
5662 y Fl(20)p eop
%%Page: 21 24
21 23 bop 440 199 a Fl(Chapter:)36 b(Abstract)28 b(Syn)n(tax)440
531 y Fh(TERMS)440 726 y Fl(T)-7 b(erms)24 b(are)f(either)h(v)-5
b(ariables,)23 b(in)n(tegers,)h(strings)f(or)g(applications)g(of)h(a)g
(function)h(sym)n(b)r(ol)440 825 y(to)30 b(a)f(list)i(of)f(terms.)43
b(A)31 b(wildcard)e(corresp)r(onds)f(to)i(an)f(anon)n(ymous)g(v)-5
b(ariable.)43 b(In)30 b(com-)440 925 y(men)n(ts)h(after)g(the)h
(declarations)d(of)i(the)h(op)r(erators)d(an)i(example)g(of)g(the)h
(notation)e(used)440 1024 y(in)e(concrete)f(syn)n(tax.)440
1476 y Fe(module)41 b(terms)440 1576 y(imports)g(list-cons)440
1675 y(signature)527 1775 y(sorts)h(Term)527 1875 y(constructors)614
1974 y(Wld)86 b(:)1046 b(Term)129 b(\(*)43 b(_)g(*\))614
2074 y(Var)86 b(:)43 b(String)608 b(->)43 b(Term)129
b(\(*)43 b(x)g(*\))614 2174 y(Int)86 b(:)43 b(Int)740
b(->)43 b(Term)129 b(\(*)43 b(0,)g(1,)f(2)h(...)g(*\))614
2273 y(Real)f(:)h(Real)696 b(->)43 b(Term)129 b(\(*)43
b(0.0,)f(0.1,)g(2.3)g(...)g(*\))614 2373 y(Str)86 b(:)43
b(String)608 b(->)43 b(Term)129 b(\(*)43 b("",)f("a',)g(...)g(*\))614
2472 y(Op)130 b(:)43 b(String)f(*)h(List\(Term\))c(->)k(Term)129
b(\(*)43 b(f\(t1,...,tn\))38 b(*\))440 2725 y Fl(Remarks:)440
2894 y(List)28 b(notation)f([t1,...,tn])h(translates)e(to)i(Cons\(t1,)f
(...,)h(Cons\(tn,)g(Nil\)\))440 3064 y(T)-7 b(uple)28
b(notation)f(\(t1,...,tn\))i(translates)d(to)i(TCons\(t1,)f(...,)h
(TCons\(tn,)f(TNil\)\))1831 5662 y(21)p eop
%%Page: 22 25
22 24 bop 440 199 a Fl(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Fh(STRA)-8 b(TEGIES)523 653 y Fl(In)25 b(this)g(mo)r(dule)g(w)n
(e)f(de\014ne)h(the)g(op)r(erators)d(of)j(the)g(core)e(strategy)g
(language)g(that)i(will)440 753 y(b)r(e)j(used)g(to)f(express)f(all)i
(programs)d(in)j(the)g(high-lev)n(el)f(language.)440
920 y Fe(module)41 b(strategy)440 1020 y(imports)g(terms)440
1119 y(imports)g(list-cons)440 1287 y Fg(sequential)31
b(non-deterministic)i(pr)n(ograms)523 1387 y Fl(The)f(follo)n(wing)f
(op)r(erators)f(pro)n(vide)g(a)i(language)e(for)i(sequen)n(tial)f
(non-deterministic)440 1486 y(programming.)440 1654 y
Fe(signature)527 1754 y(sorts)42 b(SVar)g(Strat)f(SDef)527
1853 y(constructors)614 1953 y(Id)261 b(:)1482 b(Strat)172
b(\(*)43 b(id)f(*\))614 2052 y(Fail)173 b(:)1482 b(Strat)172
b(\(*)43 b(fail)f(*\))614 2252 y(Test)173 b(:)43 b(Strat)1088
b(->)43 b(Strat)172 b(\(*)43 b(test)f(s)h(*\))614 2351
y(Not)217 b(:)43 b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43
b(not)f(s)h(*\))614 2551 y(Seq)217 b(:)43 b(Strat)f(*)h(Strat)739
b(->)43 b(Strat)172 b(\(*)43 b(s1)f(.)87 b(s2)43 b(*\))614
2650 y(Choice)85 b(:)43 b(Strat)f(*)h(Strat)739 b(->)43
b(Strat)172 b(\(*)43 b(s1)f(+)87 b(s2)43 b(*\))614 2750
y(LChoice)e(:)i(Strat)f(*)h(Strat)739 b(->)43 b(Strat)172
b(\(*)43 b(s1)f(<+)h(s2)g(*\))614 2949 y(SVar)173 b(:)43
b(String)1044 b(->)43 b(SVar)614 3049 y(Rec)217 b(:)43
b(String)e(*)i(Strat)696 b(->)43 b(Strat)172 b(\(*)43
b(rec)f(x)h(.)g(s)g(*\))614 3148 y(Let)217 b(:)43 b(SDef)f(*)h(Strat)
783 b(->)43 b(Strat)172 b(\(*)43 b(let)f(sdef)g(in)h(s2)f(*\))614
3248 y(SDef)173 b(:)43 b(String)e(*)i(List\(String\))c(*)k(Strat)f(->)h
(SDef)216 b(\(*)43 b(f\(xs\))e(=)i(s)g(*\))614 3348 y(Call)173
b(:)43 b(SVar)f(*)h(List\(Strat\))519 b(->)43 b(Strat)172
b(\(*)43 b(f\(ss\))e(*\))440 3515 y Fg(tra)-7 b(versal)31
b(opera)-6 b(tors)614 3683 y Fe(Path)173 b(:)43 b(Int)g(*)g(Strat)826
b(->)43 b(Strat)172 b(\(*)43 b(i\(s\))f(*\))614 3783
y(Cong)173 b(:)43 b(String)e(*)i(List\(Strat\))432 b(->)43
b(Strat)172 b(\(*)43 b(f\(s1,...,sn\))38 b(*\))614 3882
y(One)217 b(:)43 b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43
b(one\(s\))e(*\))614 3982 y(Some)173 b(:)43 b(Strat)1088
b(->)43 b(Strat)172 b(\(*)43 b(some\(s\))d(*\))614 4081
y(All)217 b(:)43 b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43
b(all\(s\))e(*\))614 4181 y(Kids)173 b(:)1482 b(Strat)172
b(\(*)43 b(kids)f(*\))614 4281 y(Thread)85 b(:)43 b(Strat)1088
b(->)43 b(Strat)172 b(\(*)43 b(thread\(s\))c(*\))440
4448 y Fg(ma)-6 b(tching)32 b(and)f(building)440 4616
y Fe(signature)527 4716 y(constructors)614 4815 y(Match)173
b(:)43 b(Term)1131 b(->)43 b(Strat)172 b(\(*)43 b(match\(s\))d(*\))614
4915 y(Build)173 b(:)43 b(Term)1131 b(->)43 b(Strat)172
b(\(*)43 b(build\(s\))d(*\))614 5015 y(MatchVar)h(:)i(String)1043
b(->)43 b(Strat)172 b(\(*)43 b(matchv\(x\))d(*\))614
5114 y(MatchFun)h(:)i(String)1043 b(->)43 b(Strat)172
b(\(*)43 b(matcho\(f\))d(*\))614 5313 y(Scope)129 b(:)43
b(List\(String\))c(*)k(Strat)434 b(->)43 b(Strat)172
b(\(*)43 b({xs:)f(s})g(*\))614 5413 y(Where)129 b(:)43
b(Strat)1088 b(->)43 b(Strat)172 b(\(*)43 b(where)e(s)i(*\))1831
5662 y Fl(22)p eop
%%Page: 23 26
23 25 bop 440 199 a Fl(Chapter:)36 b(Abstract)28 b(Syn)n(tax)440
531 y Fg(annot)-6 b(a)g(tion)614 714 y Fe(Mark)173 b(:)43
b(Term)1132 b(->)43 b(Strat)172 b(\(*)43 b(!)g(t)g(*\))614
814 y(IsMark)85 b(:)43 b(Term)1132 b(->)43 b(Strat)172
b(\(*)43 b(?)g(t)g(*\))614 1013 y(AnnBuild)84 b(:)43
b(Term)f(*)h(Term)740 b(->)43 b(Strat)614 1112 y(AnnMatch)84
b(:)43 b(Term)f(*)h(Term)740 b(->)43 b(Strat)614 1212
y(AnnRemove)d(:)j(Term)1045 b(->)43 b(Strat)440 1494
y Fg(primitives)523 1594 y Fl(Example)22 b(primitiv)n(es)g(for)h(In)n
(tegers)e(are:)34 b(Plus,)23 b(Min)n(us,)h(Geq,)f(NewIn)n(t)g
(\(generate)f(new)440 1694 y(in)n(teger\),)27 b(etc.)37
b(*\))523 1793 y(Strings)27 b(New,)h(StrConc)440 1976
y Fe(signature)527 2076 y(constructors)614 2175 y(Prim)173
b(:)43 b(String)e(->)i(Strat)614 2374 y(CountRule)d(:)j(String)e(->)i
(Strat)1831 5662 y Fl(23)p eop
%%Page: 24 27
24 26 bop 440 199 a Fl(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Fh(SIGNA)-8 b(TURES)523 656 y Fl(T)n(yp)r(es)27
b(and)h(Kinds)440 839 y Fe(module)41 b(signatures)440
938 y(signature)527 1038 y(constructors)614 1137 y(ConstType)f(:)j
(Term)609 b(->)43 b(Type)614 1237 y(FunType)128 b(:)43
b(List\(Term\))d(*)j(Term)f(->)h(Type)523 1420 y Fl(Signatures)440
1602 y Fe(signature)527 1702 y(sorts)f(SortDecl)e(OpDecl)h(BSig)527
1802 y(constructors)614 1901 y(Sort)304 b(:)43 b(String)e(*)i
(List\(Kind\))d(->)i(SortDecl)614 2001 y(OpDecl)216 b(:)43
b(String)e(*)i(Type)304 b(->)42 b(OpDecl)614 2100 y(Sorts)260
b(:)43 b(List\(SortDecl\))256 b(->)42 b(BSig)614 2200
y(Operations)e(:)j(List\(OpDecl\))344 b(->)42 b(BSig)1831
5662 y Fl(24)p eop
%%Page: 25 28
25 27 bop 440 199 a Fl(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Fh(SYNT)-8 b(A)m(CTIC)33 b(SUGAR)523 653 y Fl(In)22
b(this)f(section)g(w)n(e)g(de\014ne)h(sp)r(eci\014cations)f(that)g
(declare)g(signatures,)g(rules)g(and)g(strat-)440 753
y(egy)34 b(de\014nitions.)60 b(This)35 b(is)g(just)h(syn)n(tactic)e
(sugar)g(for)h(declaring)e(a)i(strategy)-7 b(.)58 b(In)36
b(Sec-)440 853 y(tion)28 b Fh(??)h Fl(w)n(e)f(will)g(sho)n(w)g(ho)n(w)f
(these)i(constructs)e(can)h(b)r(e)h(de\014ned)f(in)h(terms)f(of)g(the)h
(basic)440 952 y(strategies)d(of)i(Section)f(.)440 1122
y Fe(module)41 b(sugar)440 1222 y(imports)g(strategy)f(signatures)440
1392 y Fg(v)-7 b(ariadic)31 b(versions)g(of)h(some)f(combina)-6
b(tors)440 1562 y Fe(signature)527 1662 y(constructors)614
1761 y(Seqs)217 b(:)43 b(List\(Strat\))c(->)k(Strat)614
1861 y(Choices)85 b(:)43 b(List\(Strat\))c(->)k(Strat)614
1961 y(LChoices)e(:)i(List\(Strat\))c(->)k(Strat)440
2131 y Fg(ma)-6 b(tch,)31 b(build,)g(appl)-6 b(y)32 b(combina)-6
b(tions)440 2301 y Fe(signature)527 2400 y(constructors)614
2500 y(MA)87 b(:)43 b(Term)85 b(*)44 b(Strat)303 b(->)42
b(Strat)129 b(\(*)43 b(t)g(=>)g(s)g(*\))614 2599 y(AM)87
b(:)43 b(Strat)e(*)j(Term)347 b(->)42 b(Strat)129 b(\(*)43
b(s)g(=>)g(t)g(*\))614 2699 y(BA)87 b(:)43 b(Strat)e(*)j(Term)347
b(->)42 b(Strat)129 b(\(*)43 b(<s>)f(t)h(*\))614 2799
y(BAM)g(:)g(Strat)e(*)j(Term)d(*)j(Term)e(->)g(Strat)129
b(\(*)43 b(<s>)f(t)h(=>)g(t')g(*\))440 2969 y Fg(contexts)32
b(&)f(term)h(applica)-6 b(tion)440 3139 y Fe(signature)527
3238 y(constructors)614 3338 y(Con)435 b(:)43 b(Var)f(*)i(Term)e(*)h
(SVar)f(->)g(Term)173 b(\(*)43 b(x[t]\(f\))e(*\))614
3438 y(App)435 b(:)43 b(Strat)f(*)h(Term)260 b(->)42
b(Term)173 b(\(*)43 b(<s>)f(t)h(*\))614 3537 y(Explode)259
b(:)43 b(Term)f(*)h(Term)304 b(->)42 b(Term)173 b(\(*)43
b(t1)g(#)g(\(t2\))f(*\))614 3637 y(ExplodeCong)83 b(:)43
b(Strat)f(*)h(Strat)216 b(->)42 b(Strat)129 b(\(*)43
b(s1)g(#)g(\(s2\))f(*\))614 3737 y(As)479 b(:)43 b(Var)f(*)i(Term)347
b(->)42 b(Term)173 b(\(*)43 b(x@t)f(*\))614 3836 y(BuildDefault)d(:)k
(Term)609 b(->)42 b(Term)173 b(\(*)43 b(_)g(t)g(*\))440
4006 y Fg(r)n(ules)31 b(&)h(r)n(ule)f(definitions)440
4176 y Fe(signature)527 4276 y(sorts)42 b(Rule)g(RDef)527
4376 y(constructors)614 4475 y(Rule)86 b(:)43 b(Term)f(*)h(Term)f(*)h
(Strat)434 b(->)43 b(Rule)172 b(\(*)43 b(t1)g(->)g(t2)g(where)e(s)i
(*\))614 4575 y(LRule)f(:)h(Rule)1088 b(->)43 b(Strat)128
b(\(*)43 b(\\)g(t1)g(->)g(t2)g(where)e(\\)i(*\))614 4674
y(SRule)f(:)h(Rule)1088 b(->)43 b(Strat)614 4774 y(RDef)86
b(:)43 b(String)e(*)i(List\(String\))c(*)k(Rule)f(->)h(RDef)172
b(\(*)43 b(f\(xs\))f(:)h(r)g(*\))440 4944 y Fg(o)n(verla)-6
b(ys)440 5114 y Fe(signature)527 5214 y(sorts)42 b(Overlay)527
5313 y(constructors)614 5413 y(Overlay)f(:)i(String)e(*)i
(List\(String\))c(*)k(Term)f(->)h(Overlay)1831 5662 y
Fl(25)p eop
%%Page: 26 29
26 28 bop 440 199 a Fl(Chapter:)36 b(Abstract)28 b(Syn)n(tax)440
531 y Fg(specifica)-6 b(tions)440 714 y Fe(signature)527
814 y(sorts)42 b(BSpec)f(Spec)527 913 y(constructors)614
1013 y(Signature)215 b(:)43 b(List\(BSig\))170 b(->)43
b(BSpec)614 1112 y(Overlays)259 b(:)43 b(List\(Overlay\))38
b(->)43 b(BSpec)614 1212 y(Rules)391 b(:)43 b(List\(RDef\))170
b(->)43 b(BSpec)614 1312 y(Strategies)171 b(:)43 b(List\(SDef\))170
b(->)43 b(BSpec)614 1411 y(Imports)303 b(:)43 b(List\(String\))82
b(->)43 b(BSpec)614 1511 y(Specification)c(:)k(List\(BSpec\))126
b(->)43 b(Spec)1831 5662 y Fl(26)p eop
%%Page: 27 30
27 29 bop 440 199 a Fl(Chapter:)36 b(Abstract)28 b(Syn)n(tax)523
531 y Fh(L0)440 739 y Fe(module)41 b(L0)440 839 y(imports)g(strategy)
440 938 y(strategies)527 1137 y(string)g(=)i(id)527 1237
y(int)g(=)g(id)527 1436 y(basic-term\(x\))38 b(=)614
1536 y(Var\(string\))527 1636 y(+)43 b(Int\(int\))527
1735 y(+)g(Str\(string\))527 1835 y(+)g(Op\(string,)d(map\(x\)\))527
2034 y(basic-strat\(x\))e(=)614 2134 y(Id)527 2233 y(+)43
b(Fail)527 2333 y(+)g(Seq\(x,)e(x\))527 2433 y(+)i(LChoice\(x,)d(x\))
527 2532 y(+)j(Choice\(x,)d(x\))527 2632 y(+)j(Not\(x\))527
2731 y(+)g(Test\(x\))527 2831 y(+)g(Scope\(map\(string\))o(,)37
b(x\))527 2931 y(+)43 b(Rec\(string,)c(x\))527 3030 y(+)k
(Let\(SDef\(string,)37 b(map\(string\),)i(x\),)j(x\))527
3130 y(+)h(Cal\(SVar\(string\),)37 b(map\(x\)\))527 3230
y(+)43 b(Path\(int,)d(x\))527 3329 y(+)j(Cong\(string,)c(map\(x\)\))527
3429 y(+)k(One\(x\))527 3528 y(+)g(Some\(x\))527 3628
y(+)g(All\(x\))527 3728 y(+)g(Kids)527 3827 y(+)g(Where\(x\))527
3927 y(+)g(Prim\(string\))527 4027 y(+)g(CountRule\(string\))440
4209 y Fg(l0)523 4309 y Fl(T)-7 b(erms)27 b(ha)n(v)n(e)g(con)n(texts)f
(and)i(applications)440 4491 y Fe(strategies)527 4691
y(m-term)41 b(=)i(rec)g(x\(term\(x\)\))527 4890 y(mc-term)e(=)i(rec)f
(x\()614 4990 y(basic-term\(x\))527 5089 y(+)h(Con\(Var\(string\),)37
b(x,)43 b(string\))527 5189 y(\))527 5388 y(b-term\(strat\))38
b(=)44 b(rec)e(x\()1831 5662 y Fl(27)p eop
%%Page: 28 31
28 30 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)614 531 y Fe(basic-term\(x\))527
631 y(+)43 b(App\(strat,)d(x\))527 731 y(\))527 930 y(bc-term\(strat\))
e(=)43 b(rec)f(x\()614 1029 y(basic-term\(x\))527 1129
y(+)h(Con\(Var\(string\),)37 b(x,)43 b(string\))527 1229
y(+)g(App\(strat,)d(x\))527 1328 y(\))527 1528 y(L0-strat)g(=)k(rec)e
(x\()614 1627 y(basic-strat\(x\))527 1727 y(+)h(BA\(x,)f(b-term\(x\)\))
527 1826 y(+)h(AM\(x,)f(m-term\(x\)\))527 1926 y(+)h
(Match\(m-term\(x\)\))527 2026 y(+)g(Build\(b-term\(x\)\))527
2125 y(+)g(SRule\(Rule\(mc-ter)o(m,)37 b(bc-term\(x\),)i(x\)\))527
2225 y(\))527 2424 y(type)j(=)h(FunType\(map\(id\),)37
b(id\))43 b(+)g(ConstType\(id\))527 2623 y(sig)g(=)g(Signature\(map\(S)
o(ort)o(s\()o(map)o(\(S)o(ort)o(\(s)o(tr)o(ing)o(,)37
b(id\)\)\))42 b(+)1399 2723 y(Operations\(map\(O)o(pD)o(ecl)o(\(s)o
(tri)o(ng)o(,)37 b(type\)\)\)\)\))527 2922 y(rdef)42
b(=)h(RDef\(string,)c(map\(string\),)g(Rule\(term\(strat)o(\),)e
(term\(strat\))527 3022 y(rdefs)42 b(=)h(Rules\(map\(rdef\)\))527
3221 y(section)e(=)i(sig)f(+)i(rdefs)d(+)i(sdefs)527
3421 y(L0)g(=)g(Specification\(ma)o(p\(s)o(ec)o(tio)o(n\))o(\))1831
5662 y Fl(28)p eop
%%Page: 29 32
29 31 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 531 y Fe(\045{)440
731 y(#include)40 b(<aterm2.h>)440 830 y(#include)g("stratego.h")440
930 y(#include)g("stratego.grm.tab)o(.h)o(")440 1029
y(#include)g("options.h")440 1229 y(static)h(void)h(eat_comment\(\);)
440 1328 y(static)f(void)h(eat_c_comment\(\);)440 1428
y(static)f(ATerm)h(mkstring\(\);)440 1528 y(void)g(yyerror\(char)d
(*msg\);)440 1727 y(FILE)j(*outfile;)440 1926 y(#define)f(lexerror\(x,)
e(y\))j(fprintf\(stderr,)c("\045s)k(\045s\\n",)f(x,)i(y\))440
2125 y(#define)e(YY_DECL)84 b(int)42 b(yylex\(YYSTYPE)d(*lvalp\))440
2325 y(extern)i(char)h(file_name[256];)440 2524 y(/*)440
2623 y(lcid)g({lcstart}{idchar)o(s})o(*)440 2723 y(ucid)g
({ucstart}{idchar)o(s})o(*)440 2823 y(lcid)g({idchars}+)440
2922 y(ucid)g({idchars}+)440 3022 y(*/)440 3221 y(\045})440
3421 y(lcstart)f([a-z`])440 3520 y(ucstart)g([A-Z_])440
3620 y(idchars)g({lcstart}|{ucst)o(art)o(}|)o([0-)o(9')o(.\\-)o(])440
3719 y(lcid)h({lcstart}{idchar)o(s})o(*)440 3819 y(ucid)g
({ucstart}{idchar)o(s})o(*)440 3919 y(primeid)f([']{lcid}|{ucid)o(})440
4018 y(ID)i({lcid}|{ucid})440 4118 y(ws)g([\\t\\)f(]*)440
4218 y(num)g([0-9]+)440 4317 y(real)g([\\-]?[0-9]+[.][0)o(-9)o(]+)440
4417 y(shortcom)e("//"[^\\n]*[\\n])440 4516 y(backslash)g(\\x5C)440
4616 y(literate)g({backslash}"liter)o(at)o(e")440 4716
y(endcode)h({backslash}"end)o(\\{c)o(od)o(e\\})o(")440
4815 y(begincode)f({backslash}"begi)o(n\\)o({co)o(de)o(\\}")440
4915 y(endliterate)f({backslash}"endl)o(ite)o(ra)o(te")440
5114 y(\045x)k(COMM)f(MODNAME)e(IMP)j(LIT)f(STARTLIT)440
5313 y(\045option)f(yylineno)440 5413 y(\045option)g(noyywrap)1831
5662 y Fl(29)p eop
%%Page: 30 33
30 32 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 631 y Fe(\045\045)440
830 y(/*)43 b(Literate)d(programs)g(*/)440 1029 y(<INITIAL>{litera)o
(te})d(BEGIN)k(LIT;)440 1129 y(<INITIAL>{endcod)o(e})c(BEGIN)42
b(LIT;)440 1229 y(<LIT>{begincode})37 b(BEGIN)k(INITIAL;)440
1328 y(<LIT>{endliterat)o(e})c(BEGIN)42 b(INITIAL;)440
1428 y(<LIT>\\n)f(;)i(/*)g(ignore)e(newlines)f(*/)440
1528 y(<LIT>.)h(;)i(/*)g(ignore)e(text)h(*/)440 1727
y(/*)h(Layout)e(*/)440 1926 y(<INITIAL>{ws})d(;)43 b(/*)g(ignore)e
(whitespace)f(*/)440 2026 y(<INITIAL>{shortc)o(om})80
b(;)43 b(/*)g(ignore)e(comments)g(*/)440 2125 y(<INITIAL>\\n)e(;)k(/*)g
(ignore)e(newlines)f(*/)440 2325 y(/*)j(Comments)d(\(SML)i(style\))f
(*/)440 2524 y(<INITIAL>"\(*")125 b(eat_comment\(\);)440
2623 y(<INITIAL>"/*")g(eat_c_comment\(\);)440 2823 y(/*)43
b(Module)e(header)g(*/)440 3022 y(<INITIAL>"module)o(")d(BEGIN)j
(MODNAME;)f(return)h(MODULE;)440 3122 y(<INITIAL>"*")e(return)i
(ASTERISK;)440 3221 y(<INITIAL>"=")e(return)i(EQ;)440
3421 y(/*)i(Imports)d(*/)440 3620 y(<INITIAL,MODNAME)o(>"i)o(mp)o(or)o
(ts")80 b(BEGIN)42 b(MODNAME;)e(return)h(IMPORTS;)440
3819 y(<INITIAL,MODNAME)o(>"s)o(tr)o(at)o(egi)o(es)o(")81
b(BEGIN)42 b(INITIAL;)e(return)h(STRATEGIES;)440 3919
y(<INITIAL,MODNAME)o(>"r)o(ul)o(es)o(")299 b(BEGIN)42
b(INITIAL;)e(return)h(RULES;)440 4018 y(<INITIAL,MODNAME)o(>"s)o(ig)o
(na)o(tur)o(e")81 b(BEGIN)41 b(INITIAL;)f(return)h(SIGNATURE;)440
4118 y(<INITIAL,MODNAME)o(>"o)o(ve)o(rl)o(ays)o(")81
b(BEGIN)42 b(INITIAL;)e(return)h(OVERLAYS;)440 4317 y(<MODNAME>"\(*")d
(eat_comment\(\);)440 4417 y(<MODNAME>"/*")g(eat_c_comment\(\);)440
4616 y(<MODNAME>{endcod)o(e})f(BEGIN)42 b(LIT;)440 4815
y(<MODNAME>{lcid})81 b(\(*lvalp\).term)38 b(=)43 b(ATmakeString\(yyte)o
(xt)o(\);)37 b(return)k(LCID;)440 4915 y(<MODNAME>{ucid})81
b(\(*lvalp\).term)38 b(=)43 b(ATmakeString\(yyte)o(xt)o(\);)37
b(return)k(UCID;)440 5114 y(<MODNAME>[)e(\\t\\n])j(;)h(/*)g(ignore)e
(whitespace)e(*/)527 5313 y(/*)k(keywords)d(*/)1831 5662
y Fl(30)p eop
%%Page: 31 34
31 33 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 631 y Fe(<INITIAL>"rec")38
b(return)j(MU;)440 731 y(<INITIAL>"fail")c(return)k(FAIL;)440
830 y(<INITIAL>"id")d(return)j(SUCC;)440 1029 y(<INITIAL>"some")c
(return)k(SOMETOK;)440 1129 y(<INITIAL>"one")d(return)j(ONE;)440
1229 y(<INITIAL>"thread)o(")d(return)j(THREAD;)440 1328
y(<INITIAL>"all")d(return)j(ALL;)440 1428 y(<INITIAL>"not")d(return)j
(NOT;)440 1627 y(<INITIAL>"?")257 b(return)41 b(MATCHe;)440
1727 y(<INITIAL>"!")82 b(return)41 b(BUILDe;)440 1926
y(<INITIAL>"@")82 b(return)41 b(AS;)440 2125 y(<INITIAL>"@?")256
b({/*yymessage\("@?)37 b(not)42 b(implemented"\);)c(*/)43
b(return)e(ANNMATCH;})440 2225 y(<INITIAL>"@!")82 b({/*yymessage\("@!)
37 b(not)42 b(implemented"\);)c(*/)43 b(return)e(ANNBUILD;})440
2325 y(<INITIAL>"@/")82 b({yymessage\("@/)38 b(not)k(implemented"\);)c
(return)j(ANNRM;})440 2524 y(<INITIAL>"where")81 b(return)41
b(WHERE;)440 2623 y(<INITIAL>"test")81 b(return)41 b(TEST;)440
2723 y(<INITIAL>"sorts")81 b(return)41 b(SORTS;)440 2922
y(<INITIAL>"constr)o(uct)o(or)o(s")c(return)k(OPERATIONS;)440
3022 y(<INITIAL>"prim")81 b(return)41 b(PRIM;)440 3321
y(<INITIAL>"match")81 b({yymessage\("mat)o(ch)37 b(obsolete;)j(use)i
(?"\);)g(return)f(MATCH;})440 3421 y(<INITIAL>"build")81
b({yymessage\("bui)o(ld)37 b(obsolete;)j(use)i(!"\);)g(return)f
(BUILD;})440 3520 y(<INITIAL>"operat)o(ion)o(s")80 b
({yymessage\("'oper)o(ati)o(on)o(s')37 b(obsolete;)j(use)i
('constructors'"\);)484 3620 y(return)f(OPERATIONS;})440
3919 y(/*)i(Operators)d(*/)440 4118 y(<INITIAL>"\\\\")213
b(return)41 b(BACKSLASH;)440 4218 y(<INITIAL>".")213
b(return)41 b(DOT;)440 4317 y(<INITIAL>":-")d(return)j(BACKARROW;)440
4417 y(<INITIAL>":=")d(return)j(ASSIGN;)440 4516 y(<INITIAL>"+")e
(return)i(PLUS;)440 4616 y(<INITIAL>"<+")d(return)j(LTPLUS;)440
4716 y(<INITIAL>"_")e(return)i(UNDERSCORE;)440 4815 y(<INITIAL>"**")d
(return)j(STARSTAR;)440 4915 y(<INITIAL>"*")e(return)i(ASTERISK;)440
5015 y(<INITIAL>"=")e(return)i(EQ;)440 5114 y(<INITIAL>",")e(return)i
(COMMA;)440 5214 y(<INITIAL>";")e(return)i(SEMICOLON;)440
5313 y(<INITIAL>":")e(return)i(COLON;)440 5413 y(<INITIAL>"::")d
(return)j(DOUBLECOLON;)1831 5662 y Fl(31)p eop
%%Page: 32 35
32 34 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)440 531 y Fe(<INITIAL>"\(")39
b(return)i(LPAREN;)440 631 y(<INITIAL>"\)")e(return)i(RPAREN;)440
731 y(<INITIAL>"{")e(return)i(LCURLY;)440 830 y(<INITIAL>"}")e(return)i
(RCURLY;)440 930 y(<INITIAL>"[")e(return)i(LBRACK;)440
1029 y(<INITIAL>"]")e(return)i(RBRACK;)440 1129 y(<INITIAL>"<")e
(return)i(LT;)440 1229 y(<INITIAL>">")e(return)i(GT;)440
1328 y(<INITIAL>"<<")d(return)j(LL;)440 1428 y(<INITIAL>">>")d(return)j
(GG;)440 1528 y(<INITIAL>"-->")d(return)j(LONGARROW;)440
1627 y(<INITIAL>"->")d(return)j(ARROW;)440 1727 y(<INITIAL>"=>")d
(return)j(DOUBLEARROW;)440 1826 y(<INITIAL>"<=")d(return)j
(LEFTDOUBLEARROW;)440 1926 y(<INITIAL>"|")e(return)i(BAR;)440
2026 y(<INITIAL>"#")257 b(return)41 b(EXPLODE;)440 2125
y(<INITIAL>"^")257 b(return)41 b(MODIFIER;)440 2325 y(/*)i
(Identifiers,)38 b(strings)j(and)h(numbers)f(*/)440 2524
y(<INITIAL>{lcid})81 b(\(*lvalp\).term)38 b(=)43 b(ATmakeString\(yyte)o
(xt)o(\);)37 b(return)k(LCID;)440 2623 y(<INITIAL>{ucid})81
b(\(*lvalp\).term)38 b(=)43 b(ATmakeString\(yyte)o(xt)o(\);)37
b(return)k(UCID;)440 2723 y(<INITIAL>{primei)o(d})81
b(\(*lvalp\).term)38 b(=)43 b(ATmakeString\(yyt)o(ext)o(+1)o(\);)37
b(return)k(UCID;)440 2823 y(<INITIAL>"\\"")474 b(\(*lvalp\).term)38
b(=)43 b(mkstring\(\);)c(return)j(STRINGTOK;)440 2922
y(<INITIAL>{num})c(\(*lvalp\).num)82 b(=)43 b(atoi\(yytext\);)38
b(return)j(INT;)440 3022 y(<INITIAL>{real})c(\(*lvalp\).real)i(=)k
(atof\(yytext\);)38 b(return)j(REAL;)440 3221 y(/*)i(All)f(other)g
(characters)d(are)j(wrong)g(*/)440 3421 y(<INITIAL>.)d(lexerror)i
(\("ignoring)e(illegal)i(character",)e(yytext\);)440
3620 y(<<EOF>>{BEGIN\(IN)o(ITI)o(AL)o(\);)e(yyterminate\(\);})440
3819 y(\045\045)440 4018 y(/*)484 4118 y(*)43 b(Function)d(which)i
(skips)f(comment)g(chars.)g(The)h(function)e(allows)i('*')g(to)484
4218 y(*)h(occure)e(within)g(comments.)484 4317 y(*/)440
4516 y(static)g(void)h(eat_comment\(\))440 4616 y({)571
4716 y(char)g(c;)571 4915 y(while\()f(1)i(\))571 5015
y({)702 5114 y(/*)f(get)h(a)g(character)d(*/)702 5214
y(c)j(=)g(input\(\);)702 5413 y(/*)f(if)h(it)g(equals)e('*")h(and)h
(the)f(next)g(character)e(equals)h('\)')h(then)1831 5662
y Fl(32)p eop
%%Page: 33 36
33 35 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)745 531 y Fe(*)43
b(the)g(end)f(of)h(the)f(comment)f(is)i(reached.)745
631 y(*/)702 731 y(if\()f(c)h(==)g('*')f(\))702 830 y({)832
930 y(c)h(=)h(input\(\);)832 1029 y(if\()f(c)g(==)g('\)')f(\))963
1129 y(return;)702 1229 y(})571 1328 y(})440 1428 y(})440
1727 y(static)f(void)h(eat_c_comment\(\))440 1826 y({)571
1926 y(char)g(c;)571 2125 y(while\()f(1)i(\))571 2225
y({)702 2325 y(/*)f(get)h(a)g(character)d(*/)702 2424
y(c)j(=)g(input\(\);)702 2623 y(/*)f(if)h(it)g(equals)e('*")h(and)h
(the)f(next)g(character)e(equals)h('/')h(then)745 2723
y(*)h(the)g(end)f(of)h(the)f(comment)f(is)i(reached.)745
2823 y(*/)702 2922 y(if\()f(c)h(==)g('*')f(\))702 3022
y({)832 3122 y(c)h(=)h(input\(\);)832 3221 y(if\()f(c)g(==)g('/')f(\))
963 3321 y(return;)702 3421 y(})571 3520 y(})440 3620
y(})440 3819 y(static)f(char*)h(resize_buf\()d(char*)i(buf,)h(int)g
(size\))440 3919 y({)571 4018 y(buf)g(=)h(\(char*\)realloc\()38
b(buf,)k(size)g(\);)571 4118 y(assert\()e(buf)j(!=)g(NULL)e(\);)571
4218 y(return)g(buf;)440 4317 y(})440 4516 y(#define)g(CHECK\(buf,)e
(size,)j(ind)g(\))h(\\)440 4616 y(if\()f(ind)h(==)f(size)g(\){)h(size)f
(*=)h(2;)g(buf)f(=)h(resize_buf\()c(buf,)j(size)g(\);})440
4815 y(/*)484 4915 y(*)h(This)f(functions)e(parses)h(a)i(quoted)e
(string)g(and)h(accepts)484 5015 y(*)h(escaped)d(quotes)i(\(e.g.,)f
("hello)g(\\"world\\""\))e(within)i(strings.)484 5114
y(*/)440 5214 y(static)g(ATerm)h(mkstring\(\))440 5313
y({)571 5413 y(ATerm)f(theString;)1831 5662 y Fl(33)p
eop
%%Page: 34 37
34 36 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)571 531 y Fe(char*)41
b(buf)i(=)g(NULL;)571 631 y(int)f(c;)571 731 y(int)g(size)g(=)h(512;)
571 830 y(int)f(ind)86 b(=)43 b(0;)571 1029 y(/*)g(use)f(dynamically)d
(resizable)h(buffer)h(to)i(store)e(string)g(*/)571 1129
y(buf)h(=)h(resize_buf\()c(buf,)j(size)g(\);)571 1328
y(/*)h(add)f(opening)f(quote)g(*/)571 1428 y(CHECK\()g(buf,)h(size,)f
(ind)i(\);)571 1528 y(buf[ind++])c(=)k('"';)571 1727
y(while\()e(1)i(\))571 1826 y({)702 1926 y(c)g(=)g(input\(\);)702
2125 y(if\()f(c)h(==)g('\\"')f(\))832 2225 y(break;)702
2424 y(if\()g(c)h(<=)g(0)g(\))702 2524 y({)832 2623 y(yyerror\()e
("String)f(not)j(terminated)c(at)k(eof")f(\);)832 2723
y(return)f(NULL;)702 2823 y(})702 3022 y(/*)h(Handle)f(escaped)g
(character)f(*/)702 3122 y(if\()i(c)h(==)g('\\\\')f(\))702
3221 y({)832 3321 y(CHECK\()f(buf,)h(size,)g(ind)g(\);)832
3421 y(buf[ind++])e(=)j(c;)832 3520 y(c)g(=)h(input\(\);)702
3620 y(})702 3819 y(CHECK\()d(buf,)h(size,)f(ind)h(\);)702
3919 y(buf[ind++])d(=)k(c;)571 4018 y(})571 4118 y(/*)g(Add)f(closing)f
(quote)g(*/)571 4218 y(CHECK\()g(buf,)h(size,)f(ind)i(\);)571
4317 y(buf[ind++])c(=)k('"';)571 4516 y(/*)g(terminate)c(string)i(*/)
571 4616 y(buf[ind])f(=)j('\\0';)571 4815 y(/*)g(convert)d(to)j(aterm)e
(*/)571 4915 y(theString)f(=)j(ATparse\()d(buf)i(\);)571
5114 y(/*)h(free)e(buffer)h(*/)571 5214 y(free\()f(buf)i(\);)571
5413 y(/*)g(return)e(quotes)g(string)g(*/)1831 5662 y
Fl(34)p eop
%%Page: 35 38
35 37 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Lexical)27 b(Analyzer)571 531 y Fe(return)41
b(theString;)440 631 y(})440 731 y(/*)i(flex)f(user)g(code)g(*/)1831
5662 y Fl(35)p eop
%%Page: 36 39
36 38 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Fe(\045{)440 631 y(#include)j
(<aterm1.h>)440 731 y(#include)g("stratego.h")440 930
y(extern)h(int)h(yylineno;)440 1029 y(extern)f(char)h(file_name[256];)
440 1129 y(extern)f(FILE)h(*yyin;)440 1328 y(ATerm)g(parse_tree;)440
1528 y(void)g(yymessage\(char)c(*msg\))440 1627 y({)527
1727 y(fprintf\(stderr,)g("\045s:)j(line)h(\045d)h(-)g(\045s\\n",)e
(file_name,)f(yylineno)g(+)j(1,)g(msg\);)440 1826 y(})440
2026 y(void)f(yyerror\(char)d(*msg\))440 2125 y({)527
2225 y(yymessage\(msg\);)527 2325 y(exit\(1\);)440 2424
y(})440 2623 y(\045})440 2823 y(\045union{)571 2922 y(int)173
b(num;)571 3022 y(double)41 b(real;)571 3122 y(char)129
b(*string;)571 3221 y(ATerm)85 b(term;)571 3321 y(ATermList)40
b(list;)440 3421 y(})440 3620 y(\045{)440 3819 y(/*)j(int)f
(yylex\(void\);)d(*/)440 4018 y(int)j(yylex\(YYSTYPE)d(*lvalp\);)440
4118 y(int)j(yyparse\(void\);)440 4317 y(int)g(parse\(\))440
4417 y({)571 4516 y(int)g(result;)571 4616 y(result)f(=)i(yyparse\(\);)
571 4716 y(return)e(result;)440 4815 y(})440 4915 y(\045})440
5114 y(\045token)g(<term>)g(LCID)440 5214 y(\045token)g(<term>)g
(STRINGTOK)440 5313 y(\045token)g(<term>)g(UCID)440 5413
y(\045token)g(<term>)g(ID)1831 5662 y Fl(36)p eop
%%Page: 37 40
37 39 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 631 y Fe(\045token)k(ARROW)440
731 y(\045token)g(LONGARROW)440 830 y(\045token)g(ASSIGN)440
930 y(\045token)g(ASTERISK)440 1029 y(\045token)g(BACKARROW)440
1129 y(\045token)g(BAR)440 1229 y(\045token)g(BUILD)440
1328 y(\045token)g(AS)440 1428 y(\045token)g(ANNBUILD)440
1528 y(\045token)g(ANNRM)440 1627 y(\045token)g(BUILDe)440
1727 y(\045token)g(COMMA)440 1826 y(\045token)g(EQ)440
1926 y(\045token)g(FAIL)440 2026 y(\045token)g(GG)440
2125 y(\045token)g(IMPORTS)440 2225 y(\045token)g(KIDS)440
2325 y(\045token)g(LBRACK)440 2424 y(\045token)g(LCURLY)440
2524 y(\045token)g(LL)440 2623 y(\045token)g(LPAREN)440
2723 y(\045token)g(LT)440 2823 y(\045token)g(GT)440 2922
y(\045token)g(ANNMATCH)440 3022 y(\045token)g(MATCH)440
3122 y(\045token)g(MATCHe)440 3221 y(\045token)g(MODULE)440
3321 y(\045token)g(NEW)440 3421 y(\045token)g(OPERATIONS)440
3520 y(\045token)g(OVERLAYS)440 3620 y(\045token)g(PARSEPROG)440
3719 y(\045token)g(PARSEQUERY)440 3819 y(\045token)g(PRIM)440
3919 y(\045token)g(RCURLY)440 4018 y(\045token)g(RPAREN)440
4118 y(\045token)g(RULES)440 4218 y(\045token)g(SIGNATURE)440
4317 y(\045token)g(SORTS)440 4417 y(\045token)g(STARSTAR)440
4516 y(\045token)g(STRATEGIES)440 4616 y(\045token)g(STR_GT)440
4716 y(\045token)g(SUCC)440 4815 y(\045token)g(UNDERSCORE)440
4915 y(\045token)g(DOT)440 5015 y(\045token)g(BACKSLASH)440
5114 y(\045token)g(EXPLODE)440 5214 y(\045token)g(MODIFIER)440
5413 y(\045right)g(COLON)h(DOUBLECOLON)1831 5662 y Fl(37)p
eop
%%Page: 38 41
38 40 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Fe(\045right)k(PLUS)h(LTPLUS)440
631 y(\045right)f(SEMICOLON)440 731 y(\045right)g(DOUBLEARROW)440
830 y(\045right)g(LEFTDOUBLEARROW)440 930 y(\045left)85
b(ASSIGN)440 1029 y(\045right)41 b(RBRACK)440 1129 y(\045right)g(NOT)h
(WHERE)g(TEST)g(ONE)g(ALL)h(THREAD)e(SOMETOK)f(MU)440
1229 y(\045right)h(<real>)g(REAL)440 1328 y(\045right)g(<num>)h(INT)440
1528 y(\045type)g(<term>)f(decl)440 1627 y(\045type)h(<list>)f(decls)
440 1727 y(\045type)h(<term>)f(id)440 1826 y(\045type)h(<list>)f
(idlist)440 1926 y(\045type)h(<term>)f(kind)440 2026
y(\045type)h(<list>)f(kinds)440 2125 y(\045type)h(<list>)f(mods)440
2225 y(\045type)h(<term>)f(opdecl)440 2325 y(\045type)h(<list>)f
(opdecls)440 2424 y(\045type)h(<term>)f(optcond)440 2524
y(\045type)h(<list>)f(optcont)440 2623 y(\045type)h(<term>)f(optkind)
440 2723 y(\045type)h(<list>)f(optstrategylist)440 2823
y(\045type)h(<list>)f(opttermlist)440 2922 y(\045type)h(<list>)f
(optvarlist)440 3022 y(\045type)h(<list>)f(overlays)440
3122 y(\045type)h(<term>)f(overlay)440 3221 y(\045type)h(<term>)f(rule)
440 3321 y(\045type)h(<term>)f(stratrule)440 3421 y(\045type)h(<term>)f
(rule_def)440 3520 y(\045type)h(<list>)f(rules)440 3620
y(\045type)h(<term>)f(sdecl)440 3719 y(\045type)h(<list>)f(sdecls)440
3819 y(\045type)h(<term>)f(start)440 3919 y(\045type)h(<list>)f
(strategies)440 4018 y(\045type)h(<term>)f(strategy)440
4118 y(\045type)h(<term>)f(optapplication)440 4218 y(\045type)h(<term>)
f(strategy_def)440 4317 y(\045type)h(<list>)f(strategylist)440
4417 y(\045type)h(<term>)f(strategytail)440 4516 y(\045type)h(<term>)f
(tail)440 4616 y(\045type)h(<term>)f(term)440 4716 y(\045type)h(<list>)
f(termlist)440 4815 y(\045type)h(<term>)f(trav)440 4915
y(\045type)h(<list>)f(tvarlist)440 5015 y(\045type)h(<term>)f(type)440
5114 y(\045type)h(<list>)f(typelist)440 5214 y(\045type)h(<list>)f
(varlist)440 5413 y(\045start)g(start)1831 5662 y Fl(38)p
eop
%%Page: 39 42
39 41 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 631 y Fe(\045pure_parser)440
830 y(\045\045)440 1029 y(start)85 b(:)43 b(MODULE)e(id)i(decls)434
b({parse_tree)39 b(=)k(ATmake\("Specifica)o(ti)o(on)o(\([<)o(li)o(st>)o
(]\))o(",)37 b($3\);})789 1129 y(|)43 b(LBRACK)e(strategy)f(RBRACK)h
(term)86 b({parse_tree)39 b(=)k(App2\("Trm",)c($2,)j($4\);})440
1229 y(|)h(strategy)d({parse_tree)f(=)44 b(App1\("Strategy")o(,$1)o
(\);)o(})440 1328 y(;)440 1528 y(decls)e(:)h(decl)303
b({$$)42 b(=)i(ATmakeList1\($1\))o(;})440 1627 y(|)f(decls)f(decl)85
b({$$)43 b(=)g(ATappend\($1,)38 b($2\);})527 1727 y(|)43
b({$$)g(=)g(ATmakeList0\(\);})789 1826 y(;)440 2026 y(mods)f(:)87
b({$$)42 b(=)h(ATmakeList0\(\);})440 2125 y(|)g(mods)f(id)h({$$)f(=)h
(ATappend\($1,)c($2\);})440 2225 y(;)440 2424 y(decl)j(:)h(IMPORTS)e
(mods)h({$$)g(=)h(App1\("Imports",)38 b(\(ATerm\))i($2\);})440
2524 y(|)j(RULES)f(rules)85 b({$$)42 b(=)h(App1\("Rules",)c(\(ATerm\))h
($2\);})440 2623 y(|)j(STRATEGIES)d(strategies)83 b({$$)42
b(=)h(App1\("Strategies")o(,)37 b(\(ATerm\))k($2\);})440
2723 y(|)i(SIGNATURE)d(sdecls)h({$$)h(=)i(App1\("Signature)o(",)37
b(\(ATerm\))k($2\);})440 2823 y(|)i(OVERLAYS)d(overlays)h({$$)h(=)h
(App1\("Overlays",)37 b(\(ATerm\))k($2\);})789 2922 y(;)440
3122 y(sdecls)g(:)i(sdecl)f({$$)g(=)h(ATmakeList1\($1\);})440
3221 y(|)g(sdecls)e(sdecl)85 b({$$)43 b(=)g(ATappend\($1,)c($2\);})440
3321 y(|)87 b({$$)42 b(=)h(ATmakeList0\(\);})789 3421
y(;)440 3620 y(sdecl)f(:)h(SORTS)e(idlist)g({$$)i(=)g(App1\("Sorts",)38
b(\(ATerm\))j($2\);})440 3719 y(|)i(OPERATIONS)d(opdecls)g({$$)j(=)g
(App1\("Operations)o(",)37 b(\(ATerm\))k($2\);})789 3819
y(;)440 4018 y(idlist)85 b(:)871 b({$$)42 b(=)i(ATmakeList0\(\);})789
4118 y(|)f(idlist)e(id)i(optkind)563 b({$$)43 b(=)g(ATinsert\($1,)c
(App2\("Sort",)f($2,)43 b($3\)\);})440 4317 y(optkind)e(:)86
b({$$)43 b(=)g(ATmake\("Nokind"\))o(;})440 4417 y(|)g(LPAREN)e
(termlist)g(RPAREN)84 b({$$)43 b(=)g(App1\("Kinds",)38
b(\(ATerm\))j($2\);})789 4516 y(;)440 4716 y(kinds)129
b(:)43 b(kind)85 b({$$)43 b(=)g(ATmakeList1\($1\);)o(})440
4815 y(|)g(kinds)f(kind)85 b({$$)43 b(=)g(ATappend\($1,)38
b($2\);})789 4915 y(;)440 5114 y(kind)k(:)h(ASTERISK)d({$$)j(=)g
(ATmake\("Type"\);})440 5214 y(|)g(STARSTAR)d({$$)j(=)g
(ATmake\("TypeList)o("\);)o(})789 5313 y(;)1831 5662
y Fl(39)p eop
%%Page: 40 43
40 42 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Fe(opdecls)k(:)86 b({$$)43
b(=)g(ATmakeList0\(\);})440 631 y(|)g(opdecls)e(opdecl)85
b({$$)42 b(=)h(ATappend\($1,)c($2\);})789 731 y(;)440
930 y(opdecl)i(:)i(id)g(COLON)f(type)f({$$)i(=)g(App2\("OpDecl",)38
b($1,)k($3\);})789 1029 y(;)440 1229 y(type)86 b(:)43
b(typelist)d(ARROW)h(term)86 b({$$)42 b(=)i(App2\("FunType",)37
b(\(ATerm\))k($1,)h($3\);})440 1328 y(|)h(term)f({$$)g(=)i
(App1\("ConstType)o(",)37 b($1\);})789 1428 y(;)440 1627
y(typelist)440 1727 y(:)43 b(typelist)d(ASTERISK)h(term)85
b({$$)43 b(=)g(ATappend\($1,)38 b($3\);})440 1826 y(|)43
b(term)f({$$)g(=)i(ATmakeList1\($1\))o(;})789 1926 y(;)440
2125 y(id)261 b(:)43 b(LCID)85 b({$$)43 b(=)g($1;})614
2225 y(|)h(UCID)85 b({$$)42 b(=)i($1;})789 2325 y(;)440
2524 y(/*)f(Terms)e(*/)440 2723 y(term)86 b(:)43 b(id)f(optcont)346
b({if\(ATisEmpty\($2\))o(\))571 2823 y($$)43 b(=)g(App1\("Var",)c
($1\);)484 2922 y(else)571 3022 y($$)k(=)g(App3\("Con",)702
3122 y(App1\("Var",)c($1\),)i(ATgetFirst\($2\),)702 3221
y(ATgetFirst\(ATge)o(tN)o(ext)o(\($)o(2\)\))o(\);)o(})440
3421 y(|)i(UNDERSCORE)d({$$)i(=)h(ATmake\("Wld"\);})440
3620 y(|)g(UNDERSCORE)d(term)i({$$)g(=)h(App1\("BuildDefau)o(lt")o(,)37
b($2\);})440 3819 y(|)43 b(INT)348 b({$$)42 b(=)h(App1\("Int",)c
(\(ATerm\))i(ATmakeInt\($1\)\);})440 3919 y(|)i(REAL)347
b({$$)43 b(=)g(App1\("Real",)38 b(\(ATerm\))j(ATmakeReal\($1\)\);)o(})
440 4018 y(|)i(STRINGTOK)d({$$)i(=)i(App1\("Str",)39
b($1\);})702 4118 y(|)k(id)f(opttermlist)83 b({$$)42
b(=)i(App2\("Op",)39 b($1,)j(\(ATerm\))f($2\);})789 4218
y(|)i(id)g(AS)f(term)870 b({$$)43 b(=)g(App2\("As",)c(App1\("Var",)g
($1\),)j($3\);})440 4317 y(|)h(LT)g(strategy)d(GT)j(term)85
b({$$)43 b(=)g(App2\("App",)c($2,)j($4\);})440 4417 y(|)h(LBRACK)e
(termlist)g(tail)g(RBRACK)129 b({$$)42 b(=)h(list_to_consnil_o)o(p_)o
(tl\()o($2)o(,)38 b($3\);})440 4516 y(|)43 b(LPAREN)e(termlist)g
(RPAREN)g({$$)h(=)h(list_to_tconstnil)o(_o)o(p\()o($2\))o(;})440
4616 y(|)g(term)f(EXPLODE)f(LPAREN)g(term)h(RPAREN)440
4716 y({$$)g(=)i(App2\("Explode",)37 b($1,)42 b($4\)})789
4815 y(;)440 5015 y(tail)173 b(:)86 b({$$)43 b(=)g(ATmake\("Op\(\\"Nil)
o(\\",)o([])o(\)")o(\);})440 5114 y(|)g(BAR)g(term)85
b({$$)42 b(=)i($2;})789 5214 y(;)440 5413 y(optcont)d(:)i({$$)f(=)h
(ATmakeList0\(\);})1831 5662 y Fl(40)p eop
%%Page: 41 44
41 43 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Fe(|)43 b(LBRACK)e(term)h(optcond)f
(RBRACK)g(trav)440 631 y({$$)h(=)i(ATmakeList2\($2,)37
b(App2\("Call",)i($5,)j(\(ATerm\))f(ATmakeList0\(\)\)\))o(;})789
731 y(;)440 930 y(trav)173 b(:)86 b({$$)43 b(=)g(ATmake\("SVar\(\\"o)o
(nce)o(td)o(\\")o(\)"\))o(;)37 b(})440 1029 y(|)43 b(LPAREN)e(id)i
(RPAREN)85 b({$$)42 b(=)h(App1\("SVar",)c($2\);})440
1229 y(opttermlist)440 1328 y(:)87 b({$$)42 b(=)h(ATmakeList0\(\);})440
1428 y(|)g(LPAREN)e(termlist)g(RPAREN)84 b({$$)43 b(=)g($2;})789
1528 y(;)440 1727 y(termlist:)d(term)i({$$)g(=)h(ATmakeList1\($1\);})
440 1826 y(|)g(term)f(COMMA)g(termlist)127 b({$$)42 b(=)i
(ATinsert\($3,)38 b($1\);})789 1926 y(|)43 b({$$)f(=)h
(ATmakeList0\(\);})789 2026 y(;)440 2225 y(tvarlist:)d(LCID)i({$$)g(=)h
(ATmakeList1\($1\);})440 2325 y(|)g(LCID)f(COMMA)g(tvarlist)127
b({$$)42 b(=)i(ATinsert\($3,)38 b($1\);})789 2424 y(|)43
b({$$)f(=)h(ATmakeList0\(\);})789 2524 y(;)440 2723 y(/*)g(Rewrite)d
(rules)i(*/)440 2922 y(rules)85 b(:)523 b({$$)42 b(=)h
(ATmakeList0\(\);})745 3022 y(|)g(rules)f(rule_def)127
b({$$)43 b(=)g(ATappend\($1,)38 b($2\);})789 3122 y(;)440
3321 y(rule_def)440 3421 y(:)43 b(id)g(optvarlist)c(COLON)j(rule)g({$$)
g(=)h(App3\("RDef",)c($1,)j(\(ATerm\))f($2,)h(\(ATerm\))f($4\);})440
3520 y(|)i(id)g(optvarlist)440 3620 y(DOUBLECOLON)c(stratrule)h({$$)i
(=)h(App3\("RDef",)c($1,)j(\(ATerm\))f($2,)h(\(ATerm\))f($4\);})789
3719 y(;)440 3919 y(rule)173 b(:)43 b(term)f(ARROW)f(term)h(optcond)85
b({$$)42 b(=)h(App3\("Rule",)c($1,)j($3,)g($4\);)440
4018 y(})789 4118 y(;)440 4317 y(stratrule)e(:)j(strategy)d(LONGARROW)g
(strategy)g(optcond)440 4417 y({$$)i(=)i(App3\("StratRule)o(",)37
b($1,)42 b($3,)h($4\);)f(})789 4516 y(;)440 4716 y(optcond)f(:)i({$$)f
(=)h(ATmake\("Id"\);})440 4815 y(|)g(WHERE)f(strategy)e({$$)i(=)h
(App1\("Where",)c($2\);})789 4915 y(;)440 5114 y(/*)k(Strategies)c(*/)
440 5313 y(optapplication)440 5413 y(:)87 b({$$)42 b(=)h
(ATmake\("Id"\);})1831 5662 y Fl(41)p eop
%%Page: 42 45
42 44 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Fe(|)43 b(LEFTDOUBLEARROW)38
b(strategy)i({$$)i(=)h($2;})440 731 y(strategy)440 830
y(:)g(id)g(optstrategylist)81 b({$$)42 b(=)h(App2\("Call",)c
(App1\("SVar",)g($1\),)j(\(ATerm\))e($2\);})440 1029
y(|)j(id)g(MODIFIER)d(id)j(optstrategylist)527 1129 y({$$)g(=)g
(App2\("Call",)38 b(App1\("SVar",)h(App2\("Mod",)g($1,)j($3\)\),)g
(\(ATerm\)$4\);})440 1328 y(|)h(strategy)d(EXPLODE)h(LPAREN)g(strategy)
g(RPAREN)440 1428 y({$$)h(=)i(App2\("ExplodeCo)o(ng)o(",)37
b($1,)43 b($4\)})440 1627 y(|)g(MATCH)f(LPAREN)f(term)h(RPAREN)f({$$)h
(=)h(App1\("Match",)c($3\);})440 1826 y(|)k(MATCH)f(LPAREN)f(term)h
(RPAREN)f({$$)h(=)h(App1\("Match",)c($3\);})440 2026
y(|)k(MATCHe)e(term)h(optapplication)c({$$)k(=)i(App2\("AM",)39
b($3,)j($2\);})440 2225 y(/*)h(|)g(MATCHe)e(term)86 b({$$)42
b(=)h(App1\("Match",)38 b($2\);})k(*/)440 2424 y(|)h(BUILD)85
b(LPAREN)41 b(term)h(RPAREN)f({$$)i(=)g(App1\("Build",)38
b($3\);})440 2524 y(|)43 b(BUILDe)e(term)h({$$)h(=)g(App1\("Build",)38
b($2\);})440 2723 y(|)43 b(ANNMATCH)d(LPAREN)i(term)f(COMMA)h(term)g
(RPAREN)440 2823 y({$$)g(=)i(App2\("AnnMatch")o(,)37
b($3,)43 b($5\);})440 2922 y(|)g(ANNBUILD)d(LPAREN)i(term)f(COMMA)h
(term)g(RPAREN)440 3022 y({$$)g(=)i(App2\("AnnBuild")o(,)37
b($3,)43 b($5\);})440 3122 y(|)g(ANNRM)f(term)870 b({$$)42
b(=)h(App1\("AnnRemove",)37 b($2\);})440 3321 y(|)43
b(NEW)217 b({$$)42 b(=)h(ATmake\("Prim\(\\"ne)o(w\\")o(\)")o(\);)o(})
440 3421 y(|)g(STR_GT)216 b({$$)42 b(=)h(ATmake\("Prim\(\\"st)o(r_)o
(gt)o(\\"\))o("\))o(;})440 3520 y(|)g(KIDS)216 b({$$)43
b(=)g(ATmake\("Prim\(\\"k)o(ids)o(\\")o(\)")o(\);})789
3620 y(|)g(PRIM)f(LPAREN)f(STRINGTOK)f(RPAREN)84 b({$$)43
b(=)g(App1\("Prim",)c($3\);})789 3819 y(|)k(LL)g(rule)f(GG)g({$$)h(=)g
(App1\("SRule",)38 b($2\);})789 3919 y(|)43 b(BACKSLASH)d(rule)i
(BACKSLASH)e({$$)i(=)h(App1\("LRule",)38 b($2\);})440
4018 y(|)43 b(LT)g(strategy)d(GT)j(term)f({$$)g(=)h(App2\("BA",)d($2,)i
($4\);})440 4218 y(|)h(strategy)d(DOUBLEARROW)f(term)j({$$)h(=)g
(App2\("AM",)c($1,)k($3\);})440 4417 y(/*)g(|)g(term)f(ASSIGN)f(term)h
({$$)g(=)h(App2\("AM",)d($1,)i(App1\("Build",)c($3\)\);})k(*/)789
4516 y(|)h(FAIL)85 b({$$)43 b(=)g(ATmake\("Fail"\);})789
4616 y(|)g(SUCC)85 b({$$)43 b(=)g(ATmake\("Id"\);})789
4716 y(|)g(INT)f(strategy)e({$$)j(=)g(App2\("Path",)c(\(ATerm\))h
(ATmakeInt\($1\),)e($2\);)k(})789 4815 y(|)h(NOT)86 b(LPAREN)41
b(strategy)f(RPAREN)h({$$)i(=)g(App1\("Not",)c($3\);})789
4915 y(|)k(WHERE)e(LPAREN)g(strategy)g(RPAREN)g({$$)h(=)h
(App1\("Where",)c($3\);})789 5015 y(|)k(TEST)85 b(LPAREN)41
b(strategy)g(RPAREN)g({$$)h(=)h(App1\("Test",)c($3\);})440
5114 y(|)k(LCURLY)e(tvarlist)g(COLON)g(strategy)f(RCURLY)440
5214 y({$$)i(=)i(App2\("Scope",)38 b(\(ATerm\))i($2,)j($4\);})440
5313 y(|)g(strategy)d(SEMICOLON)g(strategy)h({$$)h(=)h(App2\("Seq",)c
($1,)j($3\);})440 5413 y(|)h(strategy)d(PLUS)i(strategy)84
b({$$)43 b(=)g(App2\("Choice",)38 b($1,)k($3\);})1831
5662 y Fl(42)p eop
%%Page: 43 46
43 45 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)789 531 y Fe(|)43 b(strategy)d(LTPLUS)h
(strategy)171 b({$$)43 b(=)g(App2\("LChoice",)37 b($1,)43
b($3\);})440 631 y(|)g(MU)g(LCID)f(LPAREN)f(strategy)f(RPAREN{$$)g(=)j
(App2\("Rec",)c($2,)k($4\);})440 731 y(|)g(SOMETOK)e(LPAREN)g(strategy)
f(RPAREN{$$)g(=)j(App1\("Some",)c($3\);})440 830 y(|)k(ONE)g(LPAREN)e
(strategy)f(RPAREN)h({$$)h(=)i(App1\("One",)39 b($3\);})440
930 y(|)k(ALL)g(LPAREN)e(strategy)f(RPAREN)h({$$)h(=)i(App1\("All",)39
b($3\);})440 1029 y(|)k(THREAD)e(LPAREN)g(strategy)g(RPAREN)g({$$)h(=)h
(App1\("Thread",)38 b($3\);})440 1129 y(|)43 b(LPAREN)e(strategylist)e
(RPAREN)i({$$)h(=)i(tuple_cong\($2\);)o(})440 1229 y(|)f(LBRACK)e
(strategylist)484 1328 y(strategytail)d(RBRACK)j({$$)i(=)g
(list_cong\($2,)38 b($3\);})440 1428 y(|)43 b(STRINGTOK)d({$$)i(=)i
(App1\("Match",)38 b(App1\("Str",)h($1\)\);})440 1528
y(|)k(INT)348 b({$$)42 b(=)h(App1\("Match",)702 1627
y(App1\("Int",)c(\(ATerm\))h(ATmakeInt\($1\)\)\);})440
1727 y(|)j(REAL)347 b({$$)43 b(=)g(App1\("Match",)702
1826 y(App1\("Real",)38 b(\(ATerm\))j(ATmakeReal\($1\)\)\))o(;})789
1926 y(;)440 2125 y(strategytail)440 2225 y(:)87 b({$$)42
b(=)h(ATmake\("Call\(SVar)o(\(\\)o("Ni)o(l\\)o("\),)o([])o(\)")o(\);})
440 2325 y(|)g(BAR)g(strategy)d({$$)i(=)h($2;})440 2424
y(;)440 2623 y(optstrategylist)440 2723 y(:)305 b({$$)42
b(=)h(ATmakeList0\(\);})440 2823 y(|)g(LPAREN)e(strategylist)e(RPAREN)
85 b({$$)42 b(=)h($2;})789 2922 y(;)440 3122 y(strategylist)440
3221 y(:)87 b({$$)42 b(=)h(ATmakeList0\(\);})440 3321
y(|)g(strategy)84 b({$$)42 b(=)i(ATmakeList1\($1\))o(;})440
3421 y(|)f(strategy)d(COMMA)i(strategylist)82 b({$$)43
b(=)g(ATinsert\($3,)38 b($1\);})789 3520 y(;)440 3719
y(/*)43 b(Strategy)d(definitions)f(*/)440 3919 y(strategies)440
4018 y(:)1133 b({$$)42 b(=)h(ATmakeList0\(\);})440 4118
y(|)g(strategies)d(strategy_def)82 b({$$)42 b(=)h(ATappend\($1,)c
($2\);})789 4218 y(;)440 4417 y(strategy_def)440 4516
y(:)k(id)g(optvarlist)c(EQ)k(strategy)d({$$)j(=)g(App3\("SDef",)c($1,)j
(\(ATerm\))f($2,)h($4\);})789 4616 y(;)440 4815 y(optvarlist)440
4915 y(:)87 b({$$)42 b(=)h(ATmakeList0\(\);})440 5015
y(|)g(LPAREN)e(varlist)g(RPAREN)85 b({$$)42 b(=)h($2;})789
5114 y(;)440 5313 y(varlist)e(:)86 b({$$)43 b(=)g(ATmakeList0\(\);})440
5413 y(|)g(id)g({$$)f(=)h(ATmakeList1\($1\);})1831 5662
y Fl(43)p eop
%%Page: 44 47
44 46 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 299
y(Section:)h(P)n(arser)440 531 y Fe(|)43 b(id)g(COMMA)e(varlist)85
b({$$)42 b(=)h(ATinsert\($3,)c($1\);})789 631 y(;)440
830 y(overlays:)h({$$)i(=)h(ATmakeList0\(\);})440 930
y(|)g(overlay)e(overlays)84 b({$$)42 b(=)h(ATinsert\($2,)c($1\);})789
1029 y(;)440 1229 y(overlay)i(:)i(id)g(LPAREN)e(varlist)f(RPAREN)i(EQ)g
(term)440 1328 y({$$)g(=)i(App3\("Overlay",)37 b($1,)42
b(\(ATerm\))f($3,)h($6\);})440 1428 y(|)h(id)g(EQ)g(term)85
b({$$)43 b(=)g(App3\("Overlay",)37 b($1,)42 b(\(ATerm\))f
(ATmakeList0\(\),)d($3\);})789 1528 y(;)440 1727 y(/*)43
b(Note)f(this)g(allows)f(contexts)f(in)j(overlay)d(definitions;)f
(should)i(be)i(excluded)440 1826 y(by)g(checking)d(in)j(front-end)d(*/)
1831 5662 y Fl(44)p eop
%%Page: 45 48
45 47 bop 440 199 a Fl(Chapter:)36 b(P)n(arser)440 298
y(Section:)h(Mo)r(dule)28 b(Flattening)440 531 y Fe(PACK-STRATEGO)p
440 642 2865 4 v 440 765 4 124 v 468 724 a Fl(This)g(mo)r(dule)g
(de\014nes)f(a)g(pac)n(king)g(algorithm)f(for)h(Stratego.)p
3301 765 V 440 768 2865 4 v 440 904 a(-)g(command-line)g(option)h
(handling)440 1074 y(-)f(writing)h(dep)r(endencies)f(to)h(.r.dep)440
1243 y(-)f(\014nding)h(\014le)g(based)f(on)g(path)440
1412 y(-)g(parsing)g(the)h(\014le)f(for)g(a)h(mo)r(dule)g(based)f(on)g
(giv)n(en)g(parser)440 1582 y(-)g(\015attening)440 1826
y Fe(module)41 b(pack-stratego)440 1926 y(imports)g(lib)h(pack-graph)d
(pack-modules)g(sugar)440 2125 y(strategies)527 2325
y(main)j(=)h(pack-modules\(pack)o(-s)o(tra)o(te)o(go,)37
b(basename\))440 2524 y(strategies)527 2723 y(pack-stratego\(mkp)o(t\))
g(=)789 2823 y(\\)43 b(root)f(->)h(\(root,)e(\(\),)h([]\))g(\\;)789
2922 y(graph-nodes\(Fst)o(;)c(parse\(parse-mod)o(,)g(mkpt,)j(!"r"\),)
1312 3022 y(get-stratego-imp)o(or)o(ts)o(,)1312 3122
y(\\)i(\(n,x,xs\))d(->)j([x|xs])e(\\)i(\);)789 3221 y(unzip;)789
3321 y(\(id,)f(flatten-strateg)o(o\))527 3520 y(\(*)h(parse)e(::)i
(\(filename)d(->)j(parsetree\))1050 3620 y(*)g(\(\(\))g(->)f(path\))
1050 3719 y(*)h(\(\(\))g(->)f(ext\))1050 3819 y(->)h(\(filename)d(->)j
(parsetree\))527 3919 y(*\))527 4118 y(parse\(parser,)38
b(mkpath,)j(ext\))h(=)789 4218 y(find-file\(mkpat)o(h,)37
b(ext\);)789 4317 y(split\(id,)j(parser\))527 4516 y(get-stratego-impo)
o(rt)o(s)d(=)789 4616 y(\\)43 b(\(_,)f(Specification\(xs\))o(\))37
b(->)43 b(xs)g(\\;)789 4716 y(filter\(\\Imports)o(\(xs)o(\))37
b(->)43 b(xs\\)g(\);)789 4815 y(concat)527 5015 y(flatten-stratego)37
b(=)789 5114 y(map\(\\Specificat)o(ion)o(\(x)o(s\))g(->)43
b(xs\\;)f(filter\(not\(Impor)o(ts)o(\(id)o(\)\))o(\)\);)789
5214 y(concat;)789 5313 y(\\)h(xs)g(->)f(Specification\(xs\))37
b(\\)1831 5662 y Fl(45)p eop
%%Page: 46 49
46 48 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 531 y Fe(rules)527 731
y(parse-mod)40 b(:)j(in)g(->)g(trm)614 830 y(where)f(<conc-strings>)c
(\("pack-stratego)o(",)1573 930 y(<get-pid;)i(int-to-string>\(\))o(\))e
(=>)k(out;)876 1029 y(\(*)h(<printnl>)c(\(stderr,)i([")86
b(parsing)41 b(",)i(in]\);)e(*\))876 1129 y(<call>\("parse-mo)o(d")o(,)
d(["-silent",)h("-i",)i(in,)h("-o",)g(out]\);)876 1229
y(<ReadFromFile>)c(out)k(=>)h(trm;)876 1328 y(<rm-files>)c([out])1831
5662 y Fl(46)p eop
%%Page: 47 50
47 49 bop 440 199 a Fl(Chapter:)36 b(Library)440 531
y(The)26 b(mo)r(dules)g(in)h(this)f(c)n(hapter)f(de\014ne)i(common)e
(op)r(erations)g(on)h(Stratego)f(data)g(t)n(yp)r(es.)1831
5662 y(47)p eop
%%Page: 48 51
48 50 bop 440 199 a Fl(Chapter:)36 b(Library)440 531
y Fh(LIBRAR)-8 b(Y)32 b(F)m(OR)g(STRA)-8 b(TEGIES)440
726 y Fl(This)19 b(mo)r(dule)f(instan)n(tiates)g(sev)n(eral)f(language)
g(indep)r(enden)n(t)j(functions)f(de\014ned)g(in)f(mo)r(d-)440
825 y(ule)28 b(subs)f(to)h(the)g(strategy)e(language.)440
1078 y Fe(module)41 b(stratlib)440 1177 y(imports)g(strategy)f
(substitution)f(free-variables)440 1430 y(rules)527 1629
y(Add1)j(:)h(Var\(x\))85 b(->)43 b([x])527 1729 y(Add2)f(:)h(SVar\(x\))
e(->)i([x])527 1928 y(IsVar)85 b(:)43 b(Var\(x\))f(->)g(x)527
2027 y(IsSVar)f(:)i(Call\(SVar\(x\),)c([]\))j(->)h(x)527
2127 y(MkTVar)e(:)i(x)h(->)e(Var\(x\))527 2227 y(MkSVar)f(:)i(x)h(->)e
(SVar\(x\))527 2326 y(MkCall)f(:)i(x)h(->)e(Call\(SVar\(x\),)d([]\))440
2678 y Fg(bound)31 b(v)-7 b(ariables)440 2848 y Fl(The)30
b(follo)n(wing)f(rules)g(and)h(strategies)f(de\014ne)h(whic)n(h)g
(constructs)f(bind)i(v)-5 b(ariables.)42 b(The)440 2947
y Fe(Bnd)28 b Fl(rules)g(de\014ne)i(whic)n(h)f(v)-5 b(ariables)28
b(are)g(b)r(ound.)42 b(The)29 b Fe(paste)e Fl(strategies)h(de\014ne)h
(where)440 3047 y(new)35 b(v)-5 b(ariables)34 b(should)h(b)r(e)h
(pasted)f(in)h(case)e(of)h(renaming.)59 b(The)35 b Fe(boundin)e
Fl(strategies)440 3147 y(de\014ne)28 b(in)g(whic)n(h)f(argumen)n(ts)g
(of)g(the)h(constructs)f(the)h(v)-5 b(ariables)26 b(are)h(binding.)440
3399 y Fe(rules)527 3598 y(Bind0)42 b(:)h(Scope\(xs,)d(s\))i(->)h(xs)
527 3698 y(Bind0)f(:)h(LRule\(Rule\(t1,)38 b(t2,)k(s\)\))g(->)h
(<tvars>)e(t1)527 3797 y(Bind1)h(:)h(Let\(SDef\(f,)c(xs,)j(s1\),)g
(s2\))h(->)f([f])527 3897 y(Bind2)g(:)h(SDef\(f,)e(xs,)h(s\))h(->)f(xs)
527 3997 y(Bind3)g(:)h(Rec\(x,)e(s\))i(->)f([x])440 4196
y(strategies)527 4395 y(tpaste\(nwvars\))c(=)789 4495
y(Scope\(nwvars,)g(id\))527 4694 y(tboundin\(bnd,)g(ubnd,)k(ignore\))f
(=)789 4794 y(Scope\(ignore,)d(bnd\))527 4993 y(spaste\(nwvars\))g(=)
876 5093 y(Let\(SDef\(nwvars;)f(Hd,)42 b(id,)h(id\),)e(id\))789
5192 y(+)i(SDef\(id,)d(nwvars,)h(id\))789 5292 y(+)i(Rec\(nwvars;)c
(Hd,)j(id\))1831 5662 y Fl(48)p eop
%%Page: 49 52
49 51 bop 440 199 a Fl(Chapter:)36 b(Library)527 531
y Fe(sboundin\(bnd,)i(ubnd,)k(ignore\))f(=)876 631 y
(Let\(SDef\(ignore,)c(ignore,)k(ubnd\),)g(bnd\))789 731
y(+)i(SDef\(ignore,)38 b(ignore,)j(bnd\))789 830 y(+)i(Rec\(ignore,)c
(bnd\))440 1179 y Fg(free)32 b(v)-7 b(ariables)31 b(and)g(renaming)440
1428 y Fe(strategies)527 1627 y(tvars)42 b(=)h(free-vars\(Add1,)37
b(Bind0,)k(tboundin\))527 1826 y(svars)h(=)h(free-vars\(Add2,)37
b(Bind1)42 b(+)h(Bind2)e(+)j(Bind3,)d(sboundin\))527
2026 y(trename)g(=)i(rename\(Var,)c(Bind0,)i(tboundin,)f(tpaste\))527
2125 y(srename)h(=)i(rename\(SVar,)c(Bind1)i(+)i(Bind2)f(+)h(Bind3,)e
(sboundin,)f(spaste\))527 2325 y(svars-arity)f(=)614
2424 y(free-vars2\(\\Call\()o(SV)o(ar\()o(f\))o(,)f(as\))k(->)h([\(f,)f
(<length>)e(as\)]\\)1050 2524 y(,\(Bind1)h(+)i(Bind2)f(+)h(Bind3\))1050
2623 y(,sboundin)1050 2723 y(,{f:?\(\(f,_\),f\)}\))527
2922 y(tsubs)f(=)h(subs\(IsVar\))527 3022 y(ssubs)f(=)h(subs\(IsSVar\))
527 3221 y(tsubstitute)c(=)k(substitute\(Var,)38 b(Bind0,)j(tboundin,)f
(tpaste\))440 3421 y(\(*)527 3520 y(rn_apply\(nvs,)e(bnd,)k(nbnd\))g(=)
h(Scope\(nvs,)c(bnd\))1617 3620 y(+)k(Let\(SDef\(nvs)c(;)k(Hd,)f(id,)g
(id\))h(;)g(nbnd,)f(bnd\))1617 3719 y(+)h(SDef\(id,)d(nvs,)i(bnd\))1617
3819 y(+)h(Rec\(nvs)e(;)i(Hd,)f(bnd\))440 3919 y(*\))440
4018 y(\(*)527 4118 y(trename)f(=)i(rename\(Var\(id\),)37
b(MkTVar,)k(Bind0\))527 4218 y(srename)g(=)i(rename\(SVar\(id\),)37
b(MkSVar,)k(Bind1)g(+)i(Bind2)f(+)h(Bind3\))440 4317
y(*\))440 4516 y(\(*)527 4616 y(tapply\(nvs,)c(bnd,)j(nbnd\))g(=)h
(Scope\(nvs,)c(bnd\))527 4815 y(sapply\(nvs,)g(bnd,)j(nbnd\))g(=)h
(Let\(SDef\(nvs)38 b(;)44 b(Hd,)e(id,)g(id\))h(;)g(nbnd,)e(bnd\))1617
4915 y(+)i(SDef\(id,)d(nvs,)i(bnd\))1617 5015 y(+)h(Rec\(nvs)e(;)i(Hd,)
f(bnd\))527 5214 y(trename)f(=)i(rename\(Var,)c(Bind0,)i(tapply\))527
5313 y(srename)g(=)i(rename\(SVar,)c(Bind1)i(+)i(Bind2)f(+)h(Bind3,)e
(sapply\))440 5413 y(*\))1831 5662 y Fl(49)p eop
%%Page: 50 53
50 52 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)527 631 y Fe(strename)40
b(=)k(trename)c(;)j(srename)527 830 y(is_var_list)c(=)k
(map\(Var\(id\)\))527 930 y(is_svar_list)c(=)k(map\(SVar\(id\)\))440
1182 y Fl(Con)n(text)27 b(strategies)f(for)h(strategies)440
1435 y Fe(strategies)527 1634 y(conLChoice\(s\))38 b(=)44
b(rec)e(x\(s)g(+)h(LChoice\(x,)d(id\))i(+)h(LChoice\(id,)c(x\)\))527
1833 y(conChoice\(s\))g(=)k(rec)f(x\(s)h(+)g(\(Choice\(x,)c(id\))k(+)g
(Choice\(id,)c(x\)\)\))527 2032 y(conChoiceL\(s\))f(=)44
b(Choice\(s,)39 b(id\))k(+)g(s)527 2232 y(choicebu-l'\(s\))38
b(=)43 b(rec)f(x\(try\(Choice\(id,)37 b(x\);)43 b(s\)\))527
2431 y(choicebu-l\(s\))38 b(=)44 b(rec)e(x\(try\(Choice\(x,)37
b(x\);)43 b(s\)\))527 2630 y(choicetd\(s\))c(=)k(rec)g(x\(s)f(<+)h
(Choice\(x,)d(x\)\))527 2829 y(choicemap\(s\))f(=)k(rec)f
(x\(Choice\(x,)d(x\))k(<+)g(s\))527 3029 y(choicebu\(s\))c(=)k(rec)g
(x\(try\(Choice\(x,)37 b(x\);)42 b(s\)\))527 3228 y(firstInSeq\(s\))c
(=)44 b(s)f(<+)f(Seq\(s,)g(id\))527 3427 y(lastInSeq\(s\))d(=)k
(Seq\(id,)e(rec)h(x\(s)g(<+)h(Seq\(not\(oncetd\(s)o(\)\),)37
b(x\)\)\))1831 5662 y Fl(50)p eop
%%Page: 51 54
51 53 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)1248 3112 y Fa(Compilation)1831
5662 y Fl(51)p eop
%%Page: 52 55
52 54 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y(In)22 b(this)h(section)f(w)n(e)g(de\014ne)g(the)h(desugaring)d
(pro)r(cedure)h(that)i(translates)e(a)h(sp)r(eci\014cation)440
631 y(in)28 b(the)g(high-lev)n(el)e(syn)n(tax)h(to)h(an)f(expression)f
(in)i(the)g(core)e(language.)1831 5662 y(52)p eop
%%Page: 53 56
53 55 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fe(FRONTEND)440 809 y(module)41 b(frontend)440
908 y(imports)g(normalize-spec)789 1008 y(spec-to-sdefs)789
1108 y(use-def)789 1207 y(check-construct)o(ors)440 1307
y(strategies)527 1506 y(frontendIO)f(=)j(iowrap\(frontend\))527
1705 y(frontend)d(=)789 1805 y(//where\(dtime;)d(debug\(!")84
b(frontend)41 b(initialization:)c("\)\);)789 1905 y(normalize-spec;)789
2004 y(//where\(dtime;)g(debug\(!")84 b(normalize-spec:)38
b("\)\);)789 2104 y(where\(spec-use-)o(def)o(\);)789
2203 y(//where\(dtime;)f(debug\(!")84 b(spec-use-def:)39
b("\)\);)789 2303 y(ExpandOverlays;)789 2403 y(//where\(dtime;)e
(debug\(!")84 b(ExpandOverlays:)38 b("\)\);)789 2502
y(try\(CheckConstr)o(uct)o(or)o(s\)/)o(/;)789 2602 y(//where\(dtime;)f
(debug\(!")84 b(CheckConstructors)o(:)37 b("\)\))1831
5662 y Fl(53)p eop
%%Page: 54 57
54 56 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fe(NORMALIZE-SPEC)440 802 y(module)41 b(normalize-spec)440
902 y(imports)g(stratego)f(lib)440 1149 y Fl(The)29 b(\014rst)f(phase)g
(of)g(the)h(fron)n(t-end)f(is)g(the)h(normalization)e(of)i(sp)r
(eci\014cations.)39 b(A)29 b(sp)r(eci-)440 1248 y(\014cation)h
(consists)f(of)i(a)f(list)g(of)g(basic)g(sp)r(eci\014cations)g
(\(signatures,)g(o)n(v)n(erla)n(ys,)e(rules)i(and)440
1348 y(strategy)19 b(de\014nitions\))j(in)f(an)n(y)f(order.)33
b(Normalization)19 b(collects)i(the)g(basic)f(sp)r(eci\014cations)440
1448 y(of)28 b(eac)n(h)e(kind)i(and)g(creates)e(a)h(sp)r(eci\014cation)
g(of)h(the)g(form)527 1679 y Fe(Specification\([Si)o(gn)o(at)o(ure)o
(\(i)o(d\),)1181 1779 y(Overlays\(id\),)1181 1878 y(Rules\(id\),)1181
1978 y(Strategies\(id\)]\))440 2225 y(rules)527 2424
y(BSpecs)41 b(:)i(Specification\(bsp)o(ecs)o(\))37 b(->)43
b(bspecs)527 2623 y(NormBSIG)d(:)k(Operations\(ods\))37
b(->)43 b(ods)527 2723 y(NormBSIG)d(:)k(Sorts\(ss\))39
b(->)k([])527 2922 y(NormBSP)e(:)i(Signature\(bsigs\))81
b(->)42 b(\(<normalize-sigs>)37 b(bsigs,)k([],)h([],)h([]\))527
3022 y(NormBSP)e(:)i(Strategies\(sdefs)o(\))38 b(->)k(\([],)g([],)h
([],)f(sdefs\))527 3122 y(NormBSP)f(:)i(Rules\(rdefs\))257
b(->)42 b(\([],)g([],)h(rdefs,)e([]\))527 3221 y(NormBSP)g(:)i
(Overlays\(ols\))213 b(->)42 b(\([],)g(ols,)g([],)h([]\))527
3421 y(Combine)e(:)i(\(\(ods1,)e(ols1,)g(rdefs1,)g(sdefs1\),)f(\(ods2,)
h(ols2,)h(rdefs2,)f(sdefs2\)\))f(->)963 3520 y(\(<conc>)h(\(ods1,)g
(ods2\),)1007 3620 y(<conc>)g(\(ols1,)g(ols2\),)1007
3719 y(<conc>)g(\(rdefs1,)f(rdefs2\),)1007 3819 y(<conc>)h(\(sdefs1,)f
(sdefs2\)\))527 4018 y(MkSpec)h(:)i(\(ods,)f(ols,)g(rdefs,)f(sdefs\))g
(->)919 4118 y(Specification\([Si)o(gna)o(tu)o(re\()o([O)o(pe)o(rat)o
(io)o(ns\()o(od)o(s\))o(]\),)1573 4218 y(Overlays\(ols\),)1573
4317 y(Rules\(rdefs\),)1573 4417 y(Strategies\(sdefs\))o(]\))440
4616 y(strategies)527 4815 y(normalize-sigs)d(=)789 4915
y(map\(NormBSIG\);)789 5015 y(concat)527 5214 y(normalize-specIO)f(=)43
b(iowrap\(normalize-)o(sp)o(ec\))527 5413 y(normalize-spec)38
b(=)1831 5662 y Fl(54)p eop
%%Page: 55 58
55 57 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)789
531 y Fe(BSpecs;)789 631 y(map\(NormBSP\);)789 731 y(foldr\(!\([],)39
b([],)j([],)g([]\),)g(Combine\);)789 830 y(MkSpec;)789
930 y(Specification\(v)o(ars)o(-t)o(o-c)o(on)o(sts)o(\);)789
1029 y(define-lrules)440 1279 y Fl(F)-7 b(urthermore,)32
b(the)h(grammar)d(cannot)h(distigh)n(uish)h(term)g(v)-5
b(ariables)31 b(from)h(unary)f(con-)440 1378 y(structors.)36
b(This)27 b(distinction)h(can)g(only)f(b)r(e)h(made)f(based)g(on)h(the)
g(signature.)35 b(V)-7 b(ariables)440 1478 y(are)25 b(renamed)f(to)i
(op)r(erator)e(applications)g(b)n(y)i(duplicating)f(the)h(sp)r
(eci\014cation)f(and)h(map-)440 1577 y(ping)i(one)f(sp)r(eci\014cation)
g(to)g(a)h(substitution.)440 1826 y Fe(rules)527 2026
y(Names)129 b(:)43 b(Signature\(bsigs\))37 b(->)43 b
(<filter\(OpNames\))o(;)37 b(concat>)k(bsigs)527 2125
y(OpNames)g(:)i(Operations\(ods\))81 b(->)43 b(<filter\(OpName\)>)37
b(ods)527 2225 y(OpName)85 b(:)43 b(OpDecl\(f,)d(ConstType\(_\)\))e(->)
43 b(f)527 2424 y(Names)129 b(:)43 b(Overlays\(ols\))38
b(->)43 b(<filter\(OLName\)>)37 b(ols)527 2524 y(OLName)85
b(:)43 b(Overlay\(x,)c([],)k(t\))g(->)f(x)527 2723 y(Triple)f(:)i
(\(\(x,)f(y\),)h(z\))f(->)h(\(x,)g(y,)f(z\))440 2922
y(strategies)527 3122 y(vars-to-consts)c(=)43 b(split\(filter\(Name)o
(s\))o(;)37 b(concat;)1530 3221 y(split\(id,)j(map\({x:)g(?x;)j
(!Op\(x,[]\)}\)\))1486 3321 y(,id\);)1268 3421 y(Triple;)1268
3520 y(tsubs)440 3769 y(rules)527 3968 y(UnaryConstructorN)o(am)o(e)37
b(:)44 b(OpDecl\(f,)c(ConstType\(_\)\))e(->)k(f)527 4068
y(UnaryConstructorN)o(am)o(e)37 b(:)44 b(Overlay\(x,)39
b([],)j(t\))h(->)g(x)440 4267 y(strategies)527 4467 y(vars-to-consts')
38 b(=)789 4566 y(split\(collect\(U)o(nar)o(yC)o(ons)o(tr)o(uct)o(or)o
(Na)o(me\))o(;)1050 4666 y(split\(id,)i(map\({x:)h(?x;)h
(!Op\(x,[]\)}\)\))1007 4765 y(,id\);)789 4865 y(Triple;)789
4965 y(tsubs)440 5214 y(rules)527 5413 y(DefLRule)e(:)k
(LRule\(Rule\(t1,)37 b(t2,)43 b(s\)\))f(->)1831 5662
y Fl(55)p eop
%%Page: 56 59
56 58 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)1007
531 y Fe(Scope\(<tvars>)38 b(t1,)k(SRule\(Rule\(t1,)c(t2,)k(s\)\)\))440
731 y(strategies)527 930 y(define-lrules)c(=)44 b(topdown\(try\(Def)o
(LRu)o(le)o(\)\))1831 5662 y Fl(56)p eop
%%Page: 57 60
57 59 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fe(USE-DEF)440 787 y(module)41 b(use-def)440 886
y(imports)g(sugar)g(list-set)f(stratlib)440 1120 y Fl(In)c(the)g
(triple)f Fe(\(u,)42 b(d,)h(e\))35 b(u)g Fl(represen)n(ts)f(the)i(v)-5
b(ariables)34 b(used)i(in)f(a)g(build)h(and)g Fe(d)f
Fl(the)440 1220 y(v)-5 b(ariables)29 b(b)r(ound)h(\(de\014ned\))h(in)f
(a)g(matc)n(h.)44 b Fe(e)29 b Fl(represen)n(ts)g(the)h(v)-5
b(ariables)29 b(that)h(are)f(used)440 1319 y(but)34 b(nev)n(er)e
(de\014ned.)53 b(The)33 b(follo)n(wing)f(strategies)f(de\014ne)j(for)e
(eac)n(h)g(construct)h(in)n(v)n(olv)n(ed)440 1419 y(with)28
b(term)g(v)-5 b(ariables)26 b(ho)n(w)h(it)h(uses)f(or)g(de\014nes)g(v)
-5 b(ariables.)440 1653 y Fe(strategies)527 1852 y(use-term)215
b(=)43 b({t:)f(?t;)h(![\(<tvars>)c(t,)k([],)f([]\)]})527
1952 y(def-term)215 b(=)43 b({t:)f(?t;)h(![\([],)e(<tvars>)f(t,)j
([]\)]})527 2151 y(constructs\(x\))38 b(=)832 2251 y(Build\(use-term\))
g(+)43 b(Match\(def-term\))37 b(+)43 b(MA\(def-term,)c(x\))k(+)832
2350 y(AM\(x,)f(def-term\))e(+)j(BA\(x,)e(use-term\))f(+)j(BAM\(x,)e
(use-term,)f(def-term\))g(+)832 2450 y(Scope\(id,)g(x\))j(+)g
(Rule\(def-term,)38 b(use-term,)i(x\))i(+)832 2550 y(Overlay\(id,)d
(id,)k(use-term\))d(+)j(Cong\(id,)d(map\(x\)\))440 2784
y Fl(The)31 b(parallell)f(union)i(of)f(t)n(w)n(o)f(use-def)h(triples)g
(simply)h(tak)n(es)e(the)h(p)r(oin)n(t-wise)g(union)g(of)440
2883 y(eac)n(h)h(of)g(the)h(sets.)52 b(In)32 b(the)h(sequen)n(tial)f
(union)h(the)g(uses)f(of)g(the)h(second)f(triple)h(are)e(are)440
2983 y(accoun)n(ted)c(for)g(b)n(y)g(the)h(de\014nes)g(in)g(the)g
(\014rst)f(triple.)440 3217 y Fe(rules)527 3416 y(Union)42
b(:)h(\(\(u1,)e(d1,)i(e1\),)f(\(u2,)g(d2,)g(e2\)\))g(->)876
3516 y(\(<union>)e(\(u1,)i(u2\),)g(<union>)f(\(d1,)h(d2\),)g(<union>)e
(\(e1,)i(e2\)\))527 3715 y(SeqUnion)e(:)k(\(\(u1,)d(d1,)h(e1\),)g
(\(u2,)g(d2,)h(e2\)\))f(->)1007 3815 y(\(<union>)e(\(u1,)i(<diff>)f
(\(u2,)h(d1\)\),)1050 3914 y(<union>)f(\(d1,)h(d2\),)g(<union>)e(\(e1,)
i(e2\)\))440 4148 y Fl(Because)31 b(System)i(S)g(expressions)d(can)j
(con)n(tain)e(c)n(hoice)h(op)r(erators,)g(the)h(use-def)f(infor-)440
4248 y(mation)f(of)h(an)f(expression)f(is)i(represen)n(ted)e(as)h(a)h
(set)f(of)h(use-def)f(triples,)i(one)e(for)g(eac)n(h)440
4347 y(path.)55 b(The)33 b(strategy)g Fe(seq-join)d Fl(joins)j(t)n(w)n
(o)g(sets)g(of)h(triples,)h(where)e(for)g(eac)n(h)g(pair)f(of)440
4447 y(triples)27 b(\()p Fe(cart)g Fl(stands)g(for)g(Cartesian)f(pro)r
(duct\))i(the)g(sequen)n(tial)f(union)h(is)f(tak)n(en.)440
4681 y Fe(strategies)527 4880 y(seq-join)40 b(=)k(cart\(SeqUnion\))527
4980 y(seqs-join)c(=)j(foldr\(![\([],)c([],)j([]\)],)g
(cart\(SeqUnion\)\))440 5313 y Fl(The)28 b Fe(UDjoin)d
Fl(rules)j(de\014ne)g(for)f(eac)n(h)g(construct)h(in)n(v)n(olv)n(ed)e
(with)j(v)-5 b(ariables)26 b(ho)n(w)h(use-def)440 5413
y(information)g(is)g(propagated.)1831 5662 y(57)p eop
%%Page: 58 61
58 60 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fe(rules)527 731 y(UDjoin)41 b(:)i(Seqs\(xs\))477
b(->)42 b(<seqs-join>)d(xs)527 830 y(UDjoin)i(:)i(Seq\(xs,)e(ys\))348
b(->)42 b(<seqs-join>)d([xs,)j(ys])527 930 y(UDjoin)f(:)i(Rule\(l,)e
(r,)i(c\))261 b(->)42 b(<seqs-join>)d([l,)k(c,)f(r])527
1029 y(UDjoin)f(:)i(StratRule\(l,)c(r,)k(c\))g(->)f(<seqs-join>)d([l,)k
(c,)f(r])527 1129 y(UDjoin)f(:)i(MA\(t,)f(s\))479 b(->)42
b(<seqs-join>)d([t,)k(s])527 1229 y(UDjoin)e(:)i(AM\(s,)f(t\))479
b(->)42 b(<seqs-join>)d([s,)k(t])527 1328 y(UDjoin)e(:)i(BA\(s,)f(t\))
479 b(->)42 b(<seqs-join>)d([t,)k(s])527 1428 y(UDjoin)e(:)i(BAM\(s,)f
(t1,)g(t2\))217 b(->)42 b(<seqs-join>)d([t1,)j(s,)h(t2])527
1528 y(UDjoin)e(:)i(Cong\(f,)e(ss\))348 b(->)42 b(<seqs-join>)d(ss)527
1627 y(UDjoin)i(:)i(Scope\(xs,)d(uds\))217 b(->)42 b
(<map\(JoinScope\(!x)o(s\))o(\)>)37 b(uds)527 1727 y(UDjoin)k(:)i
(Overlay\(f,)d(xs,)i(t\))87 b(->)42 b(Overlay\(f,)e(xs,)i(<seqs-join>)d
([\([],xs,[]\),t]\))527 1926 y(JoinScope\(xs\))f(:)44
b(\(u,)e(d,)h(e\))f(->)1225 2026 y(\(u,)g(<diff>)f(\(d,)h(<xs>\(\)\),)
1399 2125 y(<conc>)f(\(<isect>)f(\(u,)j(<xs>\(\)\),)d(e\)\))440
2374 y Fl(F)-7 b(or)19 b(all)h(other)f(constructs)g(the)h(use-def)g
(information)f(is)h(com)n(bined)g(with)g Fe(Union)p Fl(.)32
b(Finally)-7 b(,)440 2474 y(the)28 b(use-def)g(information)e(for)i(an)f
(expression)f(is)h(computed)h(b)n(y)g Fe(use-def)p Fl(.)440
2723 y Fe(strategies)527 2922 y(default-join)39 b(=)789
3022 y(explode-term;)f(Snd;)789 3122 y(foldr\(![\([],)g([],)43
b([]\)],)e(cart\(Union\)\))527 3321 y(use-def)g(=)789
3421 y(rec)h(x\(\(constructs\(x\))37 b(<+)43 b(all\(x\)\);)d(\(UDjoin)h
(<+)h(default-join\)\))440 3670 y Fl(Eac)n(h)20 b(de\014nition)i(of)g
(the)g(the)g(sp)r(eci\014cation)f(is)g(c)n(hec)n(k)n(ed)f(for)h(v)-5
b(alid)22 b(use)f(of)h(v)-5 b(ariables.)33 b(That)440
3769 y(is,)28 b(v)-5 b(ariables)26 b(should)h(b)r(e)h(declared)f(and)g
(de\014ned)h(b)r(efore)g(they)f(are)g(used.)440 4018
y Fe(strategies)527 4218 y(spec-use-defIO)38 b(=)43 b
(iowrap\(where\(spec)o(-u)o(se)o(-de)o(f\))o(\))527 4417
y(spec-use-def)c(=)k(Specification\([S)o(ign)o(at)o(ur)o(e\(i)o(d\))o
(,)1835 4516 y(Overlays\(defs-us)o(e-)o(de)o(f\),)1835
4616 y(Rules\(defs-use-d)o(ef)o(\),)1835 4716 y(Strategies\(defs-)o(us)
o(e-)o(def)o(\)])o(\))527 4915 y(defs-use-def)c(=)k(filter\(check\);)38
b(?[])527 5114 y(check)k(=)h(SDef\(id,)d(id,)i(use-def;)f(not\([\([],)f
(id,)i([]\)]\)\);)f(err-msg)f(+)876 5214 y(RDef\(id,)g(id,)i(use-def;)f
(not\([\([],)f(id,)i([]\)]\)\);)f(err-msg)f(+)876 5313
y(Overlay\(id,)f(id,)j(id\);)g(use-def;)963 5413 y(not\(Overlay\(id,i)o
(d,[)o(\([)o(],[)o(],)o([])o(\)]\))o(\);)37 b(err-msg)1831
5662 y Fl(58)p eop
%%Page: 59 62
59 61 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y(The)21 b(follo)n(wing)g(rules)f(transform)h(de\014nitions)g(with)
h(use-def)f(information)g(that)h(indicates)440 631 y(an)27
b(error)f(to)h(a)h(readable)e(error)g(message.)440 883
y Fe(rules)527 1083 y(MsgU)42 b(:)h([])g(->)g([])527
1182 y(MsgU)f(:)h([x])g(->)832 1282 y(["variable)d(",)i(x,)h(":)g
(used,)f(but)g(not)g(bound"])527 1381 y(MsgU)g(:)h([x,)g(y)g(|)g(ys])f
(->)832 1481 y(["variables)d(",)k(Cons\(x,)e(Cons\(y,)f(ys\)\),)i(":)h
(used,)e(but)i(not)f(bound"])527 1680 y(MsgD)g(:)h([])g(->)g([])527
1780 y(MsgD)f(:)h([x])g(->)832 1880 y(["variable)d(",)i(x,)h(":)g
(matched,)d(but)j(not)f(declared"])527 1979 y(MsgD)g(:)h([x,)g(y)g(|)g
(ys])f(->)832 2079 y(["variables)d(",)k(Cons\(x,)e(Cons\(y,)f(ys\)\),)i
(":)h(matched,)d(but)i(not)h(declared"])527 2278 y(MsgE)f(:)h([])g(->)g
([])527 2477 y(MsgE)f(:)h([x])g(->)832 2577 y(["variable)d(",)i(x,)h
(":)g(declared,)d(but)i(not)h(bound"])527 2776 y(MsgE)f(:)h([x,)g(y)g
(|)g(ys])f(->)832 2876 y(["variables)d(",)k([x,)f(y)i(|)f(ys],)f(":)g
(declared,)e(but)j(not)f(bound"])527 3075 y(MsgS)g(:)h(\(u,)g(d,)f(e\))
h(->)g(<concat>)d([<MsgU>)h(u,)i(<MsgE>)e(e])527 3175
y(MsgR)h(:)h(\(u,)g(d,)f(e\))h(->)g(<concat>)d([<MsgU>)h(u,)i(<MsgE>)e
(e])527 3374 y(MkMsg)h(:)h(RDef\(l,)e(xs,)h(uds\))g(->)h(["error)d(in)j
(rule)f(",)h(l,)f(")i(:)f(")1748 3474 y(|)g(<map\(MsgR\);)c(concat>)h
(uds])527 3673 y(MkMsg)i(:)h(SDef\(f,)e(xs,)h(uds\))g(->)h(["error)d
(in)j(definition)c(",)k(f,)g(")g(:)g(")1748 3773 y(|)g(<map\(MsgS\);)c
(concat>)h(uds])527 3972 y(MkMsg)i(:)h(Overlay\(f,)c(xs,)k(uds\))f(->)g
(["error)f(in)i(overlay)d(",)j(f,)g(")g(:)g(")1878 4071
y(|)h(<map\(MsgR\);)39 b(concat>)h(uds])440 4271 y(strategies)527
4470 y(err-msg)h(=)i(MkMsg;)e(fatal-error)1831 5662 y
Fl(59)p eop
%%Page: 60 63
60 62 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fh(SPECIFICA)f(TION)33 b(TO)f(LIST)g(OF)g(DEFINITIONS)440
722 y Fl(T)-7 b(ranslation)28 b(of)h(a)f(sp)r(eci\014cation)h
(consisting)f(of)h(a)g(signature,)f(rules)h(and)g(strategy)e(de\014-)
440 822 y(nitions)h(to)f(a)g(list)h(of)g(strategy)e(de\014nitions.)440
1055 y Fe(module)41 b(spec-to-sdefs)440 1155 y(imports)g(strategy)f
(sugar)h(stratlib)g(list-sort)440 1389 y Fg(congr)n(uences)32
b(fr)n(om)g(signa)-6 b(ture)440 1558 y Fl(Congruences)24
b(are)g(recognized)g(b)n(y)h(the)g(parser)f(as)g(strategy)g(calls;)i
(The)f(follo)n(wing)f(strat-)440 1658 y(egy)e(generates)g(strategy)g
(de\014nitions)h(from)g(the)h(signature;)f(F)-7 b(or)23
b(instance,)h(the)f(op)r(erator)440 1757 y(declaration)658
1978 y Fe(OpDecl\("F",)39 b(FunType\([_,)g(_],)j(_\)\))440
2199 y Fl(is)27 b(translated)g(to)h(the)g(strategy)e(de\014nition)658
2420 y Fe(SDef\("F",)40 b(["x1",)h("x2"],)g(Cong\("F",)f
([SVar\("x1"\),)e(SVar\("x2"\)]\)\))440 2654 y(rules)527
2853 y(MkCongDef)i(:)j(OpDecl\(f,)d(ConstType\(t\)\))e(->)43
b(SDef\(f,)e([],)h(Cong\(f,)f([]\)\))527 3053 y(MkCongDef)f(:)j
(OpDecl\(f,)d(FunType\(ts,)f(t\)\))j(->)1050 3152 y(SDef\(f,)f(xs,)h
(Cong\(f,)f(<map\(MkCall\)>)d(xs\)\))1050 3252 y(where)k(<map\(new\)>)d
(ts)k(=>)g(xs)527 3451 y(MkCongDefs)d(:)j(Sorts\(sds\))257
b(->)43 b([])527 3551 y(MkCongDefs)d(:)j(Operations\(ods\))37
b(->)43 b(<map\(MkCongDef\)>)37 b(ods)440 3750 y(strategies)527
3949 y(congdefs)j(=)k(map\(MkCongDefs\))o(;)38 b(concat)440
4183 y Fg(constr)n(uctors)31 b(fr)n(om)h(opera)-6 b(tors)440
4417 y Fe(\(*)527 4516 y(MkConsDef)40 b(:)j(OpDecl\(f,)d(FunType\(ts,)f
(t\)\))j(->)1050 4616 y(RDef\(f,)f([],)h(\))1050 4716
y(where)g(<map\(new\)>)d(ts)k(=>)g(xs)789 4915 y(RDef\(f,)d([],)919
5015 y(Rule\(Op\(x1,...,xn)o(\),)d(Op\(f,)42 b(xs\),)g(id\))527
5214 y(MkConsDef)e(:)614 5313 y(Overlay\(f,)g(xs,)i(t\))h(->)g
(RDef\(f,)d([],)j(Op\(x1,...,xn\),)37 b(t\))440 5413
y(*\))1831 5662 y Fl(60)p eop
%%Page: 61 64
61 63 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fg(congr)n(uences)32 b(fr)n(om)g(o)n(verla)-6 b(ys)440
701 y Fl(Eac)n(h)31 b(o)n(v)n(erla)n(y)e(de\014nes)j(a)g(congruence)e
(op)r(erator)g(as)i(w)n(ell)f(as)h(abstractions)e(to)i(b)r(e)g(used)440
800 y(in)c(matc)n(h)f(and)h(build)g(op)r(erations.)440
1053 y Fe(rules)527 1252 y(Overlay-to-Congde)o(f)37 b(:)614
1352 y(Overlay\(f,)j(xs,)i(t\))h(->)g(SDef\(f,)d(xs,)j(<trm-to-cong>)38
b(t\))527 1551 y(Trm-to-Cong)h(:)k(Var\(x\))434 b(->)43
b(Call\(SVar\(x\),)38 b([]\))527 1650 y(Trm-to-Cong)h(:)k(Op\(f,)f
(ts\))304 b(->)43 b(Call\(SVar\(f\),)38 b(ts\))527 1750
y(Trm-to-Cong)h(:)k(Str\(x\))434 b(->)43 b(Match\(Str\(x\)\))527
1850 y(Trm-to-Cong)c(:)k(Int\(x\))434 b(->)43 b(Match\(Int\(x\)\))527
1949 y(Trm-to-Cong)c(:)k(Real\(x\))390 b(->)43 b(Match\(Real\(x\)\))527
2049 y(Trm-to-Cong)c(:)k(BuildDefault\(x\))38 b(->)43
b(Id)440 2248 y(strategies)527 2447 y(trm-to-cong)c(=)k(rec)g
(x\(try\(Op\(id,)38 b(map\(x\)\)\);)i(Trm-to-Cong\))440
2700 y Fg(exp)-6 b(anding)32 b(o)n(verla)-6 b(ys)440
2952 y Fe(rules)527 3152 y(ExpOverlay\(ols\))38 b(:)614
3251 y(Op\(f,)k(ts\))g(->)h(<tsubstitute>)38 b(\(sbs,)k(t\))614
3351 y(where)g(ols;)g(fetch\(where\({xs,)37 b(t:)43 b(?Overlay\(f,)c
(xs,)j(t\);)1966 3450 y(!\(<zip\(\(MkTVar,)o(id)o(\)\)>)37
b(\(xs,)42 b(ts\),)g(t\)})1617 3550 y(=>)h(\(sbs,)e(t\)\)\))440
3749 y(//)i(Note:)e(when)h(overlays)e(in)j(overlay)e(definitions)e
(already)i(have)h(been)440 3849 y(//)h(expanded)d(the)i(repeat)f(is)i
(not)g(necessary.)c(Therefore)h(exp-overlays1)e(and)440
3949 y(//)43 b(exp-overlays2:)440 4148 y(strategies)527
4347 y(exp-overlays1\(ols)o(\))37 b(=)614 4447 y(try\(where\(not\(ols)g
(=>)43 b([]\)\);)789 4546 y(topdown\(repeat\()o(Exp)o(Ov)o(erl)o(ay)o
(\(ol)o(s\))o(\)\))o(\))527 4746 y(exp-overlays2\(ols)o(\))37
b(=)614 4845 y(try\(where\(not\(ols)g(=>)43 b([]\)\);)789
4945 y(topdown\(try\(Exp)o(Ove)o(rl)o(ay\()o(ol)o(s\)\))o(\)\))440
5197 y Fg(r)n(ule)31 b(definitions)h(to)g(stra)-6 b(tegy)32
b(definitions)440 5367 y Fl(A)c(rule)f(de\014nition)h(de\014nes)g(an)f
(implicitly)h(scop)r(ed)g(strategy)e(de\014nition;)1831
5662 y(61)p eop
%%Page: 62 65
62 64 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fe(rules)527 731 y(RDtoSD)41 b(:)i(RDef\(f,)e(xs,)h(r\))h(->)g
(SDef\(f,)e(xs,)h(Scope\(<tvars>)c(r,)43 b(SRule\(r\)\)\))527
930 y(DeclareVariables)37 b(:)789 1029 y(SDef\(f,)j(xs,)j(s\))f(->)h
(SDef\(f,)e(xs,)h(Scope\(<tvars>)c(s,)43 b(s\)\))440
1282 y Fg(counting)571 1534 y Fe(AddCounter)c(:)k(SDef\(f,)e(xs,)h(s\))
h(->)g(SDef\(f,)e(xs,)h(Seq\(s,)f(CountRule\(f\)\)\))440
1787 y Fg(specifica)-6 b(tion)33 b(to)e(definition)h(list)440
1956 y Fl(Desugaring)d(a)h(sp)r(eci\014cation)g(consist)f(of)i
(deriving)e(the)i(list)g(of)f(joined)g(strategy)f(de\014ni-)440
2056 y(tions)18 b(from)h(its)f(rule)h(de\014nitions)f(and)h(strategy)e
(de\014nitions;)22 b(The)c(signature)g(comp)r(onen)n(ts)440
2155 y(are)27 b(ignored;)440 2408 y Fe(rules)527 2607
y(Sp0)43 b(:)g(Specification\(b)o(spe)o(cs)o(\))38 b(->)k(bspecs)527
2707 y(Sp1)h(:)g(Signature\(bsigs)o(\))256 b(->)42 b(<congdefs>)e
(bsigs)527 2806 y(Sp2)j(:)g(Strategies\(sdef)o(s\))212
b(->)42 b(sdefs)527 2906 y(Sp3)h(:)g(Rules\(rdefs\))431
b(->)42 b(<map\(RDtoSD\)>)d(rdefs)527 3105 y(RulesToSdefs)g(:)614
3205 y(Specification\([)702 3304 y(Signature\(bsigs)o(\),)702
3404 y(Rules\(rdefs\),)702 3504 y(Strategies\(sdef)o(s\))614
3603 y(]\))k(->)614 3703 y(Specification\([)702 3802
y(Signature\(bsigs)o(\),)702 3902 y(Strategies\(<con)o(ca)o(t>)1181
4002 y([<congdefs>)c(bsigs,)1225 4101 y(<map\(RDtoSD\)>)f(rdefs,)1225
4201 y(<map\(DeclareVar)o(iab)o(le)o(s\))o(>)g(sdefs]\))614
4301 y(]\))527 4500 y(ExpandOverlays)g(:)614 4599 y(Specification\([)
702 4699 y(Signature\(bsigs)o(\),)702 4799 y(Overlays\(ols\),)702
4898 y(Rules\(rdefs\),)702 4998 y(Strategies\(sdef)o(s\))614
5098 y(]\))43 b(->)614 5197 y(Specification\([)702 5297
y(Signature\(bsigs)o(\),)702 5396 y(Rules\(<exp-over)o(la)o(ys2)o(\(!)o
(ols)o('\))o(>)38 b(rdefs\),)1831 5662 y Fl(62)p eop
%%Page: 63 66
63 65 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)702
531 y Fe(Strategies\(<con)o(c>)o(\(<m)o(ap)o(\(Ov)o(er)o(lay)o(-t)o(o-)
o(Con)o(gd)o(ef\))o(>)37 b(ols,)42 b(<exp-overlays2\(!o)o(ls)o('\)>)37
b(sdefs\)\))614 631 y(]\))614 731 y(where)42 b(<exp-overlays1\(!)o(ol)o
(s\)>)37 b(ols)42 b(=>)h(ols')440 930 y(strategies)527
1129 y(ExpandOverlaysIO)37 b(=)43 b(iowrap\(ExpandOver)o(la)o(ys\))527
1328 y(spec-to-sdefs)38 b(=)789 1428 y(Spec-to-Sdefs;)789
1528 y(strename)1831 5662 y Fl(63)p eop
%%Page: 64 67
64 66 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fh(DESUGARING)440 725 y Fl(Desugaring)26 b(:)37
b(translating)26 b(high-lev)n(el)h(constructs)g(to)g(lo)n(w-lev)n(el)f
(ones)440 972 y Fe(module)41 b(desugar)440 1071 y(imports)g(sugar)g
(stratlib)f(list-sort)g(use-def)h(lib)440 1318 y Fg(v)-7
b(ar)h(y)g(adic)32 b(opera)-6 b(tors)440 1565 y Fe(rules)527
1765 y(HL)43 b(:)g(Seqs\(Nil\))563 b(->)43 b(Id)527 1864
y(HL)g(:)g(Seqs\(Cons\(s,)c(ss\)\))216 b(->)43 b(Seq\(s,)e
(Seqs\(ss\)\))527 1964 y(HL)i(:)g(Choices\(Nil\))431
b(->)43 b(Fail)527 2064 y(HL)g(:)g(Choices\(Cons\(s,)37
b(ss\)\))86 b(->)43 b(Choice\(s,)d(Choices\(ss\)\))527
2163 y(HL)j(:)g(LChoices\(Nil\))387 b(->)43 b(Fail)527
2263 y(HL)g(:)g(LChoices\(Cons\(s,)37 b(ss\)\))42 b(->)h(LChoice\(s,)c
(LChoices\(ss\)\))527 2462 y(MkSeq)j(:)h(\(s1,)f(s2\))g(->)h(Seq\(s1,)e
(s2\))440 2661 y(strategies)527 2861 y(seqs)h(=)h(foldr\(!Id,)d
(MkSeq\))440 3108 y Fg(ma)-6 b(tch,)31 b(build,)g(appl)-6
b(y)32 b(combina)-6 b(tions)440 3355 y Fe(rules)527 3554
y(HL)43 b(:)g(BA\(s,)f(t\))304 b(->)43 b(Seq\(Build\(t\),)38
b(s\))527 3654 y(HL)43 b(:)g(MA\(t,)f(s\))304 b(->)43
b(Seq\(Match\(t\),)38 b(s\))527 3753 y(HL)43 b(:)g(AM\(s,)f(t\))304
b(->)43 b(Seq\(s,)e(Match\(t\)\))527 3853 y(HL)i(:)g(BAM\(s,)e(t1,)i
(t2\))f(->)h(Seqs\([Build\(t1\))o(,)38 b(s,)k(Match\(t2\)]\))440
4100 y Fg(stra)-6 b(tegy)32 b(applica)-6 b(tions)440
4269 y Fl(F)f(actoring)30 b(out)i(strategy)f(applications;)h(The)g
(righ)n(t-hand)f(side)g(of)h(a)f(rule)h(can)f(con)n(tain)440
4369 y(applications)d(of)h(a)g(strategy)e(to)i(a)g(term;)h(This)f(is)g
(factored)f(out)h(b)n(y)g(translating)e(it)j(to)f(a)440
4469 y(condition)h(that)h(applies)e(the)i(strategy)e(and)h(matc)n(hes)g
(the)g(result)g(against)f(a)h(new)g(v)-5 b(ari-)440 4568
y(able,)22 b(whic)n(h)f(is)g(then)h(used)f(in)g(the)g(rhs;)i(In)e(fact)
g(this)h(can)e(b)r(e)i(generalized)d(to)i(applications)440
4668 y(in)28 b(arbitrary)d(builds;)440 4915 y Fe(rules)527
5114 y(Bapp0)42 b(:)h(Build\(t[App\(Buil)o(d\()o(t'\))o(,)37
b(t''\)]\))k(->)i(Build\(t[t']\))527 5313 y(Bapp1)f(:)h(Build\(App\(s,)
38 b(t'\)\))k(->)h(Seq\(Build\(t'\),)38 b(s\))1831 5662
y Fl(64)p eop
%%Page: 65 68
65 67 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)527
531 y Fe(Bapp2)42 b(:)h(Build\(t[App\(s,)38 b(t'\)]\))j(->)876
631 y(Scope\([x],)e(Seq\(BAM\(s,)h(t',)i(Var\(x\)\),)e
(Build\(t[Var\(x\)]\)\))o(\))876 731 y(where)h(new)i(=>)f(x)440
962 y Fg(term)32 b(explosion)f(an)g(constr)n(uction)440
1194 y Fe(rules)527 1393 y(Expl)86 b(:)43 b(Match\(t[Explode\()o(t1)o
(,)38 b(t2\)]\))j(->)876 1493 y(Scope\([x],)1137 1592
y(Seq\(Match\(t[Var\(x)o(\)]\))o(,)1312 1692 y(Where\(BAM\(Prim\(")o
(_S)o(T_)o(exp)o(lo)o(de_)o(te)o(rm)o("\),)1573 1792
y(Var\(x\),)1573 1891 y(Op\("TCons",)e([t1,)j(Op\("TCons",)d([t2,)j
(Op\("TNil",[]\)]\)]\))1573 1991 y(\)\)\)\))876 2090
y(where)f(new)i(=>)f(x)527 2290 y(Expl)86 b(:)43 b(Build\(t[Explode\()o
(t1)o(,)38 b(t2\)]\))j(->)876 2389 y(Scope\([x],)1137
2489 y(Seq\(BAM\(Prim\("_ST)o(_mk)o(te)o(rm)o("\),)1486
2589 y(Op\("TCons",)e([t1,)j(Op\("TCons",)d([t2,)j(Op\("TNil",[]\)]\)])
o(\),)1486 2688 y(Var\(x\)\),)1312 2788 y(Build\(t[Var\(x\)]\))o(\)\))
876 2888 y(where)f(new)i(=>)f(x)527 3087 y(Expl)g(:)h(ExplodeCong\(s1,)
38 b(s2\))k(->)832 3186 y(Seq\(Prim\("_ST_exp)o(lo)o(de_)o(te)o(rm")o
(\),)832 3286 y(Seq\(Cong\("TCons",)37 b([s1,)42 b(Cong\("TCons",)c
([s2,)k(Cong\("TNil",[]\)])o(\)])o(\),)1007 3386 y(Prim\("_ST_mkter)o
(m"\))o(\)\))440 3617 y Fg(r)n(ules)31 b(to)h(stra)-6
b(tegies)440 3787 y Fl(A)39 b(rule)g(corresp)r(onds)f(to)h(a)f
(strategy)g(that)h(\014rst)g(matc)n(hes)g(the)g(left-hand)h(side,)i
(then)440 3886 y(c)n(hec)n(ks)27 b(the)i(conditions)e(and)h(\014nally)g
(builds)h(the)f(righ)n(t-hand)f(side;)i(The)f(left-hand)g(side)440
3986 y(and)e(righ)n(t-hand)e(side)i(should)f(b)r(e)i(in)f(basic)f(term)
g(format,)h(as)f(de\014ned)h(b)n(y)g(the)g(predicate)440
4086 y(|bterm|;)440 4317 y Fe(strategies)527 4516 y(pureterm)40
b(=)k(not\(topdown\(Con)o(\(id)o(,)37 b(id,)43 b(id\))f(+)h(App\(id,)e
(id\)\)\))527 4716 y(buildterm)f(=)j(not\(topdown\(Con\(i)o(d,)37
b(id,)42 b(id\))h(+)g(Wld\)\))440 4915 y(rules)527 5114
y(RtoS)f(:)h(SRule\(Rule\(l,)38 b(r,)43 b(s\)\))g(->)f
(Seqs\([Match\(l\),)c(Where\(s\),)i(Build\(r\)]\))832
5214 y(where)i(<pureterm>)d(l)k(;)h(<buildterm>)39 b(r)527
5413 y(RtoS)j(:)h(SRule\(StratRule\(l)o(,)37 b(r,)43
b(s\)\))g(->)f(Seqs\([l,)f(Where\(s\),)e(r]\))1831 5662
y Fl(65)p eop
%%Page: 66 69
66 68 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fg(contexts)440 701 y Fl(F)g(actoring)19 b(out)i(con)n(texts;)h
(Con)n(texts)f(used)f(in)h(a)f(rule)h(are)e(translated)h(to)h(a)f(lo)r
(cal)g(tra)n(v)n(ersal)440 800 y(that)41 b(replaces)e(the)i(pattern)f
(o)r(ccuring)f(in)i(the)g(con)n(text)f(in)g(the)h(lhs)g(b)n(y)f(the)h
(pattern)440 900 y(o)r(ccurring)26 b(in)i(the)g(con)n(text)f(in)h(the)g
(rhs;)440 1152 y Fe(rules)527 1352 y(Rcon)42 b(:)h
(SRule\(Rule\(l[Con\()o(Va)o(r\(c)o(\),)37 b(l',)42 b(f\)],)g
(r[Con\(Var\(c\),)c(r',)43 b(Call\(f',)d([]\)\)],)h(s\)\))h(->)832
1451 y(Scope\([c'],SRule\()919 1551 y(Rule\(l[Var\(c\)],)c
(r[Var\(c'\)],)1137 1650 y(Seq\(s,)j(BAM\(Call\(f',)e
([SRule\(Rule\(l',)e(r',)43 b(Id\)\)]\),)1617 1750 y(Var\(c\),)e
(Var\(c'\)\)\)\)\)\))832 1850 y(where)h(new)g(=>)h(c')527
2049 y(Rcon')f(:)h(SRule\(Rule\(l[Con)o(\(V)o(ar\()o(c\))o(,)38
b(l',)k(f\)],)g(r[Con\(Var\(c\),)c(r',)k(Call\(f',)f([]\)\)],)g(s\)\))h
(->)832 2149 y(SRule\(Rule\(l[Var\()o(c\))o(],)1312 2248
y(r[App\(Call\(f',)c([SRule\(Rule\(l',)f(r',)42 b(Id\)\)]\),)f
(Var\(c\)\)],)1312 2348 y(s\)\))527 2547 y(Rcon'')g(:)i
(SRule\(Rule\(l[Con\()o(Var)o(\(c)o(\),)37 b(l',)42 b(Call\(f,)f
([]\)\)],)g(r,)i(s\)\))f(->)832 2647 y(SRule\(Rule\(l[Var\()o(c\))o(],)
37 b(r,)1094 2746 y(Seq\(s,)k(BA\(Call\(f,)e([Match\(l'\)]\),)g
(Var\(c\)\)\)\)\))789 2846 y(\(*)j(Con\(Var\(c\),)d(_,)k(_\))g(should)e
(not)h(occur)g(in)h(r)g(*\))440 3098 y Fl(Note:)34 b(The)21
b(lo)r(cal)g(tra)n(v)n(ersal)d(should)j(b)r(e)h(closed)f(for)f(v)-5
b(ariables)20 b(not)i(o)r(ccuring)e(in)h(the)h(outer)440
3198 y(pattern;)34 b(But)f(this)f(is)h(more)e(relev)-5
b(an)n(t)32 b(for)f(m)n(ulti-con)n(texts)h(whic)n(h)g(are)f(not)i(supp)
r(orted)440 3298 y(y)n(et;)440 3467 y(Other)27 b(problems:)440
3636 y(-)18 b(lo)r(cal)g(v)-5 b(ariables)17 b(for)h(inner)g(rule;)j
(the)e(inner)f(SRule)h(should)f(b)r(e)h(enclosed)f(in)g(a)g
Fe(Scope\(xs,)40 b(_\))440 3736 y Fl(where)571 3972 y
Fe(<diff>)h(\(<tvars>)f(\(l',)i(r'\),)g(<tvars>)f(\(l[Var\(c\)],)e
(r[Var\(c'\)]\)\))f(=>)43 b(xs)440 4208 y Fl(-)d(placemen)n(t)f(of)h
(deriv)n(ed)g(strategy)e(in)i(where)g(clause;)45 b(option)40
b(\014rst)g(do)f(a)h(matc)n(hing)440 4307 y(tra)n(v)n(ersal)25
b(at)i(start)g(of)h(where,)f(and)h(at)f(end)h(of)f(where)g(do)h(a)f
(replacing)f(tra)n(v)n(ersal.)440 4477 y(-)h(m)n(ultiple)i(uses)e(of)g
(con)n(text)g(in)h(rhs)440 4646 y Fg(desugaring)k(single)f(r)n(ules)440
4898 y Fe(strategies)527 5098 y(desugarRule)39 b(=)k(rec)g
(x\(try\(Rcon;)c(x)k(+)g(Scope\(id,)d(x\))j(+)g(RtoS\)\))440
5350 y Fg(desugaring)32 b(stra)-6 b(tegies)1831 5662
y Fl(66)p eop
%%Page: 67 70
67 69 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fe(strategies)527 731 y(desugar)41 b(=)614 830
y(topdown\(try\(desug)o(ar)o(Rul)o(e\))o(;)963 930 y(repeat\(HL)f(+)j
(\(Bapp0)e(<+)i(Bapp1)e(<+)i(Bapp2\))e(+)i(Expl\)\))527
1129 y(desugar')d(=)k(topdown\(try\(des)o(uga)o(rR)o(ule)o(\);)37
b(repeat\(HL\)\))527 1328 y(desugar-spec)i(=)k(map\(SDef\(id,)c(id,)j
(desugar\)\))1831 5662 y Fl(67)p eop
%%Page: 68 71
68 70 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fh(NEEDED)31 b(DEFINITIONS)p 440 636 2865 4 v 440
859 4 224 v 468 718 a Fl(Extract)g(those)g(de\014nitions)h(that)h(are)d
(needed)i(for)g(the)g(main)g(strategy)e(and)i(join)g(the)468
818 y(b)r(o)r(dies)c(of)g(op)r(erators)d(with)j(m)n(ultiple)g
(de\014nitions.)p 3301 859 V 440 862 2865 4 v 440 1065
a Fe(module)41 b(needed-defs)440 1165 y(imports)g(strategy)f(sugar)h
(stratlib)g(list-set)f(list-misc)g(lib)i(pack-graph)440
1408 y Fg(joining)32 b(definitions)440 1651 y Fe(strategies)527
1850 y(joindefs)40 b(=)k(JoinDefs1)39 b(<+)k(JoinDefs2)440
2049 y(rules)527 2249 y(JoinDefs1)d(:)j([sdef])e(->)i(sdef)527
2448 y(JoinDefs2)d(:)j(defs)f(@)h([SDef\(f,)e(xs,)h(s\))h(|)g(_])g(->)f
(SDef\(f,)f(ys,)h(Choices\(ss\)\))789 2547 y(where)f(?ys)86
b(<=)43 b(<map\(new\)>)c(xs;)1050 2647 y(?ys')j(<=)h(<map\(MkCall\)>)38
b(ys;)1050 2747 y(?ss)86 b(<=)43 b(<map\({zs,)d(s:)j(?SDef\(f,)d(zs,)i
(s\);)g(!<ssubs>)f(\(zs,)h(ys',)g(s\)}\)>)1530 2846 y(defs)440
3090 y Fg(obt)-6 b(aining)32 b(needed)g(definitions)440
3333 y Fe(strategies)527 3532 y(needed-defs)39 b(=)614
3632 y(\\)44 b(defs)d(->)i(\(\("main",)d(0\),)i(defs,)g([]\))g(\\;)614
3731 y(graph-nodes-undef)o(\(g)o(et-)o(de)o(fin)o(it)o(ion)1355
3831 y(,svars-arity)1355 3930 y(,\\)h(\(_,x,d\))e(->)i([x|d])e(\\)i
(\);)614 4030 y(\(NoMissingDefs)38 b(<+)43 b(MissingDefs;)c(<exit>)i
(1\))527 4229 y(get-definition)d(=)745 4329 y(CongruenceDef;)g(debug)
614 4429 y(<+)43 b(OverloadedDef;)38 b(joindefs)614 4528
y(<+)43 b(NonOverloadedDef)o(;)38 b(joindefs)440 4771
y Fl(A)25 b(strategy)e(op)r(erator)g(f)h(with)h(arit)n(y)f(n)g(is)h
(needed.)36 b(All)24 b(de\014nitions)h(for)f(the)h(op)r(erator)d(are)
440 4871 y(fetc)n(hed)28 b(and)g(joined.)37 b(Note)28
b(that)g(this)g(en)n(tails)g(that)g(\(1\))g(op)r(erators)d(can)j(b)r(e)
g(o)n(v)n(erloaded)440 4971 y(and)f(\(2\))h(there)g(can)f(b)r(e)h(more)
f(than)g(one)h(de\014nition)g(of)f(an)g(op)r(erator.)440
5214 y Fe(rules)527 5413 y(OverloadedDef)38 b(:)1831
5662 y Fl(68)p eop
%%Page: 69 72
69 71 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)614
531 y Fe(\(\(f,)42 b(n\),)h(defs\))e(->)i(fdefs)614 631
y(where)f(<filter\(SDef\(?f,)o(wh)o(ere)o(\(l)o(eng)o(th)37
b(=>)43 b(n\),id\)\)>)d(defs)i(=>)h(fdefs)527 830 y(NonOverloadedDef)37
b(:)614 930 y(\(\(f,)42 b(0\),)h(defs\))e(->)i(fdefs)614
1029 y(where)f(<filter\(SDef\(?f,)o(id)o(,id)o(\)\))o(>)c(defs)j(=>)i
(fdefs)527 1229 y(CongruenceDef)38 b(:)614 1328 y(\(\(Mod\(c,)j(mod\),)
g(n\),)h(defs\))g(->)h(fdef)614 1428 y(where)f(<DefineCongruenc)o(e>)37
b(\(c,)42 b(mod,)g(n\))h(=>)g(fdef)527 1627 y(NoMissingDefs)38
b(:)614 1727 y(\(defs,)j([]\))i(->)g(defs)527 1926 y(MissingDefs)c(:)
614 2026 y(\(defs,)i([f|fs]\))g(->)i(defs)614 2125 y(where)f
(<map\(MissingDefM)o(od)37 b(<+)43 b(MissingDef\)>)38
b([f|fs])527 2325 y(MissingDef)i(:)614 2424 y(\(f,)j(n\))f(->)h
(<error>)e(["error:)f(operator)g(",)j(f,)g("/",)f(n,)h(")g(undefined)d
("])527 2623 y(MissingDefMod)e(:)614 2723 y(\(Mod\(c,)j(m\),)h(n\))h
(->)g(<error>)e(["error:)f(operator)g(",)j(c,)g("^",)f(m)h(,)g("/",)f
(n,)h(")g(undefined)d("])440 3075 y Fg(distributing)32
b(congr)n(uences)440 3244 y Fl(F)-7 b(or)33 b(eac)n(h)g(constructor)f
Fe(c)p Fl(,)i(there)g(is)f(a)g(corresp)r(onding)f(distributing)h
(congruence)f Fe(c^D)p Fl(,)440 3344 y(de\014ned)c(according)e(to)h
(the)h(follo)n(wing)f(sc)n(heme:)527 3597 y Fe(c^D\(s1,...,sn\))38
b(:)43 b(Pair\(c\(x1,...,xn\))o(,e)o(nv)o(\))38 b(->)k(c\(y1,...,yn\))
527 3696 y(where)g(<s1>)g(Pair\(x1,env\))c(=>)43 b(y1;)789
3796 y(...)789 3895 y(<sn>)f(Pair\(xn,)e(envn\))h(=>)i(yn)440
4148 y Fl(This)28 b(is)f(implemen)n(ted)h(b)n(y)g(the)g(follo)n(wing)e
(rules.)440 4400 y Fe(overlays)527 4500 y(OpPair\(t1,)40
b(t2\))i(=)h(Op\("Pair",)d([t1,t2]\))440 4699 y(rules)527
4799 y(DefineCongruence)d(:)614 4898 y(\(c,)43 b("D",)f(n\))g(->)614
4998 y(SDef\(Mod\(c,)d("D"\),)j(ss,)g(Scope\([env)e(|)j(<conc>\(xs1,)c
(ys1\)],)1835 5098 y(SRule\(Rule\(OpPai)o(r\()o(Op)o(\(c,)e(xs2\),)k
(Var\(env\)\),)2314 5197 y(Op\(c,)h(ys2\),)2314 5297
y(Seqs\(conds\)\)\)\)\))614 5396 y(where)g(?env)g(<=)h(new;)1831
5662 y Fl(69)p eop
%%Page: 70 73
70 72 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)876
531 y Fe(?\(conds,)40 b(ss,)i(xs1,)g(xs2,)g(ys1,)g(ys2\))1007
631 y(<=)g(<copy\(MkDistAppli)o(cat)o(io)o(n\))o(;)c(tuple-unzip\(id\))
o(>)g(\(n,)k(Var\(env\)\))527 830 y(MkDistApplication)37
b(:)614 930 y(env)43 b(->)f(\(BAM\(Call\(SVar\(s\))o(,[])o(\),)37
b(OpPair\(Var\(x\),)h(env\),)j(Var\(y\)\),)963 1029 y(s,)i(x,)g
(Var\(x\),)d(y,)j(Var\(y\)\))614 1129 y(where)f(new)g(=>)h(s;)g(new)f
(=>)h(x;)g(new)f(=>)h(y)440 1381 y Fg(threading)32 b(congr)n(uences)440
1551 y Fl(F)-7 b(or)41 b(eac)n(h)f(constructor)g Fe(c)p
Fl(,)k(there)d(is)g(a)g(corresp)r(onding)e(threading)i(congruence)e
Fe(c^T)p Fl(,)440 1650 y(de\014ned)28 b(according)e(to)h(the)h(follo)n
(wing)f(sc)n(heme:)527 1903 y Fe(c^T\(s1,...,sn\))38
b(:)43 b(Pair\(c\(x1,...,xn\))o(,e)o(-f)o(irs)o(t\))37
b(->)43 b(Pair\(c\(y1,...,yn)o(\),)37 b(e-last\))527
2002 y(where)42 b(<s1>)g(Pair\(x1,e-first)o(\))c(=>)k(Pair\(y1,e2\);)
1050 2102 y(...;)789 2202 y(<sn>)g(Pair\(xn,)e(en\))i(=>)h(Pair\(yn,)d
(e-last\))440 2454 y Fl(The)28 b(follo)n(wing)e(rules)h(implemen)n(t)h
(this)g(sc)n(heme:)527 2806 y Fe(DefineCongruence)37
b(:)614 2906 y(\(c,)43 b("T",)f(n\))g(->)614 3005 y(SDef\(Mod\(c,)d
("T"\),)j(ss,)g(Scope\([e-first)c(|)43 b(<concat>)d([es,)i(xs1,)g
(ys1]],)1835 3105 y(SRule\(Rule\(OpPai)o(r\()o(Op)o(\(c,)37
b(xs2\),)k(Var\(e-first\)\),)2314 3205 y(OpPair\(Op\(c,)e(ys2\),)i
(Var\(e-last\)\),)2314 3304 y(Seqs\(as\)\)\)\)\))614
3404 y(where)h(?[e-first)e(|)j(es])f(<=)h(<copy\(new\)>)c
(\(<add>\(n,1\),)g(\(\)\);)876 3504 y(?e-last)i(<=)h(<last>)f(es;)876
3603 y(?\(as,)g(ss,)i(xs1,)f(xs2,)g(ys1,)g(ys2\))876
3703 y(<=)h(<zipr\(MkThreadA)o(ppl)o(ic)o(ati)o(on)o(\);)37
b(tuple-unzip\(id\)>)g(\([e-first)j(|)j(es],)f(es\))527
3902 y(MkThreadApplicati)o(on)37 b(:)614 4002 y(\(e1,e2\))k(->)i
(\(BAM\(Call\(SVar\(s)o(\),)o([]\))o(,)37 b(OpPair\(Var\(x\),)h
(Var\(e1\)\),)2096 4101 y(OpPair\(Var\(y\),)g(Var\(e2\)\)\),)1137
4201 y(s,)43 b(x,)g(Var\(x\),)e(y,)h(Var\(y\)\))614 4301
y(where)g(new)g(=>)h(s;)g(new)f(=>)h(x;)g(new)f(=>)h(y)1831
5662 y Fl(70)p eop
%%Page: 71 74
71 73 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)440
531 y Fh(INLINING)440 724 y Fl(In)28 b(this)g(mo)r(dule)g(w)n(e)f
(de\014ne)h(inlining)f(of)h(let)g(de\014ned)g(strategy)e
(de\014nitions;)440 971 y Fe(module)41 b(inlining)440
1070 y(imports)g(strategy)f(stratlib)g(lib)440 1317 y(rules)527
1516 y(Inl1)i(:)h(Let\(SDef\(f,)c([],)k(s1\),)f(s2[Call\(SVar\(f\))o(,)
c([]\)]\))j(->)832 1616 y(Let\(SDef\(f,)e([],)k(s1\),)f(s2[<strename>)c
(s1]\))527 1815 y(Inl2)k(:)h(Let\(SDef\(f,)c(Cons\(x,)i(xs\),)h(s1\),)g
(s2[Call\(SVar\(f\),)37 b(ss\)]\))k(->)832 1914 y(Let\(SDef\(f,)e
(Cons\(x,)i(xs\),)h(s1\),)1007 2014 y(s2[<ssubs)d(;)44
b(strename>)c(\(Cons\(x,)g(xs\),)i(ss,)g(s1\)]\))527
2213 y(Inl3)g(:)h(Let\(SDef\(f,)c(Cons\(x,)i(xs\),)h(s1\),)g
(s2[Call\(SVar\(f\),)37 b(ss\)]\))k(->)832 2313 y(Let\(SDef\(f,)e
(Cons\(x,)i(xs\),)h(s1\),)1007 2413 y(s2[<zip\(MkSdef\))37
b(;)1181 2512 y(foldr\(!s1,)i(MkSDef)j(;)h(Inl1\))e(;)1181
2612 y(strename>)f(\(Cons\(x,)g(xs\),)i(ss\)]\))527 2811
y(MkSDef)f(:)i(\(x,)g(s\))g(->)f(SDef\(x,)f([],)h(s\))527
3010 y(Dead)g(:)h(Let\(SDef\(f,)c(xs,)k(s1\),)f(s2\))g(->)h(s2)832
3110 y(where)f(<not\(in\)>)e(\(SVar\(f\),)g(s2\))440
3356 y(strategies)527 3556 y(inline2)84 b(=)44 b(bottomup\(repeat)o
(\(\(r)o(ep)o(eat)o(1\()o(In)o(l1)37 b(<+)43 b(Inl2\))e(;)j
(try\(Dead\)\))39 b(<+)k(Dead\)\))527 3755 y(inline2)e(=)i
(bottomup\(repeat\()o(rep)o(ea)o(t1\()o(In)o(l1)37 b(+)43
b(Inl2\)\)\))440 4001 y Fl(Expand)27 b(the)h(strategy)54
b(with)28 b(resp)r(ect)f(to)h(the)g(desugared)e(sp)r(eci\014cation;)440
4170 y(\(***)h(Is)g(this)h(strategy)e(correct??)36 b(***\))440
4417 y Fe(rules)527 4616 y(InitExpand')j(:)k(env)g(->)f
(\(Call\(SVar\("main")o(\),)37 b([]\),)42 b(env\))527
4815 y(InitExpand)e(:)j(env)f(->)h(\(env1,)e(env2\))1094
4915 y(where)g(<repeat\(SplitDefs)c(<+)43 b(SplitDefs'\)>)38
b(\(env,)k([],)g([]\))1355 5015 y(=>)h(\([],)f(env1,)g(env2\))527
5214 y(SplitDefs)e(:)j(\(Cons\(sdef,)c(sdefs\),)i(env1,)g(env2\))h(->)
1050 5313 y(\(sdefs,)f(env1,)g(Cons\(sdef,)f(env2\)\))1050
5413 y(where)i(<doInline>)d(sdef)1831 5662 y Fl(71)p
eop
%%Page: 72 75
72 74 bop 440 199 a Fl(Chapter:)36 b(F)-7 b(ron)n(tend)527
631 y Fe(SplitDefs')40 b(:)j(\(Cons\(sdef,)c(sdefs\),)i(env1,)g(env2\))
h(->)1094 731 y(\(sdefs,)e(Cons\(sdef,)g(env1\),)h(env2\))527
930 y(ExpandCall)f(:)789 1029 y(\(Call\(SVar\(f\),)d(ss\),)42
b(env\))g(->)h(\(<strename>)c(s,)k(<ExtendEnv>)c(\(xs,)j(ss,)g(env\)\))
789 1129 y(where)f(<length>)f(ss)j(=>)g(n;)1050 1229
y(<fetch\(SDef\(?f,)38 b(where\(length)g(=>)43 b(n\);)f(?xs)h(,)g
(?s\)\)>)e(env)527 1428 y(ExpandCall)f(:)789 1528 y(\(Call\(SVar\(f\),)
d(ss\),)42 b(env\))g(->)h(\(Call\(SVar\(g\),)38 b(ss\),)k(env\))789
1627 y(where)f(<fetch\(?SDef\(f,)d([],)k(Call\(SVar\(g\),)c([]\)\)\)>)j
(env)527 1826 y(TryCall)g(:)i(\(Call\(SVar\(f\),)38 b(ss\),)k(env\))g
(->)g(\(Tried\(Call\(SVar\()o(f\),)37 b(ss\)\),)k(env\))527
2026 y(Dist\(s\))g(:)i(\(e,)f(env\))g(->)h(\(<all\(\\x)d(->)j(\(x,)f
(env\)\\;)g(s;)g(Fst\)>)g(e,)h(env\))527 2225 y(ExtendEnv)d(:)j(\(xs,)f
(ss,)g(env\))g(->)h(<conc>)e(\(<zip\(MkSDef\)>)d(\(xs,)k(ss\),)g(env\))
440 2444 y Fl(Heuristics)27 b(for)f(inlining;)i(inline)g(all)f(op)r
(erators)e(with)i(argumen)n(ts.)36 b(Also)27 b(n)n(ullary)f(op)r(era-)
440 2544 y(tors)h(that)h(represen)n(t)e(rules)h(\(do)h(a)f(matc)n(h)g
(as)g(\014rst)g(action\).)440 2713 y(T)-7 b(o)r(do:)36
b(Also)28 b(inline)g(sums)f(of)h(rules)f(if)h(they)g(o)r(ccur)f(inside)
g(a)g(sum)440 2922 y Fe(strategies)527 3122 y(doInline)40
b(=)k(SDef\(id,)c(Cons\(id,)g(id\),)i(id\))g(+)1007 3221
y(SDef\(not\("main")o(\),)37 b([],)43 b(Scope\(id,)c(Seq\(Match\(id\),)
f(id\)\)\))k(+)1007 3321 y(SDef\(not\("main")o(\),)37
b([],)43 b(Seq\(Scope\(id,)38 b(Seq\(Match\(id\),)g(id\)\),)j(id\)\))
527 3520 y(expandStrat)e(=)k(rec)g(eval\(Dist\(eval\);)37
b(try\(repeat1\(Exp)o(and)o(Ca)o(ll\))o(;)g(eval\)\))527
3719 y(expandStrat')i(=)k(\(rec)f(eval\(Dist\(eval\))37
b(;)43 b(\(\(repeat1\(ExpandC)o(all)o(\))37 b(;)44 b(eval\))2227
3819 y(<+)f(TryCall)d(<+)j(id\)\)\))f(;)h(Fst)527 4018
y(inline)e(=)i(InitExpand;)c(expandStrat;)g(Fst;)j(rename_sdefs)527
4218 y(inlineIO)e(=)k(iowrap\(inline\))440 4417 y(rules)527
4616 y(rename_sdefs)39 b(:)614 4716 y(sdefs)j(->)h(sdefs')614
4815 y(where)f(<filter\(NewName\))o(>)37 b(sdefs)42 b(=>)h(tbl;)876
4915 y(<map\(\(id,)d(MkCall\)\)>)g(tbl)i(=>)h(sbs;)876
5015 y(<map\(RenameSDef\()o(!t)o(bl,)37 b(!sbs\)\)>)j(sdefs)i(=>)h
(sdefs')527 5214 y(NewName)e(:)i(SDef\(x,)e(_,)h(_\))h(->)g(\(x,)f
(<new>\(\)\))963 5313 y(where)g(not\(!x)f(=>)h("main"\))1831
5662 y Fl(72)p eop
%%Page: 73 76
73 75 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)527 531 y Fe(RenameSDef\(mktbl,)37
b(mksbs\))k(:)614 631 y(SDef\(x,)g(xs,)h(s\))h(->)614
731 y(SDef\(y,)e(xs,)h(<subs\(IsSVar,)d(mksbs\)>)h(s\))614
830 y(where)i(\(mktbl;)f(fetch\(?\(x,)e(y\)\)\))j(<+)h(\(!x)f(=>)h(y\))
1831 5662 y Fl(73)p eop
%%Page: 74 77
74 76 bop 440 199 a Fl(Chapter:)36 b(Optimizer)440 531
y Fh(OPTIMIZER)440 809 y Fe(module)41 b(optimizer)440
908 y(imports)g(simplification)c(optimization)i(optimization3)f
(match-build)h(lib)440 1108 y(strategies)527 1307 y(main)j(=)h
(iowrap\(\(*)d(defmb;)h(*\))i(optimize\))1831 5662 y
Fl(74)p eop
%%Page: 75 78
75 77 bop 440 199 a Fl(Chapter:)36 b(Optimizer)440 531
y Fh(SIMPLIFICA)-8 b(TION)440 726 y Fl(This)28 b(mo)r(dule)f(sp)r
(eci\014es)h(basic)f(simpli\014cation)g(rules)g(for)g(strategies.)440
978 y Fe(module)41 b(simplification)440 1078 y(imports)g(strategy)440
1363 y Fh(Iden)m(tit)m(y)440 1586 y Fe(rules)527 1686
y(I1)i(:)g(Test\(Id\))389 b(->)43 b(Id)527 1785 y(I2)g(:)g(Not\(Id\))
433 b(->)43 b(Fail)527 1885 y(I3)g(:)g(Seq\(Id,)e(s\))304
b(->)43 b(s)527 1985 y(I4)g(:)g(Seq\(s,)e(Id\))304 b(->)43
b(s)527 2084 y(I5)g(:)g(Choice\(s,)d(Id\))173 b(->)43
b(s)527 2184 y(I6)g(:)g(Choice\(Id,)d(s\))173 b(->)43
b(s)527 2284 y(I7)g(:)g(LChoice\(Id,)c(s\))130 b(->)43
b(Id)527 2383 y(I8)g(:)g(Scope\(xs,)d(Id\))173 b(->)43
b(Id)527 2483 y(I9)g(:)g(Rec\(x,Id\))345 b(->)43 b(Id)527
2582 y(I10)g(:)g(All\(Id\))389 b(->)43 b(Id)527 2682
y(I11)g(:)g(Path\(i,Id\))257 b(->)43 b(Id)527 2782 y(I12)g(:)g
(Where\(Id\))301 b(->)43 b(Id)527 2881 y(I14)g(:)g(CongWld\(ss\))213
b(->)43 b(Id)g(where)e(<map\(?Id\)>)f(ss)527 2981 y(I15)j(:)g(App\(Id,)
d(t\))261 b(->)43 b(t)527 3081 y(I16)g(:)g(Match\(Wld\))257
b(->)43 b(Id)527 3280 y(I13)g(:)g(Cong\(f,)d(ss\))217
b(->)43 b(MatchFunA\(Fun\(f,)37 b(<length>)j(ss\),)i([],)g([],)h(Id\))
789 3379 y(where)e(<map\(?Id\)>)f(ss)440 3479 y(strategies)527
3678 y(ElimId)h(=)i(I1)g(+)g(I2)g(+)g(I3)g(+)g(I4)g(+)g(I5)g(+)g(I6)g
(+)g(I7)g(+)g(I8)g(+)g(I9)g(+)g(I10)f(+)919 3778 y(I11)h(+)g(I12)f(+)h
(I13)g(+)g(I14)f(+)i(I15)e(+)h(I16)440 4030 y Fl(Note)28
b(that)g(the)g(follo)n(wing)e(rules)h(are)g(not)g(sound)440
4266 y Fe(rules)527 4366 y(NotValid)40 b(:)k(One\(Id\))433
b(->)42 b(Id)527 4465 y(NotValid)e(:)k(Some\(Id\))389
b(->)42 b(Id)440 4751 y Fh(F)-8 b(ailure)440 4974 y Fe(rules)527
5073 y(F1)87 b(:)43 b(Test\(Fail\))301 b(->)42 b(Fail)527
5173 y(F2)87 b(:)43 b(Not\(Fail\))345 b(->)42 b(Id)527
5273 y(F3)87 b(:)43 b(Seq\(Fail,)d(s\))217 b(->)42 b(Fail)527
5372 y(F4)87 b(:)43 b(Seq\(s,)e(Fail\))216 b(->)42 b(Fail)1831
5662 y Fl(75)p eop
%%Page: 76 79
76 78 bop 440 199 a Fl(Chapter:)36 b(Optimizer)527 531
y Fe(F5)87 b(:)43 b(Scope\(xs,)d(Fail\))85 b(->)42 b(Fail)527
631 y(F6)87 b(:)43 b(Rec\(x,Fail\))257 b(->)42 b(Fail)527
731 y(F7)87 b(:)43 b(Some\(Fail\))301 b(->)42 b(Fail)527
830 y(F8)87 b(:)43 b(One\(Fail\))345 b(->)42 b(Fail)527
930 y(F9)87 b(:)43 b(Path\(i,Fail\))213 b(->)42 b(Fail)527
1029 y(F10)h(:)g(Cong\(f,)d(ls\))261 b(->)42 b(Fail)g(where)g
(<fetch\(?Fail\)>)c(ls)527 1129 y(F11)43 b(:)g(Choice\(Fail,)38
b(s\))87 b(->)42 b(s)527 1229 y(F12)h(:)g(Choice\(s,)d(Fail\))85
b(->)42 b(s)527 1328 y(F13)h(:)g(LChoice\(Fail,)38 b(s\))43
b(->)f(s)527 1428 y(F14)h(:)g(LChoice\(s,)c(Fail\))j(->)g(s)527
1528 y(F15)h(:)g(Where\(Fail\))257 b(->)42 b(Fail)527
1627 y(\(*)h(F)g(:)g(Case\([]\))389 b(->)43 b(Fail)f(*\))440
1727 y(strategies)527 1926 y(F)h(=)h(F1)e(+)h(F2)g(+)g(F3)g(+)g(F4)g(+)
g(F5)g(+)g(F6)g(+)g(F7)g(+)g(F8)g(+)g(F9)g(+)g(F10)f(+)702
2026 y(F11)g(+)h(F12)f(+)i(F13)e(+)h(F14)f(+)i(F15)440
2245 y Fl(Note)28 b(that)g(the)g(follo)n(wing)e(rule)h(is)h(not)f
(sound)440 2454 y Fe(rules)527 2653 y(NotValid)40 b(:)k(All\(Fail\))39
b(->)k(Fail)440 2863 y Fg(commut)-6 b(a)g(tivity)32 b(and)f(associa)-6
b(tivity)440 3082 y Fe(rules)527 3281 y(Comm)42 b(:)h(Choice\(x,)d(y\))
j(->)g(Choice\(y,)d(x\))527 3480 y(Ass)j(:)g(Choice\(Choice\(x)o(,)38
b(y\),)k(z\))130 b(->)43 b(Choice\(x,)d(Choice\(y,)f(z\)\))527
3580 y(Ass)k(:)g(Seq\(Seq\(x,)c(y\),)j(z\))392 b(->)43
b(Seq\(x,)e(Seq\(y,)g(z\)\))527 3680 y(Ass)i(:)g(LChoice\(LChoice)o
(\(x,)37 b(y\),)42 b(z\))h(->)g(LChoice\(x,)c(LChoice\(y,)h(z\)\))527
3879 y(LAss:)i(Seq\(s1,)e(Seq\(s2,)h(s3\)\))h(->)h(Seq\(Seq\(s1,)c
(s2\),)j(s3\))440 4098 y Fg(idempotence)527 4317 y Fe(P)h(:)h
(Choice\(x,)39 b(x\))87 b(->)42 b(x)527 4417 y(P)h(:)h(LChoice\(x,)39
b(x\))k(->)f(x)527 4616 y(P')h(:)g(Choice\(s,)d(s'[s]\))h(->)i
(s'[s]\(conChoice\))527 4716 y(P')g(:)g(LChoice\(s,)d(s'[s]\))h(->)h
(LChoice\(s,)e(s'[Id]\(conLChoic)o(e\))o(\))527 4915
y(P)j(:)h(Where\(Where\(s\)\))80 b(->)43 b(Where\(s\))527
5015 y(P)g(:)h(Not\(Not\(s\)\))39 b(->)j(Test\(s\))527
5114 y(P)h(:)h(Test\(Test\(s\)\))38 b(->)k(Test\(s\))527
5313 y(P)h(:)h(Where\(Seq\(Where)o(\(s)o(1\),)37 b(Seq\(Build\(t\),)h
(s2\)\)\))k(->)702 5413 y(Where\(Seq\(s1,)c(Seq\(Build\(t\),)g
(s2\)\)\))1831 5662 y Fl(76)p eop
%%Page: 77 80
77 79 bop 440 199 a Fl(Chapter:)36 b(Optimizer)440 531
y Fh(DISTRIBUTION)440 809 y Fe(module)41 b(distribution)440
908 y(imports)g(strategy)440 1008 y(imports)g(stratlib)440
1260 y Fg(choice)32 b(and)f(sequential)g(compostion)440
1430 y Fl(The)d(follo)n(wing)e(rules)h(are)g(the)h(usual)f(form)n
(ulations)f(for)i(distributivit)n(y)-7 b(.)440 1682 y
Fe(rules)527 1881 y(D)43 b(:)h(Seq\(x,)d(Choice\(y,)e(z\)\))86
b(->)43 b(Choice\(Seq\(x,)38 b(y\),)43 b(Seq\(x,)e(z\)\))527
1981 y(D)i(:)h(Seq\(x,)d(LChoice\(y,)e(z\)\))j(->)h(LChoice\(Seq\(x,)38
b(y\),)k(Seq\(x,)f(z\)\))527 2180 y(D)i(:)h(LChoice\(Choice\()o(x,)37
b(y\),)42 b(z\))h(->)g(Choice\(LChoice\(x)o(,)37 b(LChoice\(y,)j
(z\)\),)2227 2280 y(LChoice\(y,)f(LChoice\(x,)h(z\)\)\))527
2479 y(D)j(:)h(LChoice\(x,)39 b(Choice\(y,)h(z\)\))i(->)h
(Choice\(LChoice\(x)o(,)37 b(y\),)43 b(LChoice\(x,)c(z\)\))440
2731 y Fl(The)33 b(corresp)r(onding)e(righ)n(t-distributivit)n(y)h(la)n
(ws)g(are)g(not)h(sound)g(with)g(resp)r(ect)g(to)g(the)440
2831 y(seman)n(tics.)527 3067 y Fe(Dn)43 b(:)g(Seq\(Choice\(x,)38
b(y\),)43 b(z\))260 b(->)43 b(Choice\(Seq\(x,)38 b(z\),)43
b(Seq\(y,)e(z\)\))527 3166 y(Dn)i(:)g(Seq\(LChoice\(x,)38
b(y\),)k(z\))217 b(->)43 b(LChoice\(Seq\(x,)38 b(z\),)k(Seq\(y,)f
(z\)\))440 3402 y Fl(F)-7 b(or)20 b(optimization)g(w)n(e)g(w)n(an)n(t)g
(to)h(apply)f(these)g(rules)g(in)h(the)g(rev)n(erse)d(direction,)k
(i.e.,)g(factor)440 3502 y(out)28 b(common)f(pre\014xes)g(of)g(t)n(w)n
(o)g(alternativ)n(es.)527 3754 y Fe(D')43 b(:)g(LChoice\(Seq\(s,)38
b(s1\),)k(Seq\(s,)f(s2\)\))h(->)h(Seq\(s,)e(LChoice\(s1,)e(s2\)\))527
3954 y(D')k(:)g(LChoice\(Seq\(s,)38 b(s1\),)k(LChoice\(Seq\(s,)c(s2\),)
k(s3\)\))f(->)745 4053 y(LChoice\(Seq\(s,)d(LChoice\(s1,)h(s2\)\),)i
(s3\))527 4252 y(D')i(:)g(Seq\(LChoice\(s1,)37 b(s2\),)42
b(CountRule\(x\)\))d(->)745 4352 y(LChoice\(Seq\(s1,)e
(CountRule\(x\)\),)h(Seq\(s2,)j(CountRule\(x\)\)\))527
4604 y(ChoiceMergeXXX)d(:)789 4704 y(Choice\(Seq\(s,)g(s1\),)k(Seq\(s,)
f(s2\)\))h(->)h(Seq\(s,)e(Choice\(s1,)e(s2\)\))527 4903
y(ChoiceMergeXXX)f(:)789 5003 y(Choice\(Seq\(s,)g(s1\),)k
(Choice\(Seq\(s,)c(s2\),)k(s3\)\))g(->)789 5103 y(Choice\(Seq\(s,)c
(Choice\(s1,)h(s2\)\),)j(s3\))527 5302 y(ChoiceMerge)d(:)789
5401 y(Choice\(Seq\(s,)f(s1\),)k(cs[Seq\(s,)e(s2\)]\))h(->)1831
5662 y Fl(77)p eop
%%Page: 78 81
78 80 bop 440 199 a Fl(Chapter:)36 b(Optimizer)789 531
y Fe(Choice\(Seq\(s,)i(Choice\(s1,)h(s2\)\),)j(cs[Fail]\(conCM\)\))440
731 y(strategies)527 930 y(conCM\(s\))e(=)k(rec)e(x\(s)g(<+)h({x:)f
(\(Choice\(s,)e(?x\))i(+)h(Choice\(?x,)d(s\)\);)i(!x})g(<+)1268
1029 y(\(Choice\(x,)e(id\))i(+)h(Choice\(id,)d(x\)\)\))440
1279 y Fg(term)32 b(tra)-7 b(versal)440 1448 y Fl(All)28
b(and)g(Some)440 1697 y Fe(rules)527 1896 y(T)43 b(:)h(Seq\(All\(x\),)
39 b(All\(y\)\))258 b(->)43 b(All\(Seq\(x,y\)\))527 1996
y(T)g(:)h(Choice\(One\(x\),)37 b(One\(y\)\))128 b(->)43
b(One\(Choice\(x,)38 b(y\)\))440 2245 y Fl(P)n(ath)527
2494 y Fe(D')43 b(:)g(Seq\(Path\(i,)c(x\),)j(Path\(i,)f(y\)\))i(->)f
(Path\(i,)f(Seq\(x,)g(y\)\))527 2693 y(C)i(:)h(Seq\(Path\(i,)39
b(x\),)j(Path\(j,)f(y\)\))h(->)h(Seq\(Path\(j,)c(y\),)j(Path\(i,)f
(x\)\))702 2793 y(where)g(not\(<eq>)f(\(i,)j(j\)\))440
3078 y Fh(Scop)s(e)440 3301 y Fl(Scop)r(e)28 b(lifting)440
3470 y(note:)37 b(scop)r(es)27 b(cannot)g(b)r(e)h(lifted)g(out)g(of)f
(recs)527 3719 y Fe(FuseScope':)789 3819 y(Scope\(Nil,)39
b(s\))k(->)g(s)527 3919 y(FuseScope)d(:)789 4018 y(Scope\(xs,)g
(Scope\(ys,)f(s\)\))k(->)g(Scope\(<conc>)38 b(\(xs,)k(ys\),)g(s\))527
4118 y(FuseScope)e(:)789 4218 y(Seq\(Scope\(xs,)e(s1\),)k(Scope\(ys,)e
(s2\)\))i(->)789 4317 y(Scope\(<conc>)c(\(xs,)k(ys\),)g(Seq\(s1,)f
(s2\)\))527 4516 y(FuseScope')f(:)789 4616 y(Scope\(xs,)g
(Seq\(MatchFun\(f\))o(,)e(s2\)\))j(->)i(Seq\(MatchFun\(f\),)37
b(Scope\(xs,)j(s2\)\))527 4815 y(FuseScope')g(:)789 4915
y(Scope\(xs,)g(s\))i(->)h(Scope\(ys,)d(s\))789 5015 y(where)h
(<intersect>)e(\(xs,)j(<tvars>)f(s\))i(=>)f(ys)527 5214
y(FuseScope')e(:)789 5313 y(Scope\(xs,)g(Seq\(Build\(Var\(x)o(\)\),)d
(s\)\))42 b(->)789 5413 y(Seq\(Build\(Var\(x)o(\)\),)37
b(Scope\(xs,)j(s\)\))1831 5662 y Fl(78)p eop
%%Page: 79 82
79 81 bop 440 199 a Fl(Chapter:)36 b(Optimizer)789 531
y Fe(where)41 b(<not\(in\)>)f(\(x,)i(xs\))527 731 y(FuseScope')e(:)j
(Scope\(xs,)d(Seq\(Match\(Var\(x)o(\)\),)d(s\)\))42 b(->)789
830 y(Seq\(Match\(Var\(x)o(\)\),)37 b(Scope\(xs,)j(s\)\))789
930 y(where)h(<not\(in\)>)f(\(x,)i(xs\))527 1129 y(FuseScope)e(:)789
1229 y(Seq\(Scope\(xs,)e(s\),)k(CountRule\(n\)\))c(->)43
b(Scope\(xs,)d(Seq\(s,)h(CountRule\(n\)\)\))527 1468
y(CaseMerge)f(:)j(Choice\(Seq\(MatchF)o(un)o(\(f\))o(,)37
b(s1\),)42 b(Seq\(MatchFun\(g\),)37 b(s2\)\))42 b(->)1050
1567 y(Case\([\(f,)e(s1\),)i(\(g,)g(s2\)]\))1050 1667
y(where)g(<not\(eq\)>)e(\(f,)i(g\))527 1866 y(CaseMerge)e(:)j
(Choice\(Seq\(MatchF)o(un)o(\(f\))o(,)37 b(s1\),)42 b(Case\(cases[\(f,)
c(s2\)]\)\))j(->)1050 1966 y(Case\(cases[\(f,)d(Choice\(s1,)h
(s2\)\)]\(fetch\)\))527 2165 y(CaseMerge)h(:)j(Choice\(Case\(cases)o
([\()o(f,)37 b(s1\)]\),)k(Seq\(MatchFun\(f\),)c(s2\)\))42
b(->)1050 2265 y(Case\(cases[\(f,)c(Choice\(s1,)h(s2\)\)]\(fetch\)\))
527 2464 y(CaseMerge'')g(:)k(Choice\(Case\(cs1[\()o(f,)37
b(s1\)]\),)1442 2564 y(Case\(cs2[Cons\(\(f,)g(s2\),)42
b(cs3\)]\)\))1050 2663 y(->)1050 2763 y(Choice\(Case\(cs1[\()o(f,)37
b(Choice\(s1,)i(s2\)\)]\(fetch\)\),)1355 2863 y(Case\(cs2[cs3]\(at_)o
(su)o(ffi)o(x\))o(\)\))527 3062 y(CaseMerge)h(:)j(Choice\(Case\(cs1\),)
37 b(Case\(cs2\)\))i(->)k(Choice\(Case\(cs1')o(\),)37
b(Case\(cs2'\)\))1050 3161 y(where)1050 3261 y(<fetch\({f,)j(s1:)1399
3361 y(<<\(f,)h(s1\))i(->)g(\(f,)f(Choice\(s1,)d(s2\)\))1486
3460 y(where)j(<at_suffix\({cs3)o(:)c(<<Cons\(\(f,)h(s2\),)j(cs3\))g
(->)h(cs3>>}\)>)d(cs2)i(=>)h(cs2')1399 3560 y(>>}\))1050
3660 y(>)g(cs1)g(=>)f(cs1')440 3899 y Fl(When)34 b(there)f(is)g(no)g(o)
n(v)n(erlap)e(b)r(et)n(w)n(een)i(the)g(guards)f(of)h(the)h(t)n(w)n(o)e
(case)h(expressions)e(the)440 3998 y(cases)26 b(can)i(b)r(e)g(merged.)
527 4237 y Fe(CaseMerge')40 b(:)j(Choice\(Seq\(Match)o(Fu)o(n\(f)o(\),)
37 b(s\),)42 b(Case\(cases\)\))d(->)1094 4337 y(Case\(Cons\(\(f,)f
(s\),)k(cases\)\))527 4536 y(CaseMerge')e(:)j(Choice\(Case\(case)o(s\))
o(,)38 b(Seq\(MatchFun\(f\))o(,)f(s\)\))43 b(->)1094
4636 y(Case\(Cons\(\(f,)38 b(s\),)k(cases\)\))527 4835
y(CaseMerge')e(:)j(Choice\(Case\(case)o(s1)o(\),)37 b(Case\(cases2\)\))
h(->)1094 4935 y(Case\(<conc>)h(\(cases1,)h(cases2\)\))440
5174 y Fl(Left)28 b(c)n(hoice)f(of)g(cases)527 5413 y
Fe(CaseMerge)40 b(:)j(LChoice\(Seq\(Match)o(Fu)o(n\(f)o(\),)37
b(s1\),)42 b(Case\(cases[\(f,)c(s2\)]\)\))j(->)1831 5662
y Fl(79)p eop
%%Page: 80 83
80 82 bop 440 199 a Fl(Chapter:)36 b(Optimizer)1050 531
y Fe(Case\(cases[\(f,)i(LChoice\(s1,)h(s2\)\)]\(fetch\)\))527
731 y(CaseMerge)h(:)j(LChoice\(Case\(case)o(s[)o(\(f,)37
b(s1\)]\),)k(Seq\(MatchFun\(f\),)c(s2\)\))42 b(->)1050
830 y(Case\(cases[\(f,)c(LChoice\(s1,)h(s2\)\)]\(fetch\)\))527
1029 y(CaseMerge'')g(:)k(LChoice\(Case\(cs1[)o(\(f,)37
b(s1\)]\),)1399 1129 y(Case\(cs2[Cons\(\(f)o(,)g(s2\),)42
b(cs3\)]\)\))1050 1229 y(->)1050 1328 y(LChoice\(Case\(cs1[)o(\(f)o(,)c
(LChoice\(s1,)h(s2\)\)]\(fetch\)\),)1399 1428 y(Case\(cs2[cs3]\(at)o
(_s)o(uff)o(ix)o(\)\)\))527 1627 y(CaseMerge)h(:)j
(LChoice\(Case\(cs1\))o(,)37 b(Case\(cs2\)\))j(->)j(LChoice\(Case\(cs)o
(1'\))o(,)37 b(Case\(cs2'\)\))1050 1727 y(where)1050
1826 y(<fetch\({f,)j(s1:)1399 1926 y(<<\(f,)h(s1\))i(->)g(\(f,)f
(LChoice\(s1,)d(s2\)\))1486 2026 y(where)j(<at_suffix\({cs3)o(:)c
(<<Cons\(\(f,)h(s2\),)j(cs3\))g(->)h(cs3>>}\)>)d(cs2)i(=>)h(cs2')1399
2125 y(>>}\))1050 2225 y(>)g(cs1)g(=>)f(cs1')527 2475
y(CaseMerge')e(:)j(LChoice\(Seq\(Matc)o(hF)o(un\()o(f\))o(,)37
b(s\),)43 b(Case\(cases\)\))38 b(->)1094 2575 y(Case\(Cons\(\(f,)g
(s\),)k(cases\)\))527 2774 y(CaseMerge')e(:)j(LChoice\(Case\(cas)o(es)o
(\),)37 b(Seq\(MatchFun\(f\),)g(s\)\))42 b(->)1094 2874
y(Case\(Cons\(\(f,)c(s\),)k(cases\)\))527 3073 y(CaseMerge')e(:)j
(LChoice\(Case\(cas)o(es)o(1\),)37 b(Case\(cases2\)\))h(->)1094
3172 y(Case\(<conc>)h(\(cases1,)h(cases2\)\))440 3458
y Fh(Recursion)440 3681 y Fl(UnF)-7 b(olding)527 3931
y Fe(U)43 b(:)h(Rec\(x,s\))c(->)j(<subs>)e(\(x,)h(Rec\(x,s\),)e(s\))440
4181 y Fl(F)-7 b(olding)27 b(\(This)h(do)r(es)f(probably)g(not)h(w)n
(ork\))527 4431 y Fe(Fold)42 b(:)h(s[Rec\(x,)e(s'\)])g(->)i(Rec\(x,)e
(s[Call\(x,[]\)]\))440 4681 y Fl(Distribution)28 b(and)f(recursion)789
5015 y Fe(\(*)42 b(Change)g(x,)g(SVar\(x\))f(to)i(Label\(SVar\(x\),)38
b([]\)\))j(*\))527 5214 y(D'')i(:)g(Seq\(Rec\(x,)c(LChoice\(Seq\(s1,)f
(SVar\(x\)\),)h(s2\)\),)j(s3\))g(->)745 5313 y(Rec\(x,)f
(LChoice\(Seq\(s1,)d(SVar\(x\)\),)h(Seq\(s2,)i(s3\)\)\))876
5413 y(where)g(<not\(in\)>)f(\(SVar\(x\),)g(s2\))1831
5662 y Fl(80)p eop
%%Page: 81 84
81 83 bop 440 199 a Fl(Chapter:)36 b(Optimizer)527 631
y Fe(D'')43 b(:)g(Seq\(Rec\(x,)c(LChoice\(s1,)g(Seq\(s2,)i
(SVar\(x\)\)\)\),)e(s3\))j(->)745 731 y(Rec\(x,)f(LChoice\(Seq\(s1,)d
(s3\),)k(Seq\(s2,)e(SVar\(x\)\)\)\))745 830 y(where)i(<not\(in\)>)d
(\(SVar\(x\),)h(s2\))527 1029 y(D'')j(:)g(Seq\(Rec\(x,)c
(Choice\(Seq\(s1,)f(Label\(SVar\(x\),)g([]\)\),)j(s2\)\),)h(s3\))g(->)
745 1129 y(Rec\(x,)f(LChoice\(Seq\(s1,)d(x\),)k(Seq\(s2,)f(s3\)\)\))745
1229 y(where)h(<not\(in\)>)d(\(x,)k(s2\))527 1428 y(D'')g(:)g
(Seq\(Rec\(x,)c(Choice\(s1,)h(Seq\(s2,)g(x\)\)\),)i(s3\))g(->)745
1528 y(Rec\(x,)f(Choice\(Seq\(s1,)d(s3\),)k(Seq\(s2,)f(x\)\)\))745
1627 y(where)h(<not\(in\)>)d(\(x,)k(s2\))1831 5662 y
Fl(81)p eop
%%Page: 82 85
82 84 bop 440 199 a Fl(Chapter:)36 b(Optimizer)440 531
y Fh(OPTIMIZA)-8 b(TION3)440 809 y Fe(module)41 b(optimization3)440
908 y(imports)g(strategy)440 1108 y(rules)440 1307 y(\(*)i(Decomposing)
c(Match)i(*\))527 1506 y(MkVar)h(:)h(x)g(->)g(Var\(x\))527
1705 y(M)g(:)h(Match\(Op\(f,)39 b(ts\)\))i(->)i(Seq\(Match\(Op\(f,)38
b(xs\)\),)j(ms\))702 1805 y(where)g(<map\(new)f(;)j(MkVar\)>)e(ts)i(=>)
g(xs)f(;)963 1905 y(<zip\(M'\)>)e(\(xs,)i(ts\))g(=>)h(ms)527
2104 y(M')g(:)g(\(x,)f(t\))h(->)g(Seq\(Build\(x\),)38
b(Match\(t\)\))440 2303 y(\(*)43 b(Merging)d(Matches)h(*\))527
2502 y(M)i(:)h(Choice\(Seq\(Matc)o(h\()o(Op\()o(f,)37
b(xs\)\),)42 b(s1\),)1007 2602 y(Seq\(Match\(Op\(f,)37
b(xs\)\),)42 b(s2\)\))f(->)702 2702 y(Seq\(Match\(Op\(f,)c(xs\)\),)k
(Choice\(s1,)f(s2\)\))1831 5662 y Fl(82)p eop
%%Page: 83 86
83 85 bop 440 199 a Fl(Chapter:)36 b(Optimizer)440 531
y Fh(OPTIMIZA)-8 b(TION)440 809 y Fe(module)41 b(optimization)440
908 y(imports)g(strategy)f(list)i(simplification)c(distribution)g
(stratlib)440 1161 y Fl(matc)n(h)27 b(and)h(build)440
1413 y Fe(rules)527 1612 y(M)43 b(:)h(Cong\(f,)c(ss\))j(->)f
(Match\(Op\(f,)d(ts\)\))702 1712 y(where)i(<map\({t:<<Match\()o(t\))c
(->)43 b(t>>})f(+)h(<<Id)f(->)h(Match\(Wld\)>>\)>)38
b(ss)k(=>)h(ts)527 1911 y(M)g(:)h(Seq\(Build\(t\),)38
b(Seq\(Prim\("new"\),)f(s\)\))42 b(->)h(Seq\(Prim\("new"\),)37
b(s\))527 2110 y(M)43 b(:)h(Seq\(Match\(t\),)38 b(s[Build\(t\)]\))g(->)
43 b(Seq\(Match\(t\),)38 b(s[Id]\(firstInSeq\))o(\))527
2210 y(M)43 b(:)h(Seq\(Build\(t\),)38 b(s[Match\(t\)]\))g(->)43
b(Seq\(Build\(t\),)38 b(s[Id]\(firstInSeq\))o(\))527
2409 y(M)43 b(:)h(Seq\(Build\(t\),)38 b(s[Build\(t'\)]\))g(->)43
b(s[Build\(t'\)]\(fi)o(rst)o(In)o(Seq)o(\))440 2609 y(\(*)527
2708 y(M)g(:)h(Seq\(Build\(Op\(f,)37 b(ts\)\),)k(s[MatchFun\(f\)]\))d
(->)702 2808 y(Seq\(Build\(Op\(f,)f(ts\)\),)k(s[Id]\(firstInSeq\))o(\))
527 3007 y(M')i(:)g(App\(s[MatchFun\(f)o(\)],)37 b(Op\(f,)k(ts\)\))h
(->)702 3107 y(App\(s[Id]\(first)o(In)o(Seq)o(\),)37
b(Op\(f,)42 b(ts\)\))440 3306 y(*\))527 3505 y(M)h(:)h
(Seq\(Match\(Var\(x)o(\)\))o(,)38 b(s[Build\(Var\(x\)\))o(]\))f(->)702
3605 y(Seq\(Match\(Var\(x)o(\)\))o(,)h(s[Id]\(firstInSe)o(q\)\))440
3804 y(\(*)527 3904 y(M')43 b(:)g(Seq\(Build\(t1\),)38
b(Match\(t2\)\))h(->)k(Fail)745 4003 y(where)f(<not\(match\(t1\)\))o(>)
c(t2)440 4103 y(*\))527 4302 y(M')43 b(:)614 4402 y(Scope\(xs,)d
(Seq\(Build\(Var\(y\)\))o(,)d(Seq\(Match\(Var\(x\)\))o(,)g(s\)\)\))42
b(->)614 4501 y(Scope\(<diff>)d(\(xs,)j([x]\),)876 4601
y(Seq\(Build\(Var\(y\))o(\),)37 b(<tsubs>)k(\([Var\(x\)],)e
([Var\(y\)],)h(s\)\)\))614 4701 y(where)i(<in>)g(\(x,)g(xs\))527
4900 y(CommonSubterm)c(:)614 5000 y(Seq\(Match\(t1[Op\(f)o(,)f
(ts\)]\),)42 b(s[Build\(t2[Op\(f)o(,)c(ts\)]\)]\))i(->)614
5099 y(Scope\([x],)702 5199 y(Seq\(Match\(t1[Va)o(r\()o(x\)])o(\),)702
5298 y(Seq\(Seq\(Build\(V)o(ar)o(\(x\))o(\),)d(Seq\(Match\(Op\(f,)g
(ts\)\),)876 5398 y(s[Build\(t2[Var\(x)o(\)])o(\)]\))o(\)\))o(\)\))1831
5662 y Fl(83)p eop
%%Page: 84 87
84 86 bop 440 199 a Fl(Chapter:)36 b(Optimizer)614 531
y Fe(where)42 b(new)g(=>)h(x)440 731 y(\(*)g(As\(x,)e(t\))i(:)g
(match\(t\))d(and)j(bind)f(to)h(x)g(*\))527 930 y(CommonSubterm)38
b(:)614 1029 y(Seq\(Match\(t1[Op\(f)o(,)f(ts\)]\),)42
b(s[Build\(t2[Op\(f)o(,)c(ts\)]\)]\))i(->)614 1129 y(Scope\([x],)702
1229 y(Seq\(Match\(t1[As)o(\(V)o(ar\()o(x\))o(,)e(Op\(f,)j(ts\)\)]\),)
876 1328 y(s[Build\(t2[Var\(x)o(\)])o(\)]\))o(\))614
1428 y(where)h(new)g(=>)h(x)440 1780 y Fg(ma)-6 b(tch-build)32
b(fusion)440 1949 y Fl(\(This)23 b(did)h(not)f(quite)g(w)n(ork)f(as)g
(p)r(ortra)n(y)n(ed)f(here.)35 b(The)23 b(problem)g(is)g(that)g(the)h
(congruence)440 2049 y(ma)n(y)30 b(ha)n(v)n(e)g(a)g(side-e\013ect)h
(that)g(in\015uences)g(the)h(co)r(de)e(in)i(the)f(build.)47
b(The)31 b(MkApp)h(rule)440 2148 y(creates)26 b(an)i(application)f
(only)g(if)h(all)f(v)-5 b(ariables)27 b(are)f(de\014ned)i(in)g(the)g
(branc)n(h.\))527 2500 y Fe(MkApp)42 b(:)h(\(s,)f(t\))h(->)g(Seq\(s,)e
(Build\(t\)\))876 2599 y(where)g(<diff>)g(\(<tvars>)g(t,)i(<tvars>)d
(s\))j(=>)g([])527 2799 y(CongBuild)d(:)789 2898 y(Seq\(Cong\(f,)f
(ss\),)j(s[Build\(Op\(f,)c(ts\)\)]\))j(->)789 2998 y(Seq\(Cong\(f,)e
(<zip\(MkApp\)>)f(\(ss,)k(ts\)\),)g(s[Id]\(firstInSeq)o(\)\))440
3097 y(\(*)527 3197 y(CongBuild)e(:)789 3297 y(Seq\(MatchFun\(f\))o(,)e
(Seq\(CongWld\(ss\))o(,)g(s[Build\(Op\(f,)g(ts\)\)]\)\))j(->)789
3396 y(Seq\(MatchFun\(f\))o(,)d(Seq\(CongWld\(<zi)o(p\(M)o(kA)o(pp\))o
(>)f(\(ss,)42 b(ts\)\),)g(s[Id]\(firstInSeq)o(\)\))o(\))440
3496 y(*\))440 3748 y Fg(build-congr)n(uence)32 b(fusion)527
4000 y Fe(BuildCong)40 b(:)789 4099 y(Seq\(Build\(Op\(f,)d(ts\)\),)42
b(s[Cong\(f,)d(ss\)]\))j(->)789 4199 y(Seq\(Build\(Op\(f,)37
b(<zip\(\\)k(\(s,)i(t\))f(->)h(App\(s,)e(t\))i(\\)g(\)>)g(\(ss,)f
(ts\)\)\),)963 4299 y(s[Id]\(firstInSeq)o(\)\))527 4498
y(BuildCong)e(:)789 4598 y(Seq\(Build\(Op\(f,)d(ts\)\),)42
b(s[CongWld\(ss\)]\))37 b(->)789 4697 y(Seq\(Build\(Op\(f,)g(<zip\(\\)k
(\(s,)i(t\))f(->)h(App\(s,)e(t\))i(\\)g(\)>)g(\(ss,)f(ts\)\)\),)963
4797 y(s[Id]\(firstInSeq)o(\)\))527 4996 y(BuildCong)e(:)789
5096 y(Seq\(Build\(Op\(f,)d(ts\)\),)42 b(Seq\(MatchFun\(f,)37
b(n\),)42 b(s[CongWld\(ss\)]\)\))37 b(->)789 5195 y(Seq\(Build\(Op\(f,)
g(<zip\(\\)k(\(s,)i(t\))f(->)h(App\(s,)e(t\))i(\\)g(\)>)g(\(ss,)f
(ts\)\)\),)963 5295 y(s[Id]\(firstInSeq)o(\)\))789 5395
y(where)f(<length>)f(ts)j(=>)g(n)1831 5662 y Fl(84)p
eop
%%Page: 85 88
85 87 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)527 531 y Fe(AppCong)41
b(:)789 631 y(App\(s[Cong\(f,)d(ss\)],)j(Op\(f,)h(ts\)\))g(->)789
731 y(App\(s[Id]\(first)o(InS)o(eq)o(\),)963 830 y(Op\(f,)g(<zip\(\\)f
(\(s,)h(t\))h(->)g(App\(s,)e(t\))h(\\)i(\)>)e(\(ss,)g(ts\)\)\))527
1029 y(AppCong)f(:)789 1129 y(App\(s[CongWld\(s)o(s\)])o(,)c(Op\(f,)42
b(ts\)\))g(->)789 1229 y(App\(s[Id]\(first)o(InS)o(eq)o(\),)963
1328 y(Op\(f,)g(<zip\(\\)f(\(s,)h(t\))h(->)g(App\(s,)e(t\))h(\\)i(\)>)e
(\(ss,)g(ts\)\)\))527 1528 y(AppCong)f(:)789 1627 y(App\(Seq\(MatchFu)o
(n\(f)o(\),)c(s[CongWld\(ss\)]\),)g(Op\(f,)k(ts\)\))h(->)789
1727 y(App\(s[Id]\(first)o(InS)o(eq)o(\),)963 1826 y(Op\(f,)g(<zip\(\\)
f(\(s,)h(t\))h(->)g(App\(s,)e(t\))h(\\)i(\)>)e(\(ss,)g(ts\)\)\))440
2079 y Fl(Strategies)27 b(for)g(application)g(of)g(simpli\014cation)h
(rules.)440 2331 y Fe(strategies)527 2531 y(simplify)40
b(=)k(ElimId)d(+)i(F)g(+)g(Ass)g(+)g(P)g(+)g(FuseScope)d(+)j(D')g(+)g
(ChoiceMerge)c(\(*)k(+)g(M)g(*\))527 2730 y(fuse)f(=)h(ElimId)e(+)j
(Ass)e(+)h(CongBuild)d(+)j(BuildCong)d(+)j(AppCong)527
2929 y(optimize')d(=)j(downup\(repeat\(fus)o(e\))o(\);)1050
3029 y(downup\(repeat\(sim)o(pl)o(ify)37 b(+)43 b(\(CaseMerge)c(<+)k
(CaseMerge'\)\)\))527 3228 y(optimize')d(=)j(downup\(repeat\(fus)o(e\))
o(\))527 3427 y(optimize')d(=)j(downup\(repeat\(sim)o(pl)o(ify)37
b(+)43 b(\(CaseMerge)c(<+)k(CaseMerge'\)\)\))527 3626
y(optimize)d(=)k(downup\(repeat\(s)o(imp)o(li)o(fy\))o(\))527
3826 y(optimize')c(=)j(downup\(repeat\(I)38 b(+)43 b(F)g(\(*)g(+)g(Ass)
f(+)h(P)h(+)f(S)g(+)g(D')g(+)g(ChoiceMerge)c(*\)\)\))527
4025 y(optimize')h(=)j(downup\(repeat\(I12)37 b(+)43
b(I13)f(+)h(F15\)\))1831 5662 y Fl(85)p eop
%%Page: 86 89
86 88 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)440
531 y Fe(AUTOMATON)440 722 y Fl(Matc)n(hing)g(automaton)g
(instructions.)440 957 y Fe(module)41 b(automaton)440
1057 y(imports)g(terms)g(lib)440 1157 y(signature)527
1256 y(sorts)h(Aut)527 1356 y(constructors)614 1456 y(Down)260
b(:)43 b(Int)g(*)g(Aut)304 b(->)43 b(Aut)614 1555 y(Up)348
b(:)43 b(Aut)566 b(->)43 b(Aut)614 1655 y(Accept)172
b(:)43 b(List\(Int\))302 b(->)43 b(Aut)614 1754 y(Case)260
b(:)43 b(List\(Aut\))d(*)j(Aut)g(->)g(Aut)614 1954 y(MatchVars)d(:)j
(List\(String\))c(*)k(Path)f(*)h(Aut)g(->)f(Aut)614 2053
y(MatchFunA)84 b(:)43 b(String)85 b(*)43 b(List\(String\))38
b(*)44 b(Path)e(*)h(Aut)f(->)h(Aut)614 2253 y(MatchTerm)d(:)j(Path)f(*)
h(Term)f(*)i(Aut)e(->)h(Aut)440 2488 y Fl(Generation)27
b(of)g(a)h(matc)n(hing)f(automaton)f(from)i(a)f(term.)440
2723 y Fe(rules)527 2922 y(Aut1)42 b(:)h(MatchTerm\(p,)c(Wld,)j(c\))173
b(->)43 b(MatchVars\([],)38 b(p,)43 b(c\))527 3122 y(Aut4)f(:)h
(MatchTerm\(p,)c(Var\(x\),)i(c\))h(->)h(MatchVars\([x],)38
b(p,)43 b(c\))527 3321 y(Aut4a)f(:)h(MatchTerm\(p,)38
b(As\(Var\(x\),)i(t\),)i(c\))h(->)876 3421 y(MatchVars\([x],)38
b(p,)k(MatchTerm\(p,)d(t,)k(c\)\))527 3620 y(Aut2)f(:)h(MatchTerm\(p,)c
(Str\(x\),)i(c\))h(->)h(MatchFunA\(Str\(x\))o(,)38 b([],)k(p,)h(c\))527
3819 y(Aut3)f(:)h(MatchTerm\(p,)c(Int\(x\),)i(c\))h(->)h
(MatchFunA\(Int\(x\))o(,)38 b([],)k(p,)h(c\))527 4018
y(Aut3)f(:)h(MatchTerm\(p,)c(Real\(x\),)h(c\))j(->)g(MatchFunA\(Real\()
o(x\),)37 b([],)42 b(p,)h(c\))527 4218 y(Aut5)f(:)h(MatchTerm\(p,)c
(Op\(f,)i(ts\),)h(c\))h(->)832 4317 y(MatchFunA\(Fun\(f,)37
b(<length>)k(ts\),)g([],)i(p,)g(MatchKids\(0,)38 b(p,)43
b(ts,)f(c\)\))527 4516 y(Aut6)g(:)h(MatchKids\(n,)c(p,)k(Nil,)f(c\))g
(->)h(c)527 4716 y(Aut7)f(:)h(MatchKids\(n,)c(p,)k(Cons\(t,)d(ts\),)i
(c\))h(->)832 4815 y(Down\(n,)e(MatchTerm\(Cons\(n)o(,)d(p\),)k(t,)1181
4915 y(Up\(MatchKids\(<pl)o(us>)37 b(\(n,)42 b(1\),)g(p,)h(ts,)f
(c\)\)\)\))527 5114 y(Aut8)g(:)h(MatchTerm\(p,)c(BuildDefault\(t\),)e
(c\))43 b(->)832 5214 y(MatchVars\([],)38 b(p,)43 b(c\))527
5413 y(AutInit)e(:)i(Pat\(t,)e(s\))i(->)g(MatchTerm\([],)38
b(t,)43 b(Accept\(s\)\))1831 5662 y Fl(86)p eop
%%Page: 87 90
87 89 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)440
631 y Fe(strategies)527 830 y(pat-to-aut)40 b(=)j(AutInit;)1094
930 y(topdown\(repeat\(A)o(ut)o(1)38 b(+)43 b(Aut2)f(+)h(Aut3)f(+)h
(Aut4a)e(+)1748 1029 y(Aut4)h(+)h(Aut5)f(+)h(Aut6)f(+)h(Aut7)f(+)h
(Aut8\)\))527 1229 y(mk-automata)c(=)k(map\(pat-to-aut\))440
1471 y Fl(Optimization)27 b(of)h(automata)440 1714 y
Fe(rules)527 1913 y(O)43 b(:)h(Down\(n,)c(Up\(c\)\))h(->)i(c)527
2012 y(O)g(:)h(MatchVars\([],)38 b(p,)k(c\))h(->)g(c)440
2212 y(strategies)527 2411 y(opt-automaton)38 b(=)44
b(downup\(repeat\(O)o(\)\))440 2753 y Fl(Merging)26 b(of)i(automata)f
(for)g(m)n(ultiple)h(patterns)440 2922 y Fg(mer)n(ging)k(tra)-7
b(versal)31 b(opera)-6 b(tions)440 3165 y Fe(rules)527
3364 y(Mrg)43 b(:)g(Merge\(Down\(n,)38 b(c1\),)k(Down\(n,)f(c2\)\))g
(->)i(Down\(n,)e(Merge\(c1,)f(c2\)\))527 3563 y(Mrg)j(:)g
(Merge\(Up\(c1\),)38 b(Up\(c2\)\))j(->)h(Up\(Merge\(c1,)d(c2\)\))527
3763 y(Mrg)k(:)g(Merge\(Accept\(s1)o(\),)37 b(Accept\(s2\)\))i(->)k
(Accept\(Choice\(s1)o(,)38 b(s2\)\))440 4005 y Fg(skipping)32
b(up)440 4174 y Fl(When)j(a)e(pattern)h(do)r(es)g(not)g(c)n(hec)n(k)f
(some)h(subtree)f(this)i(will)f(b)r(e)g(indicated)h(b)n(y)e(an)h
Fe(Up)440 4274 y Fl(where)h(other)f(pattersn)h(that)g(do)g(insp)r(ect)g
(the)h(subtree)f(ha)n(v)n(e)e(some)i(other)f(op)r(eration.)440
4374 y(The)28 b Fe(Up)f Fl(is)g(pushed)h(inside)g(un)n(til)g(it)g
(meets)f(its)h(matc)n(hing)f Fe(Up)g Fl(in)h(the)g(other)f(pattern.)440
4616 y Fe(rules)527 4815 y(Mrg)43 b(:)g(Merge\(Down\(n,)38
b(c1\),)k(Up\(c2\)\))f(->)745 4915 y(Down\(n,)g(Merge\(c1,)f
(Up\(Up\(c2\)\)\)\))527 5114 y(Mrg)j(:)g(Merge\(Up\(c1\),)38
b(Down\(n,)j(c2\)\))h(->)745 5214 y(Down\(n,)f(Merge\(Up\(Up\(c1\)\))o
(,)c(c2\)\))527 5413 y(Mrg)43 b(:)g(Merge\(MatchFunA)o(\(f,)37
b(xs,)42 b(p,)h(c1\),)f(Up\(c2\)\))f(->)1831 5662 y Fl(87)p
eop
%%Page: 88 91
88 90 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)745
531 y Fe(MatchFunA\(f,)39 b(xs,)j(p,)h(Merge\(c1,)d(Up\(c2\)\)\))527
731 y(Mrg)j(:)g(Merge\(Up\(c1\),)38 b(MatchFunA\(f,)h(xs,)j(p,)h
(c2\)\))f(->)745 830 y(MatchFunA\(f,)d(xs,)j(p,)h(Merge\(Up\(c1\),)38
b(c2\)\))527 1029 y(Mrg)43 b(:)g(Merge\(MatchVars)o(\(xs)o(,)37
b(p,)43 b(c1\),)f(Up\(c2\)\))f(->)789 1129 y(MatchVars\(xs,)d(p,)43
b(Merge\(c1,)d(Up\(c2\)\)\))527 1328 y(Mrg)j(:)g(Merge\(Up\(c1\),)38
b(MatchVars\(xs,)g(p,)43 b(c2\)\))f(->)789 1428 y(MatchVars\(xs,)c(p,)
43 b(Merge\(Up\(c1\),)38 b(c2\)\))527 1627 y(Mrg)43 b(:)g
(Merge\(Up\(c\),)38 b(Case\(cs\)\))i(->)789 1727 y(Case\(<map\({c':)d
(?c';)42 b(!Merge\(Up\(c\),)d(c'\)}\)>)i(cs\))527 1926
y(Mrg)i(:)g(Merge\(Case\(cs\),)37 b(Up\(c\)\))k(->)789
2026 y(Case\(<map\({c':)c(?c';)42 b(!Merge\(Up\(c\),)d(c'\)}\)>)i(cs\))
440 2275 y Fl(Merging)26 b(with)j(Accept)440 2524 y Fe(rules)527
2723 y(Mrg)43 b(:)g(Merge\(Up\(c1\),)38 b(Accept\(c2\)\))h(->)745
2823 y(Up\(Merge\(c1,)g(Accept\(c2\)\)\))527 3022 y(Mrg)k(:)g
(Merge\(Accept\(c1)o(\),)37 b(Up\(c2\)\))k(->)745 3122
y(Up\(Merge\(Accept\()o(c1\))o(,)c(c2\)\))527 3321 y(Mrg)43
b(:)g(Merge\(Down\(n,)38 b(c1\),)k(Accept\(c2\)\))d(->)745
3421 y(Down\(n,)i(Merge\(c1,)f(Up\(Accept\(c2\)\)\))o(\))527
3620 y(Mrg)j(:)g(Merge\(Accept\(c1)o(\),)37 b(Down\(n,)k(c2\)\))h(->)
745 3719 y(Down\(n,)f(Merge\(Up\(Accept\()o(c1)o(\)\),)c(c2\)\))527
3919 y(Mrg)43 b(:)g(Merge\(MatchFunA)o(\(f,)37 b(xs,)42
b(p,)h(c1\),)f(Accept\(c2\)\))d(->)745 4018 y(MatchFunA\(f,)g(xs,)j(p,)
h(Merge\(c1,)d(Accept\(c2\)\)\))527 4218 y(Mrg)j(:)g(Merge\(Accept\(c1)
o(\),)37 b(MatchFunA\(f,)i(xs,)j(p,)h(c2\)\))f(->)745
4317 y(MatchFunA\(f,)d(xs,)j(p,)h(Merge\(Accept\(c1\))o(,)37
b(c2\)\))527 4516 y(Mrg)43 b(:)g(Merge\(MatchVars)o(\(xs)o(,)37
b(p,)43 b(c1\),)f(Accept\(c2\)\))d(->)789 4616 y(MatchVars\(xs,)f(p,)43
b(Merge\(c1,)d(Accept\(c2\)\)\))527 4815 y(Mrg)j(:)g(Merge\(Accept\(c1)
o(\),)37 b(MatchVars\(xs,)h(p,)43 b(c2\)\))f(->)789 4915
y(MatchVars\(xs,)c(p,)43 b(Merge\(Accept\(c1)o(\),)37
b(c2\)\))527 5114 y(Mrg)43 b(:)g(Merge\(Accept\(c\))o(,)38
b(Case\(cs\)\))i(->)789 5214 y(Case\(<map\({c':)d(?c';)42
b(!Merge\(Accept\(c\),)37 b(c'\)}\)>)k(cs\))527 5413
y(Mrg)i(:)g(Merge\(Case\(cs\),)37 b(Accept\(c\)\))j(->)1831
5662 y Fl(88)p eop
%%Page: 89 92
89 91 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)789
531 y Fe(Case\(<map\({c':)37 b(?c';)42 b(!Merge\(Accept\(c\),)37
b(c'\)}\)>)k(cs\))440 780 y Fg(mer)n(ging)32 b(ma)-6
b(tching)32 b(opera)-6 b(tions)440 1029 y Fe(rules)527
1229 y(Mrg)43 b(:)g(Merge\(MatchVars)o(\(xs)o(,)37 b(p,)43
b(c1\),)f(MatchVars\(ys,)c(p,)43 b(c2\)\))f(->)745 1328
y(MatchVars\(<conc>)37 b(\(xs,)42 b(ys\),)g(p,)h(Merge\(c1,)d(c2\)\))
527 1528 y(Mrg)j(:)g(Merge\(MatchFunA)o(\(f,)37 b(xs,)42
b(p,)h(c1\),)f(MatchFunA\(f,)c(ys,)43 b(p,)g(c2\)\))f(->)745
1627 y(MatchFunA\(f,)d(<union>)h(\(xs,)i(ys\),)g(p,)h(Merge\(c1,)d
(c2\)\))527 1826 y(Mrg)j(:)g(Merge\(MatchFunA)o(\(f,)37
b(xs,)42 b(p,)h(c1\),)f(MatchFunA\(g,)c(ys,)43 b(p,)g(c2\)\))f(->)745
1926 y(Case\([MatchFunA\()o(f,)37 b(xs,)43 b(p,)f(c1\),)g
(MatchFunA\(g,)d(ys,)j(p,)h(c2\)]\))745 2026 y(where)f(<not\(eq\)>)d
(\(f,)k(g\))527 2225 y(Mrg)g(:)g(Merge\(MatchFunA)o(\(f,)37
b(ys,)42 b(p,)h(c1\),)f(MatchVars\(xs,)c(p,)43 b(c2\)\))f(->)745
2325 y(Case\([MatchFunA\()o(f,)37 b(<union>)k(\(xs,)h(ys\),)g(p,)h
(Merge\(c1,)c(c2\)\),)1007 2424 y(MatchVars\(xs,)f(p,)43
b(c2\)]\))527 2623 y(Mrg)g(:)g(Merge\(MatchVars)o(\(xs)o(,)37
b(p,)43 b(c1\),)f(MatchFunA\(f,)d(ys,)j(p,)h(c2\)\))f(->)745
2723 y(Case\([MatchFunA\()o(f,)37 b(<union>)k(\(xs,)h(ys\),)g(p,)h
(Merge\(c1,)c(c2\)\),)1007 2823 y(MatchVars\(xs,)f(p,)43
b(c1\)]\))527 3022 y(Mrg)g(:)g(Merge2\(MatchVar)o(s\(x)o(s,)37
b(p,)43 b(c1\),)f(MatchFunA\(f,)c(ys,)43 b(p,)f(c2\)\))g(->)789
3122 y(MatchFunA\(f,)c(<union>)j(\(xs,)h(ys\),)g(p,)h(Merge\(c1,)c
(c2\)\))527 3321 y(Mrg)k(:)g(Merge2\(MatchVar)o(s\(x)o(s,)37
b(p,)43 b(c1\),)f(MatchVars\(ys,)c(p,)43 b(c2\)\))f(->)789
3421 y(MatchVars\(<conc)o(>)c(\(xs,)k(ys\),)g(p,)g(Merge\(c1,)e(c2\)\))
440 3670 y Fg(mer)n(ging)32 b(with)g(case)440 3919 y
Fe(rules)527 4118 y(MrgInsert1)40 b(:)789 4218 y(Merge\(MatchFunA)o
(\(f,)d(xs,)42 b(p,)h(c1\),)f(Case\(cs\)\))e(->)i(Case\(cs'\))789
4317 y(where)f(<fetch\({ys,)e(c2:)k(?MatchFunA\(f,)38
b(ys,)k(p,)h(c2\);)1399 4417 y(!MatchFunA\(f,)38 b(<union>)j(\(xs,)h
(ys\),)g(p,)g(Merge\(c1,)e(c2\)\)}\)>)1050 4516 y(cs)j(=>)g(cs')527
4716 y(MrgInsert2)d(:)789 4815 y(Merge\(MatchFunA)o(\(f,)d(xs,)42
b(p,)h(c1\),)f(Case\(cs\)\))e(->)789 4915 y(Case\(Cons\(Match)o(Fun)o
(A\()o(f,)d(<union>)k(\(xs,)h(ys\),)g(p,)g(Merge\(c1,)e(c2\)\),)i
(cs\)\))789 5015 y(where)f(<fetch\(?MatchVars)o(\(y)o(s,)c(p,)43
b(c2\)\)>)e(cs)527 5214 y(MrgInsert3)f(:)789 5313 y(Merge\(MatchFunA)o
(\(f,)d(xs,)42 b(p,)h(c1\),)f(Case\(cs\)\))e(->)789 5413
y(Case\(Cons\(Match)o(Fun)o(A\()o(f,)d(xs,)43 b(p,)f(c1\),)g(cs\)\))
1831 5662 y Fl(89)p eop
%%Page: 90 93
90 92 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)527
631 y Fe(Mrg)43 b(:)789 731 y(Merge\(MatchVars)o(\(xs)o(,)37
b(p,)43 b(c1\),)f(Case\(cs\)\))e(->)j(Case\(cs'\))789
830 y(where)832 930 y(<map\({c2:?c2;)38 b(!Merge2\(MatchVars)o(\(xs)o
(,)f(p,)43 b(c1\),)f(c2\)}\)>)f(cs)i(=>)g(cs'';)832 1029
y(\(\(<fetch\(MatchVar)o(s\()o(id,)o(id)o(,id)o(\)\))o(>)37
b(cs;)43 b(!cs''\))919 1129 y(<+)g(!Cons\(MatchVars\(x)o(s,)37
b(p,)43 b(c1\),)f(cs''\)\))f(=>)h(cs')440 1381 y(rules)527
1581 y(mk-merge)e(:)k(\(a,)e(b\))h(->)f(Merge\(a,)f(b\))527
1780 y(C2L)i(:)g(Choice\(s1,)c(s2\))j(->)h(<conc>)e(\(s1,)h(s2\))440
1880 y(strategies)527 2079 y(merge)g(=)h(mk-merge;)876
2178 y(topdown\(repeat\(M)o(rg)37 b(<+)43 b(\(MrgInsert1)c(<+)k
(MrgInsert2)c(<+)k(MrgInsert3\)\)\))527 2378 y(merge-automata)38
b(=)832 2477 y(foldr\(!Accept\(Fai)o(l\))o(,)g(merge\))527
2677 y(choices-to-list)g(=)43 b(choicemap\({x:)38 b(?x;)k(![x]}\);)1312
2776 y(choicebu\(C2L\))527 2976 y(mk-automaton)d(=)789
3075 y(choices-to-list)o(;)789 3175 y(mk-automata;)789
3274 y(merge-automata)1831 5662 y Fl(90)p eop
%%Page: 91 94
91 93 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)440
531 y Fh(MA)-8 b(TCHING-TREE)440 769 y Fe(module)41 b(matching-tree)440
869 y(imports)g(strategy)f(stratlib)g(optimization)f(instructions)f
(fixpoint-traversa)o(l)789 969 y(automaton)i(lib)440
1068 y(signature)527 1168 y(constructors)614 1267 y(Case)i(:)h
(List\(Strat\))c(*)44 b(Strat)d(->)i(Strat)614 1367 y(PreCase)e(:)i
(Strat)f(*)h(Strat)e(->)i(Strat)614 1467 y(Double)e(:)j(a)f(*)g(a)g(->)
g(a)440 1686 y Fl(Join)35 b(branc)n(hes)g(of)h(a)g(c)n(hoice)f(that)h
(start)g(with)g(a)g(v)-5 b(ariable)35 b(matc)n(h.)61
b(Mak)n(e)35 b(the)i(single)440 1786 y(joined)28 b(branc)n(h)e
(starting)h(with)h(a)f(v)-5 b(ariable)27 b(matc)n(h)g(the)h(\014rst)g
(branc)n(h)e(in)i(the)g(c)n(hoice.)440 2005 y Fe(strategies)527
2205 y(MatchVarPrefix'\(s)o(\))37 b(=)789 2304 y(rec)42
b(x\(Seq\(Match\(Var\()o(id\))o(\),)37 b(x\))43 b(<+)f(\(Ass)g(+)i
(I\);)e(x)h(<+)1050 2404 y({s':)f(?s';)g(!Choice\(s',)d(<s>\(\)\)}\))
527 2603 y(MatchVarPrefix\(s\))e(=)789 2703 y(rec)42
b(x\(Seq\(Match\(Var\()o(id\))o(\),)37 b(x\))43 b(<+)f(\(Ass)g(+)i
(I\);)e(x)h(<+)1050 2802 y({s':)f(?s';)g(s;)h(MatchVarPrefix'\()o(!s)o
('\)})o(\))527 3002 y(ChoiceMerge')c(=)k(ChoiceMerge1)c(+)k
(ChoiceMerge2)38 b(+)44 b(ChoiceMerge3)484 3201 y(\(*)e(Note:)g(better)
f(if)i(this)f(can)g(be)h(+)g(*\))440 3400 y(rules)527
3599 y(ChoiceMerge1)c(:)789 3699 y(Choice\(Seq\(Matc)o(h\(V)o(ar)o
(\(x\))o(\),)e(s1\),)42 b(cs\))g(->)789 3799 y(Choice\(Seq\(Matc)o
(h\(V)o(ar)o(\(x\))o(\),)37 b(Seq\(Match\(Var\(y\))o(\),)g(s1'\)\),)k
(cs'\))789 3898 y(where)g(<conChoice\(?Seq\(M)o(at)o(ch\()o(Va)o(r\()o
(y\)\))o(,)c(s2\);)42 b(!Fail\)>)f(cs)i(=>)g(cs';)1050
3998 y(<MatchVarPrefix\(!)o(s2)o(\)>)37 b(s1)43 b(=>)g(s1')527
4197 y(ChoiceMerge2)c(:)789 4297 y(Choice\(Seq\(Matc)o(h\(V)o(ar)o
(\(x\))o(\),)e(s1\),)42 b(cs\))g(->)789 4396 y(Choice\(Seq\(Matc)o
(h\(V)o(ar)o(\(x\))o(\),)37 b(s1'\),)k(cs'\))789 4496
y(where)g(<conChoice\(?Seq\(M)o(at)o(ch\()o(Wl)o(d\))o(,)d(s2\);)k
(!Fail\)>)e(cs)j(=>)g(cs';)1050 4596 y(<MatchVarPrefix\(!)o(s2)o(\)>)37
b(s1)43 b(=>)g(s1')527 4795 y(ChoiceMerge3)c(:)789 4895
y(Choice\(Seq\(Matc)o(h\(t)o(\),)e(s2\),)42 b(cs\))g(->)789
4994 y(Choice\(Seq\(Matc)o(h\(V)o(ar)o(\(x\))o(\),)37
b(s1\),)42 b(cs'\))789 5094 y(where)f(not\(!t)g(=>)i(Var\(_\)\);)1050
5193 y(<conChoice\(?Seq\(M)o(at)o(ch\()o(Va)o(r\()o(x\)\))o(,)37
b(s1\);)42 b(!Seq\(Match\(t\),)c(s2\)\)>)k(cs)g(=>)h(cs')440
5413 y Fg(precase)32 b(intr)n(oduction)1831 5662 y Fl(91)p
eop
%%Page: 92 95
92 94 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)440
531 y(Assuming)d(that)g(the)g(branc)n(hes)e(of)i(the)g(c)n(hoice)f(ha)n
(v)n(e)f(b)r(een)i(merged)f(as)g(describ)r(ed)h(ab)r(o)n(v)n(e,)440
631 y(the)d(c)n(hoice)f(is)h(turned)g(in)n(to)g(a)f(precase.)34
b(The)21 b(\014rst)f(branc)n(h)g(of)h(the)h(precase)d(deals)i(with)g
(the)440 731 y(cases)k(where)g(the)h(\014rst)f(matc)n(h)g(is)h(to)f(a)h
(non-v)-5 b(ariable)24 b(term.)36 b(If)26 b(the)g(outermost)f(function)
440 830 y(sym)n(b)r(ol)30 b(of)h(the)g(sub)5 b(ject)31
b(term)g(matc)n(hes)f(an)n(y)g(of)h(the)g(outermost)f(function)h(sym)n
(b)r(ols)f(of)440 930 y(the)k(branc)n(hes,)h(one)f(of)g(these)g(branc)n
(hes)f(will)h(b)r(e)g(tak)n(en.)56 b(The)34 b(second)g(branc)n(h)f(of)h
(the)440 1029 y(precase)24 b(deals)h(with)h(those)g(sub)5
b(ject)25 b(terms)g(that)h(ha)n(v)n(e)f(an)g(outermost)g(function)h
(sym)n(b)r(ol)440 1129 y(that)i(matc)n(hes)f(non)g(of)h(the)g
(patterns.)440 1372 y Fe(rules)527 1571 y(AddVarPart\(bld_s\))37
b(:)789 1670 y(Seq\(Match\(t\),)h(s\))43 b(->)f(Seq\(Match\(t\),)d
(Choice\(s,)g(<bld_s>)i(\(\)\)\))527 1870 y(AddVarPart'\(bld_s)o(\))c
(:)789 1969 y(x)43 b(->)g(\(x,)f(<bld_s>)f(\(\)\))527
2169 y(SepVars)g(:)789 2268 y(Choice\(Seq\(Matc)o(h\(V)o(ar)o(\(x\))o
(\),)c(s\),)42 b(cs\))h(->)789 2368 y(Seq\(Match\(Var\(x)o(\)\),)37
b(Seq\(s1,)k(PreCase\(cs',)d(s2\)\)\))789 2467 y(where)j(<rec)h
(x\(Seq\(Match\(Var\(i)o(d\))o(\),)37 b(x\))43 b(<+)g(\(Ass)e(+)j(I\);)
e(x)1355 2567 y(<+)h(<<s2)f(->)h(Id>>\)>)e(s)i(=>)g(s1;)1050
2667 y(<rec)f(x\(AddVarPart\(!s2\))37 b(<+)1355 2766
y(Choice\(x,)j(x\))j(<+)1355 2866 y(AddVarPart'\(!s2\)\))o(>)37
b(cs)43 b(=>)g(cs')527 3065 y(SepVars)e(:)789 3165 y
(Seq\(Match\(Var\(x)o(\)\),)c(s\))43 b(->)f(Seq\(Match\(Var\(x\)\))o(,)
37 b(s\))527 3364 y(SepVars')j(:)k(cs)e(->)h(PreCase\(cs,)c(Fail\))527
3563 y(PreCaseSimp)g(:)k(PreCase\(PreCase\(c)o(s,)37
b(s\),)42 b(s'\))h(->)g(PreCase\(cs,)c(LChoice\(s,)g(s'\)\))527
3763 y(PreCaseSimp)g(:)k(PreCase\(Seq\(s1,)38 b(s2\),)k(Fail\))f(->)i
(Seq\(s1,)e(s2\))527 3962 y(\(*)i(PreCaseSimp)c(:)k(PreCase\(Id,)c(s\))
k(->)g(Fail)f(*\))527 4161 y(Duplicate\(s\))d(:)k(x)g(->)g(Double\(x,)d
(<s>)i(x\))440 4503 y Fg(definining)32 b(opera)-6 b(tor)32
b(ma)-6 b(tching)440 4672 y Fl(Breaking)23 b(up)j(a)e(matc)n(h)h(of)g
(an)g(application)f(in)n(to)h(a)f(matc)n(h)h(of)g(the)g(function)h(sym)
n(b)r(ol)f(and)440 4772 y(the)j(argumen)n(t)f(terms.)36
b(Stac)n(k)27 b(op)r(erations)f(are)h(used)h(to)f(tra)n(v)n(erse)e(the)
j(sub)5 b(ject)28 b(term.)440 5015 y Fe(rules)527 5214
y(MatchOp)41 b(:)789 5313 y(Match\(Op\(f,)e(ts\)\))j(->)789
5413 y(Seq\(MatchFun\(f,)37 b(<length>)j(ts\),)i(<rec)g
(x\(MatchOpAux\(x\)\)>)37 b(\(ts,)42 b(0\)\))1831 5662
y Fl(92)p eop
%%Page: 93 96
93 95 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)527
631 y Fe(MatchOp)41 b(:)789 731 y(AnnMatch\(t1,)d(t2\))43
b(->)789 830 y(Seq\(Tpush,)c(Seq\(Build\(t1\),)f(Seq\(GetAnn,)h
(Seq\(Match\(t2\),)f(Tpop\)\)\)\))527 1029 y(MatchOpAux\(x\))g(:)789
1129 y(\(Nil,)j(n\))i(->)g(Id)527 1229 y(MatchOpAux\(x\))38
b(:)789 1328 y(\(Cons\(t,)i(ts\),)i(n\))h(->)789 1428
y(Seq\(Arg\(n\),)c(Seq\(Match\(t\),)f(Seq\(Tpop,)i(<x>)i(\(ts,)g
(<plus>)f(\(n,)i(1\)\)\)\)\))440 1680 y Fg(precase)32
b(to)g(case)440 1850 y Fl(A)26 b(precase)f(has)g(a)g(c)n(hoice)g(as)g
(\014rst)h(branc)n(h.)35 b(This)26 b(is)g(con)n(v)n(erted)e(to)h(a)h
(list)g(of)g(branc)n(hes)e(in)440 1949 y(a)f(Case.)34
b(A)23 b(Case)f(strategy)g(c)n(ho)r(oses)f(one)i(of)g(the)g(branc)n
(hes)f(in)h(the)g(\014rst)g(argumen)n(t)f(based)440 2049
y(on)33 b(the)g(\014rst)f(action)h(in)g(those)f(branc)n(hes.)51
b(This)33 b(\014rst)g(c)n(hoice)f(is)h(binding,)h(i.e.,)g(after)f(a)440
2149 y(branc)n(h)27 b(is)g(c)n(hosen,)g(no)g(bac)n(ktrac)n(king)e(to)j
(other)f(branc)n(hes)f(is)i(done.)440 2401 y Fe(rules)527
2600 y(MkCaseA)41 b(:)i(x)g(->)g([x])963 2700 y(\(*)g(where)e(!x;)i
(Seq\(MatchFun\(id)o(\))38 b(+)43 b(Match\(Int\(id\))38
b(+)43 b(Str\(id\)\),)d(id\))i(*\))527 2899 y(MkCaseB\(x\))e(:)j
(Choice\(s1,)c(s2\))k(->)f(<conc>)f(\(<x>)h(s1,)h(<x>)f(s2\))527
3098 y(MkCase)f(:)i(PreCase\(s1,)c(s2\))k(->)g(Case\(cases,)c(s2\))919
3198 y(where)j(<rec)g(x\(MkCaseB\(x\))d(<+)j(MkCaseA\)>)e(s1)j(=>)g
(cases)440 3450 y Fg(one)31 b(level)440 3703 y Fe(strategies)527
3902 y(is-case)41 b(=)i(Choice\(rec)c(x\(Seq\(Match\(id\),)e(id\))43
b(+)g(Choice\(x,)d(x\)\),)1268 4002 y(rec)i(x\(Seq\(Match\(id\),)37
b(id\))43 b(+)g(Choice\(x,)d(x\)\)\))527 4201 y(match-tree1)f(=)789
4301 y(is-case;)789 4400 y(repeat\(ChoiceMe)o(rge)o('\))o(;)789
4500 y(\(*)j(topdown\(repeat\(Ch)o(oic)o(eM)o(erg)o(e')37
b(+)43 b(F\)\);)f(*\))789 4599 y(\(*)g(downup\(repeat\(Cho)o(ice)o(Me)o
(rge)o(')37 b(+)43 b(F)h(+)f(Ass)f(+)h(I\)\);)f(*\))789
4699 y(\(*)g(try)h(choicetd)d(or)j(other)e(choice)g(specific)g
(traversal)f(*\))789 4799 y(\(*)i(choicebu-l\(repeat)o(\(Ch)o(oi)o(ceM)
o(er)o(ge)o(')c(+)43 b(F\)\);)f(*\))789 4898 y(\(*)g
(downup\(repeat\(Cho)o(ice)o(Me)o(rge)o(';)37 b(pseudo-innermost)o(3\()
o(sim)o(pl)o(ify)o(\)\))o(\);)g(*\))789 4998 y(pseudo-innermos)o(t3\()o
(si)o(mpl)o(if)o(y\);)789 5098 y(\(SepVars)j(<+)j(Choice\(id,)c(id\);)j
(SepVars'\);)789 5197 y(rec)g(z\(try\(Seq\(id,)c(z\))43
b(<+)g(PreCase\(z,)c(id\))k(<+)f(Id)h(<+)g(Fail)f(<+)1050
5297 y(choicemap\(Seq\(Mat)o(ch)o(Op)37 b(+)1660 5396
y(Match\(Wld)j(+)j(Var\(id\))e(+)i(Int\(id\))e(+)1831
5662 y Fl(93)p eop
%%Page: 94 97
94 96 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)1922
531 y Fe(Real\(id\))40 b(+)j(Str\(id\)\),)d(id\)\)\)\))527
731 y(match-tree')f(=)789 830 y(repeat\(oncetd\(m)o(atc)o(h-)o(tre)o
(e1)o(\);)1094 930 y(innermost'\(simpl)o(if)o(y)f(+)43
b(PreCaseSimp\)\);)789 1029 y(topdown\(try\(MkC)o(ase)o(\)\))527
1229 y(match-tree')c(=)789 1328 y(topdown\(try\(mat)o(ch-)o(tr)o(ee1)o
(;)1312 1428 y(innermost'\(simpl)o(if)o(y)e(+)44 b(PreCaseSimp\)\)\);)
789 1528 y(topdown\(try\(MkC)o(ase)o(\)\))527 1727 y(match-tree')39
b(=)789 1826 y(topdown\(try\(mat)o(ch-)o(tr)o(ee1)o(;)1312
1926 y(pseudo-innermost)o(3\()o(si)o(mpl)o(if)o(y)f(+)43
b(PreCaseSimp\)\)\);)789 2026 y(topdown\(try\(MkC)o(ase)o(\)\))527
2225 y(match-tree')c(=)789 2325 y(alltd\(match-tre)o(e1\))527
2524 y(match-tree)h(=)j(mk-automaton)440 2773 y Fg(all)31
b(levels)440 3022 y Fe(rules)527 3221 y(LiftScope)40
b(:)j(Choice\(Scope\(xs,)37 b(s1\),)42 b(Scope\(ys,)e(s2\)\))i(->)1050
3321 y(Scope\(<conc>)d(\(xs,)j(ys\),)g(Choice\(s1,)d(s2\)\))527
3520 y(IntroContinuation)e(:)789 3620 y(Seq\(Match\(t\),)h(s\))43
b(->)789 3719 y(Let\(SDef\(x,)c([],)j(s\),)g(Pat\(t,)g
(Call\(SVar\(x\),)c([]\)\)\))789 3819 y(where)j(new)i(=>)f(x)527
4018 y(LiftLet)f(:)i(Choice\(Let\(sdef,)37 b(s\),)42
b(s'\))h(->)f(Let\(sdef,)e(Choice\(s,)g(s'\)\))527 4118
y(LiftLet)h(:)i(Choice\(s',)c(Let\(sdef,)h(s\)\))j(->)f(Let\(sdef,)e
(Choice\(s',)g(s\)\))789 4317 y(\(*)i(assuming)f(sdef)h(does)g(not)g
(affect)f(s')i(*\))527 4516 y(JoinVars)d(:)789 4616 y(Scope\(xs,)g
(s[Seq\(Match\(Var)o(\(x\))o(\),)d(Seq\(Match\(Var\(y\))o(\),)g
(s'\)\)]\))k(->)789 4716 y(Scope\(<diff>)d(\(xs,)k([y]\),)1050
4815 y(<tsubs>)f(\([y],)g([Var\(x\)],)f(s[Seq\(Match\(Var\(x)o(\)\))o
(,)e(s'\)]\)\))440 5015 y(rules)527 5214 y(MakeLinear')h(:)789
5313 y(Scope\(xs,)h(Seq\(Match\(t[Con)o(s\(t)o('[)o(Va)o(r\(x)o(\)])o
(,ts)o('[)o(Va)o(r\(x)o(\)])o(\)],)d(s\)\)\))42 b(->)789
5413 y(Scope\(Cons\(y,)c(xs\),)1831 5662 y Fl(94)p eop
%%Page: 95 98
95 97 bop 440 199 a Fl(Chapter:)36 b(Matc)n(hing)27 b(Automata)1050
531 y Fe(Seq\(Match\(t[Cons\()o(t')o(,ts)o('[)o(Va)o(r\(y)o(\)])o
(\)]\))o(,)1050 631 y(Seq\(Build\(Var\(y\)\))o(,)37 b
(Seq\(Match\(Var\(x\)\))o(,)g(s\)\)\)\))789 731 y(where)k(new)i(=>)f(y)
527 930 y(MakeLinear)e(:)614 1029 y(Scope\(xs,)g(Seq\(Match\(t\),)e
(s\)\))43 b(->)614 1129 y(Scope\(<conc>)c(\(xs,)j(ys\),)g
(Seq\(Match\(t'\),)c(Seq\(ts,)i(s\)\)\))614 1229 y(where)i(<rec)g
(x\(\(V1)f(+)i(V2\))g(<+)g(thread\(x\)\)>)c(Pair\(t,)h(\([],)i([],)h
(Id\)\))2140 1328 y(=>)g(Pair\(t',)d(\(xs,)i(ys,)g(ts\)\))527
1528 y(V1)h(:)g(Pair\(Var\(x\),)c(\(xs,)j(ys,)g(ts\)\))g(->)745
1627 y(Pair\(Var\(x\),)d(\(Cons\(x,)h(xs\),)i(ys,)g(ts\)\))745
1727 y(where)g(<not\(in\)>)d(\(x,)k(xs\))527 1926 y(V2)g(:)g
(Pair\(Var\(x\),)c(\(xs,)j(ys,)g(ts\)\))g(->)745 2026
y(Pair\(Var\(x\),)d(\(xs,)j(Cons\(y,)e(ys\),)1355 2125
y(Seq\(Build\(Var\(x\)\))o(,)d(Seq\(Match\(Var\(y\)\))o(,)h(ts\)\)\)\))
745 2225 y(where)k(<in>)g(\(x,)g(xs\);)g(new)g(=>)h(y)527
2424 y(mk-aut)e(:)i(Match\(t\))e(->)h(<pat-to-aut>)d(Pat\(t,)i(Id\))440
2677 y(strategies)527 2876 y(is-scoped-case)d(=)789 2976
y(Choice\(rec)h(x\(Scope\(id,)g(Seq\(Match\(id\),)f(id\)\))k(+)h
(Choice\(x,)d(x\)\),)1094 3075 y(rec)i(x\(Scope\(id,)d
(Seq\(Match\(id\),)f(id\)\))k(+)h(Choice\(x,)d(x\)\)\))527
3274 y(lift-scopes)f(=)789 3374 y(choicebu\(LiftSc)o(ope)o(\))527
3573 y(lift-continuation)o(s)e(=)789 3673 y(choicemap\(Intro)o(Con)o
(ti)o(nua)o(ti)o(on\))o(;)789 3773 y(rec)42 b(x\(bottomup\(try\(L)o
(ift)o(Le)o(t;)37 b(all\(x\)\)\)\))527 3972 y(make-linear)i(=)789
4071 y(choicemap\(MakeL)o(ine)o(ar)o(\))527 4271 y(mk-match-tree')f(=)
789 4370 y(is-scoped-case;)789 4470 y(make-linear;)789
4570 y(lift-scopes;)789 4669 y(Scope\(id,)i(lift-continuati)o(ons)o(;)
1225 4769 y(rec)i(x\(Let\(id,)e(x\))j(<+)f(match-tree\)\);)789
4868 y(repeat\(JoinVars)o(\);)789 4968 y(id)527 5167
y(mk-match-tree)c(=)789 5267 y(is-scoped-case;)789 5367
y(make-linear;)1831 5662 y Fl(95)p eop
%%Page: 96 99
96 98 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)789 531 y Fe(lift-scopes;)789
631 y(Scope\(id,)40 b(lift-continuati)o(ons)o(;)1225
731 y(rec)i(x\(Let\(id,)e(x\))j(<+)f(match-tree\)\))527
930 y(main')g(=)h(topdown\(try\(mk-m)o(at)o(ch-)o(tr)o(ee)37
b(<+)43 b(MatchOp\)\))527 1129 y(main)f(=)h(iowrap\(topdown\(tr)o(y\()o
(mk-)o(ma)o(tch)o(-t)o(re)o(e)38 b(<+)k(mk-aut\)\)\))527
1328 y(main')g(=)789 1428 y(is-case;)789 1528 y(repeat\(ChoiceMe)o(rge)
o('\))1831 5662 y Fl(96)p eop
%%Page: 97 100
97 99 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)440 531 y(In)g(this)g
(section)f(w)n(e)h(de\014ne)g(the)g(abstract)e(mac)n(hine)i
(instructions)f(and)h(a)f(simpli\014er)h(and)440 631
y(p)r(eephole)h(optimizer)f(for)g(abstract)f(mac)n(hine)i(programs.)
1831 5662 y(97)p eop
%%Page: 98 101
98 100 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)440 531 y Fh(INSTR)m(UCTION)
33 b(SIMPLIFICA)-8 b(TION)440 807 y Fe(module)41 b(ins-simplificati)o
(on)440 907 y(imports)g(instructions)d(list)440 1158
y Fg(block)31 b(fla)-6 b(ttening)440 1327 y Fl(The)35
b(follo)n(wing)f(rules)g(sp)r(ecify)h(the)h(\015attening)e(of)h(nested)
g(blo)r(c)n(ks)f(in)n(to)h(a)g(single)f(blo)r(c)n(k)440
1427 y(with)c(a)e(list)i(of)f(instructions.)41 b(This)29
b(transformation)f(enables)g(p)r(eephole)i(optimization,)440
1527 y(whic)n(h)e(optimizes)f(adjacen)n(t)g(instructions.)440
1696 y(The)h(strategy)e Fe(flatten-blocks)c Fl(is)27
b(designed)g(to)h(minimize)g(stac)n(k-depth.)440 1947
y Fe(rules)527 2147 y(BlkFlat')40 b(:)k(Block\(is\))39
b(->)k(Block\(is'\))963 2246 y(where)f(<rec)f(x\(Nil)h(+)h(Cons\(id,)d
(x\))j(;)g(try\(BlkFlatAux\)\)>)37 b(is)43 b(=>)f(is')527
2445 y(BlkFlatAux)e(:)j(Cons\(Block\(is1\),)37 b(is2\))42
b(->)g(<conc>)g(\(is1,)f(is2\))527 2645 y(BlkFlat1)f(:)k
(Cons\(Block\([]\),)37 b(is\))42 b(->)h(is)527 2744 y(BlkFlat2)d(:)k
(Cons\(Block\(Cons)o(\(i,)37 b(is\)\),)k(is'\))h(->)1007
2844 y(Cons\(i,)e(Cons\(Block\(is\),)e(is'\)\))440 3043
y(strategies)527 3242 y(flatten-blocks)g(=)789 3342 y(rec)k
(x\(try\(Nil)e(+)j(Block\(x\))d(+)1225 3442 y(Cons\(id,)g(x\);)1225
3541 y(rec)i(y\(try\(BlkFlat1)c(+)43 b(BlkFlat2;)d(Cons\(id,)g(y\);)i
(y\)\)\)\))440 3793 y Fg(peephole)32 b(optimiza)-6 b(tion)440
3962 y Fl(Some)32 b(sequences)g(of)g(adjacen)n(t)g(instructions)g(can)g
(b)r(e)g(reduced)g(to)g(an)g(equiv)-5 b(alen)n(t,)34
b(but)440 4062 y(shorter)26 b(\(co)r(de)i(size)f(reduction\))h(or)e
(more)h(e\016cien)n(t)h(sequence)f(of)h(instructions.)440
4313 y Fe(rules)527 4412 y(PH)43 b(:)g(Cons\(MatchVar\(n\))o(,)38
b(Cons\(BuildVar\(n)o(\),)f(is\)\))42 b(->)745 4512 y
(Cons\(MatchVar\(n\))o(,)c(is\))527 4711 y(PH)43 b(:)g
(Cons\(MatchFun\(f,)37 b(n\),)42 b(Cons\(TravInit,)c(Cons\(AllBuild,)g
(is\)\)\))k(->)745 4811 y(Cons\(MatchFun\(f,)37 b(n\),)42
b(is\))440 5062 y Fl(En)n(vironmen)n(t)26 b(stac)n(k)h(op)r(erations)
527 5313 y Fe(PH)43 b(:)g(Cons\(Epush\(0\),)38 b(is\))k(->)h(is)1831
5662 y Fl(98)p eop
%%Page: 99 102
99 101 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)527 531 y Fe(PH)43
b(:)g(Cons\(Epop\(0\),)38 b(is\))43 b(->)f(is)527 731
y(PH)h(:)g(Cons\(Epush\(n\),)38 b(Cons\(Epush\(m\),)g(is\)\))k(->)745
830 y(Cons\(Epush\(<plus)o(>)c(\(n,)k(m\)\),)g(is\))527
1029 y(PH)h(:)g(Cons\(Epop\(n\),)38 b(Cons\(Epop\(m\),)h(is\)\))i(->)
745 1129 y(Cons\(Epop\(<plus>)c(\(n,)42 b(m\)\),)g(is\))440
1369 y Fl(T)-7 b(erm)27 b(stac)n(k)g(op)r(erations)527
1610 y Fe(PH)43 b(:)g(Cons\(Arg\(n\),)c(Cons\(Tpop,)g(is\)\))j(->)h(is)
440 1850 y Fl(Redundan)n(t)28 b(jumps)527 2190 y Fe(PH)43
b(:)g(Cons\(Goto\(l\),)38 b(Cons\(Label\(l\),)g(is\)\))k(->)745
2290 y(Cons\(Label\(l\),)c(is\))527 2489 y(PH')43 b(:)g
(Cons\(Goto\(l\),)38 b(is[Cons\(Label\(l\))o(,)f(Cons\(Goto\(l'\),)h
(is'\)\)]\))j(->)789 2589 y(Cons\(Goto\(l'\),)c(is\))440
2829 y Fg(mer)n(ging)32 b(labels)440 2998 y Fl(Tw)n(o)20
b(adjacen)n(t)g(lab)r(el)h(de\014nitions)g(can)f(b)r(e)h(merged)f(in)n
(to)g(a)h(single)f(lab)r(el)h(de\014nitions.)34 b(This)440
3098 y(requires)f(substituting)h(the)g(lab)r(el)g(that)h(is)f(left)g
(for)g(the)g(lab)r(el)g(that)g(is)g(remo)n(v)n(ed)e(in)j(all)440
3198 y(jumps)28 b(to)g(that)g(lab)r(el.)440 3438 y Fe(rules)527
3637 y(DblLbls)41 b(:)i(Cons\(Label\(l1\),)37 b(Cons\(Label\(l2\),)h
(is\)\))k(->)963 3737 y(Cons\(LabelSubsU\()o(l2,)37 b(l1\),)963
3836 y(Cons\(Label\(l1\),)963 3936 y(Cons\(LabelSubsD\()o(l2,)g(l1\),)
42 b(is\)\)\))440 4176 y Fl(Applying)28 b(up)n(w)n(ard)e(substitutions)
527 4417 y Fe(SbsU)42 b(:)130 b(Cons\(LabelSubsU\(l)o(2,)37
b(l1\),)42 b(Cons\(Label\(l2\),)37 b(is\)\))42 b(->)919
4516 y(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42 b(Cons\(Label\(l1\),)37
b(is\)\))527 4716 y(SbsU)42 b(:)130 b(Cons\(LabelSubsU\(l)o(2,)37
b(l1\),)42 b(Cons\(Goto\(l2\),)c(is\)\))k(->)919 4815
y(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42 b(Cons\(Goto\(l1\),)c(is\)\))
527 5015 y(SbsU)k(:)130 b(Cons\(LabelSubsU\(l)o(2,)37
b(l1\),)42 b(Cons\(Cpush\(l2\),)37 b(is\)\))42 b(->)919
5114 y(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42 b(Cons\(Cpush\(l1\),)37
b(is\)\))527 5313 y(SbsU)42 b(:)130 b(Cons\(LabelSubsU\(l)o(2,)37
b(l1\),)42 b(Cons\(Rpush\(l2\),)37 b(is\)\))42 b(->)919
5413 y(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42 b(Cons\(Rpush\(l1\),)37
b(is\)\))1831 5662 y Fl(99)p eop
%%Page: 100 103
100 102 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)440 531 y(Applying)h(do)n(wn)
n(w)n(ard)d(substitutions)527 778 y Fe(SbsD)42 b(:)130
b(Cons\(LabelSubsD\(l)o(2,)37 b(l1\),)42 b(Cons\(Label\(l2\),)37
b(is\)\))42 b(->)919 877 y(Cons\(Label\(l1\),)c(Cons\(LabelSubsD\()o
(l2)o(,)g(l1\),)j(is\)\))527 1076 y(SbsD)h(:)130 b(Cons\(LabelSubsD\(l)
o(2,)37 b(l1\),)42 b(Cons\(Goto\(l2\),)c(is\)\))k(->)919
1176 y(Cons\(Goto\(l1\),)c(Cons\(LabelSubsD\(l)o(2,)f(l1\),)42
b(is\)\))527 1375 y(SbsD)g(:)130 b(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Cons\(Cpush\(l2\),)37 b(is\)\))42 b(->)919
1475 y(Cons\(Cpush\(l1\),)c(Cons\(LabelSubsD\()o(l2)o(,)g(l1\),)j
(is\)\))527 1674 y(SbsD)h(:)130 b(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Cons\(Rpush\(l2\),)37 b(is\)\))42 b(->)919
1774 y(Cons\(Rpush\(l1\),)c(Cons\(LabelSubsD\()o(l2)o(,)g(l1\),)j
(is\)\))440 2020 y Fl(Propagating)25 b(substitutions)j(up)g(and)f(do)n
(wn)g(the)h(list.)527 2266 y Fe(Up)43 b(:)217 b(Cons\(i,)41
b(Cons\(LabelSubsU\(l)o(1,)c(l2\),)42 b(is\)\))g(->)919
2366 y(Cons\(LabelSubsU\(l)o(1,)37 b(l2\),)42 b(Cons\(i,)f(is\)\))919
2466 y(where)h(not)g(\(<id>)g(i)h(=>)g(LabelSubsU\(_,_\)\))527
2665 y(Down)f(:)130 b(Cons\(LabelSubsD\(l)o(2,)37 b(l1\),)42
b(Cons\(i,)f(is\)\))h(->)919 2764 y(Cons\(i,)f(Cons\(LabelSubsD\(l)o
(1,)c(l2\),)42 b(is\)\))919 2864 y(where)g(not)g(\(<id>)g(i)h(=>)g
(LabelSubsD\(_,_\)\))440 3110 y Fl(Remo)n(ving)27 b(substitutions)h(at)
f(top)h(and)f(b)r(ottom)h(of)f(the)h(list.)527 3356 y
Fe(UnSbsU)41 b(:)i(Cons\(LabelSubsU\(l)o(2,)37 b(l1\),)42
b(is\))g(->)h(is)527 3556 y(UnSbsD)e(:)i(Cons\(LabelSubsD\(l)o(2,)37
b(l1\),)42 b(Nil\))g(->)h(Nil)440 3802 y Fg(the)32 b(stra)-6
b(tegy)440 3971 y Fl(The)28 b(p)r(eephole)f(optimization)h(strategy)-7
b(.)440 4218 y Fe(strategies)527 4417 y(ph)43 b(=)g(rec)f(y\(try\(PH;)e
(y)j(+)h(SbsU)e(+)h(\(Up;)f(\(SbsU)f(<+)i(Cons\(id,)d(y\)\)\)\)\))527
4616 y(phdown)h(=)i(repeat\(PH)d(+)j(DblLbls)e(+)i(\(SbsD)f(<+)h
(\(UnSbsD)d(+)j(Down\)\)\))527 4716 y(phup)129 b(=)43
b(repeat\(PH)d(+)j(\(SbsU)f(<+)h(rec)f(x\(Up;)g(Cons\(id,)e
(try\(x\)\)\)\)\))527 4915 y(peephole')g(=)j(Block\(listbu\(ph\);)1268
5015 y(repeat\(UnSbsU\);)1268 5114 y(listtd\(try\(SbsD)38
b(<+)k(\(UnSbsD)f(<+)i(Down\)\)\)\))527 5313 y(peephole')d(=)j
(Block\(listdu2\(phd)o(ow)o(n,)37 b(phup\);)1268 5413
y(repeat\(UnSbsU\)\))1810 5662 y Fl(100)p eop
%%Page: 101 104
101 103 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
299 y(Section:)h(Abstract)27 b(Mac)n(hine)527 631 y Fe(peephole)40
b(=)k(try\(Block\(listd)o(u\(r)o(ep)o(eat)o(\(P)o(H\))o(\)\)\))1810
5662 y Fl(101)p eop
%%Page: 102 105
102 104 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(In)h(this)f(section)g(w)n(e)g
(de\014ne)h(the)f(translation)f(from)h(strategies)f(to)h(abstract)g
(mac)n(hine)440 631 y(instructions.)440 800 y(\(***)27
b(Consider)f(transformation)g(to)i(an)f(A-Normal-form)f(lik)n(e)h
(format.)36 b(***\))1810 5662 y(102)p eop
%%Page: 103 106
103 105 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y Fh(BA)m(CKEND)440
809 y Fe(module)k(backend)440 908 y(imports)g(compiler)f(specialized)f
(ins-simplificati)o(on)e(io)440 1008 y(strategies)527
1207 y(main)42 b(=)h(iowrap\(compile\))440 1460 y Fl(Assem)n(bling)22
b(the)g(compiler.)34 b(T)-7 b(ranslate)21 b(Instr)h(applications)f(un)n
(til)i(done)f(and)g(\015atten)g(the)440 1559 y(blo)r(c)n(ks)27
b(at)g(the)h(same)f(time.)440 1812 y Fe(strategies)527
2011 y(\(*)43 b(compile)e(:)i(Strategy)d(->)j(Instr)e(*\))527
2210 y(compile)g(=)i(map\(MkInstr;)1137 2310 y(topdown\(repeat\(Cs)o
(pec)o(ia)o(l)37 b(<+)43 b(C\)\)\);)963 2409 y(flatten-blocks;)963
2509 y(peephole;)963 2609 y(Assemble)440 2861 y Fl(Mak)n(e)27
b(a)g(strategy)f(in)n(to)i(an)f(instruction)440 3113
y Fe(rules)527 3313 y(MkInstr)41 b(:)i(s)g(->)g(Instr\(s,)d([],)j(0\))
527 3512 y(Assemble)d(:)k(is)e(->)1007 3611 y(Block\([Rpush\(re)o(ady)o
(\),)1312 3711 y(Goto\("main"\),)1312 3811 y(Block\(is\),)1312
3910 y(Label\(ready\)]\))1007 4010 y(where)f(new)h(=>)h(ready)1810
5662 y Fl(103)p eop
%%Page: 104 107
104 106 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y Fh(COMPILER)440
807 y Fe(module)k(compiler)440 906 y(imports)g(instructions)d(strategy)
j(list)h(substitution)c(automaton)440 1157 y Fl(semi-instructions:)e
(strategies)26 b(em)n(b)r(edded)i(in)n(to)g(instructions)440
1408 y Fe(signature)527 1507 y(constructors)614 1607
y(Instr)42 b(:)h(Strategy)d(*)j(Env)g(*)g(REnv)f(->)h(Instr)440
1858 y Fl(Lo)r(oking)26 b(up)i(v)-5 b(ariables)27 b(in)h(the)f(en)n
(vironmen)n(t)440 2109 y Fe(rules)527 2308 y(io-index)40
b(:)k(\(x,)e(env\))g(->)h(\(i,)f(o\))658 2407 y(where)f(<fetch\({i,)f
(xs:)i(?\(i,)g(xs\);)g(!\(i,)g(<get-index>)d(\(x,)j(xs\)\)};)g(?\(i,)f
(o\)\)>)h(env)440 2658 y Fl(Semi-instructions)24 b(can)g(b)r(e)h
(re\014ned)f(to)g(instructions)g(b)n(y)g(means)g(of)g(the)h(follo)n
(wing)e(rules.)440 2828 y Fg(sequential)31 b(pr)n(ogramming)440
2997 y Fl(Iden)n(tit)n(y)d(and)f(failure)440 3248 y Fe(rules)527
3447 y(C)43 b(:)h(Instr\(Id,)39 b(env,)j(rcs\))g(->)h(Block\([]\))527
3646 y(C)g(:)h(Instr\(Fail,)39 b(env,)i(rcs\))h(->)h(Goto\("fail"\))440
3897 y Fl(T)-7 b(est)28 b(and)f(negation)440 4066 y(Note:)37
b(this)28 b(is)f(really)g(a)g(where)g(implemen)n(tation)h(the)g(en)n
(vironmen)n(t)e(is)i(not)f(restored.)527 4317 y Fe(C)43
b(:)h(Instr\(Test\(s\),)37 b(env,)42 b(rcs\))g(->)702
4417 y(Block\([Tdupl,)1007 4516 y(Instr\(s,)e(env,)i(rcs\),)1007
4616 y(Tpop]\))527 4815 y(C)h(:)h(Instr\(Not\(s\),)38
b(env,)k(rcs\))g(->)702 4915 y(Block\([Cpush\(fc)o(\),)1007
5015 y(Tdupl,)1007 5114 y(Instr\(s,)e(env,)i(rcs\),)1007
5214 y(Cpop,)f(Crestore,)f(Cjump,)1007 5313 y(Label\(fc\)]\))702
5413 y(where)h(new)h(=>)h(fc)1810 5662 y Fl(104)p eop
%%Page: 105 108
105 107 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(Sequen)n(tial)27
b(comp)r(osition)527 784 y Fe(C)43 b(:)h(Instr\(Seq\(s1,)38
b(s2\),)k(env,)g(rcs\))g(->)702 883 y(Block\([Instr\(s1)o(,)37
b(env,)42 b(rcs\),)1007 983 y(Instr\(s2,)d(env,)j(rcs\)]\))440
1235 y Fl(Choice)527 1488 y Fe(C)h(:)h(Instr\(LChoice\(s)o(1,)37
b(s2\),)42 b(env,)g(rcs\))g(->)702 1587 y(Block\([Cpush\(fc)o(\),)1007
1687 y(Instr\(s1,)d(env,)j(rcs\),)g(Cpop,)f(Goto\(sc\),)1007
1787 y(Label\(fc\),)e(Instr\(s2,)h(env,)i(rcs\),)1007
1886 y(Label\(sc\)]\))702 1986 y(where)f(\(new)h(=>)h(sc\))f(;)h(\(new)
f(=>)h(fc\))527 2185 y(C)g(:)h(Instr\(Choice\(s1)o(,)37
b(s2\),)42 b(env,)g(rcs\))g(->)702 2285 y(Block\([Cpush\(fc)o(\),)1007
2384 y(Instr\(s1,)d(env,)j(rcs\),)g(Cpop,)f(Goto\(sc\),)1007
2484 y(Label\(fc\),)e(Instr\(s2,)h(env,)i(rcs\),)1007
2584 y(Label\(sc\)]\))702 2683 y(where)f(\(new)h(=>)h(sc\))f(;)h(\(new)
f(=>)h(fc\))440 2936 y Fl(Matc)n(hing)27 b(automaton)527
3288 y Fe(C)43 b(:)h(Instr\(Down\(n,)38 b(s\),)k(env,)g(rcs\))g(->)702
3387 y(Block\([Arg\(n\),)1007 3487 y(Instr\(s,)e(env,)i(rcs\)]\))527
3686 y(C)h(:)h(Instr\(Up\(s\),)38 b(env,)k(rcs\))g(->)702
3786 y(Block\([Tpop,)1007 3885 y(Instr\(s,)e(env,)i(rcs\)]\))527
4085 y(C)h(:)h(Instr\(Accept\(s\))o(,)37 b(env,)42 b(rcs\))g(->)702
4184 y(Instr\(s,)e(env,)i(rcs\))527 4384 y(C)h(:)h(Instr\(MatchVars)o
(\([)o(],)37 b(p,)43 b(s\),)f(env,)g(rcs\))g(->)702 4483
y(Instr\(s,)e(env,)i(rcs\))527 4682 y(C)h(:)h(Instr\(MatchVars)o(\(C)o
(ons)o(\(x)o(,)38 b(xs\),)k(p,)g(s\),)h(env,)f(rcs\))f(->)702
4782 y(Block\([ins,)1007 4882 y(Instr\(MatchVars)o(\(xs)o(,)c(p,)43
b(s\),)f(env,)g(rcs\)]\))702 4981 y(where)f(<io-index>)e(\(x,)k(env\))f
(=>)h(\(i,)f(o\);)963 5081 y(\(\(<eq>)f(\(i,)h(rcs\);)g
(!MatchVar\(o\)\))c(<+)43 b(!MatchVard\(i,)38 b(o\))43
b(=>)g(ins\))527 5280 y(C)g(:)h(Instr\(MatchFunA)o(\(F)o(un\()o(f,)o
(n\),)37 b(xs,)42 b(p,)h(s\),)f(env,)g(rcs\))g(->)702
5380 y(Block\([MatchFun)o(\(f)o(,n\))o(,)1810 5662 y
Fl(105)p eop
%%Page: 106 109
106 108 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)1007 531 y Fe(Instr\(MatchVars)o(\(xs)o(,)
g(p,)43 b(s\),)f(env,)g(rcs\)]\))527 731 y(C)h(:)h(Instr\(MatchFunA)o
(\(S)o(tr\()o(x\))o(,)38 b(xs,)k(p,)h(s\),)f(env,)g(rcs\))g(->)702
830 y(Block\([MatchStr)o(in)o(g\(x)o(\),)1007 930 y(Instr\(MatchVars)o
(\(xs)o(,)37 b(p,)43 b(s\),)f(env,)g(rcs\)]\))527 1129
y(C)h(:)h(Instr\(MatchFunA)o(\(I)o(nt\()o(x\))o(,)38
b(xs,)k(p,)h(s\),)f(env,)g(rcs\))g(->)702 1229 y(Block\([MatchInt)o
(\(x)o(\),)1007 1328 y(Instr\(MatchVars)o(\(xs)o(,)37
b(p,)43 b(s\),)f(env,)g(rcs\)]\))527 1528 y(C)h(:)h(Instr\(MatchFunA)o
(\(R)o(eal)o(\(x)o(\),)37 b(xs,)43 b(p,)f(s\),)h(env,)f(rcs\))f(->)702
1627 y(Block\([MatchRea)o(l\()o(x\),)1007 1727 y(Instr\(MatchVars)o
(\(xs)o(,)c(p,)43 b(s\),)f(env,)g(rcs\)]\))527 1926 y(C)h(:)h
(Instr\(Case\(cs\),)37 b(env,)42 b(rcs\))g(->)702 2026
y(Block\([Instr\(Ca)o(se)o(s\(c)o(s')o(,)c(sc\),)k(env,)f(rcs\),)1007
2125 y(Instr\(s,)f(env,)i(rcs\),)1007 2225 y(Label\(sc\)]\))702
2325 y(where)f(new)h(=>)h(sc;)963 2424 y(\(<at_suffix\({cs:)37
b(Cons\(MatchVars\(i)o(d,i)o(d,)o(id)o(\);?)o(s,)g(?cs\);)42
b(!cs}\)>)f(cs)963 2524 y(<+)i(\(!Fail)e(=>)i(s;)f(!cs\)\))g(=>)h(cs')
527 2723 y(C)g(:)h(Instr\(Cases\([],)37 b(sc\),)42 b(env,)g(rcs\))g(->)
702 2823 y(Block\([]\))527 3022 y(C)h(:)h(Instr\(Cases\(Con)o(s\()o
(Mat)o(ch)o(Fun)o(A\()o(f,)37 b(xs,)42 b(p,)h(s\),)g(cases\),)d(sc\),)i
(env,)g(rcs\))g(->)702 3122 y(Block\([<CasePre)o(fi)o(x>)37
b(\(f,)43 b(fc\),)1007 3221 y(Instr\(MatchVars)o(\(xs)o(,)37
b(p,)43 b(s\),)f(env,)g(rcs\),)1007 3321 y(Goto\(sc\),)1007
3421 y(Label\(fc\),)1007 3520 y(Instr\(Cases\(cas)o(es,)37
b(sc\),)42 b(env,)g(rcs\)]\))702 3620 y(where)f(new)h(=>)h(fc)527
3819 y(CasePrefix)d(:)j(\(Fun\(f,)d(n\),)j(fc\))f(->)h(MatchFunFC\(f,)
38 b(n,)43 b(fc\))527 3919 y(CasePrefix)d(:)j(\(Int\(n\),)d(fc\))86
b(->)43 b(MatchIntFC\(n,)38 b(fc\))527 4018 y(CasePrefix)i(:)j
(\(Real\(n\),)d(fc\))i(->)h(MatchRealFC\(n,)38 b(fc\))527
4118 y(CasePrefix)i(:)j(\(Str\(x\),)d(fc\))86 b(->)43
b(MatchStringFC\(x,)37 b(fc\))440 4367 y Fl(Cases)27
b(\(Old)g(New)h(St)n(yle\))527 4616 y Fe(C')43 b(:)g
(Instr\(Case\(cases)o(,)38 b(s\),)k(env,)g(rcs\))g(->)702
4716 y(Block\([Instr\(Ca)o(se)o(s\(c)o(as)o(es,)37 b(sc\),)42
b(env,)g(rcs\),)1007 4815 y(Instr\(s,)e(env,)i(rcs\),)1007
4915 y(Label\(sc\)]\))702 5015 y(where)f(new)h(=>)h(sc)527
5214 y(C')g(:)g(Instr\(Cases\([],)37 b(sc\),)42 b(env,)g(rcs\))g(->)702
5313 y(Block\([]\))1810 5662 y Fl(106)p eop
%%Page: 107 110
107 109 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)527 531 y Fe(C')43 b(:)g
(Instr\(Cases\(Cons)o(\(Se)o(q\()o(s1,)37 b(s2\),)42
b(cases\),)e(sc\),)i(env,)g(rcs\))g(->)702 631 y(Block\([<CasePre)o(fi)
o(x>)37 b(\(s1,)42 b(fc\),)1007 731 y(Instr\(s2,)d(env,)j(rcs\),)1007
830 y(Goto\(sc\),)1007 930 y(Label\(fc\),)1007 1029 y
(Instr\(Cases\(cas)o(es,)37 b(sc\),)42 b(env,)g(rcs\)]\))702
1129 y(where)f(new)h(=>)h(fc)527 1328 y(CasePrefix')c(:)k
(\(MatchFun\(f\),)126 b(fc\))86 b(->)42 b(MatchFunFC\(f,)d(fc\))527
1428 y(CasePrefix')g(:)k(\(Match\(Int\(n\)\),)38 b(fc\))86
b(->)42 b(MatchIntFC\(n,)d(fc\))527 1528 y(CasePrefix')g(:)k
(\(Match\(Real\(n\)\),)37 b(fc\))43 b(->)f(MatchRealFC\(n,)c(fc\))527
1627 y(CasePrefix')h(:)k(\(Match\(Str\(x\)\),)38 b(fc\))86
b(->)42 b(MatchStringFC\(x,)37 b(fc\))440 1880 y Fl(Cases)27
b(\(Old)g(Old)h(St)n(yle\))527 2132 y Fe(C'')43 b(:)g
(Instr\(Case\(case)o(s\),)37 b(env,)42 b(rcs\))g(->)702
2232 y(Instr\(Cases\(cas)o(es)o(,)c(sc\),)k(env,)g(rcs\))702
2331 y(where)f(new)h(=>)h(sc)527 2531 y(C'')g(:)g(Instr\(Cases\([],)37
b(sc\),)42 b(env,)g(rcs\))g(->)702 2630 y(Label\(sc\))527
2829 y(C'')h(:)g(Instr\(Cases\([\(f)o(,)38 b(s\)],)k(sc\),)g(env,)f
(rcs\))h(->)702 2929 y(Block\([MatchFun)o(\(f)o(\),)1007
3029 y(Instr\(s,)e(env,)i(rcs\),)1007 3128 y(Label\(sc\)]\))527
3328 y(C'')h(:)g(Instr\(Cases\(Con)o(s\(\()o(f,)37 b(s\),)42
b(cases\),)f(sc\),)h(env,)g(rcs\))g(->)702 3427 y(Block\([MatchFun)o
(FC)o(\(f,)37 b(fc\),)1007 3527 y(Instr\(s,)j(env,)i(rcs\),)1007
3626 y(Goto\(sc\),)1007 3726 y(Label\(fc\),)1007 3826
y(Instr\(Cases\(cas)o(es,)37 b(sc\),)42 b(env,)g(rcs\)]\))702
3925 y(where)f(new)h(=>)h(fc)440 4178 y Fg(jumping)527
4430 y Fe(C)g(:)h(Instr\(Rec\(x,)38 b(s\),)k(env,)g(rcs\))g(->)702
4530 y(Block\([Rpush\(sc)o(\),)1007 4629 y(Label\(x\),)1007
4729 y(Instr\(s,)e(env,)i(rcs\),)1007 4829 y(Return,)1007
4928 y(Label\(sc\)]\))702 5028 y(where)f(new)h(=>)h(sc)440
5280 y(\(*)527 5380 y(C)g(:)h(Instr\(Call\(SVar)o(\(x)o(\),)37
b([]\),)42 b(env,)g(rcs\))g(->)1810 5662 y Fl(107)p eop
%%Page: 108 111
108 110 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)702 531 y Fe(Block\([Rpush\(re)o(t\))o(,)h
(Goto\(entry\),)g(Label\(ret\)]\))702 631 y(where)j(<lookup>)f(\(x,)j
(rcs\))f(=>)g(entry;)f(new)i(=>)g(ret)440 731 y(*\))527
830 y(C)g(:)h(Instr\(Call\(SVar)o(\(x)o(\),)37 b([]\),)42
b(env,)g(rcs\))g(->)702 930 y(Block\([Rpush\(re)o(t\))o(,)c(Goto\(x\),)
i(Label\(ret\)]\))702 1029 y(where)h(new)h(=>)h(ret)527
1257 y(C)g(:)h(Instr\(Let\(sdef,)37 b(s\),)42 b(env,)g(rcs\))g(->)702
1357 y(Block\([Instr\(s,)37 b(env,)42 b(rcs\),)1007 1456
y(Goto\(y\),)1007 1556 y(Instr\(sdef,)d(env,)j(rcs\),)1007
1656 y(Label\(y\)]\))702 1755 y(where)f(new)h(=>)h(y)440
1983 y Fl(This)28 b(is)f(not)h(optimal!)36 b(Causes)27
b(a)g(c)n(hain)g(of)h(jumps)g(to)g(the)g(end)f(of)h(the)g(co)r(de)527
2211 y Fe(C)43 b(:)h(Instr\(SDef\(x,)38 b([],)k(s\),)g(env,)g(rcs\))g
(->)702 2310 y(Block\([Label\(x\))o(,)1007 2410 y(Instr\(s,)e(env,)i
(rcs\),)1007 2510 y(Return]\))440 2737 y Fl(P)n(ath)527
2965 y Fe(C)h(:)h(Instr\(Path\(i,)38 b(s\),)k(env,)g(rcs\))g(->)702
3065 y(Block\([TpushIth)o(So)o(n\(i)o(\),)1007 3164 y(Instr\(s,)e(env,)
i(rcs\),)1007 3264 y(TputIthSon\(i\)]\))440 3492 y Fl(Congruence)527
3719 y Fe(C)h(:)h(Instr\(Cong\(f,)38 b(ss\),)k(env,)g(rcs\))g(->)702
3819 y(Block\([MatchFun)o(\(f)o(,)c(<length>)i(ss\),)1007
3919 y(TravInit,)1007 4018 y(Instr\(CongKids\()o(ss\))o(,)d(env,)42
b(rcs\),)1007 4118 y(AllBuild]\))527 4317 y(C)h(:)h(Instr\(CongWld\(s)o
(s\))o(,)38 b(env,)k(rcs\))g(->)702 4417 y(Block\([TravInit)o(,)1007
4516 y(Instr\(CongKids\()o(ss\))o(,)37 b(env,)42 b(rcs\),)1007
4616 y(AllBuild]\))527 4815 y(C)h(:)h(Instr\(CongKids\()o(Ni)o(l\),)37
b(env,)42 b(rcs\))g(->)702 4915 y(Block\([]\))527 5114
y(C)h(:)h(Instr\(CongKids\()o(Co)o(ns\()o(s,)37 b(ss\)\),)42
b(env,)f(rcs\))h(->)702 5214 y(Block\([OneNextS)o(on)o(,)1007
5313 y(Instr\(s,)e(env,)i(rcs\),)1007 5413 y(Instr\(CongKids\()o(ss\))o
(,)37 b(env,)42 b(rcs\)]\))1810 5662 y Fl(108)p eop
%%Page: 109 112
109 111 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(Generic)27 b(tra)n(v)n(ersal)e
(op)r(erators;)h(All)527 784 y Fe(C)43 b(:)h(Instr\(All\(s\),)38
b(env,)k(rcs\))g(->)702 883 y(Block\([AllInit,)1007 983
y(Label\(c1\),)1007 1083 y(AllNextSon\(c2\),)211 b(\(*)43
b(Succeed)e(if)i(there)e(are)h(no)h(more)f(children)e(*\))1007
1182 y(Instr\(s,)g(env,)i(rcs\),)1007 1282 y(Goto\(c1\),)475
b(\(*)43 b(process)e(next)h(child)f(*\))1007 1381 y(Label\(c2\),)1007
1481 y(AllBuild]\))702 1581 y(where)g(new)h(=>)h(c1)g(;)g(new)f(=>)h
(c2)440 1833 y Fl(One)527 2086 y Fe(C)g(:)h(Instr\(One\(s\),)38
b(env,)k(rcs\))g(->)702 2185 y(Block\([IsAppl,)1007 2285
y(OneInit,)1007 2384 y(Label\(c1\),)1007 2484 y(OneNextSon,)344
b(\(*)43 b(Fail)e(if)i(there)f(are)g(no)h(more)f(children)e(*\))1007
2584 y(Cpush\(c1\),)1007 2683 y(Instr\(s,)g(env,)i(rcs\),)1007
2783 y(Cpop,)1007 2883 y(OneBuild]\))702 2982 y(where)f(new)h(=>)h(c1)g
(;)g(new)f(=>)h(c2)440 3235 y Fl(Some)527 3487 y Fe(C)g(:)h
(Instr\(Some\(s\),)37 b(env,)42 b(rcs\))g(->)702 3587
y(Block\([IsAppl,)1007 3686 y(SomeInit,)1007 3786 y(Label\(c1\),)1007
3885 y(SomeNextSon\(c2\))o(,)c(\(*)k(jump)g(to)h(c2)g(if)g(all)f
(children)e(have)i(been)g(handled)1878 3985 y(and)h(CounterOk)d(*\))
1007 4085 y(Cpush\(c1\),)1007 4184 y(Instr\(s,)g(env,)i(rcs\),)1007
4284 y(Cpop,)1007 4384 y(CounterOK,)d(\(*)k(record)e(success)g(of)h(at)
h(least)f(one)g(child)g(*\))1007 4483 y(Goto\(c1\),)1007
4583 y(Label\(c2\),)1007 4682 y(SomeBuild]\))702 4782
y(where)f(new)h(=>)h(c1)g(;)g(new)f(=>)h(c2)440 5034
y Fl(Thread)527 5287 y Fe(C)g(:)h(Instr\(Thread\(s\))o(,)37
b(env,)42 b(rcs\))g(->)702 5386 y(Block\([ThreadIn)o(it)o(\(\),)1810
5662 y Fl(109)p eop
%%Page: 110 113
110 112 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)1007 531 y Fe(Label\(c1\),)1007
631 y(ThreadNextSon\(c)o(2\),)1007 731 y(Instr\(s,)j(env,)i(rcs\),)1007
830 y(ThreadSetEnv\(\),)1007 930 y(Goto\(c1\),)1007 1029
y(Label\(c2\),)1007 1129 y(ThreadBuild\(\)]\))702 1229
y(where)f(new)h(=>)h(c1)g(;)g(new)f(=>)h(c2)440 1478
y Fl(Scop)r(e)527 1727 y Fe(C)g(:)h(Instr\(Scope\(xs,)37
b(s\),)42 b(env,)g(i\))h(->)702 1826 y(Block\([Epushd\(i)o(,)37
b(o\),)1007 1926 y(Instr\(s,)j(Cons\(\(i,)g(xs\),)i(env\),)g(<add>)f
(\(i,)h(1\)\),)1007 2026 y(Epopd\(i,)e(o\)]\))702 2125
y(where)h(<length>)f(xs)j(=>)g(o)440 2374 y Fl(Where)527
2623 y Fe(C)g(:)h(Instr\(Where\(s\),)37 b(env,)42 b(rcs\))g(->)702
2723 y(Block\([Tdupl,)1007 2823 y(Instr\(s,)e(env,)i(rcs\),)1007
2922 y(Tpop]\))440 3171 y Fl(Primitiv)n(es)527 3421 y
Fe(C)h(:)h(Instr\(Prim\(x\),)37 b(env,)42 b(rcs\))g(->)702
3520 y(Iprim\(x\))527 3719 y(C)h(:)h(Instr\(Prim2\(x,)37
b(y\),)43 b(env,)f(rcs\))g(->)702 3819 y(Iprim2\(x,)d(y\))527
4018 y(C)k(:)h(Instr\(CountRule)o(\(x)o(\),)37 b(env,)42
b(rcs\))g(->)702 4118 y(ICountRule\(x\))440 4367 y Fl(Matc)n(hing)27
b(terms)527 4616 y Fe(C')43 b(:)g(Instr\(Match\(Var\()o(x\)\))o(,)37
b(env,)42 b(rcs\))g(->)h(ins)702 4716 y(where)e(<io-index>)e(\(x,)k
(env\))f(=>)h(\(i,)f(o\);)963 4815 y(\(\(<eq>)f(\(i,)h(rcs\);)g
(!MatchVar\(o\)\))c(<+)43 b(!MatchVard\(i,)38 b(o\))43
b(=>)g(ins\))527 5015 y(C')g(:)g(Instr\(MatchFun\(f)o(\),)37
b(env,)42 b(rcs\))g(->)702 5114 y(MatchFun\(f\))527 5313
y(C')h(:)g(Instr\(Match\(Str\()o(x\)\))o(,)37 b(env,)42
b(rcs\))g(->)702 5413 y(MatchString\(x\))1810 5662 y
Fl(110)p eop
%%Page: 111 114
111 113 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)527 631 y Fe(C')43 b(:)g
(Instr\(Match\(Int\()o(n\)\))o(,)37 b(env,)42 b(rcs\))g(->)702
731 y(MatchInt\(n\))527 930 y(C')h(:)g(Instr\(Match\(Real)o(\(n\))o
(\),)37 b(env,)42 b(rcs\))g(->)702 1029 y(MatchReal\(n\))440
1262 y Fl(Building)28 b(T)-7 b(erms)527 1494 y Fe(C)43
b(:)h(Instr\(Build\(Str)o(\(x)o(\)\),)37 b(env,)42 b(rcs\))g(->)702
1594 y(BuildStr\(x\))527 1793 y(C)h(:)h(Instr\(Build\(Int)o(\(x)o
(\)\),)37 b(env,)42 b(rcs\))g(->)702 1893 y(BuildInt\(x\))527
2092 y(C)h(:)h(Instr\(Build\(Rea)o(l\()o(x\)\))o(,)37
b(env,)42 b(rcs\))g(->)702 2192 y(BuildReal\(x\))527
2391 y(C)h(:)h(Instr\(Build\(Var)o(\(x)o(\)\),)37 b(env,)42
b(rcs\))g(->)g(ins)702 2491 y(where)f(<io-index>)e(\(x,)k(env\))f(=>)h
(\(i,)f(o\);)963 2590 y(\(\(<eq>)f(\(i,)h(rcs\);)g(!BuildVar\(o\)\))c
(<+)43 b(!BuildVard\(i,)38 b(o\))43 b(=>)g(ins\))527
2790 y(C)g(:)h(Instr\(Build\(Bui)o(ld)o(Def)o(au)o(lt\()o(t\))o(\),)37
b(env,)42 b(rcs\))g(->)702 2889 y(Instr\(Build\(t\),)37
b(env,)42 b(rcs\))527 3088 y(C)h(:)h(Instr\(Build\(Op\()o(f,)37
b(ts\)\),)42 b(env,)g(rcs\))f(->)702 3188 y(Block\([BuildKid)o(s\()o
(ts,)c(env,)42 b(rcs\),)1007 3288 y(BuildFun\(f,)d(<length>)h(ts\)]\))
527 3487 y(C)j(:)h(BuildKids\(Nil,)37 b(env,)42 b(rcs\))g(->)h
(Block\([]\))527 3686 y(C)g(:)h(BuildKids\(Cons\()o(t,)37
b(ts\),)42 b(env,)g(rcs\))g(->)702 3786 y(Block\([Instr\(Bu)o(il)o
(d\(t)o(\),)37 b(env,)42 b(rcs\),)f(Tpush,)1007 3885
y(BuildKids\(ts,)d(env,)k(rcs\)]\))527 4085 y(C)h(:)h
(Instr\(Build\(App)o(\(s)o(,)38 b(t\)\),)k(env,)g(rcs\))f(->)702
4184 y(Block\([Instr\(Bu)o(il)o(d\(t)o(\),)c(env,)42
b(rcs\),)1007 4284 y(Instr\(s,)e(env,)i(rcs\)]\))440
4516 y Fl(T)-7 b(erm)27 b(stac)n(k)g(instructions)527
4749 y Fe(C')43 b(:)g(Instr\(Tpop,)126 b(env,)42 b(rcs\))g(->)h(Tpop)
527 4848 y(C')g(:)g(Instr\(Tpush,)82 b(env,)42 b(rcs\))g(->)h(Tpush)527
4948 y(C')g(:)g(Instr\(Arg\(n\),)38 b(env,)k(rcs\))g(->)h(Arg\(n\))440
5181 y Fl(Annotations)527 5413 y Fe(C)g(:)h(Instr\(GetAnn,)38
b(env,)k(rcs\))g(->)g(GetAnn)1810 5662 y Fl(111)p eop
%%Page: 112 115
112 114 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)527 631 y Fe(C)43 b(:)h(Instr\(AnnBuild\()
o(t1)o(,)38 b(t2\),)k(env,)g(rcs\))f(->)702 731 y(Block\([Tpush,)1007
830 y(Instr\(Build\(t1\))o(,)d(env,)k(rcs\),)1007 930
y(Tpush,)1007 1029 y(Instr\(Build\(t2\))o(,)c(env,)k(rcs\),)1007
1129 y(SetAnn]\))527 1328 y(C)h(:)h(Instr\(AnnRemove)o(\(t)o(\),)37
b(env,)42 b(rcs\))g(->)702 1428 y(Block\([Tpush,)1007
1528 y(Instr\(Build\(t\),)37 b(env,)42 b(rcs\),)1007
1627 y(RemoveAnn]\))1810 5662 y Fl(112)p eop
%%Page: 113 116
113 115 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y Fh(SPECIAL)c(P)-8
b(A)g(TTERNS)440 724 y Fl(This)40 b(mo)r(dule)g(de\014nes)g(exceptions)
f(to)g(the)i(normal)d(compiler)h(rules)h(b)n(y)f(recognizing)440
823 y(patterns)27 b(that)h(can)f(b)r(e)h(implemen)n(ted)g(in)g(a)g
(more)e(e\016cien)n(t)i(w)n(a)n(y)-7 b(.)440 1067 y Fe(module)41
b(specialized)440 1167 y(imports)g(compiler)f(simplification)440
1410 y Fg(repea)-6 b(t)440 1580 y Fl(A)22 b(rep)r(etition)f(of)g(a)g
(strategy)f Fe(s1)h Fl(for)f(0)h(or)g(more)f(times,)j(terminated)e
(with)h(an)f(application)440 1679 y(of)36 b(a)g(strategy)f
Fe(s2)h Fl(can)g(b)r(e)g(translated)g(in)n(to)g(a)g(lo)r(op)g
(structure.)62 b(Only)36 b(one)g Fe(Cpush)e Fl(is)440
1779 y(p)r(erformed)e(to)h(deal)f(with)h(failure)g(of)f(the)h(lo)r(op)g
(b)r(o)r(dy)-7 b(.)52 b(This)33 b(has)f(the)h(e\013ect)g(that)g(t)n(w)n
(o)440 1879 y(copies)d(of)g(the)h(sub)5 b(ject)31 b(term)f(are)f(on)i
(the)f(stac)n(k.)45 b(The)30 b(lo)r(op)g(b)r(o)r(dy)h(w)n(orks)e(on)h
(the)h(top-)440 1978 y(most.)36 b(If)26 b(the)f(b)r(o)r(dy)h(succeeds,)
f(this)h(term)f(can)g(b)r(e)h(committed)f(and)h(`sa)n(v)n(ed')e(b)n(y)h
(cop)n(ying)440 2078 y(it)j(o)n(v)n(er)e(the)i(term)f(under)h(the)g
(top)f(of)h(the)g(stac)n(k.)440 2247 y(The)g(pattern)f
Fe(Repeat\(s1,)40 b(s2\))26 b Fl(is)h(an)h(o)n(v)n(erla)n(y)d(that)j
(is)f(de\014ned)h(b)r(elo)n(w.)440 2491 y Fe(rules)484
2690 y(Cspecial)40 b(::)j(Instr\(Repeat\(?s)o(1,)37 b(?s2\),)42
b(?env,)f(?rcs\))h(-->)745 2790 y(!)h(Block\([Cpush\(end_)o(lo)o(op\))o
(,)1094 2889 y(Label\(loop\),)1094 2989 y(Instr\(s1,)d(env,)i(rcs\),)
1094 3089 y(Tduplinv,)1094 3188 y(Goto\(loop\),)1094
3288 y(Label\(end_loop\),)1094 3388 y(Instr\(s2,)e(env,)i(rcs\)]\))745
3487 y(where)g(new)g(=>)h(loop;)e(new)i(=>)f(end_loop)440
3731 y Fl(This)26 b(is)f(an)g(instance)g(of)h(tail)f(recursion)g(that)g
(can)g(b)r(e)h(further)g(generalized)e(to)h(arbitrary)440
3830 y(man)n(y)30 b(lo)r(op)g(b)r(o)r(dies.)45 b(In)30
b(that)h(generalization)d(w)n(e)i(migh)n(t)g(consider)g(the)g(follo)n
(wing)g(rule)440 3930 y(whic)n(h)e(is)f(not)h(applicable)f(in)h
(general)e(b)r(ecause)h(of)g(bac)n(ktrac)n(king:)789
4159 y Fe(Choice\(Seq\(s1,)37 b(Call\(SVar\(x\),)i([]\)\),)i(Seq\(s2,)g
(Call\(SVar\(x\),)d([]\)\)\))k(->)789 4258 y(Seq\(Choice\(s1,)37
b(s2\),)42 b(Call\(SVar\(x\),)d([]\)\))440 4487 y Fl(It)28
b(is)f(applicable)g(when)g(the)h(strategies)e Fe(s1)h
Fl(and)g Fe(s2)f Fl(are)h(m)n(utually)g(exclusiv)n(e,)g(i.e.,)g(if)h
Fe(s1)440 4587 y Fl(succeeds,)f Fe(s2)g Fl(cannot)g(p)r(ossibly)g
(succeed.)440 4756 y(The)d Fe(Repeat\(s1,)39 b(s2\))22
b Fl(o)n(v)n(erla)n(y)-7 b(.)33 b(The)24 b(o)n(v)n(erla)n(y)d
(recognizes)g(the)j(pattern)f(of)h(the)g Fe(repeat)440
4856 y Fl(strategy)i(op)r(erator)g(from)h(the)h(library:)789
5085 y Fe(repeat\(s\))40 b(=)j(rec)f(x\(\(s;)g(x\))g(<+)h(id\))440
5313 y Fl(but)19 b(generalized)e(to)i(arbitrary)d(terminators)i
(\(other)g(than)h Fe(id)p Fl(\).)33 b(The)19 b(o)n(v)n(erla)n(y)d
(transforms)440 5413 y(the)k(\014rst)g(argumen)n(t)f(of)h(the)g
Fe(LChoice)d Fl(to)j(a)f(left-asso)r(ciativ)n(e)g(pattern.)34
b(The)20 b(result)g(should)1810 5662 y(113)p eop
%%Page: 114 117
114 116 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)440 531 y(b)r(e)24 b(a)f(sequen)n(tial)g
(comp)r(osition)g(with)h(the)g(recursion)e(v)-5 b(ariable)22
b(as)h(second)g(argumen)n(t)g(and)440 631 y(a)33 b(strategy)g(as)g
(\014rst)h(argumen)n(t,)g(where)f(the)i(recursion)d(v)-5
b(ariable)33 b(do)r(es)g(not)h(app)r(ear)f(in)440 731
y(the)k(strategy)-7 b(.)64 b(The)37 b(second)f(de\014nition)i(tak)n(es)
e(care)g(of)h(the)g(presence)f(of)h Fe(CountRule)440
830 y Fl(strategies,)26 b(whic)n(h)i(are)e(added)i(b)n(y)f(the)h(fron)n
(tend)f(for)g(pro\014ling.)440 1083 y Fe(strategies)527
1282 y(Repeat\(s1,)40 b(s2\))i(=)789 1381 y({x:)g(Rec\(?x,)f
(LChoice\(repeat\(L)o(As)o(s\))o(;)1660 1481 y(Seq\(not\(oncetd\(SV)o
(ar\()o(?x)o(\)\))o(\);)c(s1,)1835 1581 y(Call\(SVar\(?x\),)h([]\)\))
1617 1680 y(,not\(oncetd\(SVar)o(\(?)o(x\)\))o(\);)f(s2\)\)})527
1880 y(Repeat\(s1,)j(s2\))i(=)789 1979 y({x,)g(s1',)g(str:)832
2079 y(Rec\(?x,)f(LChoice\(repeat\(L)o(Ass)o(\);)1530
2178 y(?Seq\(s1',)f(Seq\(Call\(SVar\(x)o(\),)d([]\),)42
b(Countrule\(str\)\)\))o(;)1530 2278 y(!Seq\(Seq\(s1',)c
(CountRule\(str\)\),)f(Call\(SVar\(x\),)h([]\)\);)1530
2378 y(Seq\(not\(oncetd\()o(SVa)o(r\()o(?x\))o(\)\))o(;)f(s1,)43
b(id\))1486 2477 y(,not\(oncetd\(SVar)o(\(?x)o(\)\))o(\);)37
b(s2\)\)})440 2730 y Fg(ma)-6 b(tching)32 b(onl)-6 b(y)31
b(tra)-7 b(versals)440 2899 y Fl(If)25 b(a)f(tra)n(v)n(ersal)d(is)k
(matc)n(hing)e(only)h(it)h(do)r(es)f(not)g(need)h(to)f(rebuild)g(the)h
(sub)5 b(ject)24 b(term)h(after)440 2999 y(insp)r(ection;)34
b(the)d(original)f(sub)5 b(ject)32 b(term)f(is)h(not)f(transformed.)47
b(This)32 b(should)f(b)r(e)h(done)440 3098 y(for)26 b(all)g(tra)n(v)n
(ersals)e(in)j(general,)e(but)i(w)n(e)f(try)h(it)g(out)f(\014rst)g(for)
g(the)h(oncetd)g(tra)n(v)n(ersal)d(from)440 3198 y(the)k(library)-7
b(.)440 3450 y Fe(strategies)527 3650 y(IsMatch)41 b(=)i
(not\(oncetd\(Build)o(\(id)o(\)\))o(\))527 3849 y(Oncetd\(s\))d(=)j
({x:)g(Rec\(?x,)d(LChoice\(s,)g(One\(Call\(SVar\(?)o(x\),)d
([]\)\)\)\)})527 4048 y(Cspecial)j(=)k(CsOncetd)440 4301
y(rules)527 4500 y(CsOncetd)c(::)614 4599 y(Instr\(Oncetd\(?s;)d
(IsMatch\),)j(?env,)i(?rcs\))f(-->)614 4699 y(!)j(Block\([)789
4799 y(Rpush\(endloop\),)789 4898 y(Label\(startloop)o(\),)789
4998 y(Cpush\(else\),)789 5098 y(Instr\(s,)c(env,)i(rcs\),)789
5197 y(Cpop,)789 5297 y(Goto\(repeat\),)789 5396 y(Label\(else\),)1810
5662 y Fl(114)p eop
%%Page: 115 118
115 117 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)789 531 y Fe(IsAppl,)789
631 y(MatchTravInit,)789 731 y(Label\(nextson\),)789
830 y(OneMatchNextSon)o(,)789 930 y(Cpush\(nextson\),)789
1029 y(Rpush\(doneit\),)789 1129 y(Goto\(startloop\))o(,)789
1229 y(Label\(doneit\),)789 1328 y(Cpop,)789 1428 y(MatchTravEnd,)789
1528 y(Label\(repeat\),)789 1627 y(Return,)789 1727 y(Label\(endloop\))
658 1826 y(]\))658 1926 y(where)k(new)i(=>)g(startloop;)919
2026 y(new)g(=>)g(else;)919 2125 y(new)g(=>)g(nextson;)919
2225 y(new)g(=>)g(doneit;)919 2325 y(new)g(=>)g(repeat;)919
2424 y(new)g(=>)g(endloop)440 2673 y Fg(fetch)440 2922
y Fe(strategies)527 3122 y(Fetch\(s\))d(=)k({x:)614 3221
y(Rec\(?x,)d(LChoice\(Cong\("Co)o(ns")o(,)c([s,)43 b(Id]\),)1312
3321 y(Cong\("Cons",)38 b([Id,)k(Call\(SVar\(?x\),[]\))o(]\))o(\)\)})
527 3520 y(Fetch\(s\))e(=)k({x:)614 3620 y(Rec\(?x,)d
(LChoice\(Seq\(Cong)o(\("C)o(on)o(s",)o([s)o(,I)o(d]\))o(,)c
(CountRule\("Cons"\))o(\),)1312 3719 y(Seq\(Cong\("Cons",)o([I)o(d,)o
(Cal)o(l\()o(SVa)o(r\()o(?x)o(\),[)o(]\))o(]\),)g(CountRule\("Cons")o
(\)\))o(\)\))o(})527 3919 y(Cspecial)j(=)k(CsFetch)440
4118 y(rules)527 4317 y(CsFetch)d(::)614 4417 y(Instr\(Fetch\(?s;)d
(IsMatch\),)i(?env,)h(?rcs\))h(-->)614 4516 y(!)i(Block\([)789
4616 y(Tdupl,)789 4716 y(Label\(a\),)789 4815 y(MatchFun\("Cons")o
(,2\))o(,)789 4915 y(Cpush\(b\),)789 5015 y(Arg\(0\),)789
5114 y(Instr\(s,)c(env,)i(rcs\),)789 5214 y(Tpop,)789
5313 y(Cpop,)789 5413 y(Goto\(end\),)1810 5662 y Fl(115)p
eop
%%Page: 116 119
116 118 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(Compilation)789 531 y Fe(Label\(b\),)789
631 y(Arg\(1\),)789 731 y(Tdrop,)789 830 y(Goto\(a\),)789
930 y(Label\(end\),)789 1029 y(Tpop,)702 1129 y(]\))571
1229 y(where)k(new)i(=>)f(a;)h(new)f(=>)h(b;)g(new)f(=>)h(end)440
1581 y Fl(This)23 b(can)f(b)r(e)i(generalized)d(to)i(other)f(tra)n(v)n
(ersals)e(that)j(ha)n(v)n(e)f(congruences)f(with)i(recursiv)n(e)440
1680 y(calls,)43 b(if)f(the)f(recursiv)n(e)e(call)h(is)h(only)f(to)g
(one)h(of)f(the)i(c)n(hildren)e(and)g(the)h(others)f(are)440
1780 y(iden)n(tities.)1810 5662 y(116)p eop
%%Page: 117 120
117 119 bop 440 199 a Fl(Chapter:)36 b(Bac)n(k)n(end)440
298 y(Section:)h(P)n(ostpro)r(ccesing)440 531 y(The)c(p)r(ostpro)r
(cessing)e(phase)h(of)h(the)g(compiler)f(tak)n(es)g(an)g(abstract)g
(mac)n(hine)g(program)440 631 y(and)d(deriv)n(es)f(initialization)i
(information)e(from)h(it.)43 b(Curren)n(tly)28 b(it)i(only)f(deals)g
(with)h(the)440 731 y(initialization)d(of)h(rule)f(coun)n(ters)g(b)n(y)
g(lo)r(oking)g(at)g(the)h(use)f(of)h Fe(CountRule)c Fl(instructions.)
1810 5662 y(117)p eop
%%Page: 118 121
118 120 bop 440 199 a Fl(Chapter:)36 b(A)28 b(Bo)r(otstrapp)r(ed)f
(Compiler)g(for)g(Strategies)440 531 y Fh(POSTPR)m(OCESS)440
726 y Fl(P)n(ostpro)r(cessing)e(of)i(generated)g(co)r(de)g(to)h
(extract)f(global)f(v)-5 b(ariable)27 b(information.)440
978 y Fe(module)41 b(postprocess)440 1078 y(imports)g(instructions)d
(lib)43 b(list-misc)d(list-sort)440 1277 y(rules)527
1476 y(CR1)j(:)g(ICountRule\(f\))38 b(->)43 b(RuleCounter\(f\))527
1675 y(CR2)g(:)g(RuleCounter\(f\))37 b(->)43 b(RuleCounter\(f,)38
b(<new>)k(f\))527 1875 y(CR3\(b_rcs\))e(:)j(ICountRule\(f\))38
b(->)43 b(ICountRule\(f'\))789 1974 y(where)e(b_rcs;)g
(fetch\(match\(RuleC)o(ou)o(nte)o(r\()o(f,)c(f'\)\)\))527
2174 y(Main)42 b(:)h(Block\(is\))d(->)j(Program\(RuleCoun)o(te)o(rs\()o
(rc)o(s\),)37 b(Block\(is'\)\))832 2273 y(where)963 2373
y(<filter\(CR1\);)h(uniq;)k(map\(CR2\)>)e(is)i(=>)h(rcs;)963
2472 y(<map\(try\(CR3\(bui)o(ld\()o(rc)o(s\)\))o(\)\))o(>)37
b(is)43 b(=>)g(is')440 2672 y(strategies)527 2871 y(main)f(=)h
(iowrap\(Main\))1810 5662 y Fl(118)p eop
%%Page: 119 122
119 121 bop 440 199 a Fl(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)440 531 y(Consider)27
b(as)g(an)g(example)g(of)h(optimization:)440 767 y Fe(conc)42
b(.)h(map\(s\))440 867 y(zip\(id\))e(.)i(unzip)e(->)i(id)1810
5662 y Fl(119)p eop
%%Page: 120 123
120 122 bop 440 199 a Fl(Chapter:)36 b(Compiler)440 531
y(In)23 b(this)f(c)n(hapter)g(w)n(e)g(put)h(the)g(compiler)f(comp)r
(onen)n(ts)f(dev)n(elop)r(ed)h(in)h(the)g(previous)e(c)n(hap-)440
631 y(ters)27 b(together)g(in)n(to)g(the)h(Stratego)e(Compiler)h
Fc(sc)p Fl(.)1810 5662 y(120)p eop
%%Page: 121 124
121 123 bop 440 199 a Fl(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)440 531 y Fe(SC)p Fh(:)31 b(STRA)-8
b(TEGO)32 b(COMPILER)440 809 y Fe(module)41 b(sc)440
908 y(imports)g(lib)h(sugar)440 1008 y(signature)527
1108 y(sorts)g(Option)527 1207 y(constructors)614 1307
y(Dir)261 b(:)43 b(String)e(->)i(Option)614 1406 y(ExecDir)85
b(:)43 b(String)e(->)i(Option)614 1506 y(InclDir)85 b(:)43
b(String)e(->)i(Option)614 1606 y(CInclDir)e(:)i(String)e(->)i(Option)
614 1705 y(CLibDir)85 b(:)43 b(String)e(->)i(Option)614
1805 y(Input)173 b(:)43 b(String)e(->)i(Option)614 1905
y(Main)217 b(:)43 b(String)e(->)i(Option)614 2004 y(AST)261
b(:)43 b(Option)614 2104 y(Ignore)129 b(:)43 b(Option)614
2203 y(CC)305 b(:)43 b(Option)614 2303 y(NORM)217 b(:)43
b(Option)440 2555 y Fl(Pro)r(cessing)26 b(the)h(command-line)h(options)
440 2808 y Fe(strategies)527 3007 y(main)42 b(=)h(sc)527
3206 y(sc)g(=)g(\(process-sc-opti)o(ons)37 b(<+)43 b(sc-usage;)c
(<exit>)j(1\);)745 3306 y(\(\(need-help\(sc-u)o(sag)o(e;)37
b(<exit>)k(1\),)h(id\))789 3406 y(<+)g(sc-announce;)919
3505 y(parse;)919 3605 y(output-ast;)919 3704 y(add-main;)919
3804 y(core;)919 3904 y(cc1;)919 4003 y(cc2;)919 4103
y(try\(not\(\(option-d)o(efi)o(ne)o(d\(?)o(NO)o(RM)o(\(\)\))o(,)37
b(id\)\);)1094 4203 y(\(id,)42 b(remove-intermedi)o(at)o(es)o(\)\);)919
4302 y(<printnl>\(stderr,)37 b(["compilation)h(succeeded"]\);)919
4402 y(<exit>)k(0)789 4501 y(<+)g(<printnl>\(stderr,)37
b(["compilation)h(failed"]\);)919 4601 y(<exit>)k(1)745
4701 y(\))527 4900 y(process-sc-option)o(s)37 b(=)789
5000 y(where\(filter-op)o(tio)o(ns)o(\(?")o(-I)o("\))g(=>)43
b(incl\);)789 5099 y(where\(filter-op)o(tio)o(n-)o(arg)o(s\()o(?"-)o
(CI)o("\))37 b(=>)43 b(cincl\);)789 5199 y(where\(filter-op)o(tio)o(n-)
o(arg)o(s\()o(?"-)o(CL)o("\))37 b(=>)43 b(clib\);)789
5298 y(parse-options\(s)o(c-o)o(pt)o(ion)o(s)37 b(<+)43
b(io-options\);)789 5398 y(\(option-defined)o(\(In)o(pu)o(t\(?)o(in)o
(\)\);)1810 5662 y Fl(121)p eop
%%Page: 122 125
122 124 bop 440 199 a Fl(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)789 531 y Fe(\\)43 b(opts)f(->)876
631 y(\([InclDir\(incl\),)37 b(CInclDir\(cincl\),)g(CLibDir\(clib\))h
(|)43 b(opts],)919 731 y(\(in,)f(".r"\)\))f(\\)789 830
y(<+)h(\\opts)g(->)h(\([Help)e(|)i(opts],)e(""\)\\)h(\))527
1029 y(sc-options)e(=)789 1129 y(ArgOption\("-e",)429
b(\\x)43 b(->)g(ExecDir\(x\)\\)c(\))789 1229 y(+)k(ArgOption\("-I",)342
b(!Ignore\))41 b(//)h(\\x)h(->)g(InclDir\(x\)\\)c(\))789
1328 y(+)k(ArgOption\("--Inc)o(lu)o(de")o(,)37 b(!Ignore\))k(//)h(\\x)h
(->)g(InclDir\(x\)\\)c(\))789 1428 y(+)k(ArgOption\("-CI",)298
b(!Ignore\))41 b(//)h(\\)i(\(x,y\))d(->)i(CInclDir\(x\)\\)38
b(\))789 1528 y(+)43 b(ArgOption\("-CL",)298 b(!Ignore\))41
b(//)h(\\)i(\(x,y\))d(->)i(CLibDir\(x\)\\)c(\))789 1627
y(+)k(Option\("-CC",)430 b(!CC)43 b(\))789 1727 y(+)g(Option\("-norm",)
342 b(!NORM)42 b(\))789 1826 y(+)h(ArgOption\("-i",)342
b(\\x)43 b(->)g(Input\(<basename>)37 b(x\)\\)42 b(\))789
1926 y(+)h(ArgOption\("--mai)o(n")o(,)168 b(\\x)43 b(->)g(Main\(x\)\\)d
(\))789 2026 y(+)j(ArgOption\("-m",)342 b(\\x)43 b(->)g(Main\(x\)\\)d
(\))789 2125 y(+)j(Option\("--ast",)342 b(!AST)42 b(\))440
2325 y(strategies)527 2524 y(sc-usage)e(=)527 2623 y(sc-version;)527
2723 y(<printnl>\(stderr,)963 2823 y(["Usage:)g(sc)j([options])d(-i)j
(file\\n",)1007 2922 y("Options:\\n",)1007 3022 y(")86
b(-i)43 b(spec)216 b(Compile)41 b(specification)d(spec\\n",)1007
3122 y(")86 b(-o)43 b(target)128 b(Name)42 b(executable)e(target\\n",)
1007 3221 y(")86 b(--main)41 b(s)174 b(Name)42 b(main)g(strategy)f
([default:)e(main]\\n",)1007 3321 y(")86 b(-I)43 b(dir)260
b(Look)42 b(in)h(dir)f(for)h(imported)d(Stratego)g(modules\\n",)1007
3421 y(")86 b(-CI)43 b(dir)216 b(Look)42 b(in)h(dir)f(for)h(C)g
(include)e(files\\n",)1007 3520 y(")86 b(-CL)43 b(dir)216
b(Look)42 b(in)h(dir)f(for)h(C)g(object)e(libraries\\n",)1007
3620 y(")86 b(--ast)303 b(Output)42 b(abstract)e(syntax)h(of)i
(specification\\n)o(",)1007 3719 y(")86 b(-h|--help)127
b(Display)41 b(this)h(message")963 3819 y(]\))527 4018
y(sc-version)e(=)527 4118 y(\(option-defined\(D)o(ec)o(lV)o(ers)o(io)o
(n\(?)o(ve)o(rsi)o(on)o(\)\))d(<+)43 b(!"")f(=>)h(version\);)527
4218 y(where\(<printnl>\(s)o(td)o(er)o(r,)37 b(["sc)42
b(version)f(",)i(version]\)\))527 4417 y(sc-announce)c(=)527
4516 y(try\(\(option-defin)o(ed)o(\(V)o(erb)o(os)o(e\),)e(id\);)702
4616 y(\(sc-version,)h(id\)\))440 4865 y Fl(P)n(arsing)25
b(sp)r(eci\014cations)440 5114 y Fe(strategies)527 5313
y(parse)42 b(=)614 5413 y(\(option-defined\(I)o(nc)o(lDi)o(r\()o(?in)o
(cl)o(\)\);)1810 5662 y Fl(122)p eop
%%Page: 123 126
123 125 bop 440 199 a Fl(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)658 531 y Fe(option-defined\(E)o(xe)o(cDi)o(r\()o
(?ed)o(ir)o(\)\),)g(id\);)614 631 y(\(id,)42 b(pipe'\(<pref\(!edir)o
(\)>)37 b("/pack-stratego")o(,)h(!".tree",)1094 731 y(!["--silent")g(|)
44 b(incl]\)\))440 976 y(strategies)527 1175 y(output-ast)c(=)614
1275 y(try\(\(option-defin)o(ed)o(\(AS)o(T\))o(,)e(\(?file,)i
(?ext\)\);)789 1374 y(<printnl>\(stder)o(r,)d(["abstract)j(syntax)h
(written)f(to)j(",)g(file,)f(ext]\);)789 1474 y(<exit>)f(0\))440
1819 y Fl(Adding)28 b(main)f(strategy)440 1988 y(\(***)g(What)g(happ)r
(ens)h(if)g(the)g(sp)r(eci\014cation)f(already)f(con)n(tains)h(a)g
(main)h(strategy?)36 b(***\))440 2233 y Fe(rules)527
2432 y(AddMain\(m\))k(:)614 2532 y(Specification\(sec)o(ts)o(\))e(->)
614 2631 y(Specification\([St)o(ra)o(teg)o(ie)o(s\([)o(SD)o(ef\()o("m)o
(ai)o(n",)f([],)42 b(Call\(SVar\(<m>\(\)\),)37 b([]\)\)]\))1225
2731 y(|)43 b(sects]\))440 2930 y(strategies)527 3130
y(add-main)d(=)614 3229 y(\(\(option-defined\()o(Ma)o(in\()o(?m)o
(\)\),)d(id\);)658 3329 y(\(id,)42 b(transform-file\(A)o(dd)o(Mai)o
(n\()o(!m\))o(,)37 b(!".tree1"\)\))658 3428 y(<+)43 b(\(id,)f
(transform-file\()o(id,)37 b(!".tree1"\)\)\))440 3773
y Fl(The)26 b(core)f(of)h(the)h(compiler)e(consists)h(of)g(the)g(comp)r
(onen)n(ts)g(that)g(transform)f(a)h(sp)r(eci\014ca-)440
3873 y(tion)i(to)f(abstract)g(mac)n(hine)g(instructions.)440
4118 y Fe(strategies)527 4317 y(core)42 b(=)614 4417
y(\(list\(try\(ExecDir)o(\(?)o(dir)o(\)\))o(\),)37 b(id\);)614
4516 y(\(id,)42 b(frontend\(!dir\);)832 4616 y(extract\(!dir\);)832
4716 y(inline\(!dir\);)832 4815 y(optimizer\(!dir\);)832
4915 y(matching-tree\(!di)o(r\))o(;)832 5015 y(optimizer\(!dir\);)832
5114 y(backend\(!dir\);)832 5214 y(postprocess\(!dir\))o(;)832
5313 y(pp-instructions\(!)o(di)o(r\))614 5413 y(\))1810
5662 y Fl(123)p eop
%%Page: 124 127
124 126 bop 440 199 a Fl(Chapter:)36 b(Compiler)440 299
y(Section:)h(Glue)440 631 y Fe(rules)527 830 y(pref\(d\))k(:)i(x)g(->)g
(<conc-strings>)38 b(\(<d>\(\),)i(x\))440 1029 y(strategies)527
1229 y(frontend\(d\))344 b(=)43 b(pipe\(<pref\(d\)>)38
b("/frontend",)257 b(!".s1"\))527 1328 y(extract\(d\))388
b(=)43 b(pipe\(<pref\(d\)>)38 b("/extract",)301 b(!".s2"\))527
1428 y(inline\(d\))432 b(=)43 b(pipe\(<pref\(d\)>)38
b("/inline",)345 b(!".s"\))527 1528 y(optimizer\(d\))300
b(=)43 b(pipe\(<pref\(d\)>)38 b("/optimizer",)213 b(!".so1"\))527
1627 y(matching-tree\(d\))124 b(=)43 b(pipe\(<pref\(d\)>)38
b("/matching-tree",)f(!".so2"\))527 1727 y(backend\(d\))388
b(=)43 b(pipe\(<pref\(d\)>)38 b("/backend",)301 b(!".i1"\))527
1826 y(postprocess\(d\))212 b(=)43 b(pipe\(<pref\(d\)>)38
b("/postprocess",)125 b(!".i"\))527 1926 y(pp-instructions\(d)o(\))37
b(=)43 b(pipe\(!"pp-instruc)o(tio)o(ns)o(",)386 b(!".c"\))876
2026 y(\(*)43 b(pipe\(<pref\(d\)>)37 b("pp-instructions")o(,)168
b(!".c"\)/*\))440 2278 y(strategies)440 2477 y(rules)527
2677 y(I-option)40 b(:)k(x)f(->)g(<conc-strings>\()o("-I)o(",)37
b(x\))527 2776 y(L-option)j(:)k(x)f(->)g(<conc-strings>\()o("-L)o(",)37
b(x\))440 2976 y(strategies)527 3175 y(lib\(d\))259 b(=)43
b(<conc-strings>\(<d)o(>\(\))o(,)37 b("/lib"\))527 3274
y(liblib\(d\))127 b(=)43 b(<conc-strings>\(<l)o(ib\()o(d\))o(>\()o(\),)
37 b("/lib"\))527 3374 y(include\(d\))83 b(=)43 b(<conc-strings>\(<l)o
(ib\()o(d\))o(>\()o(\),)37 b("/include"\))527 3474 y(libstrat\(d\))i(=)
k(<conc-strings>\(<l)o(ib\()o(d\))o(>\()o(\),)37 b("/stratego"\))527
3673 y(gcc)43 b(=)g(\\)g(args)f(->)h(<call>\("gcc",)38
b(args\))j(\\)527 3872 y(cc1)i(=)789 3972 y(where\(<printnl>)o(\(st)o
(de)o(rr,)37 b(["compiling"]\)\);)789 4071 y(\(list\(try\(CIncl)o(Dir)o
(\(?)o(cin)o(cl)o(\)\)\))o(,)g(id\);)789 4171 y(\(id,)42
b(where\(conc-stri)o(ngs)37 b(=>)43 b(cfile\);)1007 4271
y(\(id,)f(!".o"\);)1007 4370 y(where\(conc-stri)o(ngs)37
b(=>)43 b(target\);)1007 4470 y(where\(<gcc>)c(<conc>)i(\(cincl,["-c",)
d(cfile,"-o",)h(target]\)\)\))527 4669 y(cc2)k(=)789
4769 y(where\(<printnl>)o(\(st)o(de)o(rr,)37 b(["linking"]\)\);)789
4868 y(\(list\(try\(Dir\(?)o(dir)o(\))g(+)44 b(CLibDir\(?clib\))37
b(+)44 b(Output\(?out\)\)\),)37 b(id\);)789 4968 y(\(id,)42
b(where\(conc-stri)o(ngs)37 b(=>)43 b(ofile\);)1007 5068
y(\(try\(!out\),)c(!""\);)1007 5167 y(where\(conc-stri)o(ngs)e(=>)43
b(target\);)1007 5267 y(where\(<gcc>)c(<conc>\([ofile,)e("-o",)42
b(target],)1835 5367 y(<map\(split-at-sp)o(ac)o(e\))o(;)c(concat>)i
(clib\)\)\))1810 5662 y Fl(124)p eop
%%Page: 125 128
125 127 bop 440 199 a Fl(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)527 631 y Fe(remove-intermedia)o
(te)o(s)g(=)614 731 y(?\(base,)k(_\);)614 830 y(where\(<rzip\(conc-)o
(st)o(rin)o(gs)o(\);)c(rm-files>)963 930 y(\(base,)k([".tree",)f(".s",)
i(".so1",)e(".so2",)h(".i1",)g(".i",)h(".o"]\)\))1810
5662 y Fl(125)p eop
%%Page: 126 129
126 128 bop 440 199 a Fl(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)949 3112 y Fa(Run-Time)78
b(System)1810 5662 y Fl(126)p eop
%%Page: 127 130
127 129 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
531 y Fg(displa)-6 b(ys)32 b(vs)f(st)-6 b(a)g(tic)32
b(links)440 701 y Fl(Dealing)21 b(with)g(static)g(scop)r(e)g(requires)f
(k)n(eeping)g(trac)n(k)g(of)h(the)h(curren)n(tly)e(enclosing)g(scop)r
(e.)440 800 y(In)27 b(simple)g(cases)f(it)h(is)f(su\016cien)n(t)h(to)g
(tak)n(e)f(an)g(o\013set)h(from)g(the)g(top)f(of)h(the)g(en)n(vironmen)
n(t)440 900 y(stac)n(k.)440 1136 y Fe(environment[esp)37
b(-)44 b(o])440 1372 y Fl(But)25 b(when)f(sev)n(eral)e(activ)-5
b(ations)24 b(of)g(the)h(same)e(scop)r(e)h(can)g(b)r(e)h(created)e(due)
i(to)f(recursion,)440 1471 y(this)34 b(mec)n(hanism)e(fails)i(b)r
(ecause)f(the)g(static)g(o\013sets)g(to)h(v)-5 b(ariables)32
b(in)h(outer)g(scop)r(es)g(do)440 1571 y(not)28 b(corresp)r(ond)e(to)h
(the)h(dynamic)f(o\013sets)h(on)f(the)h(actual)f(stac)n(k.)440
1740 y(Common)e(solutions)g(for)h(this)g(problem)f(are)g(static)g
(links,)h(displa)n(ys)f(and)g(lam)n(b)r(da)h(lifting)440
1840 y(\(e.g.,)i([1)o(]\).)440 2009 y(Displa)n(ys)35
b(use)h(a)f(global)g(arra)n(y)e(that)j(giv)n(e)f(for)g(eac)n(h)g
(nesting)h(depth)g(the)g(most)g(recen)n(t)440 2109 y(activ)-5
b(ation)35 b(record)g(for)g(that)h(nesting)f(depth.)62
b(This)36 b(giv)n(es)e(fast)i(access)f(to)g(the)h(stac)n(k.)440
2208 y(Ho)n(w)n(ev)n(er,)25 b(it)j(turns)f(out)g(that)h(this)f(mec)n
(hanism)g(requires)f(a)h(lot)g(of)g(b)r(o)r(okk)n(eeping)f(and)h(it)440
2308 y(do)r(es)g(not)g(com)n(bine)g(w)n(ell)g(with)h(bac)n(ktrac)n
(king.)35 b(F)-7 b(or)26 b(eac)n(h)h(en)n(try)g(in)g(the)h(displa)n(y)e
(a)h(stac)n(k)440 2408 y(of)h(previous)e(activ)-5 b(ation)27
b(records)f(has)h(to)h(b)r(e)g(main)n(tained.)440 2577
y(A)d(static)g(link)g(is)f(a)h(reference)e(to)i(the)g(activ)-5
b(ation)24 b(record)g(of)g(the)i(previous)d(nesting)i(lev)n(el.)440
2677 y(Finding)36 b(a)g(stac)n(k)f(o\013set)h(using)g(static)g(links)f
(requires)g(follo)n(wing)g(the)i(links)f(un)n(til)g(the)440
2776 y(activ)-5 b(ation)27 b(record)f(of)i(the)g(righ)n(t)f(lev)n(el)g
(is)g(found.)440 2946 y(The)20 b(Stratego)e(run-time)i(system)f(uses)h
(static)f(links.)34 b(There)19 b(is)h(a)f(single)g(stac)n(k)g(that)h(k)
n(eeps)440 3045 y(trac)n(k)i(of)g(static)h(links.)35
b(A)23 b(static)g(link)g(consists)f(of)h(a)f(p)r(oin)n(ter)h(to)f(the)h
(en)n(vironmen)n(t)f(stac)n(k,)440 3145 y(the)36 b(nesting)e(depth)i
(and)f(a)g(p)r(oin)n(ter)f(to)h(the)h(static)f(link)g(of)g(the)h
(enclosing)e(activ)-5 b(ation)440 3244 y(record.)1810
5662 y(127)p eop
%%Page: 128 131
128 130 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.h)440 531 y Fe(/*)440 731
y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)
440 930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)k($Id:)f(stratego.h,v)c(1.2)43
b(2000/01/19)c(16:24:01)h(visser)h(Exp)i($)g(*/)440 2823
y(#include)d(<aterm2.h>)440 2922 y(#include)g("aterm-extension.)o(h")
440 3022 y(#include)g("debug.h")440 3122 y(#include)g("util.h")440
3221 y(#include)g("options.h")440 3321 y(#include)g("svm.h")1810
5662 y Fl(128)p eop
%%Page: 129 132
129 131 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(aterm-extension.h)440 531 y Fe(/*)440
731 y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g
(<visser@acm.org>)440 930 y(This)h(program)f(is)h(free)g(software;)e
(you)j(can)f(redistribute)c(it)43 b(and/or)e(modify)440
1029 y(it)i(under)e(the)i(terms)e(of)i(the)f(GNU)h(General)d(Public)h
(License)g(as)i(published)d(by)440 1129 y(the)i(Free)g(Software)f
(Foundation;)e(either)i(version)f(2,)j(or)g(\(at)f(your)g(option\))440
1229 y(any)g(later)g(version.)440 1428 y(This)g(program)f(is)h
(distributed)d(in)k(the)g(hope)e(that)h(it)h(will)f(be)h(useful,)440
1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e(without)h(even)h(the)g
(implied)f(warranty)f(of)440 1627 y(MERCHANTABILITY)d(or)43
b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)84 b(See)42
b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h(more)g
(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f(of)h
(the)f(GNU)g(General)f(Public)g(License)440 2026 y(along)h(with)f(this)
h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)g(Software)440
2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h(Suite)f(330,)g
(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440 2424
y(*/)440 2623 y(/*)k($Id:)f(aterm-extension)o(.h,)o(v)37
b(1.3)43 b(2000/02/19)c(12:23:28)h(visser)i(Exp)g($)h(*/)440
2823 y(#include)d(<aterm2.h>)440 3022 y(/*)j(Extension)d(of)i(ATerm)g
(library)f(*/)440 3221 y(#define)g(t_string\(t\))e(ATgetName\(ATgetS)o
(ym)o(bo)o(l\(t)o(\)\))440 3421 y(#define)i(t_is_appl\(t\))d
(\(ATgetType\(t\))h(==)j(AT_APPL\))440 3620 y(#define)f
(t_is_string\(t\))c(\(t_is_appl\(t\))i(&&)j(ATisQuoted\(ATgetS)o(ymb)o
(ol)o(\(t\))o(\)\))440 3819 y(#define)f(ATisReal\(t\))e
(\(ATgetType\(t\))f(==)43 b(AT_REAL\))440 3919 y(#define)e
(ATisInt\(t\))83 b(\(ATgetType\(t\))38 b(==)43 b(AT_INT\))440
4118 y(ATerm)f(list_to_consnil)o(\(A)o(Ter)o(m)37 b(t\);)440
4218 y(ATerm)42 b(list_to_tconstn)o(il)o(\(AT)o(er)o(m)c(t\);)440
4317 y(ATerm)k(list_to_consnil)o(_o)o(p\(A)o(Te)o(rmL)o(is)o(t)c(t\);)
440 4417 y(ATerm)k(list_to_consnil)o(_o)o(p_t)o(l\()o(ATe)o(rm)o(Lis)o
(t)37 b(t,)43 b(ATerm)f(tl\);)440 4516 y(ATerm)g(list_to_consnil)o(_s)o
(hal)o(lo)o(w\(A)o(Te)o(rm)37 b(t\);)440 4616 y(ATerm)42
b(list_to_tconstn)o(il)o(_op)o(\(A)o(Ter)o(mL)o(ist)37
b(t\);)440 4716 y(ATerm)42 b(consnil_to_list)o(\(A)o(Ter)o(m)37
b(t\);)440 4815 y(ATerm)42 b(consnil_to_list)o(_s)o(hal)o(lo)o(w\(A)o
(Te)o(rm)37 b(t\);)440 4915 y(ATerm)42 b(tuple_cong\(ATer)o(mL)o(ist)37
b(t\);)440 5015 y(ATerm)42 b(list_cong\(ATerm)o(Li)o(st)37
b(t,)43 b(ATerm)f(tl\);)440 5214 y(ATerm)g(ATmakeString\(ch)o(ar)37
b(*name\);)440 5313 y(ATerm)42 b(ATmakeStringQ\(c)o(ha)o(r)c(*name\);)
440 5413 y(ATbool)j(ATisString\(ATerm)c(t\);)1810 5662
y Fl(129)p eop
%%Page: 130 133
130 132 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(aterm-extension.h)440 531 y Fe(ATbool)k
(ATisThisString\(A)o(Ter)o(m)c(t,)43 b(char)f(*name\);)440
631 y(ATermList)e(ATmap\(ATermList)d(l,)43 b(ATerm)f(\(*)g
(f\)\(ATerm\)\);)440 731 y(ATbool)f(AThasName\(ATerm)c(t,)43
b(char)f(*name\);)440 930 y(ATerm)g(App0\(char)d(*name\);)440
1029 y(ATerm)j(App1\(char)d(*name,)i(ATerm)h(arg1\);)440
1129 y(ATerm)g(App2\(char)d(*name,)i(ATerm)h(arg1,)g(ATerm)f(arg2\);)
440 1229 y(ATerm)h(App3\(char)d(*name,)i(ATerm)h(arg1,)g(ATerm)f(arg2,)
h(ATerm)f(arg3\);)440 1328 y(ATerm)h(App4\(char)d(*name,)i(ATerm)h
(arg1,)g(ATerm)f(arg2,)h(ATerm)f(arg3,)h(ATerm)f(arg4\);)440
1528 y(ATerm)h(AppN\(char)d(*name,)i(ATermList)f(args\);)440
1727 y(#define)h(ATisInt\(t\))e(\(ATgetType\(t\))f(==)43
b(AT_INT\))1810 5662 y Fl(130)p eop
%%Page: 131 134
131 133 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(debug.h)440 531 y Fe(/*)440 731 y(Copyright)j
(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)440
930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)k(Booleans)d(*/)440 2723 y(#include)g
(<assert.h>)440 2922 y(#define)h(true)h(1)440 3022 y(#define)f(false)g
(0)440 3221 y(extern)g(int)h(debugging;)440 3421 y(/*)h(#define)d
(DEBUG)i(*/)440 3620 y(#define)f(toe\(t\))g(\(ATisEmpty\(t\))d(?)43
b(t)g(:)h(ATgetFirst\(t\)\))440 3819 y(#ifdef)d(DEBUG)440
3919 y(#define)g(trace\(x\))f(Trace\("",)g(x,)j(term_stack,)c
(return_stack,)f(environment,)g(\\)745 4018 y(choice_stack,)g
(lchoice_stack\))440 4118 y(#define)j(debug\(x\))f(Trace\(x,)g(-1,)j
(term_stack,)c(return_stack,)f(environment,)g(\\)745
4218 y(choice_stack,)g(lchoice_stack\))440 4317 y(#define)j
(debugs\(x\))f(if)i(\(debugging)e(>)j(1\))g(x)440 4417
y(#else)440 4516 y(#define)e(trace\(x\))440 4616 y(#define)g
(debug\(x\))440 4716 y(#define)g(debugs\(x\))440 4815
y(#endif)1810 5662 y Fl(131)p eop
%%Page: 132 135
132 134 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(util.h)440 531 y Fe(/*)440 731 y(Copyright)j(\(C\))
i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)440
930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(#ifndef)i(UTIL_H)440 2723 y(#define)g(UTIL_H)440
2922 y(#include)f(<string.h>)440 3122 y(#ifndef)h(streq)440
3221 y(#)87 b(define)41 b(streq\(s,t\))e(\(!\(strcmp\(s,t\)\)\))440
3321 y(#endif)440 3520 y(#ifndef)i(MIN)440 3620 y(#)87
b(define)41 b(MIN\(a,b\))f(\(\(a\))i(<)h(\(b\))g(?)g(\(a\))f(:)h
(\(b\)\))440 3719 y(#endif)440 3919 y(#ifndef)e(MAX)440
4018 y(#)87 b(define)41 b(MAX\(a,b\))f(\(\(a\))i(>)h(\(b\))g(?)g(\(a\))
f(:)h(\(b\)\))440 4118 y(#endif)440 4317 y(#define)e(IDX_TOTAL)650
b(0)440 4417 y(#define)41 b(IDX_MIN)738 b(1)440 4516
y(#define)41 b(IDX_MAX)738 b(2)440 4716 y(#define)41
b(STATS\(array,)d(value\))85 b(\\)527 4815 y(array[IDX_TOTAL])37
b(+=)43 b(value;)e(\\)527 4915 y(if\(value)f(<)k(array[IDX_MIN]\))37
b(\\)614 5015 y(array[IDX_MIN])h(=)43 b(value;)85 b(\\)527
5114 y(if\(value)40 b(>)k(array[IDX_MAX]\))37 b(\\)614
5214 y(array[IDX_MAX])h(=)43 b(value)1810 5662 y Fl(132)p
eop
%%Page: 133 136
133 135 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(util.h)440 531 y Fe(#define)k(MYMAXINT)f
(0x7FFFFFFF)440 731 y(#endif)1810 5662 y Fl(133)p eop
%%Page: 134 137
134 136 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(options.h)440 531 y Fe(/*)440 731
y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)
440 930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(#include)h(<aterm2.h>)440 2823 y(ATbool)h(silent;)
440 2922 y(char)h(*program_name;)440 3022 y(char)g(*input_file;)440
3122 y(char)g(*output_file;)440 3221 y(ATbool)f(binary_output;)440
3321 y(int)86 b(show_stats;)440 3421 y(ATermList)40 b(includes;)440
3620 y(void)i(process_options\()o(in)o(t)c(argc,)j(char)h(*argv[]\);)
1810 5662 y Fl(134)p eop
%%Page: 135 138
135 137 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Fe(/*)440 731 y(Copyright)j(\(C\))i
(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)440
930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)440 2823 y($Id:)j(svm.h,v)f(1.7)h(2000/06/12)d
(14:04:53)i(visser)g(Exp)h($)440 3022 y(Implementation)c(of)43
b(abstract)d(machine)h(instructions)d(for)k(strategy)f(core)h(language)
440 3221 y(TODO)440 3421 y(*)h(The)g(environment)c(is)j(not)h(saved)e
(before)g(a)i(choice.)e(This)h(means)g(that)g(some)527
3520 y(variables)e(can)i(become)f(instantiated)e(in)k(a)g(failing)e
(alternative)e(and)j(then)527 3620 y(not)h(be)f(restored)f(to)h
(unitialized.)440 3819 y(*)h(Make)f(stack)g(sizes)f(dynamic)g(or)i(at)f
(least)g(configurable)c(from)k(the)527 3919 y(command-line.)440
4118 y(*/)440 4317 y(#ifndef)f(__defined_strat)o(ego)o(_s)o(vm_)o(h)440
4417 y(#define)g(__defined_strat)o(ego)o(_s)o(vm_)o(h)440
4616 y(/*)i(Constants)d(for)i(stack-size)d(*/)440 4815
y(#define)i(TSIZE)g(15000)440 4915 y(#define)g(RSIZE)g(15000)440
5015 y(#define)g(ESIZE)g(15000)440 5114 y(#define)g(DSIZE)g(10000)440
5214 y(#define)g(CSIZE)g(15000)440 5313 y(#define)g(NR_COUNTERS)e(5000)
440 5413 y(#define)i(NR_RULECOUNTERS)c(5000)1810 5662
y Fl(135)p eop
%%Page: 136 139
136 138 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 631 y Fe(/*)43 b(Idiom)e(*/)440
830 y(#define)g(between\(a,)e(x,)k(b\))g(\(assert\(\(a\))c(<=)j
(\(x\)\),)g(assert\(\(x\))d(<=)k(\(b\)\)\))440 1029 y(/*)g(Error)e
(handling)g(*/)440 1229 y(#define)g(panic\(s\))f(ATfprintf\(stderr)o(,)
e("fatal)j(error:)g(\045s\\n",)g(s\);)h(exit\(1\);)440
1428 y(/*)h(Dispatching)c(*/)440 1627 y(#define)i(GO\(s\))g({register)f
(void)i(*a;)g(if\(\(a)g(=)h(s\))g(!=)g(NULL\))e(goto)h(*a;})440
1826 y(/*)h(Profiling)d(*/)440 2026 y(extern)h(int)h(rule_counter;)440
2125 y(extern)f(int)h(match_counter;)440 2225 y(extern)f(int)h
(build_counter;)440 2424 y(struct)f({)527 2524 y(char)h(*name;)527
2623 y(long)g(int)g(count;)440 2723 y(})h(rule_counters[NR_)o(RU)o(LE)o
(COU)o(NT)o(ERS)o(];)440 2922 y(long)f(int)g(cur_rule_counter;)440
3122 y(#define)f(CountRule\(f\))d(rule_counters[f].)o(co)o(unt)o(++)o
(;)g(rule_counter++;)440 3321 y(#define)j(RuleCounter\(s1,)c(s2,)42
b(n\))h(\\)571 3421 y(rule_counters[n])o(.n)o(am)o(e)38
b(=)43 b(s2;)f(rule_counters[n].)o(co)o(un)o(t)c(=)43
b(0;)440 3719 y(/*)g(Counters)d(*/)440 3919 y(struct)h({)527
4018 y(int)i(count;)527 4118 y(int)g(ok;)440 4218 y(})g
(counter_stack[NR_)o(CO)o(UN)o(TER)o(S])o(;)440 4317
y(long)f(int)g(cur_counter;)440 4516 y(#define)f(CounterInit\(\))81
b(cur_counter)40 b(=)j(-1)440 4716 y(#define)e(NewCounter\(\))82
b(assert\(cur_count)o(er)37 b(<)43 b(NR_COUNTERS)c(-)k(1\);)g(\\)1399
4815 y(cur_counter++;)38 b(\\)1399 4915 y(counter_stack[cu)o(r_)o(cou)o
(nt)o(er])o(.c)o(ou)o(nt)f(=)43 b(1;)g(\\)1399 5015 y(counter_stack[cu)
o(r_)o(cou)o(nt)o(er])o(.o)o(k)37 b(=)44 b(0;)440 5214
y(#define)d(CloseCounter\(\))81 b(cur_counter--;)440
5413 y(#define)41 b(CounterOK\(\))213 b(counter_stack[cu)o(r_c)o(ou)o
(nte)o(r])o(.o)o(k)38 b(=)43 b(1)1810 5662 y Fl(136)p
eop
%%Page: 137 140
137 139 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Fe(#define)k(IsCounterOK\(\))125
b(counter_stack[cu)o(r_c)o(ou)o(nte)o(r])o(.o)o(k)440
731 y(#define)41 b(TheCounter\(\))169 b(\(counter_stack[c)o(ur_)o(co)o
(unt)o(er)o(].)o(cou)o(nt)o(\))440 830 y(#define)41 b(IncCounter\(\))
169 b(TheCounter\(\)++)440 930 y(#define)41 b(DecCounter\(\))169
b(TheCounter\(\)--)440 1029 y(#define)41 b(SetCounter\(i\))125
b(TheCounter\(\))39 b(=)k(i)440 1229 y(/*)g(Term)f(stack)f(*/)440
1428 y(ATerm)h(term_stack[TSIZ)o(E])o(;)440 1528 y(long)g(int)g(tsp;)
440 1727 y(/*)h(The)f(stackpointer)d(tsp)j(points)f(to)i(the)f(element)
f(on)i(top)f(of)h(the)f(stack)g(*/)440 1926 y(#define)f(Ttop\(\))302
b(\(term_stack[tsp]\))440 2026 y(#define)41 b(Ttopi\(i\))214
b(\(term_stack[tsp)38 b(-)43 b(\(i\)]\))440 2125 y(#define)e(Tset\(t\))
258 b(assert\(\(t\))40 b(!=)j(NULL\);)e(Ttop\(\))g(=)i(\(t\))440
2225 y(#define)e(Tseti\(i,)f(t\))86 b(assert\(\(t\))40
b(!=)j(NULL\);)e(Ttopi\(i\))f(=)j(\(t\))440 2325 y(#define)e(Tpush\(\))
258 b(assert\(tsp)40 b(<)j(TSIZE\);)e(tsp++;)g(Ttop\(\))g(=)i(NULL)440
2424 y(#define)e(Tpop\(\))302 b(assert\(tsp)40 b(>)j(0\);)f(tsp--)440
2524 y(#define)f(Tdupl\(\))258 b(Tpush\(\);)41 b(Tset\(Ttopi\(1\)\))440
2623 y(#define)g(Tduplinv\(\))126 b(Tseti\(1,)41 b(Ttop\(\)\);)440
2723 y(#define)g(Tdrop\(\))258 b(Tseti\(1,)41 b(Ttop\(\)\);)f(Tpop\(\))
440 2823 y(#define)h(Tinitst\(\))170 b(tsp)43 b(=)g(0;)g(Ttop\(\))e(=)i
(NULL)440 3022 y(#define)e(Tswap\(i,)f(j\))86 b({ATerm)41
b(t;)i(t)g(=)h(Ttopi\(i\);)39 b(Tseti\(i,)i(Ttopi\(j\)\);)e(Tseti\(j,)h
(t\);})440 3221 y(#define)h(Arg\(n\))302 b(Tpush\(\);)41
b(Tset\(ATgetArgum)o(ent)o(\(T)o(to)o(pi\()o(1\))o(,)d(n\)\))440
3421 y(#define)j(Argi\(i,)f(n\))130 b(Tpush\(\);)41 b(Tset\(ATgetArgum)
o(ent)o(\(T)o(to)o(pi\()o(i\))o(,)d(n\)\))440 3620 y(void)k
(TprintStack\(void)o(\);)440 3719 y(void)g(TprintStackTop\(i)o(nt)37
b(j,)43 b(char)f(*s\);)440 3919 y(/*)h(Return)e(stack)g(*/)440
4118 y(void)h(*return_stack[RS)o(IZ)o(E];)440 4218 y(long)g(int)g(rsp;)
440 4417 y(void)g(*fail_address;)440 4516 y(ATbool)f(failed;)440
4716 y(/*)i(rsp)f(points)f(to)i(the)f(next)g(*free*)f(element)g(of)i
(the)f(return)f(stack)h(*/)440 4915 y(#define)f(Rpush\(l\))f(\\)527
5015 y(if\(rsp)h(>=)i(RSIZE\))e({)i(\\)614 5114 y(ATfprintf\(stderr,)37
b("Fatal)k(error:)g(loop)h(detected")e(\\)702 5214 y(")j(\(rstack)d
(overflow;)g(rsp)j(=)g(\045d\)\\n",)d(rsp\);)i(\\)614
5313 y(assert\(rsp)e(<)j(RSIZE\);)e(\\)527 5413 y(})i
(return_stack[rsp+)o(+])37 b(=)43 b(&&l;)1810 5662 y
Fl(137)p eop
%%Page: 138 141
138 140 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Fe(#define)k(Return\(\))f(goto)i
(*\(return_stack[-)o(-r)o(sp])o(\))440 731 y(/*)h(Environment)c(stack)i
(*/)440 930 y(ATerm)h(environment[ESI)o(ZE)o(];)440 1029
y(long)g(int)g(esp;)440 1229 y(/*)h(esp)f(points)f(to)i(the)f(next)g
(*free*)f(element)g(in)i(the)f(environment)d(*/)440 1428
y(#define)i(Einit\(\))171 b(esp)42 b(=)i(0;)440 1627
y(#define)d(Ei\(i\))259 b(\(esp)42 b(-)h(\(i\)\))440
1826 y(#define)e(Eget\(i\))171 b(\(between\(0,)39 b(Ei\(i\),)i
(ESIZE\),)g(environment[Ei\(i)o(\)]\))440 1926 y(#define)g(Eset\(i,)f
(t\))j(\(between\(0,)c(Ei\(i\),)i(ESIZE\),)g(environment[Ei\(i)o(\)])c
(=)43 b(\(t\)\))440 2125 y(#define)e(Egeta\(i\))171 b(\(between\(0,)39
b(i,)k(ESIZE\),)d(environment[i]\))440 2225 y(#define)h(Eseta\(i,)f
(t\))j(\(between\(0,)c(i,)k(ESIZE\),)d(environment[i])e(=)43
b(\(t\)\))440 2424 y(#define)e(Enext\(\))171 b({assert\(esp)39
b(<)k(ESIZE\);)e(environment[esp+)o(+])c(=)43 b(NULL;})440
2524 y(#define)e(Eprev\(\))171 b({assert\(esp)39 b(<)k(ESIZE\);)e
(environment[--es)o(p])c(=)43 b(NULL;})440 2723 y(#define)e(Epush\(i\))
127 b({int)42 b(j;)h(for\(j)e(=)j(0;)e(j)h(<)h(i;)e(j++\))g
({Enext\(\);}})440 2823 y(#define)f(Epop\(i\))171 b({int)42
b(j;)h(for\(j)e(=)j(0;)e(j)h(<)h(i;)e(j++\))g({Eprev\(\);}})440
3022 y(void)g(EprintStack\(void)o(\);)440 3221 y(/*)h(Display)d(stack)i
(*/)440 3421 y(long)g(int)g(display[DSIZE];)440 3520
y(int)g(dsp;)440 3719 y(long)g(int)g(Ed\(int)f(i,)i(int)f(o\);)440
3919 y(#define)f(Egetd\(i,)f(o\))173 b(Egeta\(Ed\(i,)40
b(o\)\))440 4018 y(#define)h(Esetd\(i,)f(o,)j(t\))f(Eseta\(Ed\(i,)e
(o\),)i(t\))440 4218 y(#define)f(D\(i\))85 b(display)440
4417 y(#define)41 b(DgetEsp\(\))257 b(display_stack[dsp)o(].e)o(sp)440
4516 y(#define)41 b(DsetEsp\(i\))213 b(display_stack[dsp)o(].e)o(sp)37
b(=)43 b(i)440 4716 y(void)f(Epushd\(int)d(i,)k(int)f(o\);)440
4815 y(void)g(Epopd\(int)e(i,)j(int)f(o\);)440 4915 y(void)g
(Dinit\(void\);)440 5015 y(void)g(Drestore\(void\);)440
5214 y(/*)h(Matching)d(*/)440 5413 y(void)i(*_MatchVar\(int)c(i\);)1810
5662 y Fl(138)p eop
%%Page: 139 142
139 141 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Fe(void)42 b(*_MatchVard\(int)37
b(i,)43 b(long)f(int)g(o\);)440 631 y(void)g(*_MatchInt\(int)c(i\);)440
731 y(void)k(*_MatchIntFC\(int)37 b(i,)43 b(void)f(*\);)440
830 y(void)g(*_MatchReal\(doub)o(le)37 b(i\);)440 930
y(void)42 b(*_MatchRealFC\(do)o(ub)o(le)37 b(i,)43 b(void)f(*\);)440
1029 y(void)g(*_MatchString\(ch)o(ar)37 b(*s\);)440 1129
y(void)42 b(*_MatchStringFC\()o(ch)o(ar)37 b(*s,)43 b(void)f(*\);)440
1229 y(void)g(*_MatchFun\(char)37 b(*f,)43 b(int)f(n\);)440
1328 y(void)g(*_MatchFunFC\(cha)o(r)37 b(*f,)43 b(int)f(n,)h(void)f
(*fc\);)440 1528 y(#define)f(MatchVar\(i\))431 b(GO\(_MatchVar\(i\)\))
440 1627 y(#define)41 b(MatchVard\(i,)d(o\))261 b(GO\(_MatchVard\(i,)37
b(o\)\))440 1727 y(#define)k(MatchInt\(i\))431 b(GO\(_MatchInt\(i\)\))
440 1826 y(#define)41 b(MatchIntFC\(i,)d(fc\))173 b(GO\(_MatchIntFC\(i)
o(,)38 b(fc\)\))440 1926 y(#define)j(MatchReal\(i\))387
b(GO\(_MatchReal\(i\))o(\))440 2026 y(#define)41 b(MatchRealFC\(i,)c
(fc\))130 b(GO\(_MatchRealFC\()o(i,)37 b(fc\)\))440 2125
y(#define)k(MatchString\(s\))299 b(GO\(_MatchString\()o(s\)\))440
2225 y(#define)41 b(MatchStringFC\(s)o(,)d(fc\))k(GO\(_MatchStringF)o
(C\(s)o(,)37 b(fc\)\))440 2325 y(#define)k(MatchFun\(f,)e(n\))304
b(GO\(_MatchFun\(f,)37 b(n\)\))440 2424 y(#define)k(MatchFunFC\(f,)d
(n,)43 b(fc\))f(GO\(_MatchFunFC\(f)o(,)c(n,)k(fc\)\))440
2623 y(/*)h(Building)d(*/)440 2823 y(#define)h(BuildVar\(i\))e(\\)527
2922 y({ATerm)i(t;)i(\\)571 3022 y(if\(\(t)e(=)i(Eget\(i\)\))e(==)h
(NULL\))g({)h(\\)658 3122 y(/*)g(ATfprintf\(stder)o(r,)37
b("Warning:)j(unbound)h(variable)f(\(\045d\)\\n",)g(i\);)j(*/)f(\\)658
3221 y(goto)g(*fail_address;)c(\\)571 3321 y(})43 b(else)f
({Tset\(t\);}})440 3520 y(#define)f(BuildVard\(i,)d(o\))43
b(\\)527 3620 y({ATerm)e(t;)i(\\)571 3719 y(if\(\(t)e(=)i(Egetd\(i,)e
(o\)\))h(==)h(NULL\))e({)j(\\)658 3819 y(/*)f(ATfprintf\(stder)o(r,)37
b("Warning:)j(unbound)h(variable)f(\(\045d,)i(\045d\)\\n",)f(i,)h(o\);)
h(*/)g(\\)658 3919 y(goto)f(*fail_address;)c(\\)571 4018
y(})43 b(else)f({Tset\(t\);}})440 4218 y(#define)f(BuildStr\(s\))e(\\)
527 4317 y(Tset\(ATmakeString)o(\(s)o(\)\))440 4516 y(#define)i
(BuildInt\(i\))e(\\)527 4616 y(Tset\(\(ATerm\))g(ATmakeInt\(i\)\))440
4815 y(#define)i(BuildReal\(r\))d(\\)527 4915 y(Tset\(\(ATerm\))h
(ATmakeReal\(r\)\))440 5114 y(void)j(BuildFun\(char)c(*f,)k(int)h(i\);)
440 5313 y(/*)g(Annotations)c(*/)1810 5662 y Fl(139)p
eop
%%Page: 140 143
140 142 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)440 531 y Fe(#define)k(GetAnn\(\))f(\\)440
631 y({ATerm)h(x;)i(\\)484 731 y(if\(\(x)e(=)i(ATgetAnnotation\(T)o(to)
o(pi\()o(1\))o(,)38 b(Ttop\(\)\)\))i(==)j(NULL\))e(\\)527
830 y({)i(goto)f(*fail_address;)c(})43 b(\\)484 930 y(else)f({)h
(Tset\(x\);)d(})j(\\)440 1029 y(})440 1229 y(#define)e(SetAnn\(\))f(\\)
484 1328 y(Tseti\(2,)g(ATsetAnnotation\()o(Tt)o(opi)o(\(2)o(\),)d
(Ttopi\(1\),)j(Ttop\(\)\)\);)g(Tpop\(\);)h(Tpop\(\))440
1528 y(#define)g(RemoveAnn\(\))e(\\)527 1627 y(Tseti\(1,)h
(ATremoveAnnotatio)o(n\(T)o(to)o(pi\()o(1\))o(,)d(Ttop\(\)\)\);)j
(Tpop\(\);)440 1826 y(/*)j(Choice)e(stack)g(*/)440 2026
y(struct)g({)527 2125 y(long)h(int)g(tsp;)527 2225 y(long)g(int)g(esp;)
527 2325 y(long)g(int)g(rsp;)527 2424 y(long)g(int)g(counter;)527
2524 y(void)173 b(*continuation;)527 2623 y(int)260 b(dsp;)440
2723 y(})43 b(choice_stack[CSIZ)o(E])o(;)440 2823 y(long)f(int)g(csp;)
440 3022 y(/*)h(csp)f(points)f(to)i(the)f(next)g(free)g(choice)f(stack)
h(entry)f(*/)440 3221 y(#define)g(Cset\(cont,)e(a,)k(b,)g(c,)f(d,)h
(e\))g(\\)440 3321 y({)g(\\)527 3421 y(choice_stack[csp])o(.c)o(on)o
(tin)o(ua)o(tio)o(n)37 b(=)44 b(cont;)d(\\)527 3520 y
(choice_stack[csp])o(.t)o(sp)c(=)43 b(a;)g(\\)527 3620
y(choice_stack[csp])o(.e)o(sp)37 b(=)43 b(b;)g(\\)527
3719 y(choice_stack[csp])o(.r)o(sp)37 b(=)43 b(c;)g(\\)527
3819 y(choice_stack[csp])o(.c)o(ou)o(nte)o(r)37 b(=)44
b(d;)e(\\)527 3919 y(choice_stack[csp])o(.d)o(sp)37 b(=)43
b(e;)g(\\)440 4018 y(})440 4218 y(#define)e(Cpush\(x\))f(\\)440
4317 y({)j(\\)527 4417 y(assert\(csp)d(<)j(CSIZE\);)d(\\)527
4516 y(Cset\(&&x,)g(tsp,)i(esp,)g(rsp,)g(cur_counter,)c(dsp\);)k(\\)527
4616 y(csp++;)f(Tdupl\(\);)g(\\)440 4716 y(})440 4915
y(#define)g(Cpop\(\))84 b(Tdrop\(\);)41 b(csp--;)440
5114 y(#define)g(Crestore\(\))83 b(\\)440 5214 y({)43
b(\\)527 5313 y(csp--;)e(\\)527 5413 y(tsp)i(=)g(choice_stack[cs)o(p].)
o(ts)o(p;)37 b(\\)1810 5662 y Fl(140)p eop
%%Page: 141 144
141 143 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)527 531 y Fe(esp)43 b(=)g(choice_stack[cs)o
(p].)o(es)o(p;)37 b(\\)527 631 y(rsp)43 b(=)g(choice_stack[cs)o(p].)o
(rs)o(p;\\)527 731 y(dsp)g(=)g(choice_stack[cs)o(p].)o(ds)o(p;)37
b(\\)527 830 y(cur_counter)i(=)k(choice_stack[csp])o(.co)o(un)o(te)o
(r;)37 b(\\)440 930 y(})440 1129 y(#define)k(Cjump\(\))f({goto)i
(*choice_stack[cs)o(p])o(.co)o(nt)o(inu)o(at)o(io)o(n;})440
1328 y(#define)f(Cempty\(\))f(\(csp)i(==)h(0\))440 1528
y(/*)g(Path)f(Traversal)e(*/)440 1727 y(#define)h(IsAppl\(\))f
(if\(!t_is_appl\(Tt)o(op\()o(\)\))o(\))d({goto)42 b(*fail_address;};)
440 1926 y(#define)f(TpushIthSon\(i\))c(Tpush\(\);)k(Tset\(ATgetArgume)
o(nt)o(\(T)o(top)o(i\()o(1\),)c(i)43 b(-)g(1\)\);)440
2125 y(#define)e(TputIthSon\(i\))d(Tseti\(1,)i(ATsetArgument\(Tto)o(pi)
o(\(1)o(\),)d(Ttop\(\),)k(i)i(-)g(1\)\);)f(Tpop\(\);)440
2325 y(/*)h(Traversal)d(*/)440 2524 y(void)i(TravInit\(\);)440
2623 y(void)g(*_NextSon\(void)c(*on_empty\);)440 2723
y(void)k(*_SomeNextSon\(vo)o(id)37 b(*s\);)440 2823 y(void)42
b(TravBuild\(void\);)440 3022 y(#define)f(NextSon\(x\))213
b(GO\(_NextSon\(x\)\))440 3122 y(#define)41 b(SomeNextSon\(x\))c
(GO\(_SomeNextSon\(x)o(\)\))440 3321 y(#define)k(AllInit\(\))257
b(TravInit\(\))440 3421 y(#define)41 b(AllNextSon\(s\))81
b(NextSon\(s\))440 3520 y(#define)41 b(AllBuild\(\))213
b(TravBuild\(\))440 3719 y(#define)41 b(OneInit\(\))257
b(TravInit\(\))440 3819 y(#define)41 b(OneNextSon\(\))125
b(NextSon\(fail_addr)o(ess)o(\))440 3919 y(#define)41
b(OneBuild\(\))213 b(TravBuild\(\))440 4118 y(#define)41
b(SomeInit\(\))213 b(TravInit\(\))440 4218 y(#define)41
b(SomeBuild\(\))169 b(TravBuild\(\))440 4417 y(#define)41
b(ThreadInit\(\))82 b(\\)571 4516 y(MatchFun\("Pair",)37
b(2\);)42 b(\\)571 4616 y(Arg\(1\);)e(\\)571 4716 y(Argi\(2,0\);)f(\\)
571 4815 y(TravInit\(\);)440 5015 y(#define)i(ThreadNextSon\(s)o(\))d
(\\)571 5114 y(NextSon\(s\);)h(\\)571 5214 y(Tpush\(\);)h(\\)571
5313 y(Tset\(Ttopi\(TheCo)o(un)o(te)o(r\(\))d(+)43 b(3\)\);)f(\\)571
5413 y(Tpush\(\);)e(\\)1810 5662 y Fl(141)p eop
%%Page: 142 145
142 144 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
299 y(Section:)37 b(svm.h)571 531 y Fe(BuildFun\("Pair",)g(2\);)440
731 y(#define)k(ThreadSetEnv\(\))c(\\)571 830 y(MatchFun\("Pair",)o
(2\))o(;)g(\\)571 930 y(Arg\(0\);)j(\\)571 1029 y(Argi\(2,)g(1\);)j(\\)
571 1129 y(Tseti\(TheCounter)o(\(\))37 b(+)43 b(4,)g(Ttop\(\)\);)d(\\)
571 1229 y(Tpop\(\);)g(\\)571 1328 y(Tdrop\(\);)440 1528
y(#define)h(ThreadGetEnv\(\))c(ThreadSetEnv\(\))440 1727
y(#define)k(ThreadBuild\(\))81 b(\\)571 1826 y(TravBuild\(\);)38
b(\\)571 1926 y(Tswap\(0,1\);)h(\\)571 2026 y(Tpush\(\);)h(\\)571
2125 y(BuildFun\("Pair",)d(2\);)42 b(\\)571 2225 y(Tdrop\(\);)440
2424 y(void)g(MatchTravInit\(\);)440 2524 y(void)g(*_MatchNextSon\(v)o
(oi)o(d)c(*on_empty\);)440 2723 y(#define)j(OneMatchNextSon)o(\(\))c
(GO\(_MatchNextSon\()o(fa)o(il_)o(ad)o(dr)o(ess)o(\)\))440
2823 y(#define)k(MatchTravEnd\(\))81 b({Tpop\(\);)40
b(CloseCounter\(\);})440 3022 y(/*)j(Procedure)d(header)h(and)h(footer)
f(*/)440 3221 y(#define)g(DOIT_START)e(\\)440 3321 y(\\)440
3421 y(ATerm)j(doit\(ATerm)d(t\))k(\\)440 3520 y({)g(\\)527
3620 y(Tinitst\(\);)d(Einit\(\);)g(CounterInit\(\);)e(Tset\(t\);)i
(fail_address)f(=)k(&&fail;)440 3819 y(#define)e(DOIT_END)f(\\)440
3919 y(\\)527 4018 y(return\(Ttop\(\)\);)e(\\)527 4118
y(fail)k(:)h(\\)614 4218 y(if\(!Cempty\(\)\))c({Crestore\(\);)f
(Cjump\(\);})i(\\)614 4317 y(else)i({failed)f(=)i(ATtrue;)e(return)g
(Ttop\(\);})f(\\)527 4417 y(exit\(1\);)g(\\)440 4516
y(})440 4716 y(#endif)1810 5662 y Fl(142)p eop
%%Page: 143 146
143 145 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 531 y Fe(/*)440 731
y(Copyright)j(\(C\))i(1998,)g(1999)g(Eelco)f(Visser)g(<visser@acm.org>)
440 930 y(This)h(program)f(is)h(free)g(software;)e(you)j(can)f
(redistribute)c(it)43 b(and/or)e(modify)440 1029 y(it)i(under)e(the)i
(terms)e(of)i(the)f(GNU)h(General)d(Public)h(License)g(as)i(published)d
(by)440 1129 y(the)i(Free)g(Software)f(Foundation;)e(either)i(version)f
(2,)j(or)g(\(at)f(your)g(option\))440 1229 y(any)g(later)g(version.)440
1428 y(This)g(program)f(is)h(distributed)d(in)k(the)g(hope)e(that)h(it)
h(will)f(be)h(useful,)440 1528 y(but)f(WITHOUT)f(ANY)h(WARRANTY;)e
(without)h(even)h(the)g(implied)f(warranty)f(of)440 1627
y(MERCHANTABILITY)d(or)43 b(FITNESS)e(FOR)h(A)h(PARTICULAR)d(PURPOSE.)
84 b(See)42 b(the)440 1727 y(GNU)g(General)f(Public)g(License)g(for)h
(more)g(details.)440 1926 y(You)g(should)f(have)h(received)f(a)i(copy)f
(of)h(the)f(GNU)g(General)f(Public)g(License)440 2026
y(along)h(with)f(this)h(program;)f(if)h(not,)g(write)g(to)h(the)f(Free)
g(Software)440 2125 y(Foundation,)d(Inc.,)j(59)g(Temple)f(Place)h(-)h
(Suite)f(330,)g(Boston,)e(MA)440 2225 y(02111-1307,)f(USA.)440
2424 y(*/)440 2623 y(/*)440 2823 y($Id:)j(stratego.c,v)d(1.5)j
(2000/06/12)d(14:04:53)i(visser)g(Exp)h($)440 3022 y(Implementation)c
(of)43 b(abstract)d(machine)h(instructions)d(for)k(stragegy)440
3122 y(primitives.)d(See)j(strategy.h)e(for)i(more)g(documentation.)440
3321 y(*/)440 3520 y(#include)e(<aterm2.h>)440 3620 y(#include)g
("stratego.h")440 3819 y(#define)h(ATmakeSymbol)d(ATmakeAFun)440
4018 y(ATbool)j(ATfindSymbol\(cha)o(r)d(*name,)j(int)h(arity,)f(ATbool)
g(quoted\);)440 4218 y(/*)i(Profiling)d(*/)440 4417 y(int)i
(rule_counter)d(=)k(0;)440 4516 y(int)f(match_counter)d(=)k(0;)440
4616 y(int)f(build_counter)d(=)k(0;)440 4716 y(ATbool)e(failed)g(=)i
(false;)440 4915 y(/*)g(Term)f(stack)f(*/)440 5114 y(void)h
(TprintStack\(void)o(\))440 5214 y({)527 5313 y(TprintStackTop\(ts)o
(p,)37 b(""\);)440 5413 y(})1810 5662 y Fl(143)p eop
%%Page: 144 147
144 146 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 631 y Fe(void)42 b
(TprintStackTop\(i)o(nt)37 b(j,)43 b(char)f(*s\))440
731 y({)527 830 y(int)h(i;)527 930 y(ATfprintf\(stderr,)37
b("tsp)42 b(=)h(\045d)g(\045s\\n",)e(tsp,)h(s\);)527
1029 y(for\(i)g(=)h(tsp;)f(i)h(>=)g(tsp)f(-)h(j)g(&&)g(i)g(>=)g(0;)g
(i--\))f({)614 1129 y(if\(term_stack[i])37 b(==)43 b(NULL\))702
1229 y(ATfprintf\(stder)o(r,)37 b(")87 b(ts[\045d])41
b(=)i(NULL)f(\(\045d\)\\n",)e(i,)j(tsp)f(==)h(i\);)614
1328 y(else)702 1428 y(ATfprintf\(stder)o(r,)37 b(")87
b(ts[\045d])41 b(=)i(\045t)g(\(\045d\)\\n",)127 b(i,)43
b(term_stack[i],)38 b(tsp)k(==)h(i\);)527 1528 y(})440
1627 y(})440 1826 y(/*)g(Environment)c(stack)i(*/)440
2026 y(void)h(EprintStack\(void)o(\))440 2125 y({)527
2225 y(int)h(i;)527 2325 y(ATfprintf\(stdout,)37 b("esp)42
b(=)h(\045d\\n",)e(esp\);)527 2424 y(for\(i)h(=)h(0;)g(i)g(<=)g(esp;)e
(i++\))h({)614 2524 y(if\(environment[i])37 b(==)43 b(NULL\))702
2623 y(ATfprintf\(stdou)o(t,)37 b(")87 b(es[\045d])41
b(=)i(NULL)f(\(\045d\)\\n",)e(i,)j(esp)f(==)h(i\);)614
2723 y(else)702 2823 y(ATfprintf\(stdou)o(t,)37 b(")87
b(es[\045d])41 b(=)i(\045t)g(\(\045d\)\\n",)127 b(i,)43
b(environment[i],)37 b(esp)43 b(==)g(i\);)527 2922 y(})440
3022 y(})440 3221 y(/*)g(Display)d(stack)i(*/)440 3421
y(int)g(max_nesting)d(=)44 b(-1;)440 3620 y(#define)d(Desp\(x\))215
b(display[x])440 3719 y(#define)41 b(Dnesting\(x\))e(display[x)h(-)j
(1])440 3819 y(#define)e(Dnext\(x\))171 b(display[x)40
b(-)j(2])440 4018 y(void)f(Dinit\(void\))440 4118 y({)527
4218 y(dsp)h(=)g(-1;)440 4317 y(})440 4516 y(int)f(dframe\(int)e(i\))
440 4616 y({)527 4716 y(int)j(x;)527 4815 y(x)g(=)h(dsp;)527
4915 y(while\(x)d(>=)i(2)g(&&)g(Dnesting\(x\))c(>)k(i\))614
5015 y(x)h(=)f(Dnext\(x\);)527 5114 y(return)e(Dnesting\(x\))e(==)k(i)g
(?)g(x)h(:)f(-1;)440 5214 y(})440 5413 y(long)f(int)g(Ed\(int)f(i,)i
(int)f(o\))1810 5662 y Fl(144)p eop
%%Page: 145 148
145 147 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 531 y Fe({)527 631
y(int)43 b(x;)527 731 y(x)g(=)h(display[dframe\()o(i\))o(])38
b(-)43 b(o;)527 830 y(//ATfprintf\(stder)o(r,)37 b("Ed\(\045d,)k
(\045d\))h(=)h(\045d)g(\(frame)e(=)i(\045d\)\\n",)e(i,)i(o,)f(x,)h
(dframe\(i\)\);)527 930 y(return)e(x;)440 1029 y(})440
1229 y(void)h(Epushd\(int)d(i,)k(int)f(o\))440 1328 y({)527
1428 y(int)h(x)g(=)g(dframe\(i)d(-)j(1\);)527 1528 y(Epush\(o\);)527
1627 y(dsp)g(+=)f(3;)527 1727 y(Desp\(dsp\))214 b(=)44
b(esp;)527 1826 y(Dnesting\(dsp\))38 b(=)44 b(i;)527
1926 y(Dnext\(dsp\))170 b(=)44 b(x;)527 2026 y(//ATfprintf\(stder)o(r,)
37 b("Epushd\(\045d,)i(\045d\))j(:)h(x)h(=)f(\045d)g(dsp)f(=)h
(\045d\\n",)e(i,)i(o,)g(x,)f(dsp\);)440 2125 y(})440
2325 y(void)g(Epopd\(int)e(i,)j(int)f(o\))440 2424 y({)527
2524 y(assert\(Desp\(dsp\))37 b(==)43 b(esp\);)527 2623
y(assert\(Dnesting\(d)o(sp)o(\))37 b(==)43 b(i\);)527
2723 y(Epop\(o\);)527 2823 y(dsp)g(-=)f(3;)527 2922 y
(//ATfprintf\(stder)o(r,)37 b("Epopd\(\045d,)i(\045d\))k(:)g(dsp)f(=)h
(\045d\\n",)e(i,)i(o,)g(dsp\);)440 3022 y(})440 3221
y(void)f(Drestore\(void\))440 3321 y({)440 3421 y(})440
3620 y(/*)h(Matching)d(*/)440 3819 y(void)i(*_MatchVar\(int)c(i\))440
3919 y({)527 4018 y(if\(Eget\(i\))i(==)i(NULL\))g({Eset\(i,)e
(Ttop\(\)\);})527 4118 y(else)i(if\(!ATisEqual\(Eg)o(et\()o(i\))o(,)c
(Ttop\(\)\)\))i({return)h(fail_address;})527 4218 y(return)g(NULL;)440
4317 y(})440 4516 y(void)h(*_MatchVard\(int)37 b(i,)43
b(long)f(int)g(o\))440 4616 y({)527 4716 y(if\(Egetd\(i,)d(o\))k(==)g
(NULL\))e({Esetd\(i,)f(o,)j(Ttop\(\)\);})527 4815 y(else)f
(if\(!ATisEqual\(Eg)o(etd)o(\(i)o(,)c(o\),)k(Ttop\(\)\)\))e({return)h
(fail_address;})527 4915 y(return)g(NULL;)440 5015 y(})440
5214 y(void)h(*_MatchInt\(int)c(i\))440 5313 y({)527
5413 y(if\(\(ATgetType\(Tto)o(p\()o(\)\))f(!=)43 b(AT_INT\))e(||)h
(\(ATgetInt\(\(ATermI)o(nt)o(\))c(Ttop\(\)\))i(!=)j(i\)\))1810
5662 y Fl(145)p eop
%%Page: 146 149
146 148 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)614 531 y Fe({return)k(fail_address;})
527 631 y(return)g(NULL;)440 731 y(})440 930 y(void)h
(*_MatchIntFC\(int)37 b(i,)43 b(void)f(*fc\))440 1029
y({)527 1129 y(if\(\(ATgetType\(Tto)o(p\()o(\)\))37 b(!=)43
b(AT_INT\))e(||)h(\(ATgetInt\(\(ATermI)o(nt)o(\))c(Ttop\(\)\))i(!=)j
(i\)\))614 1229 y({return)e(fc;})527 1328 y(return)g(NULL;)440
1428 y(})440 1627 y(void)h(*_MatchReal\(doub)o(le)37
b(i\))440 1727 y({)527 1826 y(if\(\(ATgetType\(Tto)o(p\()o(\)\))g(!=)43
b(AT_REAL\))d(||)j(\(ATgetReal\(\(ATer)o(mR)o(eal)o(\))37
b(Ttop\(\)\))k(!=)i(i\)\))614 1926 y({return)e(fail_address;})527
2026 y(return)g(NULL;)440 2125 y(})440 2325 y(void)h(*_MatchRealFC\(do)
o(ub)o(le)37 b(i,)43 b(void)f(*fc\))440 2424 y({)527
2524 y(if\(\(ATgetType\(Tto)o(p\()o(\)\))37 b(!=)43 b(AT_REAL\))d(||)j
(\(ATgetReal\(\(ATer)o(mR)o(eal)o(\))37 b(Ttop\(\)\))k(!=)i(i\)\))614
2623 y({return)e(fc;})527 2723 y(return)g(NULL;)440 2823
y(})440 3022 y(void)h(*_MatchString\(ch)o(ar)37 b(*s\))440
3122 y({)527 3221 y(if\(!ATisThisStrin)o(g\()o(Tt)o(op\()o(\),)g(s\)\))
614 3321 y({return)k(fail_address;})527 3421 y(return)g(NULL;)440
3520 y(})440 3719 y(void)h(*_MatchStringFC\()o(ch)o(ar)37
b(*s,)43 b(void)f(*fc\))440 3819 y({)527 3919 y(if\(!ATisThisStrin)o
(g\()o(Tt)o(op\()o(\),)37 b(s\)\))614 4018 y({return)k(fc;})527
4118 y(return)g(NULL;)440 4218 y(})440 4417 y(void)h(*_MatchFun\(char)
37 b(*f,)43 b(int)f(n\))440 4516 y({)527 4616 y(assert\(Ttop\(\))c(!=)
43 b(NULL\);)527 4716 y(//ATfprintf\(stder)o(r,)37 b
("_MatchFun\(\045s,)h(\045d\)\\n",)i(f,)j(n\);)527 4815
y(if\(!t_is_appl\(Tto)o(p\()o(\)\))658 4915 y(||)g(ATgetArity\(ATge)o
(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o(\))37 b(!=)43 b(n)658
5015 y(||)g(strcmp\(ATgetNam)o(e\(A)o(Tg)o(etS)o(ym)o(bol)o(\(T)o(to)o
(p\(\))o(\)\))o(,)38 b(f\))k(!=)h(0)658 5114 y(||)g(ATisQuoted\(ATge)o
(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o(\)\))614 5214 y({return)e
(fail_address;})527 5313 y(return)g(NULL;)440 5413 y(})1810
5662 y Fl(146)p eop
%%Page: 147 150
147 149 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 631 y Fe(void)42 b
(*_MatchFunFC\(cha)o(r)37 b(*f,)43 b(int)f(n,)h(void)f(*fc\))440
731 y({)527 830 y(assert\(Ttop\(\))c(!=)43 b(NULL\);)527
930 y(//ATfprintf\(stder)o(r,)37 b("_MatchFunFC\(\045s,)g(\045d\)\\n",)
k(f,)h(n\);)527 1029 y(if\(!t_is_appl\(Tto)o(p\()o(\)\))658
1129 y(||)h(ATgetArity\(ATge)o(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o(\))
37 b(!=)43 b(n)658 1229 y(||)g(strcmp\(ATgetNam)o(e\(A)o(Tg)o(etS)o(ym)
o(bol)o(\(T)o(to)o(p\(\))o(\)\))o(,)38 b(f\))k(!=)h(0)658
1328 y(||)g(ATisQuoted\(ATge)o(tSy)o(mb)o(ol\()o(Tt)o(op\()o(\)\))o
(\)\))614 1428 y({)702 1528 y(return)e(fc;)614 1627 y(})527
1727 y(return)g(NULL;)440 1826 y(})440 2026 y(/*)i(Building)d(*/)440
2225 y(void)i(BuildFun\(char)c(*f,)k(int)h(i\))440 2325
y({)527 2424 y(int)g(j;)527 2524 y(Tset\(\(ATerm\))c
(ATmakeList0\(\)\);)527 2623 y(for\(j)j(=)h(i;)g(j)g(>)g(0;)g(j--\))f
({)614 2723 y(Tseti\(1,)f(\(ATerm\))f(ATinsert\(\(ATermLi)o(st)o(\))e
(Ttop\(\),)i(Ttopi\(1\)\)\);)614 2823 y(Tpop\(\);)527
2922 y(})527 3022 y(Tset\(\(ATerm\))f(ATmakeApplList\(A)o(Tm)o(ake)o
(Sy)o(mb)o(ol\()o(f,)e(i,)43 b(ATfalse\),)702 3122 y(\(ATermList\))c
(Ttop\(\)\)\);)440 3221 y(})440 3421 y(/*)k(Traversal)440
3620 y(Initialization:)37 b(Declare)k(a)i(new)g(counter)d(that)i(will)g
(keep)g(track)g(of)g(the)440 3719 y(number)f(of)i(arguments)d(of)i(the)
h(node.)e(Push)h(the)h(list)f(of)g(arguments)e(on)j(the)440
3819 y(stack)f(and)g(set)g(the)h(counter)d(to)j(0.)g(*/)440
4018 y(void)f(TravInit\(\))440 4118 y({)527 4218 y(NewCounter\(\);)527
4317 y(if\(t_is_appl\(Ttop)o(\(\))o(\)\))37 b({)614 4417
y(Tpush\(\);)614 4516 y(Tset\(\(ATerm\))i(ATgetArguments\(\()o(ATe)o
(rm)o(Ap)o(pl\))e(Ttopi\(1\)\)\);)527 4616 y(})527 4716
y(else)42 b({Tpush\(\);)e(Tset\(\(ATerm\))f(ATmakeList0\(\)\);)o(})527
4815 y(SetCounter\(0\);)440 4915 y(})440 5114 y(/*)k(When)f(the)g(list)
g(of)h(arguments)d(is)i(empty)g(proceed)f(with)g(the)i(code)f(at)440
5214 y(|on_empty|.)d(Otherwise)h(shift)h(the)i(next)f(argument)e(on)j
(the)f(stack.)85 b(*/)440 5413 y(void)42 b(*_NextSon\(void)c
(*on_empty\))1810 5662 y Fl(147)p eop
%%Page: 148 151
148 150 bop 440 199 a Fl(Chapter:)36 b(Run-time)29 b(System)440
298 y(Section:)37 b(stratego.c)440 531 y Fe({)527 631
y(if\(ATisEmpty\(\(ATe)o(rm)o(Li)o(st\))g(Ttopi\(TheCounter)o(\(\))o
(\)\)\))614 731 y({return)k(on_empty;})527 830 y(else)h({)614
930 y(Tpush\(\);)614 1029 y(IncCounter\(\);)614 1129
y(Tset\(ATgetFirst\(\()o(AT)o(erm)o(Li)o(st\))37 b(Ttopi\(TheCounter)o
(\(\))o(\)\))o(\);)614 1229 y(Tseti\(TheCounter\()o(\),)g(\(ATerm\))k
(ATgetNext\(\(ATerm)o(Li)o(st)o(\))d(Ttopi\(TheCounte)o(r\(\))o(\)\))o
(\);)527 1328 y(})527 1428 y(return)j(NULL;)440 1528
y(})440 1727 y(void)h(*_SomeNextSon\(vo)o(id)37 b(*s\))440
1826 y({)527 1926 y(if\(ATisEmpty\(\(ATe)o(rm)o(Li)o(st\))g
(Ttopi\(TheCounter)o(\(\))o(\)\)\))614 2026 y({if\(IsCounterOK\(\))o
(\))g({return)k(s;})i(else)e({return)g(fail_address;}})527
2125 y(else)h({)614 2225 y(Tpush\(\);)614 2325 y(IncCounter\(\);)614
2424 y(Tset\(ATgetFirst\(\()o(AT)o(erm)o(Li)o(st\))37
b(Ttopi\(TheCounter)o(\(\))o(\)\))o(\);)614 2524 y(Tseti\(TheCounter\()
o(\),)g(\(ATerm\))k(ATgetNext\(\(ATerm)o(Li)o(st)o(\))d
(Ttopi\(TheCounte)o(r\(\))o(\)\))o(\);)527 2623 y(})527
2723 y(return)j(NULL;)440 2823 y(})440 3022 y(/*)i(Rebuild)d(the)j
(list)f(of)g(arguments)e(and)j(rebuild)d(the)j(application)c(of)k(the)
440 3122 y(original)d(function)h(symbol.)f(*/)440 3321
y(void)i(TravBuild\(void\))440 3421 y({)527 3520 y(if\(t_is_appl\(Ttop)
o(i\()o(Th)o(eCo)o(un)o(ter)o(\(\))37 b(+)43 b(1\)\)\))614
3620 y({)702 3719 y(/*)f(if\(!\(ATgetArity\(A)o(Tg)o(etS)o(ym)o(bol)o
(\(T)o(to)o(pi\()o(Th)o(eCo)o(un)o(te)o(r\(\))37 b(+)43
b(1\)\)\))1050 3819 y(==)g(TheCounter\(\))c(+)k(ATgetLength\(Ttop)o
(i\()o(Th)o(eCo)o(un)o(ter)o(\(\))o(\)\)\))o(\))440 3919
y({)527 4018 y(int)g(i;)527 4118 y(for\(i)f(=)h(0;)g(i)g(<=)g
(TheCounter\(\))38 b(+)43 b(1;)g(i++\))614 4218 y({)702
4317 y(ATfprintf\(stdou)o(t,)37 b("tsp[top-\045d])i(=)k(\045t\\n",)e
(i,)i(Ttopi\(i\)\);)614 4417 y(})527 4516 y(ATfprintf\(stdout,)37
b("TheCounter)i(=)k(\045d)g(arity)e(=)i(\045d\\n",)e(TheCounter\(\),)
614 4616 y(ATgetArity\(ATgetS)o(ym)o(bol)o(\(T)o(top)o(i\()o(The)o(Co)o
(un)o(ter)o(\(\))c(+)43 b(1\)\)\)\);)440 4716 y(})702
4815 y(*/)702 4915 y(assert\(ATgetAri)o(ty)o(\(AT)o(ge)o(tSy)o(mb)o
(ol\()o(Tt)o(op)o(i\(T)o(he)o(Cou)o(nt)o(er)o(\(\))37
b(+)43 b(1\)\)\))f(==)1007 5015 y(\(TheCounter\(\))c(+)43
b(ATgetLength\(Ttop)o(i\(T)o(he)o(Co)o(unt)o(er)o(\(\)\))o(\)\))o(\);)
702 5114 y(for\(;)e(TheCounter\(\))e(>)k(0;)g(DecCounter\(\)\))440
5214 y({)527 5313 y(Tseti\(TheCounter\()o(\),)440 5413
y(\(ATerm\))e(ATinsert\(\(ATerm)o(Lis)o(t\))c(Ttopi\(TheCounter)o
(\(\)\))o(,)g(Ttop\(\)\)\);)1810 5662 y Fl(148)p eop
%%Page: 149 152
149 151 bop 440 199 a Fl(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)527 531 y Fe(Tpop\(\);)440
631 y(})702 731 y(Tseti\(1,)614 830 y(\(ATerm\))k(ATmakeApplList\(A)o
(Tge)o(tS)o(ymb)o(ol)o(\(T)o(top)o(i\()o(1\)\))o(,)c(\(ATermList\))i
(Ttop\(\)\)\);)614 930 y(})527 1029 y(Tpop\(\);)527 1129
y(CloseCounter\(\);)440 1229 y(})440 1428 y(/*)k(Matching)d(Traversal)
440 1627 y(When)i(a)h(traversal)d(looks)h(into)h(a)i(term)e(only)f(to)i
(match)f(subterms,)e(there)h(is)i(no)440 1727 y(need)f(to)h(rebuild)d
(the)j(term)f(afterwards.)d(*/)440 1926 y(void)j(MatchTravInit\(\))440
2026 y({)527 2125 y(NewCounter\(\);)527 2225 y(SetCounter\(ATgetA)o(ri)
o(ty)o(\(AT)o(ge)o(tSy)o(mb)o(ol\()o(Tt)o(op)o(\(\)\))o(\)\))o(;)527
2325 y(Tpush\(\);)440 2424 y(})440 2623 y(/*)h(When)f(the)g(list)g(of)h
(arguments)d(is)i(empty)g(proceed)f(with)g(the)i(code)f(at)440
2723 y(|on_empty|.)d(Otherwise)h(shift)h(the)i(next)f(argument)e(on)j
(the)f(stack.)85 b(*/)440 2922 y(void)42 b(*_MatchNextSon\(v)o(oi)o(d)c
(*on_empty\))440 3022 y({)527 3122 y(if\(TheCounter\(\))g(==)k(0\))614
3221 y({return)f(on_empty;})527 3321 y(else)h({)614 3421
y(DecCounter\(\);)614 3520 y(Tset\(ATgetArgumen)o(t\()o(Tto)o(pi)o
(\(1\))o(,)37 b(TheCounter\(\)\)\);)527 3620 y(})527
3719 y(return)k(NULL;)440 3819 y(})1810 5662 y Fl(149)p
eop
%%Page: 150 153
150 152 bop 440 199 a Fl(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)440 531 y Fh(BIBLIOGRAPHY)482
792 y Fl([1])k(Andrew)29 b(W.)h(App)r(el.)44 b Fc(Mo)l(dern)33
b(Compiler)g(Implementation)g(in)e(ML)p Fl(.)44 b(Cam)n(bridge)611
892 y(Univ)n(ersit)n(y)26 b(Press,)g(1998.)482 1058 y([2])41
b(P)n(eter)g(Boro)n(v)-5 b(ansk)q(\023)-43 b(y,)43 b(Claude)f(Kirc)n
(hner,)i(and)f(H)n(\023)-39 b(el)n(\022)g(ene)40 b(Kirc)n(hner.)79
b(Con)n(trolling)611 1157 y(rewriting)17 b(b)n(y)i(rewriting.)i(In)e
(Jos)n(\023)-39 b(e)16 b(Meseguer,)k(editor,)g Fc(Pr)l(o)l(c)l(e)l(e)l
(dings)i(of)g(the)g(First)g(In-)611 1257 y(ternational)27
b(Workshop)h(on)f(R)l(ewriting)f(L)l(o)l(gic)i(and)f(its)f(Applic)l
(ations)p Fl(,)h(v)n(olume)d(4)f(of)611 1357 y Fc(Ele)l(ctr)l(onic)h
(Notes)g(in)g(The)l(or)l(etic)l(al)h(Computer)g(Scienc)l(e)p
Fl(,)e(Asilomar,)e(P)n(aci\014c)f(Gro)n(v)n(e,)611 1456
y(CA,)28 b(Septem)n(b)r(er)f(1996.)f(Elsevier.)482 1622
y([3])41 b(Mark)20 b(V)-7 b(an)22 b(den)g(Brand)f(and)g(Eelco)g
(Visser.)26 b(F)-7 b(rom)21 b(Bo)n(x)g(to)h(T)2549 1640
y(E)2595 1622 y(X:)34 b(An)22 b(algebraic)e(ap-)611 1722
y(proac)n(h)k(to)i(the)g(generation)e(of)i(do)r(cumen)n(tation)f(to)r
(ols.)34 b(T)-7 b(ec)n(hnical)25 b(Rep)r(ort)h(P9420,)611
1822 y(Programming)e(Researc)n(h)j(Group,)g(Univ)n(ersit)n(y)f(of)i
(Amsterdam,)f(July)h(1994.)482 1988 y([4])41 b(A.)d(V)-7
b(an)38 b(Deursen,)i(J.)e(Heering,)h(and)f(P)-7 b(.)37
b(Klin)n(t,)k(editors.)66 b Fc(L)l(anguage)40 b(Pr)l(ototyp-)611
2087 y(ing.)c(A)n(n)f(A)n(lgebr)l(aic)h(Sp)l(e)l(ci\014c)l(ation)g
(Appr)l(o)l(ach)p Fl(,)h(v)n(olume)d(5)f(of)h Fc(AMAST)h(Series)h(in)
611 2187 y(Computing)p Fl(.)h(W)-7 b(orld)27 b(Scien)n(ti\014c,)h
(Singap)r(ore,)f(Septem)n(b)r(er)h(1996.)482 2353 y([5])41
b(T.B.)29 b(Dinesh,)i(Magne)e(Ha)n(v)n(eraaen,)f(and)i(Jan)f(Heering.)
43 b(An)30 b(algebraic)e(program-)611 2452 y(ming)e(st)n(yle)g(for)g(n)
n(umerical)g(soft)n(w)n(are)f(and)h(its)h(optimization.)34
b(CWI)27 b(Rep)r(ort)g(SEN-)611 2552 y(R9844,)f(CWI,)i(Amsterdam,)f
(The)h(Netherlands,)f(Decem)n(b)r(er)g(1998.)482 2718
y([6])41 b(P)n(atricia)26 b(Johann)h(and)h(Eelco)f(Visser.)37
b(W)-7 b(arm)27 b(fusion)h(in)g(Stratego:)37 b(A)28 b(case)f(study)611
2818 y(in)21 b(the)h(generation)e(of)i(program)d(transformation)h
(systems.)26 b(T)-7 b(ec)n(hnical)21 b(rep)r(ort,)h(De-)611
2917 y(partmen)n(t)j(of)g(Computer)g(Science,)h(Univ)n(ersiteit)g
(Utrec)n(h)n(t,)f(Utrec)n(h)n(t,)h(The)g(Nether-)611
3017 y(lands,)h(1999.)482 3183 y([7])41 b(Bas)h(Luttik)h(and)f(Eelco)g
(Visser.)81 b(Sp)r(eci\014cation)43 b(of)g(rewriting)f(strategies.)80
b(In)611 3283 y(M.)34 b(P)-7 b(.)34 b(A.)g(Sellink,)i(editor,)f
Fc(2nd)i(International)f(Workshop)h(on)f(the)g(The)l(ory)h(and)611
3382 y(Pr)l(actic)l(e)29 b(of)g(A)n(lgebr)l(aic)h(Sp)l(e)l(ci\014c)l
(ations)f(\(ASF+SDF'97\))p Fl(,)e(Electronic)e(W)-7 b(orkshops)611
3482 y(in)28 b(Computing,)f(Berlin,)g(No)n(v)n(em)n(b)r(er)g(1997.)e
(Springer-V)-7 b(erlag.)482 3648 y([8])41 b(P)-7 b(.)37
b(A.)h(Olivier)f(and)h(H.)g(A.)g(de)g(Jong.)66 b(E\016cien)n(t)38
b(annotated)f(terms.)67 b(T)-7 b(ec)n(hnical)611 3748
y(rep)r(ort,)32 b(Programming)e(Researc)n(h)g(Group,)j(Univ)n(ersit)n
(y)e(of)h(Amsterdam,)h(August)611 3847 y(1998.)482 4013
y([9])41 b(Eelco)c(Visser.)68 b Fc(Syntax)39 b(De\014nition)h(for)g(L)l
(anguage)h(Pr)l(ototyping)p Fl(.)70 b(PhD)38 b(thesis,)611
4113 y(Univ)n(ersit)n(y)26 b(of)i(Amsterdam,)f(Septem)n(b)r(er)h(1997.)
440 4279 y([10])41 b(Eelco)30 b(Visser.)48 b(Strategic)30
b(pattern)i(matc)n(hing.)48 b(In)31 b(P)-7 b(.)31 b(Narendran)g(and)g
(M.)h(Rusi-)611 4379 y(no)n(witc)n(h,)23 b(editors,)g
Fc(R)l(ewriting)i(T)-6 b(e)l(chniques)26 b(and)g(Applic)l(ations)h(\(R)
-6 b(T)g(A'99\))p Fl(,)24 b(v)n(olume)611 4478 y(1631)18
b(of)i Fc(L)l(e)l(ctur)l(e)i(Notes)h(in)h(Computer)f(Scienc)l(e)p
Fl(,)f(pages)d(30{44,)h(T)-7 b(ren)n(to,)21 b(Italy)-7
b(,)22 b(July)611 4578 y(1999.)j(Springer-V)-7 b(erlag.)440
4744 y([11])41 b(Eelco)28 b(Visser)g(and)h(Zine-el-Abidine)g(Benaissa.)
39 b(A)30 b(core)d(language)h(for)g(rewriting.)611 4844
y Fc(Ele)l(ctr)l(onic)h(Notes)f(in)h(The)l(or)l(etic)l(al)h(Computer)f
(Scienc)l(e)p Fl(,)e(15,)f(Septem)n(b)r(er)g(1998.)33
b(In)611 4943 y(C.)39 b(Kirc)n(hner)e(and)i(H.)g(Kirc)n(hner,)h
(editors,)h(Pro)r(ceedings)c(of)i(the)g(Second)g(In)n(ter-)611
5043 y(national)32 b(W)-7 b(orkshop)32 b(on)h(Rewriting)g(Logic)f(and)h
(its)g(Applications)g(\(WRLA'98\),)611 5142 y(P)n(on)n(t-\022)-42
b(a-Mousson,)24 b(F)-7 b(rance.)1810 5662 y(150)p eop
%%Page: 151 154
151 153 bop 440 199 a Fl(Chapter:)36 b(Other)27 b(Op)r(erations)440
298 y(Section:)37 b(Exp)r(erimen)n(ts)440 531 y([12])k(Eelco)c(Visser,)
k(Zine-el-Abidine)d(Benaissa,)i(and)e(Andrew)g(T)-7 b(olmac)n(h.)68
b(Building)611 631 y(program)36 b(optimizers)i(with)i(rewriting)d
(strategies.)69 b Fc(A)n(CM)40 b(SIGPLAN)g(Notic)l(es)p
Fl(,)611 731 y(34\(1\):13{26,)21 b(Jan)n(uary)h(1999.)28
b(Pro)r(ceedings)22 b(of)h(the)h(In)n(ternational)f(Conference)g(on)611
830 y(F)-7 b(unctional)27 b(Programming)e(\(ICFP'98\).)1810
5662 y(151)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
