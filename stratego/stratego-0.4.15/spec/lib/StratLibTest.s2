[SDef("Nil",[],Cong("Nil",[])),SDef("Scope",["b_18","c_18"],Cong("Scope",[Call(SVar("b_18"),[]),Call(SVar("c_18"),[])])),SDef("tboundin",["s_33","t_33","u_33"],Scope([],Call(SVar("Scope"),[Call(SVar("u_33"),[]),Call(SVar("s_33"),[])]))),SDef("Bind0",[],Choice(Scope(["w_11","x_11"],Seq(Match(Op("Scope",[Var("x_11"),Var("w_11")])),Seq(Where(Id),Seq(Build(Var("x_11")),Id)))),Choice(Scope(["y_11","z_11","a_12"],Seq(Match(Op("LRule",[Op("Rule",[Var("a_12"),Var("y_11"),Var("z_11")])])),Seq(Where(Id),Seq(Seq(Build(Var("a_12")),Call(SVar("tvars"),[])),Id)))),Fail))),SDef("Add1",[],Scope(["p_11"],Seq(Match(Op("Var",[Var("p_11")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("p_11"),Op("Nil",[])])),Id))))),SDef("tvars",[],Scope([],Call(SVar("free-vars"),[Call(SVar("Add1"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[])]))),SDef("test4",[],Scope([],Call(SVar("tvars"),[]))),SDef("Cons",["p_16","q_16"],Cong("Cons",[Call(SVar("p_16"),[]),Call(SVar("q_16"),[])])),SDef("Hd",[],Scope(["l_9","m_9"],Seq(Match(Op("Cons",[Var("m_9"),Var("l_9")])),Seq(Where(Id),Seq(Build(Var("m_9")),Id))))),SDef("spaste",["v_33"],Scope([],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Seq(Call(SVar("v_33"),[]),Call(SVar("Hd"),[])),Id,Id]),Id]),Choice(Call(SVar("SDef"),[Id,Call(SVar("v_33"),[]),Id]),Call(SVar("Rec"),[Seq(Call(SVar("v_33"),[]),Call(SVar("Hd"),[])),Id]))))),SDef("SVar",["f_17"],Cong("SVar",[Call(SVar("f_17"),[])])),SDef("DistBinding",["h_19","i_19"],Scope(["i_5","j_5","k_5"],Seq(Match(Op("TCons",[Var("k_5"),Op("TCons",[Var("j_5"),Op("TCons",[Var("i_5"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Seq(Build(Var("k_5")),Call(SVar("h_19"),[Scope(["l_5"],Seq(Match(Var("l_5")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("l_5"),Op("TCons",[Var("i_5"),Op("TNil",[])])])),Call(SVar("i_19"),[])),Id)))),Scope(["m_5"],Seq(Match(Var("m_5")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("m_5"),Op("TCons",[Var("j_5"),Op("TNil",[])])])),Call(SVar("i_19"),[])),Id)))),Id])),Id))))),SDef("Zip3",[],Scope(["v_7","w_7"],Seq(Match(Op("TCons",[Var("v_7"),Op("TCons",[Var("w_7"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("v_7"),Var("w_7")])),Id))))),SDef("Zip2",[],Scope(["l_7","m_7","n_7","o_7"],Seq(Match(Op("TCons",[Op("Cons",[Var("l_7"),Var("n_7")]),Op("TCons",[Op("Cons",[Var("m_7"),Var("o_7")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("TCons",[Var("l_7"),Op("TCons",[Var("m_7"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("n_7"),Op("TCons",[Var("o_7"),Op("TNil",[])])]),Op("TNil",[])])])),Id))))),SDef("Zip1",[],Scope([],Seq(Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Nil",[])),Id))))),SDef("TNil",[],Cong("TNil",[])),SDef("TCons",["l_16","m_16"],Cong("TCons",[Call(SVar("l_16"),[]),Call(SVar("m_16"),[])])),SDef("genzip",["a_27","b_27","c_27","d_27"],Scope([],Rec("e_27",Choice(Call(SVar("a_27"),[]),Seq(Call(SVar("b_27"),[]),Seq(Call(SVar("TCons"),[Call(SVar("d_27"),[]),Call(SVar("TCons"),[Call(SVar("e_27"),[]),Call(SVar("TNil"),[])])]),Call(SVar("c_27"),[]))))))),SDef("zip",["f_27"],Scope([],Call(SVar("genzip"),[Call(SVar("Zip1"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("f_27"),[])]))),SDef("at_end",["x_28"],Scope([],Rec("y_28",Choice(Call(SVar("Cons"),[Id,Call(SVar("y_28"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("x_28"),[])))))),SDef("conc",[],Scope(["e_10","f_10"],Seq(Match(Op("TCons",[Var("f_10"),Op("TCons",[Var("e_10"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("f_10")),Call(SVar("at_end"),[Build(Var("e_10"))])),Id))))),SDef("new",[],Scope([],Prim("_ST_new"))),SDef("map",["l_28"],Scope([],Rec("m_28",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("l_28"),[]),Call(SVar("m_28"),[])]))))),SDef("RnBinding",["f_19","g_19"],Scope(["d_5","e_5","f_5","g_5","h_5"],Seq(Match(Op("TCons",[Var("d_5"),Op("TCons",[Var("g_5"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Seq(Build(Var("d_5")),Call(SVar("f_19"),[])),Match(Var("e_5"))),Seq(Seq(Call(SVar("map"),[Call(SVar("new"),[])]),Match(Var("f_5"))),Seq(Seq(Scope(["r_36"],Seq(Seq(Build(Op("TCons",[Var("e_5"),Op("TCons",[Var("f_5"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("r_36")),Id))),Build(Op("TCons",[Var("r_36"),Op("TCons",[Var("g_5"),Op("TNil",[])])])))),Call(SVar("conc"),[])),Match(Var("h_5"))))))),Seq(Scope(["y_36"],Seq(Seq(Build(Var("d_5")),Seq(Call(SVar("g_19"),[Build(Var("f_5"))]),Seq(Match(Var("y_36")),Id))),Build(Op("TCons",[Var("y_36"),Op("TCons",[Var("g_5"),Op("TCons",[Var("h_5"),Op("TNil",[])])])])))),Id))))),SDef("Look2",[],Scope(["a_6","b_6"],Seq(Match(Op("TCons",[Var("a_6"),Op("TCons",[Op("Cons",[Wld,Var("b_6")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("a_6"),Op("TCons",[Var("b_6"),Op("TNil",[])])])),Id))))),SDef("Look1",[],Scope(["y_5","z_5"],Seq(Match(Op("TCons",[Var("y_5"),Op("TCons",[Op("Cons",[Op("TCons",[Var("y_5"),Op("TCons",[Var("z_5"),Op("TNil",[])])]),Wld]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Var("z_5")),Id))))),SDef("lookup",[],Scope([],Rec("v_25",LChoice(Call(SVar("Look1"),[]),Seq(Call(SVar("Look2"),[]),Call(SVar("v_25"),[])))))),SDef("RnVar",["e_19"],Scope(["b_5","c_5"],Seq(Match(Op("TCons",[Var("c_5"),Op("TCons",[Var("b_5"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("c_5")),Call(SVar("e_19"),[Seq(Call(SVar("split"),[Id,Build(Var("b_5"))]),Call(SVar("lookup"),[]))])),Id))))),SDef("dist",["a_19"],Scope(["q_4","r_4"],Seq(Match(Op("TCons",[Var("r_4"),Op("TCons",[Var("q_4"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("r_4")),All(Scope(["s_4"],Seq(Match(Var("s_4")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("s_4"),Op("TCons",[Var("q_4"),Op("TNil",[])])])),Call(SVar("a_19"),[])),Id)))))),Id))))),SDef("env-alltd",["e_24"],Scope([],Rec("f_24",LChoice(Call(SVar("e_24"),[]),Call(SVar("dist"),[Call(SVar("f_24"),[])]))))),SDef("rename",["l_24","m_24","n_24","o_24"],Scope([],Seq(Scope(["x_13"],Seq(Match(Var("x_13")),Seq(Where(Id),Seq(Build(Op("TCons",[Var("x_13"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Id)))),Rec("p_24",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("l_24"),[])]),Seq(Call(SVar("RnBinding"),[Call(SVar("m_24"),[]),Call(SVar("o_24"),[])]),Call(SVar("DistBinding"),[Call(SVar("n_24"),[]),Call(SVar("p_24"),[])])))]))))),SDef("srename",[],Scope([],Call(SVar("rename"),[Call(SVar("SVar"),[]),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[]),Call(SVar("spaste"),[])]))),SDef("test3",[],Scope([],Call(SVar("srename"),[]))),SDef("Add2",[],Scope(["q_11"],Seq(Match(Op("SVar",[Var("q_11")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("q_11"),Op("Nil",[])])),Id))))),SDef("diff",[],Scope(["l_6","m_6"],Seq(Match(Op("TCons",[Var("m_6"),Op("TCons",[Var("l_6"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("m_6")),Rec("s_19",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("l_6"))]),Call(SVar("s_19"),[])),Call(SVar("Cons"),[Id,Call(SVar("s_19"),[])]))))),Id))))),SDef("free-vars",["j_23","k_23","l_23"],Scope([],Rec("m_23",LChoice(Call(SVar("j_23"),[]),LChoice(Seq(Scope(["t_13"],Seq(Where(Seq(Call(SVar("k_23"),[]),Match(Var("t_13")))),Call(SVar("l_23"),[Seq(Call(SVar("split"),[Call(SVar("m_23"),[]),Build(Var("t_13"))]),Call(SVar("diff"),[])),Call(SVar("m_23"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("m_23"),[])])))))),SDef("svars",[],Scope([],Call(SVar("free-vars"),[Call(SVar("Add2"),[]),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[])]))),SDef("test2",[],Scope([],Call(SVar("svars"),[]))),SDef("Rec",["g_17","h_17"],Cong("Rec",[Call(SVar("g_17"),[]),Call(SVar("h_17"),[])])),SDef("SDef",["k_17","l_17","m_17"],Cong("SDef",[Call(SVar("k_17"),[]),Call(SVar("l_17"),[]),Call(SVar("m_17"),[])])),SDef("Let",["i_17","j_17"],Cong("Let",[Call(SVar("i_17"),[]),Call(SVar("j_17"),[])])),SDef("sboundin",["w_33","x_33","y_33"],Scope([],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Call(SVar("y_33"),[]),Call(SVar("y_33"),[]),Call(SVar("x_33"),[])]),Call(SVar("w_33"),[])]),Choice(Call(SVar("SDef"),[Call(SVar("y_33"),[]),Call(SVar("y_33"),[]),Call(SVar("w_33"),[])]),Call(SVar("Rec"),[Call(SVar("y_33"),[]),Call(SVar("w_33"),[])]))))),SDef("Bind3",[],Scope(["i_12","j_12"],Seq(Match(Op("Rec",[Var("j_12"),Var("i_12")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("j_12"),Op("Nil",[])])),Id))))),SDef("Bind2",[],Scope(["f_12","g_12","h_12"],Seq(Match(Op("SDef",[Var("f_12"),Var("h_12"),Var("g_12")])),Seq(Where(Id),Seq(Build(Var("h_12")),Id))))),SDef("Bind1",[],Scope(["b_12","c_12","d_12","e_12"],Seq(Match(Op("Let",[Op("SDef",[Var("e_12"),Var("b_12"),Var("c_12")]),Var("d_12")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("e_12"),Op("Nil",[])])),Id))))),SDef("plus",[],Scope([],Prim("_ST_plus"))),SDef("Tl",[],Scope(["n_9","o_9"],Seq(Match(Op("Cons",[Var("n_9"),Var("o_9")])),Seq(Where(Id),Seq(Build(Var("o_9")),Id))))),SDef("length",[],Scope([],Rec("t_28",Choice(Seq(Call(SVar("Nil"),[]),Build(Int(0))),Seq(Call(SVar("Tl"),[]),Seq(Call(SVar("t_28"),[]),Scope(["e_15"],Seq(Match(Var("e_15")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("e_15"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("plus"),[])),Id)))))))))),SDef("HdMember",["o_19"],Scope(["e_6","f_6"],Seq(Match(Op("Cons",[Var("f_6"),Var("e_6")])),Seq(Where(Where(Seq(Call(SVar("o_19"),[]),Call(SVar("fetch"),[Seq(Id,Match(Var("f_6")))])))),Seq(Build(Var("e_6")),Id))))),SDef("union",[],Scope(["j_6","k_6"],Seq(Match(Op("TCons",[Var("k_6"),Op("TCons",[Var("j_6"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("k_6")),Rec("r_19",LChoice(Seq(Call(SVar("Nil"),[]),Build(Var("j_6"))),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("j_6"))]),Call(SVar("r_19"),[])),Call(SVar("Cons"),[Id,Call(SVar("r_19"),[])]))))),Id))))),SDef("foldr",["h_25","i_25","j_25"],Scope([],Rec("k_25",Choice(Seq(Call(SVar("Nil"),[]),Call(SVar("h_25"),[])),Seq(Scope(["z_13","a_14"],Seq(Match(Op("Cons",[Var("z_13"),Var("a_14")])),Seq(Where(Id),Seq(Scope(["g_40"],Seq(Seq(Build(Var("z_13")),Seq(Call(SVar("j_25"),[]),Seq(Match(Var("g_40")),Id))),Scope(["k_40"],Seq(Seq(Build(Var("a_14")),Seq(Call(SVar("k_25"),[]),Seq(Match(Var("k_40")),Id))),Build(Op("TCons",[Var("g_40"),Op("TCons",[Var("k_40"),Op("TNil",[])])])))))),Id)))),Call(SVar("i_25"),[])))))),SDef("foldr-kids",["x_19","y_19","z_19"],Scope(["s_6"],Seq(Scope(["r_40"],Seq(Match(Var("r_40")),Where(Seq(Build(Var("r_40")),Seq(Prim("_ST_explode_term"),Seq(Match(Op("TCons",[Wld,Op("TCons",[Var("s_6"),Op("TNil",[])])])),Id)))))),Seq(Where(Id),Seq(Seq(Build(Var("s_6")),Call(SVar("foldr"),[Call(SVar("x_19"),[]),Call(SVar("y_19"),[]),Call(SVar("z_19"),[])])),Id))))),SDef("collect-kids",["b_26"],Scope([],Call(SVar("foldr-kids"),[Build(Op("Nil",[])),Call(SVar("union"),[]),Call(SVar("b_26"),[])]))),SDef("fetch",["u_28"],Scope([],Rec("v_28",LChoice(Call(SVar("Cons"),[Call(SVar("u_28"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("v_28"),[])]))))),SDef("HdMember'",["p_19","q_19"],Scope(["g_6","h_6"],Seq(Match(Op("Cons",[Var("h_6"),Var("g_6")])),Seq(Where(Where(Seq(Call(SVar("q_19"),[]),Call(SVar("fetch"),[Scope(["i_6"],Seq(Match(Var("i_6")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("h_6"),Op("TCons",[Var("i_6"),Op("TNil",[])])])),Call(SVar("p_19"),[])),Id))))])))),Seq(Build(Var("g_6")),Id))))),SDef("diff'",["t_19"],Scope(["n_6","o_6"],Seq(Match(Op("TCons",[Var("o_6"),Op("TCons",[Var("n_6"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("o_6")),Rec("u_19",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember'"),[Call(SVar("t_19"),[]),Build(Var("n_6"))]),Call(SVar("u_19"),[])),Call(SVar("Cons"),[Id,Call(SVar("u_19"),[])]))))),Id))))),SDef("diff",["a_26"],Scope([],Call(SVar("diff'"),[Call(SVar("a_26"),[])]))),SDef("free-vars2",["z_23","a_24","b_24","c_24"],Scope([],Rec("d_24",Seq(Call(SVar("split"),[LChoice(Call(SVar("z_23"),[]),Build(Op("Nil",[]))),LChoice(Scope(["w_13"],Seq(Where(Seq(Call(SVar("a_24"),[]),Match(Var("w_13")))),Seq(Call(SVar("b_24"),[Seq(Call(SVar("split"),[Call(SVar("d_24"),[]),Build(Var("w_13"))]),Call(SVar("diff"),[Call(SVar("c_24"),[])])),Call(SVar("d_24"),[]),Build(Op("Nil",[]))]),Call(SVar("collect-kids"),[Id])))),Call(SVar("collect-kids"),[Call(SVar("d_24"),[])]))]),Call(SVar("union"),[]))))),SDef("svars-arity",[],Scope([],Call(SVar("free-vars2"),[Scope(["b_16","c_16"],Seq(Match(Op("Call",[Op("SVar",[Var("b_16")]),Var("c_16")])),Seq(Where(Id),Seq(Scope(["x_41"],Seq(Seq(Build(Var("c_16")),Seq(Call(SVar("length"),[]),Seq(Match(Var("x_41")),Id))),Build(Op("Cons",[Op("TCons",[Var("b_16"),Op("TCons",[Var("x_41"),Op("TNil",[])])]),Op("Nil",[])])))),Id)))),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[]),Scope(["d_16"],Seq(Id,Match(Op("TCons",[Op("TCons",[Var("d_16"),Op("TCons",[Wld,Op("TNil",[])])]),Op("TCons",[Var("d_16"),Op("TNil",[])])]))))]))),SDef("test1",[],Scope([],Call(SVar("svars-arity"),[]))),SDef("exit",[],Scope([],Prim("_ST_exit"))),SDef("printnl",[],Scope([],Prim("_ST_printnl"))),SDef("error",[],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Id]),Call(SVar("printnl"),[]))))),SDef("fatal-error",[],Scope([],Where(Seq(Call(SVar("error"),[]),Seq(Build(Int(1)),Call(SVar("exit"),[])))))),SDef("WriteToTextFile",[],Scope([],Prim("_ST_WriteToTextFile"))),SDef("split",["h_20","i_20"],Scope(["z_10"],Seq(Match(Var("z_10")),Seq(Where(Id),Seq(Scope(["k_42"],Seq(Seq(Build(Var("z_10")),Seq(Call(SVar("h_20"),[]),Seq(Match(Var("k_42")),Id))),Scope(["o_42"],Seq(Seq(Build(Var("z_10")),Seq(Call(SVar("i_20"),[]),Seq(Match(Var("o_42")),Id))),Build(Op("TCons",[Var("k_42"),Op("TCons",[Var("o_42"),Op("TNil",[])])])))))),Id))))),SDef("ReadFromFile",[],Scope([],Prim("_ST_ReadFromFile"))),SDef("stdio",["o_21"],Scope([],LChoice(Seq(Seq(Build(Op("stdin",[])),Call(SVar("ReadFromFile"),[])),Seq(Call(SVar("o_21"),[]),Seq(Call(SVar("split"),[Build(Op("stdout",[])),Id]),Call(SVar("WriteToTextFile"),[])))),Seq(Build(Op("Cons",[Str("** rewriting failed"),Op("Nil",[])])),Call(SVar("fatal-error"),[]))))),SDef("main",[],Scope([],Call(SVar("stdio"),[Call(SVar("Cons"),[Call(SVar("test1"),[]),Call(SVar("Cons"),[Call(SVar("test2"),[]),Call(SVar("Cons"),[Call(SVar("test3"),[]),Call(SVar("Cons"),[Call(SVar("test4"),[]),Call(SVar("Nil"),[])])])])])])))]
