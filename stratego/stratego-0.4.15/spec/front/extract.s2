[SDef("Expl",[],Choice(Scope(["w_7","x_7","y_7","z_7"],Scope(["i_49"],Seq(Match(Op("Match",[Var("w_7")])),Seq(Where(Seq(Where(Seq(Call(SVar("new"),[]),Match(Var("z_7")))),Seq(Build(Var("w_7")),Seq(Call(SVar("oncetd"),[Seq(Match(Op("Explode",[Var("x_7"),Var("y_7")])),Seq(Where(Id),Seq(Build(Op("Var",[Var("z_7")])),Id)))]),Seq(Match(Var("i_49")),Id))))),Seq(Build(Op("Scope",[Op("Cons",[Var("z_7"),Op("Nil",[])]),Op("Seq",[Op("Match",[Var("i_49")]),Op("Where",[Op("BAM",[Op("Prim",[Str("_ST_explode_term")]),Op("Var",[Var("z_7")]),Op("Op",[Str("TCons"),Op("Cons",[Var("x_7"),Op("Cons",[Op("Op",[Str("TCons"),Op("Cons",[Var("y_7"),Op("Cons",[Op("Op",[Str("TNil"),Op("Nil",[])]),Op("Nil",[])])])]),Op("Nil",[])])])])])])])])),Id))))),Choice(Scope(["a_8","b_8","c_8","d_8"],Scope(["v_49"],Seq(Match(Op("Build",[Var("c_8")])),Seq(Where(Seq(Where(Seq(Call(SVar("new"),[]),Match(Var("d_8")))),Seq(Build(Var("c_8")),Seq(Call(SVar("oncetd"),[Seq(Match(Op("Explode",[Var("a_8"),Var("b_8")])),Seq(Where(Id),Seq(Build(Op("Var",[Var("d_8")])),Id)))]),Seq(Match(Var("v_49")),Id))))),Seq(Build(Op("Scope",[Op("Cons",[Var("d_8"),Op("Nil",[])]),Op("Seq",[Op("BAM",[Op("Prim",[Str("_ST_mkterm")]),Op("Op",[Str("TCons"),Op("Cons",[Var("a_8"),Op("Cons",[Op("Op",[Str("TCons"),Op("Cons",[Var("b_8"),Op("Cons",[Op("Op",[Str("TNil"),Op("Nil",[])]),Op("Nil",[])])])]),Op("Nil",[])])])]),Op("Var",[Var("d_8")])]),Op("Build",[Var("v_49")])])])),Id))))),Choice(Scope(["e_8","f_8"],Seq(Match(Op("ExplodeCong",[Var("e_8"),Var("f_8")])),Seq(Where(Id),Seq(Build(Op("Seq",[Op("Prim",[Str("_ST_explode_term")]),Op("Seq",[Op("Cong",[Str("TCons"),Op("Cons",[Var("e_8"),Op("Cons",[Op("Cong",[Str("TCons"),Op("Cons",[Var("f_8"),Op("Cons",[Op("Cong",[Str("TNil"),Op("Nil",[])]),Op("Nil",[])])])]),Op("Nil",[])])])]),Op("Prim",[Str("_ST_mkterm")])])])),Id)))),Fail)))),SDef("Bapp2",[],Scope(["s_7","t_7","u_7","v_7"],Scope(["m_50"],Seq(Match(Op("Build",[Var("u_7")])),Seq(Where(Seq(Where(Seq(Call(SVar("new"),[]),Match(Var("v_7")))),Seq(Build(Var("u_7")),Seq(Call(SVar("oncetd"),[Seq(Match(Op("App",[Var("s_7"),Var("t_7")])),Seq(Where(Id),Seq(Build(Op("Var",[Var("v_7")])),Id)))]),Seq(Match(Var("m_50")),Id))))),Seq(Build(Op("Scope",[Op("Cons",[Var("v_7"),Op("Nil",[])]),Op("Seq",[Op("BAM",[Var("s_7"),Var("t_7"),Op("Var",[Var("v_7")])]),Op("Build",[Var("m_50")])])])),Id)))))),SDef("Bapp1",[],Scope(["q_7","r_7"],Seq(Match(Op("Build",[Op("App",[Var("r_7"),Var("q_7")])])),Seq(Where(Id),Seq(Build(Op("Seq",[Op("Build",[Var("q_7")]),Var("r_7")])),Id))))),SDef("Bapp0",[],Scope(["n_7","o_7","p_7"],Scope(["d_51"],Seq(Match(Op("Build",[Var("o_7")])),Seq(Where(Seq(Id,Seq(Build(Var("o_7")),Seq(Call(SVar("oncetd"),[Seq(Match(Op("App",[Op("Build",[Var("p_7")]),Var("n_7")])),Seq(Where(Id),Seq(Build(Var("p_7")),Id)))]),Seq(Match(Var("d_51")),Id))))),Seq(Build(Op("Build",[Var("d_51")])),Id)))))),SDef("HL",[],Choice(Scope([],Seq(Match(Op("Seqs",[Op("Nil",[])])),Seq(Where(Id),Seq(Build(Op("Id",[])),Id)))),Choice(Scope(["w_6","x_6"],Seq(Match(Op("Seqs",[Op("Cons",[Var("w_6"),Var("x_6")])])),Seq(Where(Id),Seq(Build(Op("Seq",[Var("w_6"),Op("Seqs",[Var("x_6")])])),Id)))),Choice(Scope([],Seq(Match(Op("Choices",[Op("Nil",[])])),Seq(Where(Id),Seq(Build(Op("Fail",[])),Id)))),Choice(Scope(["y_6","z_6"],Seq(Match(Op("Choices",[Op("Cons",[Var("y_6"),Var("z_6")])])),Seq(Where(Id),Seq(Build(Op("Choice",[Var("y_6"),Op("Choices",[Var("z_6")])])),Id)))),Choice(Scope([],Seq(Match(Op("LChoices",[Op("Nil",[])])),Seq(Where(Id),Seq(Build(Op("Fail",[])),Id)))),Choice(Scope(["a_7","b_7"],Seq(Match(Op("LChoices",[Op("Cons",[Var("a_7"),Var("b_7")])])),Seq(Where(Id),Seq(Build(Op("LChoice",[Var("a_7"),Op("LChoices",[Var("b_7")])])),Id)))),Choice(Scope(["e_7","f_7"],Seq(Match(Op("BA",[Var("f_7"),Var("e_7")])),Seq(Where(Id),Seq(Build(Op("Seq",[Op("Build",[Var("e_7")]),Var("f_7")])),Id)))),Choice(Scope(["g_7","h_7"],Seq(Match(Op("MA",[Var("g_7"),Var("h_7")])),Seq(Where(Id),Seq(Build(Op("Seq",[Op("Match",[Var("g_7")]),Var("h_7")])),Id)))),Choice(Scope(["i_7","j_7"],Seq(Match(Op("AM",[Var("i_7"),Var("j_7")])),Seq(Where(Id),Seq(Build(Op("Seq",[Var("i_7"),Op("Match",[Var("j_7")])])),Id)))),Choice(Scope(["k_7","l_7","m_7"],Seq(Match(Op("BAM",[Var("l_7"),Var("k_7"),Var("m_7")])),Seq(Where(Id),Seq(Build(Op("Seqs",[Op("Cons",[Op("Build",[Var("k_7")]),Op("Cons",[Var("l_7"),Op("Cons",[Op("Match",[Var("m_7")]),Op("Nil",[])])])])])),Id)))),Fail))))))))))),SDef("repeat",["a_37","b_37"],Scope([],Rec("c_37",LChoice(Seq(Call(SVar("a_37"),[]),Call(SVar("c_37"),[])),Call(SVar("b_37"),[]))))),SDef("repeat",["d_37"],Scope([],Call(SVar("repeat"),[Call(SVar("d_37"),[]),Id]))),SDef("Wld",[],Cong("Wld",[])),SDef("buildterm",[],Scope([],Not(Call(SVar("topdown"),[Choice(Call(SVar("Con"),[Id,Id,Id]),Call(SVar("Wld"),[]))])))),SDef("App",["s_29","t_29"],Cong("App",[Call(SVar("s_29"),[]),Call(SVar("t_29"),[])])),SDef("Con",["p_29","q_29","r_29"],Cong("Con",[Call(SVar("p_29"),[]),Call(SVar("q_29"),[]),Call(SVar("r_29"),[])])),SDef("pureterm",[],Scope([],Not(Call(SVar("topdown"),[Choice(Call(SVar("Con"),[Id,Id,Id]),Call(SVar("App"),[Id,Id]))])))),SDef("RtoS",[],Choice(Scope(["g_8","h_8","i_8"],Seq(Match(Op("SRule",[Op("Rule",[Var("h_8"),Var("i_8"),Var("g_8")])])),Seq(Where(Where(Seq(Seq(Build(Var("h_8")),Call(SVar("pureterm"),[])),Seq(Build(Var("i_8")),Call(SVar("buildterm"),[]))))),Seq(Build(Op("Seqs",[Op("Cons",[Op("Match",[Var("h_8")]),Op("Cons",[Op("Where",[Var("g_8")]),Op("Cons",[Op("Build",[Var("i_8")]),Op("Nil",[])])])])])),Id)))),Choice(Scope(["j_8","k_8","l_8"],Seq(Match(Op("SRule",[Op("StratRule",[Var("j_8"),Var("l_8"),Var("k_8")])])),Seq(Where(Id),Seq(Build(Op("Seqs",[Op("Cons",[Var("j_8"),Op("Cons",[Op("Where",[Var("k_8")]),Op("Cons",[Var("l_8"),Op("Nil",[])])])])])),Id)))),Fail))),SDef("oncetd",["m_46"],Scope([],Rec("n_46",LChoice(Call(SVar("m_46"),[]),One(Call(SVar("n_46"),[])))))),SDef("Rcon",[],Scope(["m_8","n_8","o_8","p_8","q_8","r_8","s_8","t_8","u_8"],Scope(["p_53"],Scope(["q_53"],Seq(Match(Op("SRule",[Op("Rule",[Var("n_8"),Var("o_8"),Var("p_8")])])),Seq(Where(Seq(Seq(Where(Seq(Call(SVar("new"),[]),Match(Var("u_8")))),Seq(Build(Var("n_8")),Seq(Call(SVar("oncetd"),[Seq(Match(Op("Con",[Op("Var",[Var("t_8")]),Var("r_8"),Var("m_8")])),Seq(Where(Id),Seq(Build(Op("Var",[Var("t_8")])),Id)))]),Seq(Match(Var("p_53")),Id)))),Seq(Build(Var("o_8")),Seq(Call(SVar("oncetd"),[Seq(Match(Op("Con",[Op("Var",[Var("t_8")]),Var("s_8"),Op("Call",[Var("q_8"),Op("Nil",[])])])),Seq(Where(Id),Seq(Build(Op("Var",[Var("u_8")])),Id)))]),Seq(Match(Var("q_53")),Id))))),Seq(Build(Op("Scope",[Op("Cons",[Var("u_8"),Op("Nil",[])]),Op("SRule",[Op("Rule",[Var("p_53"),Var("q_53"),Op("Seq",[Var("p_8"),Op("BAM",[Op("Call",[Var("q_8"),Op("Cons",[Op("SRule",[Op("Rule",[Var("r_8"),Var("s_8"),Op("Id",[])])]),Op("Nil",[])])]),Op("Var",[Var("t_8")]),Op("Var",[Var("u_8")])])])])])])),Id))))))),SDef("desugarRule",[],Scope([],Rec("b_35",Call(SVar("try"),[Choice(Seq(Call(SVar("Rcon"),[]),Call(SVar("b_35"),[])),Choice(Call(SVar("Scope"),[Id,Call(SVar("b_35"),[])]),Call(SVar("RtoS"),[])))])))),SDef("topdown",["z_44"],Scope([],Rec("a_45",Seq(Call(SVar("z_44"),[]),All(Call(SVar("a_45"),[])))))),SDef("desugar",[],Scope([],Call(SVar("topdown"),[Seq(Call(SVar("try"),[Call(SVar("desugarRule"),[])]),Call(SVar("repeat"),[Choice(Call(SVar("HL"),[]),Choice(LChoice(Call(SVar("Bapp0"),[]),LChoice(Call(SVar("Bapp1"),[]),Call(SVar("Bapp2"),[]))),Call(SVar("Expl"),[])))]))]))),SDef("desugar-spec",[],Scope([],Call(SVar("map"),[Call(SVar("SDef"),[Id,Id,Call(SVar("desugar"),[])])]))),SDef("MissingDef",[],Scope(["m_13","n_13"],Seq(Match(Op("TCons",[Var("m_13"),Op("TCons",[Var("n_13"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Op("Cons",[Str("error: operator "),Op("Cons",[Var("m_13"),Op("Cons",[Str("/"),Op("Cons",[Var("n_13"),Op("Cons",[Str(" undefined "),Op("Nil",[])])])])])])),Call(SVar("error"),[])),Id))))),SDef("error",[],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Id]),Call(SVar("printnl"),[]))))),SDef("MissingDefMod",[],Scope(["o_13","p_13","q_13"],Seq(Match(Op("TCons",[Op("Mod",[Var("o_13"),Var("p_13")]),Op("TCons",[Var("q_13"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Op("Cons",[Str("error: operator "),Op("Cons",[Var("o_13"),Op("Cons",[Str("^"),Op("Cons",[Var("p_13"),Op("Cons",[Str("/"),Op("Cons",[Var("q_13"),Op("Cons",[Str(" undefined "),Op("Nil",[])])])])])])])])),Call(SVar("error"),[])),Id))))),SDef("MissingDefs",[],Scope(["j_13","k_13","l_13"],Seq(Match(Op("TCons",[Var("j_13"),Op("TCons",[Op("Cons",[Var("k_13"),Var("l_13")]),Op("TNil",[])])])),Seq(Where(Where(Seq(Build(Op("Cons",[Var("k_13"),Var("l_13")])),Call(SVar("map"),[LChoice(Call(SVar("MissingDefMod"),[]),Call(SVar("MissingDef"),[]))])))),Seq(Build(Var("j_13")),Id))))),SDef("NoMissingDefs",[],Scope(["i_13"],Seq(Match(Op("TCons",[Var("i_13"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Var("i_13")),Id))))),SDef("HdMember'",["z_33","a_34"],Scope(["a_17","b_17"],Seq(Match(Op("Cons",[Var("b_17"),Var("a_17")])),Seq(Where(Where(Seq(Call(SVar("a_34"),[]),Call(SVar("fetch"),[Scope(["c_17"],Seq(Match(Var("c_17")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("b_17"),Op("TCons",[Var("c_17"),Op("TNil",[])])])),Call(SVar("z_33"),[])),Id))))])))),Seq(Build(Var("a_17")),Id))))),SDef("diff'",["d_34"],Scope(["h_17","i_17"],Seq(Match(Op("TCons",[Var("i_17"),Op("TCons",[Var("h_17"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("i_17")),Rec("e_34",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember'"),[Call(SVar("d_34"),[]),Build(Var("h_17"))]),Call(SVar("e_34"),[])),Call(SVar("Cons"),[Id,Call(SVar("e_34"),[])]))))),Id))))),SDef("diff",["u_40"],Scope([],Call(SVar("diff'"),[Call(SVar("u_40"),[])]))),SDef("free-vars2",["w_38","x_38","y_38","z_38"],Scope([],Rec("a_39",Seq(Call(SVar("split"),[LChoice(Call(SVar("w_38"),[]),Build(Op("Nil",[]))),LChoice(Scope(["a_26"],Seq(Where(Seq(Call(SVar("x_38"),[]),Match(Var("a_26")))),Seq(Call(SVar("y_38"),[Seq(Call(SVar("split"),[Call(SVar("a_39"),[]),Build(Var("a_26"))]),Call(SVar("diff"),[Call(SVar("z_38"),[])])),Call(SVar("a_39"),[]),Build(Op("Nil",[]))]),Call(SVar("collect-kids"),[Id])))),Call(SVar("collect-kids"),[Call(SVar("a_39"),[])]))]),Call(SVar("union"),[]))))),SDef("svars-arity",[],Scope([],Call(SVar("free-vars2"),[Scope(["f_28","g_28"],Seq(Match(Op("Call",[Op("SVar",[Var("f_28")]),Var("g_28")])),Seq(Where(Id),Seq(Scope(["b_56"],Seq(Seq(Build(Var("g_28")),Seq(Call(SVar("length"),[]),Seq(Match(Var("b_56")),Id))),Build(Op("Cons",[Op("TCons",[Var("f_28"),Op("TCons",[Var("b_56"),Op("TNil",[])])]),Op("Nil",[])])))),Id)))),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[]),Scope(["h_28"],Seq(Id,Match(Op("TCons",[Op("TCons",[Var("h_28"),Op("TCons",[Wld,Op("TNil",[])])]),Op("TCons",[Var("h_28"),Op("TNil",[])])]))))]))),SDef("IsSVar",[],Scope(["w_21"],Seq(Match(Op("Call",[Op("SVar",[Var("w_21")]),Op("Nil",[])])),Seq(Where(Id),Seq(Build(Var("w_21")),Id))))),SDef("alltd",["u_46"],Scope([],Rec("v_46",LChoice(Call(SVar("u_46"),[]),All(Call(SVar("v_46"),[])))))),SDef("subs",["y_47","z_47"],Scope(["t_27"],Seq(Where(Seq(Call(SVar("z_47"),[]),Match(Var("t_27")))),Call(SVar("alltd"),[Seq(Call(SVar("y_47"),[]),Scope(["u_27"],Scope(["v_27"],Seq(Match(Var("v_27")),Seq(Where(Where(Seq(Build(Var("t_27")),Call(SVar("fetch"),[Seq(Id,Match(Op("TCons",[Var("v_27"),Op("TCons",[Var("u_27"),Op("TNil",[])])])))])))),Seq(Build(Var("u_27")),Id))))))])))),SDef("subs",["v_34"],Scope(["q_21","r_21","s_21"],Seq(Match(Op("TCons",[Var("q_21"),Op("TCons",[Var("r_21"),Op("TCons",[Var("s_21"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Seq(Build(Var("s_21")),Call(SVar("subs"),[Call(SVar("v_34"),[]),Seq(Build(Op("TCons",[Var("q_21"),Op("TCons",[Var("r_21"),Op("TNil",[])])])),Call(SVar("zip"),[Id]))])),Id))))),SDef("ssubs",[],Scope([],Call(SVar("subs"),[Call(SVar("IsSVar"),[])]))),SDef("JoinDefs2",[],Scope(["n_12","o_12","p_12","q_12","r_12","s_12","t_12"],Seq(Match(As(Var("s_12"),Op("Cons",[Op("SDef",[Var("q_12"),Var("o_12"),Var("n_12")]),Wld]))),Seq(Where(Where(Seq(Seq(Seq(Build(Var("o_12")),Call(SVar("map"),[Call(SVar("new"),[])])),Match(Var("p_12"))),Seq(Seq(Seq(Build(Var("p_12")),Call(SVar("map"),[Call(SVar("MkCall"),[])])),Match(Var("r_12"))),Seq(Seq(Build(Var("s_12")),Call(SVar("map"),[Scope(["u_12","v_12"],Seq(Seq(Id,Match(Op("SDef",[Var("q_12"),Var("u_12"),Var("v_12")]))),Seq(Build(Op("TCons",[Var("u_12"),Op("TCons",[Var("r_12"),Op("TCons",[Var("v_12"),Op("TNil",[])])])])),Call(SVar("ssubs"),[]))))])),Match(Var("t_12"))))))),Seq(Build(Op("SDef",[Var("q_12"),Var("p_12"),Op("Choices",[Var("t_12")])])),Id))))),SDef("JoinDefs1",[],Scope(["m_12"],Seq(Match(Op("Cons",[Var("m_12"),Op("Nil",[])])),Seq(Where(Id),Seq(Build(Var("m_12")),Id))))),SDef("joindefs",[],Scope([],LChoice(Call(SVar("JoinDefs1"),[]),Call(SVar("JoinDefs2"),[])))),SDef("NonOverloadedDef",[],Scope(["a_13","b_13","c_13"],Seq(Match(Op("TCons",[Op("TCons",[Var("a_13"),Op("TCons",[Int(0),Op("TNil",[])])]),Op("TCons",[Var("b_13"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Build(Var("b_13")),Call(SVar("filter"),[Call(SVar("SDef"),[Seq(Id,Match(Var("a_13"))),Id,Id])])),Match(Var("c_13"))))),Seq(Build(Var("c_13")),Id))))),SDef("plus",[],Scope([],Prim("_ST_plus"))),SDef("length",[],Scope([],Rec("h_43",Choice(Seq(Call(SVar("Nil"),[]),Build(Int(0))),Seq(Call(SVar("Tl"),[]),Seq(Call(SVar("h_43"),[]),Scope(["i_27"],Seq(Match(Var("i_27")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("i_27"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("plus"),[])),Id)))))))))),SDef("filter",["n_39"],Scope([],Rec("o_39",Choice(Call(SVar("Nil"),[]),LChoice(Call(SVar("Cons"),[Call(SVar("n_39"),[]),Call(SVar("o_39"),[])]),Seq(Call(SVar("Tl"),[]),Call(SVar("o_39"),[]))))))),SDef("OverloadedDef",[],Scope(["w_12","x_12","y_12","z_12"],Seq(Match(Op("TCons",[Op("TCons",[Var("w_12"),Op("TCons",[Var("x_12"),Op("TNil",[])])]),Op("TCons",[Var("y_12"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Build(Var("y_12")),Call(SVar("filter"),[Call(SVar("SDef"),[Seq(Id,Match(Var("w_12"))),Where(Seq(Call(SVar("length"),[]),Match(Var("x_12")))),Id])])),Match(Var("z_12"))))),Seq(Build(Var("z_12")),Id))))),SDef("debug",[],Scope([],Where(Seq(Call(SVar("split"),[Build(Op("stderr",[])),Scope(["o_25"],Seq(Match(Var("o_25")),Seq(Where(Id),Seq(Build(Op("Cons",[Var("o_25"),Op("Nil",[])])),Id))))]),Call(SVar("printnl"),[]))))),SDef("Ttl",[],Scope(["j_21","k_21"],Seq(Match(Op("TCons",[Var("j_21"),Var("k_21")])),Seq(Where(Id),Seq(Build(Var("k_21")),Id))))),SDef("Thd",[],Scope(["h_21","i_21"],Seq(Match(Op("TCons",[Var("i_21"),Var("h_21")])),Seq(Where(Id),Seq(Build(Var("i_21")),Id))))),SDef("tuple-unzip",["v_42"],Scope([],Rec("w_42",LChoice(Seq(Call(SVar("split"),[Call(SVar("map"),[Call(SVar("Thd"),[])]),Call(SVar("map"),[Call(SVar("Ttl"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("v_42"),[]),Call(SVar("TCons"),[Call(SVar("w_42"),[]),Call(SVar("TNil"),[])])]),Scope(["g_27","h_27"],Seq(Match(Op("TCons",[Var("g_27"),Op("TCons",[Var("h_27"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("g_27"),Var("h_27")])),Id)))))),Seq(Call(SVar("map"),[Call(SVar("TNil"),[])]),Build(Op("TNil",[]))))))),SDef("MkThreadApplication",[],Scope(["p_14","q_14","r_14","s_14","t_14"],Seq(Match(Op("TCons",[Var("p_14"),Op("TCons",[Var("q_14"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Call(SVar("new"),[]),Match(Var("r_14"))),Seq(Seq(Call(SVar("new"),[]),Match(Var("s_14"))),Seq(Call(SVar("new"),[]),Match(Var("t_14"))))))),Seq(Build(Op("TCons",[Op("BAM",[Op("Call",[Op("SVar",[Var("r_14")]),Op("Nil",[])]),Op("Op",[Str("Pair"),Op("Cons",[Op("Var",[Var("s_14")]),Op("Cons",[Op("Var",[Var("p_14")]),Op("Nil",[])])])]),Op("Op",[Str("Pair"),Op("Cons",[Op("Var",[Var("t_14")]),Op("Cons",[Op("Var",[Var("q_14")]),Op("Nil",[])])])])]),Op("TCons",[Var("r_14"),Op("TCons",[Var("s_14"),Op("TCons",[Op("Var",[Var("s_14")]),Op("TCons",[Var("t_14"),Op("TCons",[Op("Var",[Var("t_14")]),Op("TNil",[])])])])])])])),Id))))),SDef("Zip1b'",[],Scope([],Seq(Match(Op("TCons",[Wld,Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Nil",[])),Id))))),SDef("zipr",["w_41"],Scope([],Call(SVar("genzip"),[Call(SVar("Zip1b'"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("w_41"),[])]))),SDef("Tl",[],Scope(["r_19","s_19"],Seq(Match(Op("Cons",[Var("r_19"),Var("s_19")])),Seq(Where(Id),Seq(Build(Var("s_19")),Id))))),SDef("Last",[],Scope(["t_19"],Seq(Match(Op("Cons",[Var("t_19"),Op("Nil",[])])),Seq(Where(Id),Seq(Build(Var("t_19")),Id))))),SDef("last",[],Scope([],Rec("n_40",LChoice(Call(SVar("Last"),[]),Seq(Call(SVar("Tl"),[]),Call(SVar("n_40"),[])))))),SDef("add",[],Scope([],Prim("_ST_add"))),SDef("geq",[],Scope([],Prim("_ST_geq"))),SDef("subt",[],Scope([],Prim("_ST_subt"))),SDef("copy",["o_40"],Scope([],Call(SVar("for"),[Scope(["o_26","p_26"],Seq(Match(Op("TCons",[Var("o_26"),Op("TCons",[Var("p_26"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("o_26"),Op("TCons",[Var("p_26"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])])),Id)))),Scope(["q_26","r_26"],Seq(Match(Op("TCons",[Int(0),Op("TCons",[Var("q_26"),Op("TCons",[Var("r_26"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Build(Var("r_26")),Id)))),Scope(["s_26","t_26","u_26"],Seq(Match(Op("TCons",[Var("s_26"),Op("TCons",[Var("t_26"),Op("TCons",[Var("u_26"),Op("TNil",[])])])])),Seq(Where(Where(Seq(Build(Op("TCons",[Var("s_26"),Op("TCons",[Int(1),Op("TNil",[])])])),Call(SVar("geq"),[])))),Seq(Scope(["q_60"],Seq(Seq(Build(Op("TCons",[Var("s_26"),Op("TCons",[Int(1),Op("TNil",[])])])),Seq(Call(SVar("subt"),[]),Seq(Match(Var("q_60")),Id))),Scope(["u_60"],Seq(Seq(Build(Var("t_26")),Seq(Call(SVar("o_40"),[]),Seq(Match(Var("u_60")),Id))),Build(Op("TCons",[Var("q_60"),Op("TCons",[Var("t_26"),Op("TCons",[Op("Cons",[Var("u_60"),Var("u_26")]),Op("TNil",[])])])])))))),Id))))]))),SDef("MkDistApplication",[],Scope(["a_14","b_14","c_14","d_14"],Seq(Match(Var("a_14")),Seq(Where(Where(Seq(Seq(Call(SVar("new"),[]),Match(Var("b_14"))),Seq(Seq(Call(SVar("new"),[]),Match(Var("c_14"))),Seq(Call(SVar("new"),[]),Match(Var("d_14"))))))),Seq(Build(Op("TCons",[Op("BAM",[Op("Call",[Op("SVar",[Var("b_14")]),Op("Nil",[])]),Op("Op",[Str("Pair"),Op("Cons",[Op("Var",[Var("c_14")]),Op("Cons",[Var("a_14"),Op("Nil",[])])])]),Op("Var",[Var("d_14")])]),Op("TCons",[Var("b_14"),Op("TCons",[Var("c_14"),Op("TCons",[Op("Var",[Var("c_14")]),Op("TCons",[Var("d_14"),Op("TCons",[Op("Var",[Var("d_14")]),Op("TNil",[])])])])])])])),Id))))),SDef("DefineCongruence",[],Choice(Scope(["r_13","s_13","t_13","u_13","v_13","w_13","x_13","y_13","z_13"],Seq(Match(Op("TCons",[Var("r_13"),Op("TCons",[Str("D"),Op("TCons",[Var("s_13"),Op("TNil",[])])])])),Seq(Where(Where(Seq(Seq(Call(SVar("new"),[]),Match(Var("t_13"))),Seq(Seq(Build(Op("TCons",[Var("s_13"),Op("TCons",[Op("Var",[Var("t_13")]),Op("TNil",[])])])),Seq(Call(SVar("copy"),[Call(SVar("MkDistApplication"),[])]),Call(SVar("tuple-unzip"),[Id]))),Match(Op("TCons",[Var("u_13"),Op("TCons",[Var("v_13"),Op("TCons",[Var("w_13"),Op("TCons",[Var("x_13"),Op("TCons",[Var("y_13"),Op("TCons",[Var("z_13"),Op("TNil",[])])])])])])])))))),Seq(Scope(["n_61"],Seq(Seq(Build(Op("TCons",[Var("w_13"),Op("TCons",[Var("y_13"),Op("TNil",[])])])),Seq(Call(SVar("conc"),[]),Seq(Match(Var("n_61")),Id))),Build(Op("SDef",[Op("Mod",[Var("r_13"),Str("D")]),Var("v_13"),Op("Scope",[Op("Cons",[Var("t_13"),Var("n_61")]),Op("SRule",[Op("Rule",[Op("Op",[Str("Pair"),Op("Cons",[Op("Op",[Var("r_13"),Var("x_13")]),Op("Cons",[Op("Var",[Var("t_13")]),Op("Nil",[])])])]),Op("Op",[Var("r_13"),Var("z_13")]),Op("Seqs",[Var("u_13")])])])])])))),Id)))),Choice(Scope(["e_14","f_14","g_14","h_14","i_14","j_14","k_14","l_14","m_14","n_14","o_14"],Seq(Match(Op("TCons",[Var("e_14"),Op("TCons",[Str("T"),Op("TCons",[Var("f_14"),Op("TNil",[])])])])),Seq(Where(Where(Seq(Seq(Seq(Scope(["v_61"],Seq(Seq(Build(Op("TCons",[Var("f_14"),Op("TCons",[Int(1),Op("TNil",[])])])),Seq(Call(SVar("add"),[]),Seq(Match(Var("v_61")),Id))),Build(Op("TCons",[Var("v_61"),Op("TCons",[Op("TNil",[]),Op("TNil",[])])])))),Call(SVar("copy"),[Call(SVar("new"),[])])),Match(Op("Cons",[Var("h_14"),Var("i_14")]))),Seq(Seq(Seq(Build(Var("i_14")),Call(SVar("last"),[])),Match(Var("g_14"))),Seq(Seq(Build(Op("TCons",[Op("Cons",[Var("h_14"),Var("i_14")]),Op("TCons",[Var("i_14"),Op("TNil",[])])])),Seq(Call(SVar("zipr"),[Call(SVar("MkThreadApplication"),[])]),Call(SVar("tuple-unzip"),[Id]))),Match(Op("TCons",[Var("j_14"),Op("TCons",[Var("k_14"),Op("TCons",[Var("l_14"),Op("TCons",[Var("m_14"),Op("TCons",[Var("n_14"),Op("TCons",[Var("o_14"),Op("TNil",[])])])])])])]))))))),Seq(Scope(["i_62"],Seq(Seq(Build(Op("Cons",[Var("i_14"),Op("Cons",[Var("l_14"),Op("Cons",[Var("n_14"),Op("Nil",[])])])])),Seq(Call(SVar("concat"),[]),Seq(Match(Var("i_62")),Id))),Build(Op("SDef",[Op("Mod",[Var("e_14"),Str("T")]),Var("k_14"),Op("Scope",[Op("Cons",[Var("h_14"),Var("i_62")]),Op("SRule",[Op("Rule",[Op("Op",[Str("Pair"),Op("Cons",[Op("Op",[Var("e_14"),Var("m_14")]),Op("Cons",[Op("Var",[Var("h_14")]),Op("Nil",[])])])]),Op("Op",[Str("Pair"),Op("Cons",[Op("Op",[Var("e_14"),Var("o_14")]),Op("Cons",[Op("Var",[Var("g_14")]),Op("Nil",[])])])]),Op("Seqs",[Var("j_14")])])])])])))),Id)))),Fail))),SDef("CongruenceDef",[],Scope(["d_13","e_13","f_13","g_13","h_13"],Seq(Match(Op("TCons",[Op("TCons",[Op("Mod",[Var("e_13"),Var("f_13")]),Op("TCons",[Var("g_13"),Op("TNil",[])])]),Op("TCons",[Var("d_13"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Build(Op("TCons",[Var("e_13"),Op("TCons",[Var("f_13"),Op("TCons",[Var("g_13"),Op("TNil",[])])])])),Call(SVar("DefineCongruence"),[])),Match(Var("h_13"))))),Seq(Build(Var("h_13")),Id))))),SDef("get-definition",[],Scope([],LChoice(Seq(Call(SVar("CongruenceDef"),[]),Call(SVar("debug"),[])),LChoice(Seq(Call(SVar("OverloadedDef"),[]),Call(SVar("joindefs"),[])),Seq(Call(SVar("NonOverloadedDef"),[]),Call(SVar("joindefs"),[])))))),SDef("GnUndefined",[],Scope(["v_9","w_9","x_9","y_9","z_9","a_10"],Seq(Match(Op("TCons",[Op("Cons",[Var("z_9"),Var("v_9")]),Op("TCons",[Var("w_9"),Op("TCons",[Var("x_9"),Op("TCons",[Var("y_9"),Op("TCons",[Var("a_10"),Op("TNil",[])])])])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("v_9"),Op("TCons",[Var("w_9"),Op("TCons",[Var("x_9"),Op("TCons",[Var("y_9"),Op("TCons",[Op("Cons",[Var("z_9"),Var("a_10")]),Op("TNil",[])])])])])])),Id))))),SDef("GnNext",["r_32","s_32","t_32"],Scope(["m_9","n_9","o_9","p_9","q_9","r_9","s_9","t_9","u_9"],Seq(Match(Op("TCons",[Op("Cons",[Var("p_9"),Var("m_9")]),Op("TCons",[Var("t_9"),Op("TCons",[Var("q_9"),Op("TCons",[Var("n_9"),Op("TCons",[Var("o_9"),Op("TNil",[])])])])])])),Seq(Where(Where(Seq(Seq(Seq(Build(Op("TCons",[Var("p_9"),Op("TCons",[Var("q_9"),Op("TNil",[])])])),Call(SVar("r_32"),[])),Match(Var("r_9"))),Seq(Seq(Seq(Build(Var("r_9")),Call(SVar("s_32"),[])),Match(Var("s_9"))),Seq(Seq(Build(Op("TCons",[Var("s_9"),Op("TCons",[Var("t_9"),Op("TNil",[])])])),Call(SVar("diff"),[])),Match(Var("u_9"))))))),Seq(Scope(["k_63"],Seq(Seq(Build(Op("TCons",[Var("u_9"),Op("TCons",[Var("m_9"),Op("TNil",[])])])),Seq(Call(SVar("conc"),[]),Seq(Match(Var("k_63")),Id))),Scope(["o_63"],Seq(Seq(Build(Op("TCons",[Var("u_9"),Op("TCons",[Var("t_9"),Op("TNil",[])])])),Seq(Call(SVar("conc"),[]),Seq(Match(Var("o_63")),Id))),Scope(["s_63"],Seq(Seq(Build(Op("TCons",[Var("p_9"),Op("TCons",[Var("r_9"),Op("TCons",[Var("n_9"),Op("TNil",[])])])])),Seq(Call(SVar("t_32"),[]),Seq(Match(Var("s_63")),Id))),Build(Op("TCons",[Var("k_63"),Op("TCons",[Var("o_63"),Op("TCons",[Var("q_9"),Op("TCons",[Var("s_63"),Op("TCons",[Var("o_9"),Op("TNil",[])])])])])])))))))),Id))))),SDef("GnExit",[],Scope(["b_10","c_10","d_10","e_10"],Seq(Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Var("b_10"),Op("TCons",[Var("c_10"),Op("TCons",[Var("d_10"),Op("TCons",[Var("e_10"),Op("TNil",[])])])])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("d_10"),Op("TCons",[Var("e_10"),Op("TNil",[])])])),Id))))),SDef("GnInit",[],Scope(["j_9","k_9","l_9"],Seq(Match(Op("TCons",[Var("j_9"),Op("TCons",[Var("k_9"),Op("TCons",[Var("l_9"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("Cons",[Var("j_9"),Op("Nil",[])]),Op("TCons",[Op("Cons",[Var("j_9"),Op("Nil",[])]),Op("TCons",[Var("k_9"),Op("TCons",[Var("l_9"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])])])])),Id))))),SDef("repeat-until",["i_37","j_37"],Scope([],Rec("k_37",Seq(Call(SVar("i_37"),[]),LChoice(Call(SVar("j_37"),[]),Call(SVar("k_37"),[])))))),SDef("for",["u_37","v_37","w_37"],Scope([],Seq(Call(SVar("u_37"),[]),Call(SVar("repeat-until"),[Call(SVar("w_37"),[]),Call(SVar("v_37"),[])])))),SDef("graph-nodes-undef",["c_35","d_35","e_35"],Scope([],Call(SVar("for"),[Call(SVar("GnInit"),[]),Call(SVar("GnExit"),[]),LChoice(Call(SVar("GnNext"),[Call(SVar("c_35"),[]),Call(SVar("d_35"),[]),Call(SVar("e_35"),[])]),Call(SVar("GnUndefined"),[]))]))),SDef("needed-defs",[],Scope([],Seq(Scope(["u_25"],Seq(Match(Var("u_25")),Seq(Where(Id),Seq(Build(Op("TCons",[Op("TCons",[Str("main"),Op("TCons",[Int(0),Op("TNil",[])])]),Op("TCons",[Var("u_25"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])])),Id)))),Seq(Call(SVar("graph-nodes-undef"),[Call(SVar("get-definition"),[]),Call(SVar("svars-arity"),[]),Scope(["v_25","w_25"],Seq(Match(Op("TCons",[Wld,Op("TCons",[Var("v_25"),Op("TCons",[Var("w_25"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("v_25"),Var("w_25")])),Id))))]),LChoice(Call(SVar("NoMissingDefs"),[]),Seq(Call(SVar("MissingDefs"),[]),Seq(Build(Int(1)),Call(SVar("exit"),[])))))))),SDef("Hd",[],Scope(["p_19","q_19"],Seq(Match(Op("Cons",[Var("q_19"),Var("p_19")])),Seq(Where(Id),Seq(Build(Var("q_19")),Id))))),SDef("spaste",["j_48"],Scope([],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Seq(Call(SVar("j_48"),[]),Call(SVar("Hd"),[])),Id,Id]),Id]),Choice(Call(SVar("SDef"),[Id,Call(SVar("j_48"),[]),Id]),Call(SVar("Rec"),[Seq(Call(SVar("j_48"),[]),Call(SVar("Hd"),[])),Id]))))),SDef("Rec",["j_31","k_31"],Cong("Rec",[Call(SVar("j_31"),[]),Call(SVar("k_31"),[])])),SDef("SDef",["n_31","o_31","p_31"],Cong("SDef",[Call(SVar("n_31"),[]),Call(SVar("o_31"),[]),Call(SVar("p_31"),[])])),SDef("Let",["l_31","m_31"],Cong("Let",[Call(SVar("l_31"),[]),Call(SVar("m_31"),[])])),SDef("sboundin",["k_48","l_48","m_48"],Scope([],Choice(Call(SVar("Let"),[Call(SVar("SDef"),[Call(SVar("m_48"),[]),Call(SVar("m_48"),[]),Call(SVar("l_48"),[])]),Call(SVar("k_48"),[])]),Choice(Call(SVar("SDef"),[Call(SVar("m_48"),[]),Call(SVar("m_48"),[]),Call(SVar("k_48"),[])]),Call(SVar("Rec"),[Call(SVar("m_48"),[]),Call(SVar("k_48"),[])]))))),SDef("Bind3",[],Scope(["m_22","n_22"],Seq(Match(Op("Rec",[Var("n_22"),Var("m_22")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("n_22"),Op("Nil",[])])),Id))))),SDef("Bind2",[],Scope(["j_22","k_22","l_22"],Seq(Match(Op("SDef",[Var("j_22"),Var("l_22"),Var("k_22")])),Seq(Where(Id),Seq(Build(Var("l_22")),Id))))),SDef("Bind1",[],Scope(["f_22","g_22","h_22","i_22"],Seq(Match(Op("Let",[Op("SDef",[Var("i_22"),Var("f_22"),Var("g_22")]),Var("h_22")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("i_22"),Op("Nil",[])])),Id))))),SDef("SVar",["i_31"],Cong("SVar",[Call(SVar("i_31"),[])])),SDef("srename",[],Scope([],Call(SVar("rename"),[Call(SVar("SVar"),[]),Choice(Call(SVar("Bind1"),[]),Choice(Call(SVar("Bind2"),[]),Call(SVar("Bind3"),[]))),Call(SVar("sboundin"),[]),Call(SVar("spaste"),[])]))),SDef("tpaste",["f_48"],Scope([],Call(SVar("Scope"),[Call(SVar("f_48"),[]),Id]))),SDef("Var",["u_30"],Cong("Var",[Call(SVar("u_30"),[])])),SDef("DistBinding",["r_33","s_33"],Scope(["c_16","d_16","e_16"],Seq(Match(Op("TCons",[Var("e_16"),Op("TCons",[Var("d_16"),Op("TCons",[Var("c_16"),Op("TNil",[])])])])),Seq(Where(Id),Seq(Seq(Build(Var("e_16")),Call(SVar("r_33"),[Scope(["f_16"],Seq(Match(Var("f_16")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("f_16"),Op("TCons",[Var("c_16"),Op("TNil",[])])])),Call(SVar("s_33"),[])),Id)))),Scope(["g_16"],Seq(Match(Var("g_16")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("g_16"),Op("TCons",[Var("d_16"),Op("TNil",[])])])),Call(SVar("s_33"),[])),Id)))),Id])),Id))))),SDef("Zip3",[],Scope(["z_17","a_18"],Seq(Match(Op("TCons",[Var("z_17"),Op("TCons",[Var("a_18"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("z_17"),Var("a_18")])),Id))))),SDef("Zip2",[],Scope(["p_17","q_17","r_17","s_17"],Seq(Match(Op("TCons",[Op("Cons",[Var("p_17"),Var("r_17")]),Op("TCons",[Op("Cons",[Var("q_17"),Var("s_17")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("TCons",[Var("p_17"),Op("TCons",[Var("q_17"),Op("TNil",[])])]),Op("TCons",[Op("TCons",[Var("r_17"),Op("TCons",[Var("s_17"),Op("TNil",[])])]),Op("TNil",[])])])),Id))))),SDef("Zip1",[],Scope([],Seq(Match(Op("TCons",[Op("Nil",[]),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("Nil",[])),Id))))),SDef("genzip",["o_41","p_41","q_41","r_41"],Scope([],Rec("s_41",Choice(Call(SVar("o_41"),[]),Seq(Call(SVar("p_41"),[]),Seq(Call(SVar("TCons"),[Call(SVar("r_41"),[]),Call(SVar("TCons"),[Call(SVar("s_41"),[]),Call(SVar("TNil"),[])])]),Call(SVar("q_41"),[]))))))),SDef("zip",["t_41"],Scope([],Call(SVar("genzip"),[Call(SVar("Zip1"),[]),Call(SVar("Zip2"),[]),Call(SVar("Zip3"),[]),Call(SVar("t_41"),[])]))),SDef("conc",[],Scope(["i_20","j_20"],Seq(Match(Op("TCons",[Var("j_20"),Op("TCons",[Var("i_20"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("j_20")),Call(SVar("at_end"),[Build(Var("i_20"))])),Id))))),SDef("RnBinding",["p_33","q_33"],Scope(["x_15","y_15","z_15","a_16","b_16"],Seq(Match(Op("TCons",[Var("x_15"),Op("TCons",[Var("a_16"),Op("TNil",[])])])),Seq(Where(Where(Seq(Seq(Seq(Build(Var("x_15")),Call(SVar("p_33"),[])),Match(Var("y_15"))),Seq(Seq(Call(SVar("map"),[Call(SVar("new"),[])]),Match(Var("z_15"))),Seq(Seq(Scope(["q_66"],Seq(Seq(Build(Op("TCons",[Var("y_15"),Op("TCons",[Var("z_15"),Op("TNil",[])])])),Seq(Call(SVar("zip"),[Id]),Seq(Match(Var("q_66")),Id))),Build(Op("TCons",[Var("q_66"),Op("TCons",[Var("a_16"),Op("TNil",[])])])))),Call(SVar("conc"),[])),Match(Var("b_16"))))))),Seq(Scope(["x_66"],Seq(Seq(Build(Var("x_15")),Seq(Call(SVar("q_33"),[Build(Var("z_15"))]),Seq(Match(Var("x_66")),Id))),Build(Op("TCons",[Var("x_66"),Op("TCons",[Var("a_16"),Op("TCons",[Var("b_16"),Op("TNil",[])])])])))),Id))))),SDef("Look2",[],Scope(["u_16","v_16"],Seq(Match(Op("TCons",[Var("u_16"),Op("TCons",[Op("Cons",[Wld,Var("v_16")]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Var("u_16"),Op("TCons",[Var("v_16"),Op("TNil",[])])])),Id))))),SDef("Look1",[],Scope(["s_16","t_16"],Seq(Match(Op("TCons",[Var("s_16"),Op("TCons",[Op("Cons",[Op("TCons",[Var("s_16"),Op("TCons",[Var("t_16"),Op("TNil",[])])]),Wld]),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Var("t_16")),Id))))),SDef("lookup",[],Scope([],Rec("p_40",LChoice(Call(SVar("Look1"),[]),Seq(Call(SVar("Look2"),[]),Call(SVar("p_40"),[])))))),SDef("RnVar",["o_33"],Scope(["v_15","w_15"],Seq(Match(Op("TCons",[Var("w_15"),Op("TCons",[Var("v_15"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("w_15")),Call(SVar("o_33"),[Seq(Call(SVar("split"),[Id,Build(Var("v_15"))]),Call(SVar("lookup"),[]))])),Id))))),SDef("dist",["k_33"],Scope(["k_15","l_15"],Seq(Match(Op("TCons",[Var("l_15"),Op("TCons",[Var("k_15"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("l_15")),All(Scope(["m_15"],Seq(Match(Var("m_15")),Seq(Where(Id),Seq(Seq(Build(Op("TCons",[Var("m_15"),Op("TCons",[Var("k_15"),Op("TNil",[])])])),Call(SVar("k_33"),[])),Id)))))),Id))))),SDef("env-alltd",["b_39"],Scope([],Rec("c_39",LChoice(Call(SVar("b_39"),[]),Call(SVar("dist"),[Call(SVar("c_39"),[])]))))),SDef("rename",["i_39","j_39","k_39","l_39"],Scope([],Seq(Scope(["b_26"],Seq(Match(Var("b_26")),Seq(Where(Id),Seq(Build(Op("TCons",[Var("b_26"),Op("TCons",[Op("Nil",[]),Op("TNil",[])])])),Id)))),Rec("m_39",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("i_39"),[])]),Seq(Call(SVar("RnBinding"),[Call(SVar("j_39"),[]),Call(SVar("l_39"),[])]),Call(SVar("DistBinding"),[Call(SVar("k_39"),[]),Call(SVar("m_39"),[])])))]))))),SDef("trename",[],Scope([],Call(SVar("rename"),[Call(SVar("Var"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[]),Call(SVar("tpaste"),[])]))),SDef("strename",[],Scope([],Seq(Call(SVar("trename"),[]),Call(SVar("srename"),[])))),SDef("DeclareVariables",[],Scope(["p_23","q_23","r_23"],Seq(Match(Op("SDef",[Var("p_23"),Var("q_23"),Var("r_23")])),Seq(Where(Id),Seq(Scope(["h_68"],Seq(Seq(Build(Var("r_23")),Seq(Call(SVar("tvars"),[]),Seq(Match(Var("h_68")),Id))),Build(Op("SDef",[Var("p_23"),Var("q_23"),Op("Scope",[Var("h_68"),Var("r_23")])])))),Id))))),SDef("map",["z_42"],Scope([],Rec("a_43",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("z_42"),[]),Call(SVar("a_43"),[])]))))),SDef("Scope",["e_32","f_32"],Cong("Scope",[Call(SVar("e_32"),[]),Call(SVar("f_32"),[])])),SDef("tboundin",["g_48","h_48","i_48"],Scope([],Call(SVar("Scope"),[Call(SVar("i_48"),[]),Call(SVar("g_48"),[])]))),SDef("Bind0",[],Choice(Scope(["a_22","b_22"],Seq(Match(Op("Scope",[Var("b_22"),Var("a_22")])),Seq(Where(Id),Seq(Build(Var("b_22")),Id)))),Choice(Scope(["c_22","d_22","e_22"],Seq(Match(Op("LRule",[Op("Rule",[Var("e_22"),Var("c_22"),Var("d_22")])])),Seq(Where(Id),Seq(Seq(Build(Var("e_22")),Call(SVar("tvars"),[])),Id)))),Fail))),SDef("Add1",[],Scope(["t_21"],Seq(Match(Op("Var",[Var("t_21")])),Seq(Where(Id),Seq(Build(Op("Cons",[Var("t_21"),Op("Nil",[])])),Id))))),SDef("union",[],Scope(["d_17","e_17"],Seq(Match(Op("TCons",[Var("e_17"),Op("TCons",[Var("d_17"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("e_17")),Rec("b_34",LChoice(Seq(Call(SVar("Nil"),[]),Build(Var("d_17"))),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("d_17"))]),Call(SVar("b_34"),[])),Call(SVar("Cons"),[Id,Call(SVar("b_34"),[])]))))),Id))))),SDef("foldr",["b_40","c_40","d_40"],Scope([],Rec("e_40",Choice(Seq(Call(SVar("Nil"),[]),Call(SVar("b_40"),[])),Seq(Scope(["d_26","e_26"],Seq(Match(Op("Cons",[Var("d_26"),Var("e_26")])),Seq(Where(Id),Seq(Scope(["j_69"],Seq(Seq(Build(Var("d_26")),Seq(Call(SVar("d_40"),[]),Seq(Match(Var("j_69")),Id))),Scope(["n_69"],Seq(Seq(Build(Var("e_26")),Seq(Call(SVar("e_40"),[]),Seq(Match(Var("n_69")),Id))),Build(Op("TCons",[Var("j_69"),Op("TCons",[Var("n_69"),Op("TNil",[])])])))))),Id)))),Call(SVar("c_40"),[])))))),SDef("foldr-kids",["h_34","i_34","j_34"],Scope(["m_17"],Seq(Scope(["u_69"],Seq(Match(Var("u_69")),Where(Seq(Build(Var("u_69")),Seq(Prim("_ST_explode_term"),Seq(Match(Op("TCons",[Wld,Op("TCons",[Var("m_17"),Op("TNil",[])])])),Id)))))),Seq(Where(Id),Seq(Seq(Build(Var("m_17")),Call(SVar("foldr"),[Call(SVar("h_34"),[]),Call(SVar("i_34"),[]),Call(SVar("j_34"),[])])),Id))))),SDef("collect-kids",["v_40"],Scope([],Call(SVar("foldr-kids"),[Build(Op("Nil",[])),Call(SVar("union"),[]),Call(SVar("v_40"),[])]))),SDef("HdMember",["y_33"],Scope(["y_16","z_16"],Seq(Match(Op("Cons",[Var("z_16"),Var("y_16")])),Seq(Where(Where(Seq(Call(SVar("y_33"),[]),Call(SVar("fetch"),[Seq(Id,Match(Var("z_16")))])))),Seq(Build(Var("y_16")),Id))))),SDef("diff",[],Scope(["f_17","g_17"],Seq(Match(Op("TCons",[Var("g_17"),Op("TCons",[Var("f_17"),Op("TNil",[])])])),Seq(Where(Id),Seq(Seq(Build(Var("g_17")),Rec("c_34",LChoice(Call(SVar("Nil"),[]),LChoice(Seq(Call(SVar("HdMember"),[Build(Var("f_17"))]),Call(SVar("c_34"),[])),Call(SVar("Cons"),[Id,Call(SVar("c_34"),[])]))))),Id))))),SDef("free-vars",["g_38","h_38","i_38"],Scope([],Rec("j_38",LChoice(Call(SVar("g_38"),[]),LChoice(Seq(Scope(["x_25"],Seq(Where(Seq(Call(SVar("h_38"),[]),Match(Var("x_25")))),Call(SVar("i_38"),[Seq(Call(SVar("split"),[Call(SVar("j_38"),[]),Build(Var("x_25"))]),Call(SVar("diff"),[])),Call(SVar("j_38"),[]),Build(Op("Nil",[]))]))),Call(SVar("collect-kids"),[Id])),Call(SVar("collect-kids"),[Call(SVar("j_38"),[])])))))),SDef("tvars",[],Scope([],Call(SVar("free-vars"),[Call(SVar("Add1"),[]),Call(SVar("Bind0"),[]),Call(SVar("tboundin"),[])]))),SDef("RDtoSD",[],Scope(["m_23","n_23","o_23"],Seq(Match(Op("RDef",[Var("m_23"),Var("n_23"),Var("o_23")])),Seq(Where(Id),Seq(Scope(["v_70"],Seq(Seq(Build(Var("o_23")),Seq(Call(SVar("tvars"),[]),Seq(Match(Var("v_70")),Id))),Build(Op("SDef",[Var("m_23"),Var("n_23"),Op("Scope",[Var("v_70"),Op("SRule",[Var("o_23")])])])))),Id))))),SDef("new",[],Scope([],Prim("_ST_new"))),SDef("MkCall",[],Scope(["z_21"],Seq(Match(Var("z_21")),Seq(Where(Id),Seq(Build(Op("Call",[Op("SVar",[Var("z_21")]),Op("Nil",[])])),Id))))),SDef("MkCongDef",[],Choice(Scope(["o_22","p_22"],Seq(Match(Op("OpDecl",[Var("p_22"),Op("ConstType",[Var("o_22")])])),Seq(Where(Id),Seq(Build(Op("SDef",[Var("p_22"),Op("Nil",[]),Op("Cong",[Var("p_22"),Op("Nil",[])])])),Id)))),Choice(Scope(["q_22","r_22","s_22","t_22"],Seq(Match(Op("OpDecl",[Var("r_22"),Op("FunType",[Var("s_22"),Var("q_22")])])),Seq(Where(Where(Seq(Seq(Build(Var("s_22")),Call(SVar("map"),[Call(SVar("new"),[])])),Match(Var("t_22"))))),Seq(Scope(["o_71"],Seq(Seq(Build(Var("t_22")),Seq(Call(SVar("map"),[Call(SVar("MkCall"),[])]),Seq(Match(Var("o_71")),Id))),Build(Op("SDef",[Var("r_22"),Var("t_22"),Op("Cong",[Var("r_22"),Var("o_71")])])))),Id)))),Fail))),SDef("MkCongDefs",[],Choice(Scope(["u_22"],Seq(Match(Op("Sorts",[Var("u_22")])),Seq(Where(Id),Seq(Build(Op("Nil",[])),Id)))),Choice(Scope(["v_22"],Seq(Match(Op("Operations",[Var("v_22")])),Seq(Where(Id),Seq(Seq(Build(Var("v_22")),Call(SVar("map"),[Call(SVar("MkCongDef"),[])])),Id)))),Fail))),SDef("congdefs",[],Scope([],Seq(Call(SVar("map"),[Call(SVar("MkCongDefs"),[])]),Call(SVar("concat"),[])))),SDef("at_end",["l_43"],Scope([],Rec("m_43",Choice(Call(SVar("Cons"),[Id,Call(SVar("m_43"),[])]),Seq(Call(SVar("Nil"),[]),Call(SVar("l_43"),[])))))),SDef("Concat",["m_34"],Scope(["k_20","l_20"],Seq(Match(Op("Cons",[Var("l_20"),Var("k_20")])),Seq(Where(Id),Seq(Seq(Build(Var("l_20")),Call(SVar("at_end"),[Seq(Build(Var("k_20")),Call(SVar("m_34"),[]))])),Id))))),SDef("concat",[],Scope([],Rec("b_44",Choice(Call(SVar("Nil"),[]),Call(SVar("Concat"),[Call(SVar("b_44"),[])]))))),SDef("RulesToSdefs",[],Scope(["z_23","a_24","b_24"],Seq(Match(Op("Specification",[Op("Cons",[Op("Signature",[Var("z_23")]),Op("Cons",[Op("Rules",[Var("a_24")]),Op("Cons",[Op("Strategies",[Var("b_24")]),Op("Nil",[])])])])])),Seq(Where(Id),Seq(Scope(["k_72"],Seq(Seq(Scope(["l_72"],Seq(Seq(Build(Var("z_23")),Seq(Call(SVar("congdefs"),[]),Seq(Match(Var("l_72")),Id))),Scope(["p_72"],Seq(Seq(Build(Var("a_24")),Seq(Call(SVar("map"),[Call(SVar("RDtoSD"),[])]),Seq(Match(Var("p_72")),Id))),Scope(["t_72"],Seq(Seq(Build(Var("b_24")),Seq(Call(SVar("map"),[Call(SVar("DeclareVariables"),[])]),Seq(Match(Var("t_72")),Id))),Build(Op("Cons",[Var("l_72"),Op("Cons",[Var("p_72"),Op("Cons",[Var("t_72"),Op("Nil",[])])])])))))))),Seq(Call(SVar("concat"),[]),Seq(Match(Var("k_72")),Id))),Build(Op("Specification",[Op("Cons",[Op("Signature",[Var("z_23")]),Op("Cons",[Op("Strategies",[Var("k_72")]),Op("Nil",[])])])])))),Id))))),SDef("extract",[],Scope([],Seq(Call(SVar("RulesToSdefs"),[]),Seq(Call(SVar("strename"),[]),Seq(Scope(["i_28"],Seq(Match(Op("Specification",[Op("Cons",[Wld,Op("Cons",[Op("Strategies",[Var("i_28")]),Op("Nil",[])])])])),Seq(Where(Id),Seq(Build(Var("i_28")),Id)))),Seq(Call(SVar("needed-defs"),[]),Call(SVar("desugar-spec"),[]))))))),SDef("TNil",[],Cong("TNil",[])),SDef("TCons",["q_28","r_28"],Cong("TCons",[Call(SVar("q_28"),[]),Call(SVar("r_28"),[])])),SDef("report-failure",[],Scope([],Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("rewriting failed"),Op("Nil",[])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))),SDef("try",["r_44"],Scope([],LChoice(Call(SVar("r_44"),[]),Id))),SDef("report-success",[],Scope(["l_25","m_25"],Seq(Where(Call(SVar("try"),[Seq(Call(SVar("TCons"),[Not(Call(SVar("option-defined"),[Seq(Id,Match(Op("Silent",[])))])),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Runtime",[Var("m_25")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("l_25")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Var("l_25"),Op("Cons",[Str(" ("),Op("Cons",[Var("m_25"),Op("Cons",[Str(" secs)"),Op("Nil",[])])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])))))])),Seq(Build(Int(0)),Call(SVar("exit"),[]))))),SDef("WriteToTextFile",[],Scope([],Prim("_ST_WriteToTextFile"))),SDef("WriteToBinaryFile",[],Scope([],Prim("_ST_WriteToBinaryFile"))),SDef("output-file'",[],Scope(["k_25"],Seq(Call(SVar("TCons"),[LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Output",[Var("k_25")])))]),Seq(Build(Op("stdout",[])),Match(Var("k_25")))),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("split"),[Build(Var("k_25")),Id]),Call(SVar("TNil"),[])])]),LChoice(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Binary",[])))]),Call(SVar("TCons"),[Call(SVar("WriteToBinaryFile"),[]),Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("WriteToTextFile"),[]),Call(SVar("TNil"),[])])])))))),SDef("dtime",[],Scope([],Prim("_ST_dtime"))),SDef("apply-strategy",["z_35"],Scope(["h_25"],Seq(Where(Call(SVar("dtime"),[])),Seq(Call(SVar("z_35"),[]),Seq(Where(Seq(Call(SVar("dtime"),[]),Match(Var("h_25")))),Scope(["i_25","j_25"],Seq(Match(Op("TCons",[Var("i_25"),Op("TCons",[Var("j_25"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("Cons",[Op("Runtime",[Var("h_25")]),Var("i_25")]),Op("TCons",[Var("j_25"),Op("TNil",[])])])),Id))))))))),SDef("ReadFromFile",[],Scope([],Prim("_ST_ReadFromFile"))),SDef("split",["o_34","p_34"],Scope(["d_21"],Seq(Match(Var("d_21")),Seq(Where(Id),Seq(Scope(["f_74"],Seq(Seq(Build(Var("d_21")),Seq(Call(SVar("o_34"),[]),Seq(Match(Var("f_74")),Id))),Scope(["j_74"],Seq(Seq(Build(Var("d_21")),Seq(Call(SVar("p_34"),[]),Seq(Match(Var("j_74")),Id))),Build(Op("TCons",[Var("f_74"),Op("TCons",[Var("j_74"),Op("TNil",[])])])))))),Id))))),SDef("input-file'",[],Scope(["g_25"],Seq(LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Input",[Var("g_25")])))]),Seq(Build(Op("stdin",[])),Match(Var("g_25")))),Call(SVar("split"),[Id,Seq(Build(Var("g_25")),Call(SVar("ReadFromFile"),[]))])))),SDef("exit",[],Scope([],Prim("_ST_exit"))),SDef("printnl",[],Scope([],Prim("_ST_printnl"))),SDef("usage'",[],Scope(["f_25"],Where(Seq(Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("f_25")])))]),Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("usage : "),Op("Cons",[Var("f_25"),Op("Cons",[Str(" [-S] [-i file] [-o file] [-b] [-s] [--help|-h|-?]"),Op("Nil",[])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))))),SDef("Undefined",["k_28"],Cong("Undefined",[Call(SVar("k_28"),[])])),SDef("Help",[],Cong("Help",[])),SDef("fetch",["i_43"],Scope([],Rec("j_43",LChoice(Call(SVar("Cons"),[Call(SVar("i_43"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("j_43"),[])]))))),SDef("option-defined",["t_35"],Scope([],Call(SVar("fetch"),[Call(SVar("t_35"),[])]))),SDef("need-help",[],Scope([],Seq(Call(SVar("option-defined"),[Choice(Call(SVar("Help"),[]),Call(SVar("Undefined"),[Id]))]),Call(SVar("usage'"),[])))),SDef("Option",["w_32","x_32"],Scope(["x_10","y_10"],Seq(Match(Op("Cons",[Var("y_10"),Var("x_10")])),Seq(Where(Where(Seq(Build(Var("y_10")),Call(SVar("w_32"),[])))),Seq(Scope(["e_75"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("x_32"),[]),Seq(Match(Var("e_75")),Id))),Build(Op("Cons",[Var("e_75"),Var("x_10")])))),Id))))),SDef("ArgOption",["y_32","z_32"],Scope(["z_10","a_11","b_11"],Seq(Match(Op("Cons",[Var("b_11"),Op("Cons",[Var("z_10"),Var("a_11")])])),Seq(Where(Where(Seq(Build(Var("b_11")),Call(SVar("y_32"),[])))),Seq(Scope(["o_75"],Seq(Seq(Build(Var("z_10")),Seq(Call(SVar("z_32"),[]),Seq(Match(Var("o_75")),Id))),Build(Op("Cons",[Var("o_75"),Var("a_11")])))),Id))))),SDef("io-options",[],Scope([],Choice(Call(SVar("Option"),[Match(Str("-S")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--silent")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--verbose")),Build(Op("Verbose",[]))]),Choice(Call(SVar("Option"),[Match(Str("-v")),Build(Op("Version",[]))]),Choice(Call(SVar("Option"),[Match(Str("--version")),Build(Op("Version",[]))]),Choice(Call(SVar("ArgOption"),[Match(Str("@version")),Scope(["a_25"],Seq(Match(Var("a_25")),Seq(Where(Id),Seq(Build(Op("DeclVersion",[Var("a_25")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-i")),Scope(["b_25"],Seq(Match(Var("b_25")),Seq(Where(Id),Seq(Build(Op("Input",[Var("b_25")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--input")),Scope(["c_25"],Seq(Match(Var("c_25")),Seq(Where(Id),Seq(Build(Op("Input",[Var("c_25")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-o")),Scope(["d_25"],Seq(Match(Var("d_25")),Seq(Where(Id),Seq(Build(Op("Output",[Var("d_25")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--output")),Scope(["e_25"],Seq(Match(Var("e_25")),Seq(Where(Id),Seq(Build(Op("Output",[Var("e_25")])),Id))))]),Choice(Call(SVar("Option"),[Match(Str("-b")),Build(Op("Binary",[]))]),Choice(Call(SVar("Option"),[Match(Str("-s")),Build(Op("Statistics",[]))]),Choice(Call(SVar("Option"),[Match(Str("--help")),Build(Op("Help",[]))]),Choice(Call(SVar("Option"),[Match(Str("-h")),Build(Op("Help",[]))]),Call(SVar("Option"),[Match(Str("-?")),Build(Op("Help",[]))]))))))))))))))))),SDef("UndefinedOption",[],Scope(["g_11","h_11"],Seq(Match(Op("Cons",[Var("g_11"),Var("h_11")])),Seq(Where(Id),Seq(Build(Op("Cons",[Op("Undefined",[Var("g_11")]),Var("h_11")])),Id))))),SDef("Cons",["s_30","t_30"],Cong("Cons",[Call(SVar("s_30"),[]),Call(SVar("t_30"),[])])),SDef("Nil",[],Cong("Nil",[])),SDef("parse-options",["q_35"],Scope([],Call(SVar("Cons"),[Scope(["z_24"],Seq(Match(Var("z_24")),Seq(Where(Id),Seq(Build(Op("Program",[Var("z_24")])),Id)))),Rec("r_35",LChoice(Choice(Call(SVar("Nil"),[]),Seq(Call(SVar("q_35"),[]),Call(SVar("Cons"),[Id,Call(SVar("r_35"),[])]))),Call(SVar("UndefinedOption"),[])))]))),SDef("iowrapO",["w_35","x_35"],Scope([],Seq(Call(SVar("parse-options"),[LChoice(Call(SVar("x_35"),[]),Call(SVar("io-options"),[]))]),LChoice(Call(SVar("need-help"),[]),LChoice(Seq(Call(SVar("input-file'"),[]),Seq(Call(SVar("apply-strategy"),[Call(SVar("w_35"),[])]),Seq(Call(SVar("output-file'"),[]),Call(SVar("report-success"),[])))),Call(SVar("report-failure"),[])))))),SDef("iowrap",["v_35"],Scope([],Call(SVar("iowrapO"),[Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("v_35"),[]),Call(SVar("TNil"),[])])]),Fail]))),SDef("extractIO",[],Scope([],Call(SVar("iowrap"),[Call(SVar("extract"),[])]))),SDef("main",[],Scope([],Call(SVar("extractIO"),[])))]
