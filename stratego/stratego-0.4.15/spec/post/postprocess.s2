[SDef("CR3",["s_18"],Scope(["b_11","c_11"],Seq(Match(Op("ICountRule",[Var("b_11")])),Seq(Where(Where(Seq(Call(SVar("s_18"),[]),Call(SVar("fetch"),[Match(Op("RuleCounter",[Var("b_11"),Var("c_11")]))])))),Seq(Build(Op("ICountRule",[Var("c_11")])),Id))))),SDef("map",["b_26"],Scope([],Rec("c_26",Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Call(SVar("b_26"),[]),Call(SVar("c_26"),[])]))))),SDef("new",[],Scope([],Prim("_ST_new"))),SDef("CR2",[],Scope(["a_11"],Seq(Match(Op("RuleCounter",[Var("a_11")])),Seq(Where(Id),Seq(Scope(["c_32"],Seq(Seq(Build(Var("a_11")),Seq(Call(SVar("new"),[]),Seq(Match(Var("c_32")),Id))),Build(Op("RuleCounter",[Var("a_11"),Var("c_32")])))),Id))))),SDef("Uniq",[],Scope(["b_2","c_2"],Seq(Match(Op("Cons",[Var("b_2"),Var("c_2")])),Seq(Where(Where(Seq(Build(Var("c_2")),Call(SVar("fetch"),[Seq(Id,Match(Var("b_2")))])))),Seq(Build(Var("c_2")),Id))))),SDef("repeat",["q_30","r_30"],Scope([],Rec("s_30",LChoice(Seq(Call(SVar("q_30"),[]),Call(SVar("s_30"),[])),Call(SVar("r_30"),[]))))),SDef("repeat",["t_30"],Scope([],Call(SVar("repeat"),[Call(SVar("t_30"),[]),Id]))),SDef("listbu",["t_26"],Scope([],Rec("u_26",Seq(Choice(Call(SVar("Nil"),[]),Call(SVar("Cons"),[Id,Call(SVar("u_26"),[])])),Call(SVar("t_26"),[]))))),SDef("uniq",[],Scope([],Call(SVar("listbu"),[Call(SVar("repeat"),[Call(SVar("Uniq"),[])])]))),SDef("CR1",[],Scope(["z_10"],Seq(Match(Op("ICountRule",[Var("z_10")])),Seq(Where(Id),Seq(Build(Op("RuleCounter",[Var("z_10")])),Id))))),SDef("Tl",[],Scope(["r_9","s_9"],Seq(Match(Op("Cons",[Var("r_9"),Var("s_9")])),Seq(Where(Id),Seq(Build(Var("s_9")),Id))))),SDef("filter",["i_23"],Scope([],Rec("j_23",Choice(Call(SVar("Nil"),[]),LChoice(Call(SVar("Cons"),[Call(SVar("i_23"),[]),Call(SVar("j_23"),[])]),Seq(Call(SVar("Tl"),[]),Call(SVar("j_23"),[]))))))),SDef("Main",[],Scope(["d_11","e_11","f_11"],Seq(Match(Op("Block",[Var("e_11")])),Seq(Where(Where(Seq(Seq(Seq(Build(Var("e_11")),Seq(Call(SVar("filter"),[Call(SVar("CR1"),[])]),Seq(Call(SVar("uniq"),[]),Call(SVar("map"),[Call(SVar("CR2"),[])])))),Match(Var("d_11"))),Seq(Seq(Build(Var("e_11")),Call(SVar("map"),[Call(SVar("try"),[Call(SVar("CR3"),[Build(Var("d_11"))])])])),Match(Var("f_11")))))),Seq(Build(Op("Program",[Op("RuleCounters",[Var("d_11")]),Op("Block",[Var("f_11")])])),Id))))),SDef("TNil",[],Cong("TNil",[])),SDef("TCons",["e_15","f_15"],Cong("TCons",[Call(SVar("e_15"),[]),Call(SVar("f_15"),[])])),SDef("report-failure",[],Scope([],Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("rewriting failed"),Op("Nil",[])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))),SDef("try",["n_31"],Scope([],LChoice(Call(SVar("n_31"),[]),Id))),SDef("report-success",[],Scope(["s_13","t_13"],Seq(Where(Call(SVar("try"),[Seq(Call(SVar("TCons"),[Not(Call(SVar("option-defined"),[Seq(Id,Match(Op("Silent",[])))])),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Runtime",[Var("t_13")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("s_13")])))]),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Var("s_13"),Op("Cons",[Str(" ("),Op("Cons",[Var("t_13"),Op("Cons",[Str(" secs)"),Op("Nil",[])])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])))))])),Seq(Build(Int(0)),Call(SVar("exit"),[]))))),SDef("WriteToTextFile",[],Scope([],Prim("_ST_WriteToTextFile"))),SDef("WriteToBinaryFile",[],Scope([],Prim("_ST_WriteToBinaryFile"))),SDef("output-file'",[],Scope(["r_13"],Seq(Call(SVar("TCons"),[LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Output",[Var("r_13")])))]),Seq(Build(Op("stdout",[])),Match(Var("r_13")))),Call(SVar("TCons"),[Id,Call(SVar("TNil"),[])])]),Seq(Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("split"),[Build(Var("r_13")),Id]),Call(SVar("TNil"),[])])]),LChoice(Call(SVar("TCons"),[Call(SVar("option-defined"),[Seq(Id,Match(Op("Binary",[])))]),Call(SVar("TCons"),[Call(SVar("WriteToBinaryFile"),[]),Call(SVar("TNil"),[])])]),Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("WriteToTextFile"),[]),Call(SVar("TNil"),[])])])))))),SDef("dtime",[],Scope([],Prim("_ST_dtime"))),SDef("apply-strategy",["d_22"],Scope(["o_13"],Seq(Where(Call(SVar("dtime"),[])),Seq(Call(SVar("d_22"),[]),Seq(Where(Seq(Call(SVar("dtime"),[]),Match(Var("o_13")))),Scope(["p_13","q_13"],Seq(Match(Op("TCons",[Var("p_13"),Op("TCons",[Var("q_13"),Op("TNil",[])])])),Seq(Where(Id),Seq(Build(Op("TCons",[Op("Cons",[Op("Runtime",[Var("o_13")]),Var("p_13")]),Op("TCons",[Var("q_13"),Op("TNil",[])])])),Id))))))))),SDef("ReadFromFile",[],Scope([],Prim("_ST_ReadFromFile"))),SDef("split",["s_17","t_17"],Scope(["k_6"],Seq(Match(Var("k_6")),Seq(Where(Id),Seq(Scope(["i_34"],Seq(Seq(Build(Var("k_6")),Seq(Call(SVar("s_17"),[]),Seq(Match(Var("i_34")),Id))),Scope(["m_34"],Seq(Seq(Build(Var("k_6")),Seq(Call(SVar("t_17"),[]),Seq(Match(Var("m_34")),Id))),Build(Op("TCons",[Var("i_34"),Op("TCons",[Var("m_34"),Op("TNil",[])])])))))),Id))))),SDef("input-file'",[],Scope(["n_13"],Seq(LChoice(Call(SVar("option-defined"),[Seq(Id,Match(Op("Input",[Var("n_13")])))]),Seq(Build(Op("stdin",[])),Match(Var("n_13")))),Call(SVar("split"),[Id,Seq(Build(Var("n_13")),Call(SVar("ReadFromFile"),[]))])))),SDef("exit",[],Scope([],Prim("_ST_exit"))),SDef("printnl",[],Scope([],Prim("_ST_printnl"))),SDef("usage'",[],Scope(["m_13"],Where(Seq(Call(SVar("option-defined"),[Seq(Id,Match(Op("Program",[Var("m_13")])))]),Seq(Seq(Build(Op("TCons",[Op("stderr",[]),Op("TCons",[Op("Cons",[Str("usage : "),Op("Cons",[Var("m_13"),Op("Cons",[Str(" [-S] [-i file] [-o file] [-b] [-s] [--help|-h|-?]"),Op("Nil",[])])])]),Op("TNil",[])])])),Call(SVar("printnl"),[])),Seq(Build(Int(1)),Call(SVar("exit"),[]))))))),SDef("Undefined",["y_14"],Cong("Undefined",[Call(SVar("y_14"),[])])),SDef("Help",[],Cong("Help",[])),SDef("fetch",["k_26"],Scope([],Rec("l_26",LChoice(Call(SVar("Cons"),[Call(SVar("k_26"),[]),Id]),Call(SVar("Cons"),[Id,Call(SVar("l_26"),[])]))))),SDef("option-defined",["x_21"],Scope([],Call(SVar("fetch"),[Call(SVar("x_21"),[])]))),SDef("need-help",[],Scope([],Seq(Call(SVar("option-defined"),[Choice(Call(SVar("Help"),[]),Call(SVar("Undefined"),[Id]))]),Call(SVar("usage'"),[])))),SDef("Option",["h_17","i_17"],Scope(["g_4","h_4"],Seq(Match(Op("Cons",[Var("h_4"),Var("g_4")])),Seq(Where(Where(Seq(Build(Var("h_4")),Call(SVar("h_17"),[])))),Seq(Scope(["h_35"],Seq(Seq(Build(Op("TNil",[])),Seq(Call(SVar("i_17"),[]),Seq(Match(Var("h_35")),Id))),Build(Op("Cons",[Var("h_35"),Var("g_4")])))),Id))))),SDef("ArgOption",["j_17","k_17"],Scope(["i_4","j_4","k_4"],Seq(Match(Op("Cons",[Var("k_4"),Op("Cons",[Var("i_4"),Var("j_4")])])),Seq(Where(Where(Seq(Build(Var("k_4")),Call(SVar("j_17"),[])))),Seq(Scope(["r_35"],Seq(Seq(Build(Var("i_4")),Seq(Call(SVar("k_17"),[]),Seq(Match(Var("r_35")),Id))),Build(Op("Cons",[Var("r_35"),Var("j_4")])))),Id))))),SDef("io-options",[],Scope([],Choice(Call(SVar("Option"),[Match(Str("-S")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--silent")),Build(Op("Silent",[]))]),Choice(Call(SVar("Option"),[Match(Str("--verbose")),Build(Op("Verbose",[]))]),Choice(Call(SVar("Option"),[Match(Str("-v")),Build(Op("Version",[]))]),Choice(Call(SVar("Option"),[Match(Str("--version")),Build(Op("Version",[]))]),Choice(Call(SVar("ArgOption"),[Match(Str("@version")),Scope(["h_13"],Seq(Match(Var("h_13")),Seq(Where(Id),Seq(Build(Op("DeclVersion",[Var("h_13")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-i")),Scope(["i_13"],Seq(Match(Var("i_13")),Seq(Where(Id),Seq(Build(Op("Input",[Var("i_13")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--input")),Scope(["j_13"],Seq(Match(Var("j_13")),Seq(Where(Id),Seq(Build(Op("Input",[Var("j_13")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("-o")),Scope(["k_13"],Seq(Match(Var("k_13")),Seq(Where(Id),Seq(Build(Op("Output",[Var("k_13")])),Id))))]),Choice(Call(SVar("ArgOption"),[Match(Str("--output")),Scope(["l_13"],Seq(Match(Var("l_13")),Seq(Where(Id),Seq(Build(Op("Output",[Var("l_13")])),Id))))]),Choice(Call(SVar("Option"),[Match(Str("-b")),Build(Op("Binary",[]))]),Choice(Call(SVar("Option"),[Match(Str("-s")),Build(Op("Statistics",[]))]),Choice(Call(SVar("Option"),[Match(Str("--help")),Build(Op("Help",[]))]),Choice(Call(SVar("Option"),[Match(Str("-h")),Build(Op("Help",[]))]),Call(SVar("Option"),[Match(Str("-?")),Build(Op("Help",[]))]))))))))))))))))),SDef("UndefinedOption",[],Scope(["p_4","q_4"],Seq(Match(Op("Cons",[Var("p_4"),Var("q_4")])),Seq(Where(Id),Seq(Build(Op("Cons",[Op("Undefined",[Var("p_4")]),Var("q_4")])),Id))))),SDef("Cons",["i_15","j_15"],Cong("Cons",[Call(SVar("i_15"),[]),Call(SVar("j_15"),[])])),SDef("Nil",[],Cong("Nil",[])),SDef("parse-options",["u_21"],Scope([],Call(SVar("Cons"),[Scope(["g_13"],Seq(Match(Var("g_13")),Seq(Where(Id),Seq(Build(Op("Program",[Var("g_13")])),Id)))),Rec("v_21",LChoice(Choice(Call(SVar("Nil"),[]),Seq(Call(SVar("u_21"),[]),Call(SVar("Cons"),[Id,Call(SVar("v_21"),[])]))),Call(SVar("UndefinedOption"),[])))]))),SDef("iowrapO",["a_22","b_22"],Scope([],Seq(Call(SVar("parse-options"),[LChoice(Call(SVar("b_22"),[]),Call(SVar("io-options"),[]))]),LChoice(Call(SVar("need-help"),[]),LChoice(Seq(Call(SVar("input-file'"),[]),Seq(Call(SVar("apply-strategy"),[Call(SVar("a_22"),[])]),Seq(Call(SVar("output-file'"),[]),Call(SVar("report-success"),[])))),Call(SVar("report-failure"),[])))))),SDef("iowrap",["z_21"],Scope([],Call(SVar("iowrapO"),[Call(SVar("TCons"),[Id,Call(SVar("TCons"),[Call(SVar("z_21"),[]),Call(SVar("TNil"),[])])]),Fail]))),SDef("main",[],Scope([],Call(SVar("iowrap"),[Call(SVar("Main"),[])])))]
