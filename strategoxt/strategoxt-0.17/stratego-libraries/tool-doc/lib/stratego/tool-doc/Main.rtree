Module("stratego/tool-doc/Main",[Imports([Import("libstratego-lib"),Import("libstratego-xtc"),Import("libstratego-gpp")]),Strategies([SDefNoArgs("tool-doc",Where(Seq(Call(SVar("topdown"),[Call(SVar("repeat"),[CallNoArgs(SVar("DesugarToolDoc"))])]),Seq(CallNoArgs(SVar("tool-doc2box")),Seq(CallT(SVar("box2text-stream"),[],[NoAnnoList(Int("80")),RootApp(CallNoArgs(SVar("stderr-stream")))]),BA(CallNoArgs(SVar("fputc")),NoAnnoList(Tuple([NoAnnoList(Char("'\\n'")),RootApp(CallNoArgs(SVar("stderr-stream")))]))))))))]),Signature([Constructors([OpDecl("HSection",FunType([ConstType(SortNoArgs("String")),ConstType(Sort("List",[SortNoArgs("DocSection")]))],ConstType(SortNoArgs("DocSection")))),OpDecl("Paragraph",FunType([ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("Line",FunType([ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("ItemList",FunType([ConstType(Sort("List",[SortNoArgs("DocSection")]))],ConstType(SortNoArgs("DocSection")))),OpDecl("DefList",FunType([ConstType(Sort("List",[SortNoArgs("Def")]))],ConstType(SortNoArgs("DocSection")))),OpDecl("Def",FunType([ConstType(SortNoArgs("String")),ConstType(SortNoArgs("DocSection"))],ConstType(SortNoArgs("Def"))))]),Constructors([OpDecl("HelpString",FunType([ConstType(SortNoArgs("String")),ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("HelpString")))),OpDecl("HelpString",FunType([ConstType(Sort("List",[SortNoArgs("String")])),ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("HelpString"))))])]),Signature([Constructors([OpDecl("Usage",FunType([ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("Summary",FunType([ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("Description",FunType([ConstType(Sort("List",[SortNoArgs("String")]))],ConstType(SortNoArgs("DocSection")))),OpDecl("OptionUsage",ConstType(SortNoArgs("DocSection"))),OpDecl("Authors",FunType([ConstType(Sort("List",[SortNoArgs("DocSection")]))],ConstType(SortNoArgs("DocSection")))),OpDecl("Author",FunType([ConstType(SortNoArgs("DocSection"))],ConstType(SortNoArgs("DocSection")))),OpDecl("Person",FunType([ConstType(SortNoArgs("String")),ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("WebHome",FunType([ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("AutoReportBugs",ConstType(SortNoArgs("DocSection"))),OpDecl("ReportBugs",FunType([ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("AutoProgram",ConstType(SortNoArgs("DocSection"))),OpDecl("Program",FunType([ConstType(SortNoArgs("String")),ConstType(SortNoArgs("String")),ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("Config",FunType([ConstType(Sort("List",[SortNoArgs("ConfigItem")]))],ConstType(SortNoArgs("DocSection")))),OpDecl("DefaultXTCRepository",ConstType(SortNoArgs("Def"))),OpDecl("CurrentXTCRepository",ConstType(SortNoArgs("Def"))),OpDecl("ConfigItem",FunType([ConstType(SortNoArgs("String")),ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("Def")))),OpDecl("License",FunType([ConstType(Sort("List",[SortNoArgs("String")]))],ConstType(SortNoArgs("DocSection")))),OpDecl("GNU_GPL",FunType([ConstType(SortNoArgs("String")),ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection")))),OpDecl("GNU_LGPL",FunType([ConstType(SortNoArgs("String")),ConstType(SortNoArgs("String"))],ConstType(SortNoArgs("DocSection"))))])]),Rules([RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Usage",[Var("s")])),NoAnnoList(Op("Line",[App(CallNoArgs(SVar("conc-strings")),NoAnnoList(Tuple([NoAnnoList(Str("\"Usage: \"")),Var("s")])))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Summary",[Var("p")])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"Summary:\"")),NoAnnoList(List([NoAnnoList(Op("Paragraph",[Var("p")]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Description",[Var("ps")])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"Description:\"")),App(Call(SVar("map"),[Build(NoAnnoList(Op("Paragraph",[RootApp(Id)])))]),Var("ps"))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("OptionUsage",[])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"Options:\"")),NoAnnoList(List([NoAnnoList(Op("DefList",[App(Seq(CallNoArgs(SVar("table-get")),Seq(CallNoArgs(SVar("reverse")),Seq(Call(SVar("map"),[CallNoArgs(SVar("ensure-help-string"))]),Call(SVar("filter"),[LRule(RuleNoCond(NoAnnoList(Op("HelpString",[Var("f"),Var("d")])),NoAnnoList(Op("Def",[Var("f"),NoAnnoList(Op("Paragraph",[Var("d")]))]))))])))),NoAnnoList(Tuple([NoAnnoList(Str("\"usage-table\"")),NoAnnoList(Str("\"usage\""))])))]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Authors",[Var("ps")])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"Authors:\"")),NoAnnoList(List([NoAnnoList(Op("ItemList",[Var("ps")]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Author",[Var("p")])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"Author:\"")),NoAnnoList(List([NoAnnoList(Op("ItemList",[NoAnnoList(List([Var("p")]))]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Person",[Var("name"),Var("mail")])),NoAnnoList(Op("Paragraph",[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([Var("name"),NoAnnoList(Str("\" <\"")),Var("mail"),NoAnnoList(Str("\">\""))])))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("WebHome",[Var("s")])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"Website:\"")),NoAnnoList(List([NoAnnoList(Op("Line",[Var("s")]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("AutoReportBugs",[])),NoAnnoList(Op("ReportBugs",[App(LChoice(CallNoArgs(SVar("SRTS-package-bugreport")),Build(NoAnnoList(Str("\"not available\"")))),NoAnnoList(Tuple([])))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("ReportBugs",[Var("s")])),NoAnnoList(Op("Paragraph",[App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Please report bugs to \"")),Var("s")])))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("AutoProgram",[])),NoAnnoList(Op("HSection",[App(CallNoArgs(SVar("get-config")),NoAnnoList(Str("\"program\""))),NoAnnoList(List([NoAnnoList(Op("DefList",[NoAnnoList(ListTail([NoAnnoList(Op("Def",[NoAnnoList(Str("\"Package\"")),NoAnnoList(Op("Paragraph",[App(LChoice(CallNoArgs(SVar("SRTS-package-name")),Build(NoAnnoList(Str("\"not available\"")))),NoAnnoList(Tuple([])))]))])),NoAnnoList(Op("Def",[NoAnnoList(Str("\"Version\"")),NoAnnoList(Op("Paragraph",[App(LChoice(CallNoArgs(SVar("SRTS-package-version")),Build(NoAnnoList(Str("\"not available\"")))),NoAnnoList(Tuple([])))]))]))],RootApp(LChoice(Build(NoAnnoList(List([NoAnnoList(Op("Def",[NoAnnoList(Str("\"Revision\"")),NoAnnoList(Op("Paragraph",[RootApp(CallNoArgs(SVar("SRTS-package-revision")))]))]))]))),Build(NoAnnoList(List([])))))))]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Program",[Var("name"),Var("package"),Var("version")])),NoAnnoList(Op("HSection",[Var("name"),NoAnnoList(List([NoAnnoList(Op("DefList",[NoAnnoList(List([NoAnnoList(Op("Def",[NoAnnoList(Str("\"Package\"")),NoAnnoList(Op("Paragraph",[Var("package")]))])),NoAnnoList(Op("Def",[NoAnnoList(Str("\"Version\"")),NoAnnoList(Op("Paragraph",[Var("version")]))]))]))]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("Config",[Var("items")])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"Configuration:\"")),NoAnnoList(List([NoAnnoList(Op("DefList",[Var("items")]))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("DefaultXTCRepository",[])),NoAnnoList(Op("ConfigItem",[NoAnnoList(Str("\"Default XTC Repository\"")),App(LChoice(CallNoArgs(SVar("GetInternalDefaultXtcRepository")),Build(NoAnnoList(Str("\"not available\"")))),NoAnnoList(Tuple([])))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("CurrentXTCRepository",[])),NoAnnoList(Op("ConfigItem",[NoAnnoList(Str("\"Current XTC Repository\"")),App(LChoice(CallNoArgs(SVar("xtc-location")),Build(NoAnnoList(Str("\"not available\"")))),NoAnnoList(Tuple([])))])))),ExtSDef("GetInternalDefaultXtcRepository",[],[]),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("ConfigItem",[Var("k"),Var("v")])),NoAnnoList(Op("Def",[Var("k"),NoAnnoList(Op("Line",[Var("v")]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("License",[Var("ps")])),NoAnnoList(Op("HSection",[NoAnnoList(Str("\"License:\"")),App(Call(SVar("map"),[Build(NoAnnoList(Op("Paragraph",[RootApp(Id)])))]),Var("ps"))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("GNU_GPL",[Var("year"),Var("author")])),NoAnnoList(Op("License",[NoAnnoList(List([App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Copyright (C) \"")),Var("year"),NoAnnoList(Str("\" \"")),Var("author")]))),NoAnnoList(Str("\"This program is free software; you can redistribute it and/or\n        modify it under the terms of the GNU General Public License as published by the \n        Free Software Foundation; either version 2 of the License, or (at your option) \n        any later version.\"")),NoAnnoList(Str("\"This program is distributed in the hope that it will be useful, but \n        WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or \n        FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more \n        details.\"")),NoAnnoList(Str("\"You should have received a copy of the GNU General Public License \n        along with this program; if not, write to the Free Software Foundation, \n        Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA\""))]))])))),RDefNoArgs("DesugarToolDoc",RuleNoCond(NoAnnoList(Op("GNU_LGPL",[Var("year"),Var("author")])),NoAnnoList(Op("License",[NoAnnoList(List([App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Copyright (C) \"")),Var("year"),NoAnnoList(Str("\" \"")),Var("author")]))),NoAnnoList(Str("\"This library is free software; you can redistribute it and/or modify \n         it under the terms of the GNU Lesser General Public License as published by the \n         Free Software Foundation; either version 2 of the License, or (at your option) \n         any later version.\"")),NoAnnoList(Str("\"This library is distributed in the hope that it will be useful, but \n         WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or \n         FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License \n         for more details.\"")),NoAnnoList(Str("\"You should have received a copy of the GNU Lesser General Public \n         License along with this library; if not, write to the Free Software Foundation, \n         Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA\""))]))]))))]),Strategies([ExtSDef("SRTS-package-name",[],[]),ExtSDef("SRTS-package-version",[],[]),ExtSDef("SRTS-package-bugreport",[],[]),ExtSDef("SRTS-package-revision",[],[])]),Strategies([SDefNoArgs("ensure-help-string",Call(SVar("HelpString"),[Choice(CallNoArgs(SVar("is-string")),CallNoArgs(SVar("is-list"))),CallNoArgs(SVar("is-string"))])),RDefNoArgs("ensure-help-string",Rule(Var("s"),NoAnnoList(Op("HelpString",[Var("flags"),Var("descr")])),Seq(BA(CallNoArgs(SVar("is-string")),Var("s")),AM(BA(CallNoArgs(SVar("split-before")),NoAnnoList(Tuple([Var("s"),NoAnnoList(Str("\"  \""))]))),NoAnnoList(Tuple([Var("flags"),Var("descr")])))))),RDefNoArgs("ensure-help-string",RuleNoCond(NoAnnoList(Str("\"\"")),NoAnnoList(Op("HelpString",[NoAnnoList(Str("\"\"")),NoAnnoList(Str("\"\""))]))))])])
