Module("stratego/tool-doc/PrettyPrint",[Imports([Import("stratego/tool-doc/Main"),Import("libstratego-lib"),Import("libstratego-gpp")]),Strategies([SDefNoArgs("tool-doc2box",CallNoArgs(SVar("tool-doc-docsections-to-box")))]),Strategies([RDefNoArgs("tool-doc-docsections-to-box",Rule(Var("docsections"),NoAnnoList(Op("V",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("VS",[])),NoAnnoList(Str("1"))])),NoAnnoList(Op("Nil",[]))])),Var("bs")])),AM(BA(Call(SVar("map"),[CallNoArgs(SVar("tool-doc-try-docsection-to-box"))]),Var("docsections")),Var("bs")))),SDefNoArgs("tool-doc-try-docsection-to-box",LChoice(CallNoArgs(SVar("tool-doc-docsection-to-box")),Seq(Call(SVar("debug"),[Build(NoAnnoList(Str("\"Not a docsection: \"")))]),Fail))),RDefNoArgs("tool-doc-docsection-to-box",Rule(NoAnnoList(Op("HSection",[Var("s"),Var("sections")])),NoAnnoList(Op("V",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("IS",[])),NoAnnoList(Str("3"))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("VS",[])),NoAnnoList(Str("0"))])),NoAnnoList(Op("Nil",[]))]))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("S",[Var("s")])),NoAnnoList(Op("Cons",[NoAnnoList(Op("V",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("VS",[])),NoAnnoList(Str("1"))])),NoAnnoList(Op("Nil",[]))])),Var("bs")])),NoAnnoList(Op("Nil",[]))]))]))])),AM(BA(Call(SVar("map"),[CallNoArgs(SVar("tool-doc-try-docsection-to-box"))]),Var("sections")),Var("bs")))),RDefNoArgs("tool-doc-docsection-to-box",Rule(NoAnnoList(Op("Paragraph",[Var("s")])),NoAnnoList(Op("HV",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("1"))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("VS",[])),NoAnnoList(Str("0"))])),NoAnnoList(Op("Nil",[]))]))])),Var("tokens")])),AM(BA(Seq(BA(CallNoArgs(SVar("string-tokenize")),NoAnnoList(Tuple([NoAnnoList(List([NoAnnoList(Char("' '")),NoAnnoList(Char("'\\n'")),NoAnnoList(Char("'\\r'")),NoAnnoList(Char("'\\t'"))])),RootApp(Id)]))),Call(SVar("map"),[Build(NoAnnoList(Op("S",[RootApp(Id)])))])),Var("s")),Var("tokens")))),RDefNoArgs("tool-doc-docsection-to-box",RuleNoCond(NoAnnoList(Op("Line",[Var("s")])),NoAnnoList(Op("S",[Var("s")])))),RDefNoArgs("tool-doc-docsection-to-box",Rule(NoAnnoList(Op("ItemList",[Var("sections")])),NoAnnoList(Op("V",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("VS",[])),NoAnnoList(Str("0"))])),NoAnnoList(Op("Nil",[]))])),Var("bs")])),AM(BA(Call(SVar("map"),[Seq(CallNoArgs(SVar("tool-doc-try-docsection-to-box")),Build(NoAnnoList(Op("H",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("1"))])),NoAnnoList(Op("Nil",[]))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("S",[NoAnnoList(Str("\"*\""))])),NoAnnoList(Op("Cons",[RootApp(Id),NoAnnoList(Op("Nil",[]))]))]))]))))]),Var("sections")),Var("bs")))),RDefNoArgs("tool-doc-docsection-to-box",Rule(NoAnnoList(Op("DefList",[Var("defs")])),NoAnnoList(Op("A",[NoAnnoList(Op("AOPTIONS",[NoAnnoList(Op("Cons",[NoAnnoList(Op("AL",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("2"))])),NoAnnoList(Op("Nil",[]))]))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("AL",[NoAnnoList(Op("Cons",[NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("0"))])),NoAnnoList(Op("Nil",[]))]))])),NoAnnoList(Op("Nil",[]))]))]))])),NoAnnoList(Op("Nil",[])),Var("bs")])),AM(BA(Call(SVar("map"),[CallNoArgs(SVar("tool-doc-def-to-row"))]),Var("defs")),Var("bs")))),RDefNoArgs("tool-doc-def-to-row",Rule(NoAnnoList(Op("Def",[Var("k"),Var("v")])),NoAnnoList(Op("R",[NoAnnoList(Op("Nil",[])),NoAnnoList(Op("Cons",[NoAnnoList(Op("S",[Var("k")])),NoAnnoList(Op("Cons",[Var("b"),NoAnnoList(Op("Nil",[]))]))]))])),AM(BA(CallNoArgs(SVar("tool-doc-try-docsection-to-box")),Var("v")),Var("b"))))])])
