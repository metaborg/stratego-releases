Module("stratego/rtg/parse",[Imports([Import("libstratego-sglr")]),Strategies([SDefNoArgs("parse-rtg-file",Seq(Where(Assign(Var("tbl"),RootApp(CallNoArgs(SVar("get-rtg-parse-table"))))),Seq(CallT(SVar("parse-file"),[CallNoArgs(SVar("strsglr-perror")),CallNoArgs(SVar("strsglr-report-parse-error"))],[RootApp(CallNoArgs(SVar("get-rtg-parse-table")))]),CallNoArgs(SVar("rtg-parsefix"))))),SDefNoArgs("parse-rtg-stream",Seq(Where(Assign(Var("tbl"),RootApp(CallNoArgs(SVar("get-rtg-parse-table"))))),Seq(CallT(SVar("parse-stream"),[CallNoArgs(SVar("strsglr-report-parse-error"))],[RootApp(CallNoArgs(SVar("get-rtg-parse-table")))]),CallNoArgs(SVar("rtg-parsefix"))))),SDefNoArgs("get-rtg-parse-table",LChoice(CallNoArgs(SVar("MemoRTGParseTable")),Seq(ImportTerm("rtg.tbl"),Seq(CallNoArgs(SVar("open-parse-table")),Seq(Match(Var("tbl")),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("MemoRTGParseTable")),RuleNoCond(Wld,Var("tbl")))])))))),ExtSDef("STRRTG-get-rtg-parsetable",[],[])]),Strategies([SDefNoArgs("rtg-parsefix",Call(SVar("topdown"),[Call(SVar("try"),[CallNoArgs(SVar("rtg-ParseFix"))])])),RDefNoArgs("rtg-ParseFix",RuleNoCond(NoAnnoList(Op("Plain",[Var("s")])),Var("s"))),RDefNoArgs("rtg-ParseFix",RuleNoCond(NoAnnoList(Op("Quoted",[Var("parts")])),App(Seq(Call(SVar("map"),[Choice(Match(NoAnnoList(Op("Chars",[RootApp(Id)]))),Match(NoAnnoList(Op("EscapeSeq",[RootApp(BA(CallNoArgs(SVar("implode-string")),NoAnnoList(List([RootApp(Id)]))))]))))]),CallNoArgs(SVar("concat-strings"))),Var("parts")))),SDefNoArgs("rtg-ParseFix",Call(SVar("TupleTerm"),[CallNoArgs(SVar("string-to-int"))]))])])
