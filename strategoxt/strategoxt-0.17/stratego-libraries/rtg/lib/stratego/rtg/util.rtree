Module("stratego/rtg/util",[Imports([Import("stratego/rtg/signature")]),Strategies([SDefT("rtg-productions-of",[],[VarDec("nt",ConstType(SortNoArgs("NonTerm")))],Seq(Match(NoAnnoList(Op("RTG",[Wld,NoAnnoList(Op("ProdRules",[RootApp(Id)]))]))),Seq(Call(SVar("filter"),[Match(NoAnnoList(Op("ProdRule",[Var("nt"),RootApp(Id)])))]),CallNoArgs(SVar("concat"))))),SDefNoArgs("rtg-start-nonterms",Match(NoAnnoList(Op("RTG",[NoAnnoList(Op("Start",[RootApp(Id)])),NoAnnoList(Op("ProdRules",[RootApp(Id)]))]))))]),Strategies([SDefNoArgs("rtg-ungroup-productions",Call(SVar("RTG"),[Id,Call(SVar("ProdRules"),[CallNoArgs(SVar("rtg-ungroup-productions"))])])),SDefNoArgs("rtg-ungroup-productions",Seq(Call(SVar("map"),[LRule(RuleNoCond(NoAnnoList(Op("ProdRule",[Var("nt"),Var("rhss")])),App(Call(SVar("map"),[Build(NoAnnoList(Op("ProdRule",[Var("nt"),NoAnnoList(List([RootApp(Id)]))])))]),Var("rhss"))))]),CallNoArgs(SVar("concat"))))]),Strategies([SDefNoArgs("rtg-group-productions",Call(SVar("RTG"),[Id,Call(SVar("ProdRules"),[CallNoArgs(SVar("rtg-group-by-nonterm"))])])),SDefNoArgs("rtg-group-by-nonterm",Call(SVar("rtg-group-by"),[LRule(RuleNoCond(NoAnnoList(Op("ProdRule",[Var("nt"),Wld])),Var("nt"))),LRule(RuleNoCond(NoAnnoList(Op("ProdRule",[Wld,Var("rhss")])),Var("rhss"))),LRule(RuleNoCond(NoAnnoList(Tuple([Var("nt"),Var("rhsss")])),NoAnnoList(Op("ProdRule",[Var("nt"),App(CallNoArgs(SVar("concat")),Var("rhsss"))]))))]))]),Strategies([SDef("rtg-group-by",[DefaultVarDec("k"),DefaultVarDec("r"),DefaultVarDec("build")],Seq(Match(Var("items")),Seq(Call(SVar("map"),[CallNoArgs(SVar("k"))]),Seq(CallNoArgs(SVar("make-set")),Call(SVar("map"),[Call(SVar("rtg-build-group-by-pairs"),[CallNoArgs(SVar("k")),CallNoArgs(SVar("r")),CallNoArgs(SVar("build")),Build(Var("items"))])]))))),SDef("rtg-build-group-by-pairs",[DefaultVarDec("k"),DefaultVarDec("r"),DefaultVarDec("build"),DefaultVarDec("items")],Seq(Match(Var("key")),Seq(Where(AM(BA(Seq(CallNoArgs(SVar("items")),Seq(Call(SVar("filter"),[Where(Seq(CallNoArgs(SVar("k")),Match(Var("key"))))]),Call(SVar("map"),[CallNoArgs(SVar("r"))]))),NoAnnoList(Tuple([]))),Var("values"))),BA(CallNoArgs(SVar("build")),NoAnnoList(Tuple([Var("key"),Var("values")]))))))])])
