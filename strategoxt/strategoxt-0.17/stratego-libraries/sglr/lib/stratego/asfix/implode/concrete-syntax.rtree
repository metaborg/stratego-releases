Module("stratego/asfix/implode/concrete-syntax",[Imports([Import("stratego/concrete-syntax/markers")]),Strategies([SDef("skip-concrete",[DefaultVarDec("impl")],Seq(Match(NoAnnoList(Op("appl",[Var("prod"),Var("args")]))),Seq(AM(BA(CallNoArgs(SVar("get-cons")),Var("prod")),Var("c")),Seq(BA(CallNoArgs(SVar("strsglr-is-quote-cons")),Var("c")),Seq(Where(AM(BA(Call(SVar("remove-all"),[CallNoArgs(SVar("is-ignorable-syntax"))]),Var("args")),NoAnnoList(List([Var("ap")])))),Seq(Build(NoAnnoList(Explode(Var("c"),NoAnnoList(List([Var("ap")]))))),Rec("skip",Call(SVar("alltd"),[LChoice(Seq(Call(SVar("appl"),[Call(SVar("prod"),[One(Call(SVar("varsym"),[Id])),Id,Id]),Id]),CallNoArgs(SVar("impl"))),LChoice(Seq(Call(SVar("appl"),[Where(Seq(CallNoArgs(SVar("get-cons")),CallNoArgs(SVar("strsglr-is-antiquote-cons")))),Id]),CallNoArgs(SVar("impl"))),Call(SVar("annotation"),[CallNoArgs(SVar("impl")),CallNoArgs(SVar("skip"))])))])))))))),SDef("annotation",[DefaultVarDec("impl"),DefaultVarDec("skip")],Seq(Match(NoAnnoList(Op("appl",[Var("prod"),RootApp(Id)]))),Seq(Where(AM(BA(CallNoArgs(SVar("get-cons")),Var("prod")),NoAnnoList(Str("\"WithAnno\"")))),Seq(Call(SVar("filter"),[Seq(Not(CallNoArgs(SVar("is-ignorable-syntax"))),Not(Call(SVar("appl"),[Call(SVar("prod"),[Id,Call(SVar("oncetd"),[Call(SVar("lex"),[Id])]),Id]),Id])))]),Seq(Match(NoAnnoList(ListTail([Var("x")],Var("xs")))),Build(NoAnnoList(Explode(NoAnnoList(Str("\"WithAnno\"")),NoAnnoList(ListTail([App(CallNoArgs(SVar("skip")),Var("x"))],App(CallNoArgs(SVar("impl")),Var("xs"))))))))))))]),Strategies([SDefNoArgs("yield-asfix-quotes",Call(SVar("alltd"),[Call(SVar("strsglr-quote-cong"),[CallNoArgs(SVar("asfix-yield-quote"))])])),SDefNoArgs("asfix-yield-quote",Let([SDefT("yield",[],[DefaultVarDec("chars")],Choice(CallT(SVar("asfix-yield-acc"),[CallNoArgs(SVar("yield"))],[Var("chars")]),CallT(SVar("asfix-yield-quote-acc"),[CallNoArgs(SVar("yield"))],[Var("chars")])))],Choice(Call(SVar("appl"),[Build(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Str("\"yield\"")),NoAnnoList(Op("no-attrs",[]))]))),CallT(SVar("yield"),[],[NoAnnoList(List([]))])]),Choice(Call(SVar("strsglr-metavar-cong"),[Id]),Call(SVar("strsglr-antiquote-cong"),[CallNoArgs(SVar("yield-asfix-quotes"))]))))),RDefT("asfix-yield-quote-acc",[VarDec("rec",FunType([ConstType(SortVar("b")),ConstType(SortVar("c"))],ConstType(SortVar("d"))))],[DefaultVarDec("acc")],Rule(NoAnnoList(Op("amb",[NoAnnoList(ListTail([Var("x")],Wld))])),Var("acc'"),Assign(Var("acc'"),App(CallT(SVar("rec"),[],[Var("acc")]),Var("x"))))),SDefT("asfix-yield-quote-acc",[VarDec("rec",FunType([ConstType(SortVar("b")),ConstType(SortVar("c"))],ConstType(SortVar("d"))))],[DefaultVarDec("acc")],Seq(Call(SVar("strsglr-metavar-cong"),[Id]),Build(NoAnnoList(ListTail([RootApp(Id)],Var("acc")))))),SDefT("asfix-yield-quote-acc",[VarDec("rec",FunType([ConstType(SortVar("b")),ConstType(SortVar("c"))],ConstType(SortVar("d"))))],[DefaultVarDec("acc")],Seq(Call(SVar("strsglr-antiquote-cong"),[CallNoArgs(SVar("yield-asfix-quotes"))]),Build(NoAnnoList(ListTail([RootApp(Id)],Var("acc"))))))])])
