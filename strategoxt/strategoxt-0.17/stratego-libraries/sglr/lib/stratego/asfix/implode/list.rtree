Module("stratego/asfix/implode/list",[Rules([RDefNoArgs("FlatList",RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star",[Wld]))])),Wld])),NoAnnoList(List([Var("x")]))])),App(CallNoArgs(SVar("FlatList")),Var("x")))),RDefNoArgs("FlatList",RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star",[Wld]))])),Wld])),NoAnnoList(List([]))])),NoAnnoList(List([])))),RDefNoArgs("FlatList",RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])),NoAnnoList(List([Var("x")]))])),NoAnnoList(List([Var("x")])))),RDefNoArgs("FlatList",Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])),NoAnnoList(ListTail([Var("x")],Var("xs")))])),Var("z"),AM(Rec("x",LChoice(LRule(RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])),NoAnnoList(List([Var("a")]))])),NoAnnoList(List([Var("a")])))),LChoice(LRule(RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])),NoAnnoList(List([Var("a"),Var("b")]))])),App(CallNoArgs(SVar("concat")),NoAnnoList(List([App(CallNoArgs(SVar("x")),Var("a")),App(CallNoArgs(SVar("x")),Var("b"))]))))),LRule(RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])),NoAnnoList(List([Var("a"),Var("w"),Var("b")]))])),App(CallNoArgs(SVar("concat")),NoAnnoList(List([App(CallNoArgs(SVar("x")),Var("a")),NoAnnoList(List([Var("w")])),App(CallNoArgs(SVar("x")),Var("b"))])))))))),Var("z")))),RDefNoArgs("FlatList",RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])),NoAnnoList(List([Var("x")]))])),App(CallNoArgs(SVar("FlatList")),Var("x")))),RDefNoArgs("FlatList",RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])),NoAnnoList(List([]))])),NoAnnoList(List([])))),RDefNoArgs("FlatList",RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])),NoAnnoList(List([Var("x")]))])),NoAnnoList(List([Var("x")])))),RDefNoArgs("FlatList",Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])),NoAnnoList(ListTail([Var("x")],Var("xs")))])),Var("z"),AM(Rec("x",LChoice(LRule(RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])),NoAnnoList(List([Var("a")]))])),NoAnnoList(List([Var("a")])))),LChoice(LRule(RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])),NoAnnoList(List([Var("a"),Var("b"),Var("c")]))])),App(CallNoArgs(SVar("concat")),NoAnnoList(List([App(CallNoArgs(SVar("x")),Var("a")),NoAnnoList(List([Var("b")])),App(CallNoArgs(SVar("x")),Var("c"))]))))),LRule(RuleNoCond(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[Wld,NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])),NoAnnoList(List([Var("a"),Var("w1"),Var("b"),Var("w2"),Var("c")]))])),App(CallNoArgs(SVar("concat")),NoAnnoList(List([App(CallNoArgs(SVar("x")),Var("a")),NoAnnoList(List([Var("w1"),Var("b"),Var("w2")])),App(CallNoArgs(SVar("x")),Var("c"))])))))))),Var("z"))))]),Rules([RDefNoArgs("ImplodeOptionalList",Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[Var("s")]))])),Wld])),NoAnnoList(List([]))])),NoAnnoList(List([])),BA(CallNoArgs(SVar("is-asfix-list")),Var("s")))),RDefNoArgs("ImplodeOptionalList",Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[Var("s")]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[Var("s")]))])),Wld])),NoAnnoList(List([Var("x")]))])),Var("x"),BA(CallNoArgs(SVar("is-asfix-list")),Var("s")))),RDefNoArgs("ImplodeOptionalList",Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("opt",[Var("s")])),Wld])),NoAnnoList(List([]))])),NoAnnoList(List([])),BA(CallNoArgs(SVar("is-asfix-list")),Var("s")))),RDefNoArgs("ImplodeOptionalList",Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([Var("s")])),NoAnnoList(Op("opt",[Var("s")])),Wld])),NoAnnoList(List([Var("x")]))])),Var("x"),BA(CallNoArgs(SVar("is-asfix-list")),Var("s"))))]),Strategies([SDefNoArgs("is-list-sort",Choice(Call(SVar("iter"),[Id]),Choice(Call(SVar("iter-sep"),[Id,Id]),Choice(Call(SVar("iter-star"),[Id]),Call(SVar("iter-star-sep"),[Id,Id]))))),SDefNoArgs("is-asfix-list",Rec("x",Choice(CallNoArgs(SVar("is-list-sort")),Call(SVar("seq"),[Call(SVar("map"),[Choice(Call(SVar("lit"),[Id]),Choice(Call(SVar("layout"),[]),CallNoArgs(SVar("x"))))])]))))])])
