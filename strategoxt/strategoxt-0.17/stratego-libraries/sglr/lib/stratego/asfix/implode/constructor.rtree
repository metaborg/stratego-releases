Module("stratego/asfix/implode/constructor",[Strategies([SDef("ReplCons",[DefaultVarDec("impl")],LChoice(Call(SVar("ReplNamedCons"),[CallNoArgs(SVar("impl"))]),LChoice(Call(SVar("ReplAstPattern"),[CallNoArgs(SVar("impl"))]),LChoice(Call(SVar("ReplConsNil"),[CallNoArgs(SVar("impl"))]),LChoice(Call(SVar("ReplConsNone"),[CallNoArgs(SVar("impl"))]),LChoice(Call(SVar("ReplConsIns"),[CallNoArgs(SVar("impl"))]),LChoice(Call(SVar("ReplConsSome"),[CallNoArgs(SVar("impl"))]),Call(SVar("ReplConsConc"),[CallNoArgs(SVar("impl"))]))))))))]),Rules([RDef("ReplNamedCons",[DefaultVarDec("impl")],Rule(AnnoList(Op("appl",[Var("p"),Var("ts")]),[Var(ListVar("a*"))]),AnnoList(Explode(Var("c"),App(Call(SVar("map"),[CallNoArgs(SVar("impl"))]),Var("ts"))),[Var(ListVar("a*"))]),AM(BA(CallNoArgs(SVar("get-cons")),Var("p")),Var("c")))),RDefNoArgs("get-cons",Rule(NoAnnoList(Op("prod",[Wld,Wld,Var("as")])),Var("x"),BA(Call(SVar("oncetd"),[Match(NoAnnoList(Op("cons",[Var("x")])))]),Var("as"))))]),Rules([RDef("ReplAstPattern",[DefaultVarDec("impl")],Rule(AnnoList(Op("appl",[Var("p"),Var("ts")]),[Var(ListVar("a*"))]),AnnoList(Var("term"),[Var(ListVar("c*"))]),Seq(AM(BA(CallNoArgs(SVar("get-ast-pattern")),Var("p")),Var("pattern")),Seq(AM(BA(Call(SVar("map"),[CallNoArgs(SVar("impl"))]),Var("ts")),Var("is")),DynRuleScope([DynRuleScopeId("ReplacePlaceholder")],Seq(BA(Call(SVar("map-with-index"),[ScopeDefault(Seq(Match(NoAnnoList(Tuple([Var("i"),Var("t")]))),GenDynRules([SetDynRule(DynRuleId(RDecNoArgs("ReplacePlaceholder")),RuleNoCond(Var("i"),Var("t")))])))]),Var("is")),Seq(Build(Var("pattern")),Seq(Rec("rec",Call(SVar("alltd"),[Scope(["ph","t1","t2",ListVar("a*"),ListVar("b*"),ListVar("c*")],CondChoice(CallNoArgs(SVar("is-placeholder")),Seq(Match(AnnoList(Wld,[Var(ListVar("a*"))])),Seq(AM(CallNoArgs(SVar("get-placeholder")),Var("ph")),Seq(LChoice(CallNoArgs(SVar("ReplacePlaceholder")),LChoice(Seq(ExplodeCong(StrCong("\"conc\""),ParenStrat(ListCongNoTail([CallNoArgs(SVar("rec")),CallNoArgs(SVar("rec"))]))),IfThen(ExplodeCong(StrCong("\"conc\""),ParenStrat(ListCongNoTail([CallNoArgs(SVar("is-list")),CallNoArgs(SVar("is-list"))]))),LRule(RuleNoCond(NoAnnoList(Explode(NoAnnoList(Str("\"conc\"")),NoAnnoList(List([Var("xs"),Var("ys")])))),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("xs"),Var("ys")]))))))),LChoice(Seq(Match(NoAnnoList(Explode(NoAnnoList(Str("\"yield\"")),NoAnnoList(List([RootApp(CallNoArgs(SVar("ReplacePlaceholder")))]))))),CallNoArgs(SVar("asfix-yield-appl"))),Seq(CallT(SVar("log"),[],[NoAnnoList(Op("Error",[])),App(CallNoArgs(SVar("concat-strings")),NoAnnoList(List([NoAnnoList(Str("\"Could not replace placeholder <\"")),App(CallNoArgs(SVar("write-to-string")),Var("ph")),NoAnnoList(Str("\"> in pattern \"")),App(CallNoArgs(SVar("write-to-string")),Var("pattern"))])))]),BA(CallNoArgs(SVar("exit")),NoAnnoList(Int("1"))))))),IfThen(Not(Assign(NoAnnoList(List([])),Var(ListVar("a*")))),LRule(Rule(AnnoList(Var("t1"),[Var(ListVar("b*"))]),AnnoList(Var("t1"),[Var(ListVar("c*"))]),Assign(Var(ListVar("c*")),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([App(Call(SVar("map"),[CallNoArgs(SVar("rec"))]),Var(ListVar("a*"))),Var(ListVar("b*"))])))))))))),Seq(Match(Anno(Wld,ListTail([Wld],Wld))),LRule(Rule(AnnoList(Var("t1"),[Var(ListVar("a*"))]),AnnoList(Var("t2"),[Var(ListVar("b*"))]),Seq(Assign(Var(ListVar("b*")),App(Call(SVar("map"),[CallNoArgs(SVar("rec"))]),Var(ListVar("a*")))),Assign(Var("t2"),App(CallNoArgs(SVar("rec")),Anno(Var("t1"),List([]))))))))))])),Seq(Match(AnnoList(Var("term"),[Var(ListVar("b*"))])),Seq(CondChoice(Assign(NoAnnoList(List([])),Var(ListVar("a*"))),Build(Var(ListVar("b*"))),CondChoice(Assign(NoAnnoList(List([])),Var(ListVar("b*"))),BA(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var(ListVar("a*")),Var(ListVar("b*"))]))),Build(Var(ListVar("a*"))))),Match(Var(ListVar("c*"))))))))))))),RDefNoArgs("get-ast-pattern",Rule(NoAnnoList(Op("prod",[Wld,Wld,Var("as")])),App(CallNoArgs(SVar("read-from-string")),Var("x")),BA(Call(SVar("oncetd"),[Match(NoAnnoList(Op("ast",[Var("x")])))]),Var("as"))))]),Signature([Constructors([OpDecl("ast",FunType([ConstType(SortNoArgs("Term"))],ConstType(SortNoArgs("Term"))))])]),Rules([RDef("ReplConsNil",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[Var("p"),NoAnnoList(List([]))])),NoAnnoList(List([])),BA(CallNoArgs(SVar("is-nil")),Var("p")))),RDef("ReplConsNone",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[Var("p"),NoAnnoList(List([]))])),NoAnnoList(Op("None",[])),BA(CallNoArgs(SVar("is-none")),Var("p")))),RDef("ReplConsIns",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[Var("p"),NoAnnoList(List([Var("t")]))])),NoAnnoList(List([App(CallNoArgs(SVar("impl")),Var("t"))])),BA(CallNoArgs(SVar("is-ins")),Var("p"))))]),Rules([RDef("ReplConsIns",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("lit",[Var("x")]))])),Var("sym"),Wld])),NoAnnoList(List([]))])),Var("t"),Assign(Var("t"),App(CallT(SVar("implode-constant-literal"),[],[Var("x")]),Var("sym"))))),RDef("ReplConsIns",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cilit",[Var("x")]))])),Var("sym"),Wld])),NoAnnoList(List([]))])),Var("t"),Assign(Var("t"),App(CallT(SVar("implode-constant-literal"),[],[Var("x")]),Var("sym"))))),SDefT("implode-constant-literal",[],[DefaultVarDec("constant")],Rec("rec",Choice(Match(NoAnnoList(Op("cf",[RootApp(CallNoArgs(SVar("rec")))]))),Choice(Match(NoAnnoList(Op("lex",[RootApp(CallNoArgs(SVar("rec")))]))),Choice(LRule(RuleNoCond(NoAnnoList(Op("iter",[RootApp(CallNoArgs(SVar("rec")))])),NoAnnoList(List([RootApp(Id)])))),Choice(LRule(RuleNoCond(NoAnnoList(Op("iter-star",[RootApp(CallNoArgs(SVar("rec")))])),NoAnnoList(List([RootApp(Id)])))),Choice(LRule(RuleNoCond(NoAnnoList(Op("iter-sep",[RootApp(CallNoArgs(SVar("rec"))),Wld])),NoAnnoList(List([RootApp(Id)])))),Choice(LRule(RuleNoCond(NoAnnoList(Op("iter-star-sep",[RootApp(CallNoArgs(SVar("rec"))),Wld])),NoAnnoList(List([RootApp(Id)])))),Choice(LRule(RuleNoCond(NoAnnoList(Op("opt",[RootApp(CallNoArgs(SVar("rec")))])),NoAnnoList(Op("Some",[RootApp(Id)])))),Choice(LRule(RuleNoCond(NoAnnoList(Op("lit",[Wld])),Var("constant"))),LRule(RuleNoCond(NoAnnoList(Op("cilit",[Wld])),Var("constant")))))))))))))]),Rules([RDef("ReplConsSome",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[Var("p"),NoAnnoList(List([Var("t")]))])),NoAnnoList(Op("Some",[App(CallNoArgs(SVar("impl")),Var("t"))])),BA(CallNoArgs(SVar("is-some")),Var("p")))),RDef("ReplConsConc",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[Var("p"),NoAnnoList(List([Var("t1"),Var("t2")]))])),Var("t"),Seq(BA(CallNoArgs(SVar("is-conc")),Var("p")),Seq(AM(BA(CallNoArgs(SVar("impl")),Var("t1")),Var("ts1")),Seq(AM(BA(CallNoArgs(SVar("impl")),Var("t2")),Var("ts2")),AM(LChoice(Seq(BA(Choice(ListCongNoTail([]),ListCong([Id],Id)),Var("ts2")),BA(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("ts1"),Var("ts2")])))),Build(NoAnnoList(Explode(NoAnnoList(Str("\"Conc\"")),NoAnnoList(List([Var("ts1"),Var("ts2")])))))),Var("t"))))))),RDef("ReplConsConc",[DefaultVarDec("impl")],Rule(NoAnnoList(Op("appl",[Var("p"),NoAnnoList(List([Var("t1"),Var("t2"),Var("t3")]))])),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([App(CallNoArgs(SVar("impl")),Var("t1")),NoAnnoList(ListTail([App(CallNoArgs(SVar("impl")),Var("t2"))],App(CallNoArgs(SVar("impl")),Var("t3"))))]))),BA(CallNoArgs(SVar("is-conc")),Var("p"))))]),Strategies([SDefNoArgs("is-nil",Match(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])))),SDefNoArgs("is-nil",Match(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star",[Wld]))])),Wld])))),SDefNoArgs("is-nil",Match(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("iter-star-sep",[Wld,Wld])),Wld])))),SDefNoArgs("is-nil",Match(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("iter-star",[Wld])),Wld])))),SDefNoArgs("is-ins",Match(NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[Var("x")]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Var("x"),Wld]))])),Wld])))),SDefNoArgs("is-ins",Match(NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[Var("x")]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Var("x")]))])),Wld])))),SDefNoArgs("is-ins",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Var("x")])),NoAnnoList(Op("iter-sep",[Var("x"),Wld])),Wld])))),SDefNoArgs("is-ins",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Var("x")])),NoAnnoList(Op("iter",[Var("x")])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld])),NoAnnoList(Op("iter",[Wld])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star",[Wld]))])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("iter-star",[Wld])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("iter-sep",[Wld,Wld])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])))),SDefNoArgs("is-conc",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])))),SDefNoArgs("is-none",Match(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[Wld]))])),Wld])))),SDefNoArgs("is-none",Match(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("opt",[Wld])),Wld])))),SDefNoArgs("is-some",Match(NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[Var("x")]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[Var("x")]))])),Wld])))),SDefNoArgs("is-some",Match(NoAnnoList(Op("prod",[NoAnnoList(List([Var("x")])),NoAnnoList(Op("opt",[Var("x")])),Wld]))))]),Strategies([SDefNoArgs("Cns",LChoice(CallNoArgs(SVar("CnsNil")),CallNoArgs(SVar("CnsGeneric"))))]),Rules([RDefNoArgs("CnsNil",Rule(NoAnnoList(Op("appl",[Var("p"),Var("ts")])),NoAnnoList(List([])),AM(BA(CallNoArgs(SVar("ConstrNil")),Var("p")),Var("c")))),RDefNoArgs("ConstrNil",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])),NoAnnoList(Str("\"Nil\"")))),RDefNoArgs("ConstrNil",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star",[Wld]))])),Wld])),NoAnnoList(Str("\"Nil\"")))),RDefNoArgs("ConstrNil",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("iter-star-sep",[Wld,Wld])),Wld])),NoAnnoList(Str("\"Nil\"")))),RDefNoArgs("ConstrNil",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("iter-star",[Wld])),Wld])),NoAnnoList(Str("\"Nil\"")))),RDefNoArgs("CnsGeneric",Rule(NoAnnoList(Op("appl",[Var("p"),Var("ts")])),NoAnnoList(Explode(Var("c"),Var("ts"))),AM(BA(LChoice(CallNoArgs(SVar("Constr0")),CallNoArgs(SVar("Constr1"))),Var("p")),Var("c")))),RDefNoArgs("Constr0",Rule(NoAnnoList(Op("prod",[Wld,Wld,Var("as")])),Var("x"),BA(Call(SVar("oncetd"),[Match(NoAnnoList(Op("cons",[Var("x")])))]),Var("as")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[Var("x")]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Var("x"),Wld]))])),Wld])),NoAnnoList(Str("\"Ins\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[Var("x")]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Var("x")]))])),Wld])),NoAnnoList(Str("\"Ins\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Var("x")])),NoAnnoList(Op("iter-sep",[Var("x"),Wld])),Wld])),NoAnnoList(Str("\"Ins\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Var("x")])),NoAnnoList(Op("iter",[Var("x")])),Wld])),NoAnnoList(Str("\"Ins\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Wld,Wld]))])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter",[Wld]))])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("iter-sep",[Wld,Wld])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld])),NoAnnoList(Op("iter",[Wld])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Wld,Wld,Wld])),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-star-sep",[Wld,Wld]))])),Wld])),NoAnnoList(Str("\"Conc\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[Wld]))])),Wld])),NoAnnoList(Str("\"None\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([])),NoAnnoList(Op("opt",[Wld])),Wld])),NoAnnoList(Str("\"None\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([NoAnnoList(Op("cf",[Var("x")]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[Var("x")]))])),Wld])),NoAnnoList(Str("\"Some\"")))),RDefNoArgs("Constr1",RuleNoCond(NoAnnoList(Op("prod",[NoAnnoList(List([Var("x")])),NoAnnoList(Op("opt",[Var("x")])),Wld])),NoAnnoList(Str("\"Some\"")))),RDefNoArgs("Constr23",Rule(NoAnnoList(Op("prod",[Var("args"),NoAnnoList(Op("cf",[NoAnnoList(Op("iter-sep",[Var("x"),Var("y")]))])),Wld])),Var("c"),AM(BA(LChoice(Seq(Match(NoAnnoList(List([NoAnnoList(Op("cf",[Var("x")]))]))),Build(NoAnnoList(Str("\"Ins\"")))),Seq(Match(NoAnnoList(List([Wld,Wld,Wld,Wld,Wld]))),Build(NoAnnoList(Str("\"Conc\""))))),Var("args")),Var("c"))))])])
