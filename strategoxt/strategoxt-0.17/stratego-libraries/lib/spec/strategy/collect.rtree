Module("strategy/collect",[Imports([Import("collection/list/common"),Import("term/common")]),Strategies([SDef("collect-all",[DefaultVarDec("s")],Call(SVar("collect-all"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("union"))])),SDef("collect-all",[DefaultVarDec("s"),DefaultVarDec("un")],Rec("x",LChoice(Build(NoAnnoList(ListTail([RootApp(CallNoArgs(SVar("s")))],RootApp(Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("x"))]))))),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("x"))])))),SDef("collect-all",[DefaultVarDec("s"),DefaultVarDec("un"),DefaultVarDec("reduce")],Rec("x",LChoice(Build(NoAnnoList(ListTail([RootApp(CallNoArgs(SVar("s")))],RootApp(Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("x"))]))))),LChoice(Seq(CallNoArgs(SVar("reduce")),CallNoArgs(SVar("x"))),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("x"))])))))]),Strategies([SDef("collect-om",[DefaultVarDec("s")],Call(SVar("collect-om"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("union"))])),SDef("collect",[DefaultVarDec("s")],Call(SVar("collect-om"),[CallNoArgs(SVar("s"))])),SDef("collect-om",[DefaultVarDec("s"),DefaultVarDec("op")],LChoice(Build(NoAnnoList(List([RootApp(CallNoArgs(SVar("s")))]))),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("op")),Call(SVar("collect-om"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("op"))])]))),SDef("collect-om",[DefaultVarDec("s"),DefaultVarDec("un"),DefaultVarDec("skip")],Rec("x",LChoice(Build(NoAnnoList(List([RootApp(CallNoArgs(SVar("s")))]))),LChoice(Seq(CallNoArgs(SVar("skip")),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("x"))])),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("x"))])))))]),Strategies([SDef("collect-split",[DefaultVarDec("f"),DefaultVarDec("g")],Rec("x",Call(SVar("CollectSplit"),[CallNoArgs(SVar("x")),Build(NoAnnoList(Tuple([RootApp(Call(SVar("try"),[CallNoArgs(SVar("f"))])),RootApp(LChoice(CallNoArgs(SVar("g")),Build(NoAnnoList(List([])))))])))]))),SDef("collect-split",[DefaultVarDec("splitter")],Rec("x",Call(SVar("CollectSplit"),[CallNoArgs(SVar("x")),LChoice(CallNoArgs(SVar("splitter")),Build(NoAnnoList(Tuple([RootApp(Id),NoAnnoList(List([]))]))))]))),RDef("CollectSplit",[DefaultVarDec("s"),DefaultVarDec("splitter")],Rule(AnnoList(Explode(Var("c"),Var("as")),[Var(ListVar("annos*"))]),NoAnnoList(Tuple([Var("t"),App(CallNoArgs(SVar("union")),NoAnnoList(Tuple([Var("ys"),App(CallNoArgs(SVar("unions")),Var("xs"))])))])),Seq(AM(BA(Call(SVar("unzip"),[CallNoArgs(SVar("s"))]),Var("as")),NoAnnoList(Tuple([Var("bs"),Var("xs")]))),AM(BA(CallNoArgs(SVar("splitter")),AnnoList(Explode(Var("c"),Var("bs")),[Var(ListVar("annos*"))])),NoAnnoList(Tuple([Var("t"),Var("ys")])))))),SDef("CollectSplit",[DefaultVarDec("s"),DefaultVarDec("f"),DefaultVarDec("g")],Call(SVar("CollectSplit"),[CallNoArgs(SVar("s")),Build(NoAnnoList(Tuple([RootApp(Call(SVar("try"),[CallNoArgs(SVar("f"))])),RootApp(LChoice(CallNoArgs(SVar("g")),Build(NoAnnoList(List([])))))])))])),SDef("collect-split'",[DefaultVarDec("splitter")],Rec("x",LChoice(Seq(Choice(CallNoArgs(SVar("is-string")),CallNoArgs(SVar("is-int"))),CallNoArgs(SVar("splitter"))),Call(SVar("CollectSplit"),[CallNoArgs(SVar("x")),CallNoArgs(SVar("splitter"))]))))]),Strategies([SDef("postorder-collect",[DefaultVarDec("s")],Call(SVar("postorder-collect"),[CallNoArgs(SVar("s")),Build(NoAnnoList(List([])))])),SDef("postorder-collect",[DefaultVarDec("s"),DefaultVarDec("acc")],Seq(Where(AM(LChoice(Build(NoAnnoList(ListTail([RootApp(CallNoArgs(SVar("s")))],RootApp(CallNoArgs(SVar("acc")))))),CallNoArgs(SVar("acc"))),Var("ys"))),Call(SVar("crush"),[Build(Var("ys")),LRule(RuleNoCond(NoAnnoList(Tuple([Var("x"),Var("xs")])),App(Call(SVar("postorder-collect"),[CallNoArgs(SVar("s")),Build(Var("xs"))]),Var("x"))))])))]),Strategies([SDef("collect",[DefaultVarDec("s"),VarDec("skip",FunType([FunType([ConstType(SortVar("a"))],ConstType(SortVar("a"))),FunType([ConstType(SortVar("a"))],ConstType(SortVar("a"))),ConstType(SortVar("a"))],ConstType(SortVar("a"))))],LChoice(Build(NoAnnoList(List([RootApp(CallNoArgs(SVar("s")))]))),LChoice(Seq(Call(SVar("skip"),[Call(SVar("collect"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("skip"))]),Build(NoAnnoList(List([])))]),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("union")),Id])),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("union")),Call(SVar("collect"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("skip"))])])))),SDef("collect-exc",[DefaultVarDec("base"),VarDec("special",FunType([FunType([ConstType(SortVar("a"))],ConstType(SortVar("b"))),ConstType(SortVar("a"))],ConstType(SortVar("b"))))],Rec("coll",LChoice(LChoice(CallNoArgs(SVar("base")),Call(SVar("special"),[CallNoArgs(SVar("coll"))])),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("union")),CallNoArgs(SVar("coll"))])))),SDef("bu-collect",[DefaultVarDec("s")],LChoice(Rec("x",LChoice(Seq(Some(CallNoArgs(SVar("x"))),Call(SVar("crush"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("union")),LChoice(ListCong([CallNoArgs(SVar("s"))],Id),Build(NoAnnoList(List([]))))])),Build(NoAnnoList(List([RootApp(CallNoArgs(SVar("s")))]))))),Build(NoAnnoList(List([])))))]),Strategies([SDef("collect-one",[DefaultVarDec("s")],Seq(Call(SVar("oncetd"),[Seq(CallNoArgs(SVar("s")),Match(Var("t")))]),Build(Var("t"))))]),Strategies([SDef("twicetd",[DefaultVarDec("s")],Call(SVar("oncetd"),[Seq(CallNoArgs(SVar("explode-term")),Seq(TupleCong(Id,[Call(SVar("at-suffix"),[Call(SVar("Cons"),[Call(SVar("oncetd"),[CallNoArgs(SVar("s"))]),Call(SVar("oncetd"),[CallNoArgs(SVar("s"))])])])]),CallNoArgs(SVar("mkterm"))))])),SDef("atmostonce",[DefaultVarDec("s")],Not(Call(SVar("twicetd"),[CallNoArgs(SVar("s"))])))])])
