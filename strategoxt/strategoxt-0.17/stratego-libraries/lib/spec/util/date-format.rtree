Module("util/date-format",[Imports([Import("util/time"),Import("term/string"),Import("term/integer"),Import("collection/list/common")]),Strategies([RDefNoArgs("date-format",RuleNoCond(NoAnnoList(Tuple([Var("ps"),Var("t")])),App(Seq(Call(SVar("map"),[BA(LChoice(CallNoArgs(SVar("date-pattern-to-string")),CallNoArgs(SVar("Fst"))),NoAnnoList(Tuple([RootApp(Id),Var("t")])))]),CallNoArgs(SVar("concat-strings"))),Var("ps"))))]),Strategies([SDefNoArgs("date-pattern-to-string",Seq(Match(NoAnnoList(Tuple([Var("p"),Wld]))),Seq(CallNoArgs(SVar("date-pattern-to-int")),BA(CallNoArgs(SVar("align-right")),NoAnnoList(Tuple([NoAnnoList(Char("'0'")),RootApp(CallNoArgs(SVar("int-to-string"))),App(CallNoArgs(SVar("string-length")),Var("p"))]))))))]),Rules([RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"yyyy\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Var("y"),Wld,Wld])),Wld,Wld]))])),Var("y"))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"yy\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Var("y"),Wld,Wld])),Wld,Wld]))])),App(BA(CallNoArgs(SVar("mod")),NoAnnoList(Tuple([RootApp(Id),NoAnnoList(Int("100"))]))),Var("y")))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"M\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Wld,Var("m"),Wld])),Wld,Wld]))])),App(Seq(CallNoArgs(SVar("month2index")),CallNoArgs(SVar("inc"))),Var("m")))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"MM\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Wld,Var("m"),Wld])),Wld,Wld]))])),App(Seq(CallNoArgs(SVar("month2index")),CallNoArgs(SVar("inc"))),Var("m")))),RDefNoArgs("date-pattern-to-string",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"MMM\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Wld,Var("m"),Wld])),Wld,Wld]))])),App(CallNoArgs(SVar("month2abbr")),Var("m")))),RDefNoArgs("date-pattern-to-string",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"MMMM\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Wld,Var("m"),Wld])),Wld,Wld]))])),App(CallNoArgs(SVar("month2text")),Var("m")))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"d\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Wld,Wld,Var("d")])),Wld,Wld]))])),Var("d"))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"dd\"")),NoAnnoList(Op("ComponentTime",[NoAnnoList(Op("Date",[Wld,Wld,Var("d")])),Wld,Wld]))])),Var("d"))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"D\"")),NoAnnoList(Op("ComponentTime",[Wld,Wld,NoAnnoList(Op("Dupl",[Wld,Var("dy")]))]))])),Var("dy"))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"DD\"")),NoAnnoList(Op("ComponentTime",[Wld,Wld,NoAnnoList(Op("Dupl",[Wld,Var("dy")]))]))])),Var("dy"))),RDefNoArgs("date-pattern-to-string",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"EEE\"")),NoAnnoList(Op("ComponentTime",[Wld,Wld,NoAnnoList(Op("Dupl",[Var("dw"),Wld]))]))])),App(CallNoArgs(SVar("day-of-week2abbr")),Var("dw")))),RDefNoArgs("date-pattern-to-string",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"EEEE\"")),NoAnnoList(Op("ComponentTime",[Wld,Wld,NoAnnoList(Op("Dupl",[Var("dw"),Wld]))]))])),App(CallNoArgs(SVar("day-of-week2text")),Var("dw")))),RDefNoArgs("date-pattern-to-string",Rule(NoAnnoList(Tuple([NoAnnoList(Str("\"a\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),NoAnnoList(Str("\"a.m.\"")),BA(CallNoArgs(SVar("leq-lt")),NoAnnoList(Tuple([NoAnnoList(Int("0")),Var("h"),NoAnnoList(Int("12"))]))))),RDefNoArgs("date-pattern-to-string",Rule(NoAnnoList(Tuple([NoAnnoList(Str("\"a\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),NoAnnoList(Str("\"p.m.\"")),BA(CallNoArgs(SVar("leq-leq")),NoAnnoList(Tuple([NoAnnoList(Int("12")),Var("h"),NoAnnoList(Int("23"))]))))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"HH\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),Var("h"))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"kk\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),App(CallNoArgs(SVar("inc")),Var("h")))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"hh\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[NoAnnoList(Int("0")),Wld,Wld])),Wld]))])),NoAnnoList(Int("12")))),RDefNoArgs("date-pattern-to-int",Rule(NoAnnoList(Tuple([NoAnnoList(Str("\"hh\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),Var("h"),BA(CallNoArgs(SVar("leq-leq")),NoAnnoList(Tuple([NoAnnoList(Int("1")),Var("h"),NoAnnoList(Int("12"))]))))),RDefNoArgs("date-pattern-to-int",Rule(NoAnnoList(Tuple([NoAnnoList(Str("\"hh\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),App(CallNoArgs(SVar("subt")),NoAnnoList(Tuple([Var("h"),NoAnnoList(Int("12"))]))),BA(CallNoArgs(SVar("leq-leq")),NoAnnoList(Tuple([NoAnnoList(Int("12")),Var("h"),NoAnnoList(Int("23"))]))))),RDefNoArgs("date-pattern-to-int",Rule(NoAnnoList(Tuple([NoAnnoList(Str("\"KK\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),Var("h"),BA(CallNoArgs(SVar("leq-lt")),NoAnnoList(Tuple([NoAnnoList(Int("0")),Var("h"),NoAnnoList(Int("12"))]))))),RDefNoArgs("date-pattern-to-int",Rule(NoAnnoList(Tuple([NoAnnoList(Str("\"KK\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Var("h"),Wld,Wld])),Wld]))])),App(CallNoArgs(SVar("subt")),NoAnnoList(Tuple([Var("h"),NoAnnoList(Int("12"))]))),BA(CallNoArgs(SVar("leq-leq")),NoAnnoList(Tuple([NoAnnoList(Int("12")),Var("h"),NoAnnoList(Int("23"))]))))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"mm\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Wld,Var("m"),Wld])),Wld]))])),Var("m"))),RDefNoArgs("date-pattern-to-int",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"ss\"")),NoAnnoList(Op("ComponentTime",[Wld,NoAnnoList(Op("DayTime",[Wld,Wld,Var("s")])),Wld]))])),Var("s")))]),Rules([RDefNoArgs("day-of-week2abbr",RuleNoCond(NoAnnoList(Op("Sunday",[])),NoAnnoList(Str("\"Sun\"")))),RDefNoArgs("day-of-week2abbr",RuleNoCond(NoAnnoList(Op("Monday",[])),NoAnnoList(Str("\"Mon\"")))),RDefNoArgs("day-of-week2abbr",RuleNoCond(NoAnnoList(Op("Tuesday",[])),NoAnnoList(Str("\"Tue\"")))),RDefNoArgs("day-of-week2abbr",RuleNoCond(NoAnnoList(Op("Wednesday",[])),NoAnnoList(Str("\"Wed\"")))),RDefNoArgs("day-of-week2abbr",RuleNoCond(NoAnnoList(Op("Thursday",[])),NoAnnoList(Str("\"Thu\"")))),RDefNoArgs("day-of-week2abbr",RuleNoCond(NoAnnoList(Op("Friday",[])),NoAnnoList(Str("\"Fri\"")))),RDefNoArgs("day-of-week2abbr",RuleNoCond(NoAnnoList(Op("Saturday",[])),NoAnnoList(Str("\"Sat\""))))]),Rules([RDefNoArgs("day-of-week2text",RuleNoCond(NoAnnoList(Op("Sunday",[])),NoAnnoList(Str("\"Sunday\"")))),RDefNoArgs("day-of-week2text",RuleNoCond(NoAnnoList(Op("Monday",[])),NoAnnoList(Str("\"Monday\"")))),RDefNoArgs("day-of-week2text",RuleNoCond(NoAnnoList(Op("Tuesday",[])),NoAnnoList(Str("\"Tuesday\"")))),RDefNoArgs("day-of-week2text",RuleNoCond(NoAnnoList(Op("Wednesday",[])),NoAnnoList(Str("\"Wednesday\"")))),RDefNoArgs("day-of-week2text",RuleNoCond(NoAnnoList(Op("Thursday",[])),NoAnnoList(Str("\"Thursday\"")))),RDefNoArgs("day-of-week2text",RuleNoCond(NoAnnoList(Op("Friday",[])),NoAnnoList(Str("\"Friday\"")))),RDefNoArgs("day-of-week2text",RuleNoCond(NoAnnoList(Op("Saturday",[])),NoAnnoList(Str("\"Saturday\""))))]),Rules([RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("January",[])),NoAnnoList(Str("\"Jan\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("February",[])),NoAnnoList(Str("\"Feb\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("March",[])),NoAnnoList(Str("\"Mar\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("April",[])),NoAnnoList(Str("\"Apr\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("May",[])),NoAnnoList(Str("\"May\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("June",[])),NoAnnoList(Str("\"Jun\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("July",[])),NoAnnoList(Str("\"Jul\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("August",[])),NoAnnoList(Str("\"Aug\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("September",[])),NoAnnoList(Str("\"Sep\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("October",[])),NoAnnoList(Str("\"Oct\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("November",[])),NoAnnoList(Str("\"Nov\"")))),RDefNoArgs("month2abbr",RuleNoCond(NoAnnoList(Op("December",[])),NoAnnoList(Str("\"Dec\""))))]),Rules([RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("January",[])),NoAnnoList(Str("\"January\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("February",[])),NoAnnoList(Str("\"February\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("March",[])),NoAnnoList(Str("\"March\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("April",[])),NoAnnoList(Str("\"April\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("May",[])),NoAnnoList(Str("\"May\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("June",[])),NoAnnoList(Str("\"June\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("July",[])),NoAnnoList(Str("\"July\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("August",[])),NoAnnoList(Str("\"August\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("September",[])),NoAnnoList(Str("\"September\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("October",[])),NoAnnoList(Str("\"October\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("November",[])),NoAnnoList(Str("\"November\"")))),RDefNoArgs("month2text",RuleNoCond(NoAnnoList(Op("December",[])),NoAnnoList(Str("\"December\""))))])])
