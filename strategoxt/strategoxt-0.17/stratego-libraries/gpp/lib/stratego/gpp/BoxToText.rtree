Module("stratego/gpp/BoxToText",[Imports([Import("Box"),Import("libstratego-lib"),Import("stratego/gpp/Util")]),Strategies([SDefT("try-abox2text",[],[DefaultVarDec("pos"),DefaultVarDec("width")],Seq(Let([SDefT("local-abox2text",[],[DefaultVarDec("pos")],LChoice(CallT(SVar("abox2text"),[CallNoArgs(SVar("local-abox2text"))],[Var("pos"),Var("width")]),Seq(CallT(SVar("log"),[],[NoAnnoList(Op("Error",[])),NoAnnoList(Str("\"invalid box: \"")),RootApp(Id)]),BA(CallNoArgs(SVar("exit")),NoAnnoList(Int("1"))))))],CallT(SVar("local-abox2text"),[],[NoAnnoList(Int("0"))])),CallNoArgs(SVar("Fst")))),SDefT("abox2text",[],[DefaultVarDec("width")],Seq(Let([SDefT("local-abox2text",[],[DefaultVarDec("pos")],CallT(SVar("abox2text"),[CallNoArgs(SVar("local-abox2text"))],[Var("pos"),Var("width")]))],CallT(SVar("local-abox2text"),[],[NoAnnoList(Int("0"))])),CallNoArgs(SVar("Fst"))))]),Strategies([SDefT("abox2text",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],Choice(CallT(SVar("abox2text-HV"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-HV"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-H"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-V"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-A"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-R"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-S"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-C"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-FBOX"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-R"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),Choice(CallT(SVar("abox2text-ALT"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")]),CallT(SVar("abox2text-list"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("width")])))))))))))))]),Strategies([SDefT("abox2text-HV",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],Seq(Match(NoAnnoList(Op("HV",[Var("sopt"),Var("bs")]))),Seq(AM(BA(CallNoArgs(SVar("gpp-hs-chars")),Var("sopt")),Var("hs-chars")),Seq(AM(BA(CallNoArgs(SVar("implode-string")),Var("hs-chars")),Var("hs")),Seq(AM(BA(CallNoArgs(SVar("gpp-vs-text")),Var("sopt")),Var("vs")),Seq(AM(BA(CallNoArgs(SVar("length")),Var("hs-chars")),Var("hsl")),Seq(AM(BA(CallNoArgs(SVar("add")),NoAnnoList(Tuple([Var("xpos"),App(CallNoArgs(SVar("gpp-is-length")),Var("sopt"))]))),Var("left-xpos")),Seq(Build(NoAnnoList(Tuple([Var("bs"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(List([])),Var("xpos")]))]))]))),Seq(Call(SVar("foldl"),[LChoice(CallT(SVar("gpp-hv-add-to-hbox"),[CallNoArgs(SVar("rec"))],[Var("hsl"),Var("width")]),CallT(SVar("gpp-hv-in-new-vbox"),[CallNoArgs(SVar("rec"))],[Var("hsl"),Var("left-xpos"),Var("width")]))]),Seq(CallNoArgs(SVar("reverse")),Seq(Call(SVar("map"),[TupleCong(CallNoArgs(SVar("reverse")),[Id])]),Seq(Call(SVar("map"),[TupleCong(BA(CallNoArgs(SVar("separate-by")),NoAnnoList(Tuple([Var("hs"),RootApp(Id)]))),[Id])]),CallT(SVar("gpp-format-vbox"),[],[Var("sopt"),Var("xpos")]))))))))))))),RDefT("gpp-hv-add-to-hbox",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("hsl"),DefaultVarDec("width")],Rule(NoAnnoList(Tuple([Var("box"),NoAnnoList(ListTail([NoAnnoList(Tuple([Var("strs"),Var("xpos")]))],Var("vbs")))])),NoAnnoList(ListTail([NoAnnoList(Tuple([NoAnnoList(ListTail([Var("str")],Var("strs"))),App(CallNoArgs(SVar("add")),NoAnnoList(Tuple([Var("new-xpos"),Var("hsl")])))]))],Var("vbs"))),Seq(AM(BA(CallT(SVar("rec"),[],[Var("xpos")]),Var("box")),NoAnnoList(Tuple([Var("str"),Var("new-xpos")]))),Choice(BA(CallNoArgs(SVar("leq")),NoAnnoList(Tuple([Var("new-xpos"),Var("width")]))),AM(Build(Var("width")),NoAnnoList(Int("0"))))))),RDefT("gpp-hv-in-new-vbox",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("hsl"),DefaultVarDec("left-xpos"),DefaultVarDec("width")],Rule(NoAnnoList(Tuple([Var("box"),Var("vbs")])),NoAnnoList(ListTail([NoAnnoList(Tuple([NoAnnoList(List([Var("str")])),App(CallNoArgs(SVar("add")),NoAnnoList(Tuple([Var("new-xpos"),Var("hsl")])))]))],Var("vbs"))),AM(BA(CallT(SVar("rec"),[],[Var("left-xpos")]),Var("box")),NoAnnoList(Tuple([Var("str"),Var("new-xpos")])))))]),Strategies([SDefT("abox2text-H",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],Seq(Match(NoAnnoList(Op("H",[Var("sopt"),Var("bs")]))),Seq(AM(BA(CallNoArgs(SVar("gpp-hs-chars")),Var("sopt")),Var("hschars")),Seq(AM(BA(CallNoArgs(SVar("implode-string")),Var("hschars")),Var("hs")),Seq(AM(BA(CallNoArgs(SVar("length")),Var("hschars")),Var("hsl")),Seq(BA(Call(SVar("filter"),[CallNoArgs(SVar("gpp-is-real-hbox"))]),Var("bs")),Let([SDefT("rec-add",[],[DefaultVarDec("pos")],Seq(CallT(SVar("rec"),[],[Var("pos")]),TupleCong(Id,[BA(CallNoArgs(SVar("add")),NoAnnoList(Tuple([Var("hsl"),RootApp(Id)])))])))],Seq(CallT(SVar("gpp-thread-map"),[CallNoArgs(SVar("rec-add"))],[Var("xpos")]),Seq(TupleCong(CallT(SVar("separate-by"),[],[Var("hs")]),[Id]),Call(SVar("try"),[TupleCong(Not(ListCongNoTail([])),[BA(CallNoArgs(SVar("subt")),NoAnnoList(Tuple([RootApp(Id),Var("hsl")])))])])))))))))),RDefT("gpp-thread-map",[VarDec("s",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("t")],RuleNoCond(NoAnnoList(List([])),NoAnnoList(Tuple([NoAnnoList(List([])),Var("t")])))),RDefT("gpp-thread-map",[VarDec("s",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("t")],Rule(NoAnnoList(ListTail([Var("x")],Var("xs"))),NoAnnoList(Tuple([NoAnnoList(ListTail([Var("y")],Var("ys"))),Var("t''")])),Seq(AM(BA(CallT(SVar("s"),[],[Var("t")]),Var("x")),NoAnnoList(Tuple([Var("y"),Var("t'")]))),AM(BA(CallT(SVar("gpp-thread-map"),[CallNoArgs(SVar("s"))],[Var("t'")]),Var("xs")),NoAnnoList(Tuple([Var("ys"),Var("t''")]))))))]),Strategies([SDefT("abox2text-V",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],Seq(Match(NoAnnoList(Op("V",[Var("sopt"),Var("bs")]))),Seq(AM(BA(CallNoArgs(SVar("add")),NoAnnoList(Tuple([Var("xpos"),App(CallNoArgs(SVar("gpp-is-length")),Var("sopt"))]))),Var("left-xpos")),Seq(BA(Call(SVar("filter"),[CallNoArgs(SVar("gpp-is-real-vbox"))]),Var("bs")),CondChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Tuple([NoAnnoList(List([])),Var("xpos")]))),Seq(CallT(SVar("gpp-do-vbox-children"),[CallNoArgs(SVar("rec"))],[Var("xpos"),Var("left-xpos")]),CallT(SVar("gpp-format-vbox"),[],[Var("sopt"),Var("xpos")]))))))),RDefT("gpp-do-vbox-children",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("left-xpos")],RuleNoCond(NoAnnoList(ListTail([Var("b")],Var("bs"))),NoAnnoList(ListTail([App(CallT(SVar("rec"),[],[Var("xpos")]),Var("b"))],App(Call(SVar("map"),[CallT(SVar("rec"),[],[Var("left-xpos")])]),Var("bs"))))))]),Strategies([RDefT("abox2text-A",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(Op("A",[NoAnnoList(Op("AOPTIONS",[Var("aopt")])),Var("sopt"),NoAnnoList(List([]))])),NoAnnoList(Tuple([NoAnnoList(List([])),Var("xpos")])))),RDefT("abox2text-A",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(Op("A",[NoAnnoList(Op("AOPTIONS",[Var("aopt")])),Var("sopt"),NoAnnoList(List([NoAnnoList(List([]))]))])),NoAnnoList(Tuple([NoAnnoList(List([])),Var("xpos")])))),SDefT("abox2text-A",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],Seq(Match(NoAnnoList(Op("A",[NoAnnoList(Op("AOPTIONS",[Var("aopt")])),Var("sopt"),Var("bs")]))),Seq(Build(Var("bs")),Seq(CallNoArgs(SVar("gpp-construct-rows")),Seq(Call(SVar("map"),[Match(NoAnnoList(Op("R",[Wld,RootApp(Id)])))]),Seq(CallT(SVar("gpp-to-matrix"),[],[App(CallNoArgs(SVar("length")),Var("aopt"))]),Seq(CallNoArgs(SVar("matrix-transpose")),Seq(CallNoArgs(SVar("reverse")),Seq(CallNoArgs(SVar("add-indices")),Seq(CallNoArgs(SVar("reverse")),Seq(Match(Var("columns")),Seq(AM(BA(CallNoArgs(SVar("zip")),NoAnnoList(Tuple([Var("aopt"),Var("columns")]))),Var("column-tuples")),Seq(AM(BA(Call(SVar("foldl"),[Call(SVar("gpp-do-A-column"),[CallNoArgs(SVar("rec"))])]),NoAnnoList(Tuple([Var("column-tuples"),NoAnnoList(Tuple([Var("xpos"),NoAnnoList(List([]))]))]))),NoAnnoList(Tuple([Var("last-xpos"),Var("str-columns")]))),Seq(BA(Seq(CallNoArgs(SVar("reverse")),CallNoArgs(SVar("matrix-transpose"))),Var("str-columns")),Seq(Call(SVar("map"),[Build(NoAnnoList(Tuple([RootApp(Id),Var("last-xpos")])))]),CallT(SVar("gpp-format-vbox"),[],[Var("sopt"),Var("xpos")])))))))))))))))),RDef("gpp-do-A-column",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],Rule(NoAnnoList(Tuple([NoAnnoList(Tuple([Var("aopt"),NoAnnoList(Tuple([Var("index"),Var("bs")]))])),NoAnnoList(Tuple([Var("xpos"),Var("columns")]))])),NoAnnoList(Tuple([App(CallNoArgs(SVar("add")),NoAnnoList(Tuple([App(CallNoArgs(SVar("string-length")),Var("hs")),Var("max-xpos")]))),NoAnnoList(ListTail([Var("new-column")],Var("columns")))])),Seq(AM(BA(Seq(Call(SVar("map"),[CallT(SVar("rec"),[],[Var("xpos")])]),Seq(CallNoArgs(SVar("unzip")),TupleCong(Call(SVar("map"),[Call(SVar("try"),[Seq(CallNoArgs(SVar("flatten-list")),CallNoArgs(SVar("concat-strings")))])]),[CallNoArgs(SVar("list-max"))]))),Var("bs")),NoAnnoList(Tuple([Var("strings"),Var("max-xpos")]))),Seq(AM(BA(CallNoArgs(SVar("subt")),NoAnnoList(Tuple([Var("max-xpos"),Var("xpos")]))),Var("max-width")),Seq(AM(GuardedLChoice(BA(CallNoArgs(SVar("gt")),NoAnnoList(Tuple([Var("index"),NoAnnoList(Int("1"))]))),BA(Seq(CallNoArgs(SVar("gpp-SOpts-of-alignment")),CallNoArgs(SVar("gpp-hs-text"))),Var("aopt")),Build(NoAnnoList(Str("\"\"")))),Var("hs")),AM(BA(Call(SVar("map"),[Seq(BA(CallNoArgs(SVar("gpp-align-column")),NoAnnoList(Tuple([Var("index"),Var("aopt"),NoAnnoList(Tuple([NoAnnoList(Char("' '")),RootApp(Id),Var("max-width")]))]))),BA(CallNoArgs(SVar("conc-strings")),NoAnnoList(Tuple([RootApp(Id),Var("hs")]))))]),Var("strings")),Var("new-column"))))))),RDefNoArgs("gpp-align-column",RuleNoCond(NoAnnoList(Tuple([Wld,NoAnnoList(Op("AR",[Wld])),Var("t")])),App(CallNoArgs(SVar("align-right")),Var("t")))),RDefNoArgs("gpp-align-column",RuleNoCond(NoAnnoList(Tuple([Wld,NoAnnoList(Op("AC",[Wld])),Var("t")])),App(CallNoArgs(SVar("align-center")),Var("t")))),RDefNoArgs("gpp-align-column",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Int("1")),NoAnnoList(Op("AL",[Wld])),NoAnnoList(Tuple([Wld,Var("s"),Wld]))])),Var("s"))),RDefNoArgs("gpp-align-column",Rule(NoAnnoList(Tuple([Var("i"),NoAnnoList(Op("AL",[Wld])),Var("t")])),App(CallNoArgs(SVar("align-left")),Var("t")),BA(CallNoArgs(SVar("gt")),NoAnnoList(Tuple([Var("i"),NoAnnoList(Int("1"))]))))),SDefT("gpp-to-matrix",[],[DefaultVarDec("nr-cols")],Call(SVar("map"),[CallT(SVar("gpp-FitToMax"),[],[Var("nr-cols")])])),SDefT("gpp-FitToMax",[],[DefaultVarDec("nr-cols")],Seq(Match(Var("lst")),Seq(Where(AM(CallNoArgs(SVar("length")),Var("my-length"))),Seq(AM(BA(CallNoArgs(SVar("subt")),NoAnnoList(Tuple([Var("nr-cols"),Var("my-length")]))),Var("diff")),LChoice(Seq(BA(CallNoArgs(SVar("gt")),NoAnnoList(Tuple([RootApp(Id),NoAnnoList(Int("0"))]))),Seq(AM(BA(CallNoArgs(SVar("copy")),NoAnnoList(Tuple([Var("diff"),NoAnnoList(List([]))]))),Var("l")),BA(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("lst"),Var("l")]))))),LChoice(Seq(Match(NoAnnoList(Int("0"))),Build(Var("lst"))),Seq(CallT(SVar("log"),[],[NoAnnoList(Op("Error",[])),NoAnnoList(Str("\"Too many columns in row: \"")),Var("lst")]),BA(CallNoArgs(SVar("exit")),NoAnnoList(Int("1")))))))))),RDefT("abox2text-R",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(Op("R",[Var("sopt"),Var("bs")])),App(CallT(SVar("rec"),[],[Var("xpos")]),NoAnnoList(Op("HV",[Var("sopt"),Var("bs")]))))),RDefT("abox2text-S",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(Op("S",[Var("s")])),NoAnnoList(Tuple([Var("s"),App(CallNoArgs(SVar("add")),NoAnnoList(Tuple([Var("xpos"),App(CallT(SVar("gpp-rel-string-length"),[],[Var("xpos")]),Var("s"))])))])))),RDefT("abox2text-C",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(Op("C",[Wld,NoAnnoList(List([NoAnnoList(Op("S",[Var("s")]))]))])),NoAnnoList(Tuple([Var("s"),Var("xpos")])))),RDefT("abox2text-FBOX",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(Op("FBOX",[Wld,Var("b")])),App(CallT(SVar("rec"),[],[Var("xpos")]),Var("b")))),RDefT("abox2text-R",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(Op("R",[Var("sopt"),Var("bs")])),App(CallT(SVar("rec"),[],[Var("xpos")]),NoAnnoList(Op("HV",[Var("sopt"),Var("bs")]))))),SDefT("abox2text-ALT",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],Seq(Match(NoAnnoList(Op("ALT",[Var("a1"),Var("a2")]))),Seq(AM(BA(CallT(SVar("rec"),[],[Var("xpos")]),Var("a1")),As(Var("r1"),NoAnnoList(Tuple([Var("s"),Var("xpos2")])))),CondChoice(BA(CallNoArgs(SVar("leq")),NoAnnoList(Tuple([Var("xpos2"),Var("width")]))),Build(Var("r1")),BA(CallT(SVar("rec"),[],[Var("xpos")]),Var("a2")))))),RDefT("abox2text-list",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(List([Var("b")])),App(CallT(SVar("rec"),[],[Var("xpos")]),Var("b")))),RDefT("abox2text-list",[VarDec("rec",FunType([ConstType(SortVar("t")),ConstType(SortVar("t"))],ConstType(SortVar("t"))))],[DefaultVarDec("xpos"),DefaultVarDec("width")],RuleNoCond(NoAnnoList(List([])),NoAnnoList(Tuple([NoAnnoList(Str("\"\"")),Var("xpos")]))))]),Strategies([SDefNoArgs("gpp-hs-text",Seq(CallNoArgs(SVar("gpp-hs-chars")),CallNoArgs(SVar("implode-string")))),SDefNoArgs("gpp-hs-chars",Seq(CallNoArgs(SVar("gpp-hs-length")),CallT(SVar("gpp-copy"),[],[NoAnnoList(Char("' '"))]))),SDefNoArgs("gpp-vs-text",Seq(CallNoArgs(SVar("gpp-vs-chars")),CallNoArgs(SVar("implode-string")))),SDefNoArgs("gpp-vs-chars",CallT(SVar("gpp-vs-chars"),[],[NoAnnoList(List([]))])),SDefT("gpp-vs-chars",[],[DefaultVarDec("cont")],Seq(CallNoArgs(SVar("gpp-vs-length")),Seq(CallNoArgs(SVar("inc")),CallT(SVar("gpp-copy"),[],[NoAnnoList(Char("'\\n'")),Var("cont")])))),SDefNoArgs("gpp-is-text",Seq(CallNoArgs(SVar("gpp-is-chars")),CallNoArgs(SVar("implode-string")))),SDefNoArgs("gpp-is-chars",CallT(SVar("gpp-is-chars"),[],[NoAnnoList(List([]))])),SDefT("gpp-is-chars",[],[DefaultVarDec("cont")],Seq(CallNoArgs(SVar("gpp-is-length")),CallT(SVar("gpp-copy"),[],[NoAnnoList(Char("' '")),Var("cont")])))]),Strategies([SDefT("gpp-copy",[],[DefaultVarDec("t")],CallT(SVar("gpp-copy"),[],[Var("t"),NoAnnoList(List([]))])),SDefT("gpp-copy",[],[DefaultVarDec("t"),DefaultVarDec("ts")],LChoice(LRule(RuleNoCond(NoAnnoList(Int("0")),Var("ts"))),Seq(Match(Var("n")),Seq(BA(CallNoArgs(SVar("subt")),NoAnnoList(Tuple([Var("n"),NoAnnoList(Int("1"))]))),CallT(SVar("gpp-copy"),[],[Var("t"),NoAnnoList(ListTail([Var("t")],Var("ts")))])))))]),Strategies([SDefNoArgs("gpp-is-real-vbox",Not(Choice(Match(NoAnnoList(List([]))),Choice(Match(NoAnnoList(Explode(Wld,NoAnnoList(List([Wld,NoAnnoList(List([]))]))))),Match(NoAnnoList(Explode(Wld,NoAnnoList(List([Wld,NoAnnoList(List([NoAnnoList(List([]))]))]))))))))),SDefNoArgs("gpp-is-real-hbox",Not(Choice(Match(NoAnnoList(List([]))),Match(NoAnnoList(Op("H",[NoAnnoList(List([])),NoAnnoList(List([]))]))))))]),Strategies([RDefT("gpp-format-vbox",[],[DefaultVarDec("sopt"),DefaultVarDec("xpos")],Rule(Var("strs"),NoAnnoList(Tuple([Var("result"),Var("last-xpos")])),Seq(AM(BA(CallT(SVar("gpp-vertical-sep"),[],[Var("xpos")]),Var("sopt")),Var("sep")),Seq(AM(BA(CallNoArgs(SVar("last")),Var("strs")),NoAnnoList(Tuple([Wld,Var("last-xpos")]))),Seq(Build(Var("strs")),Seq(Choice(ListCongNoTail([]),ListCong([CallNoArgs(SVar("Fst"))],Rec("x",Choice(ListCongNoTail([]),Seq(ListCong([CallNoArgs(SVar("Fst"))],CallNoArgs(SVar("x"))),Build(NoAnnoList(ListTail([Var("sep")],RootApp(Id))))))))),Match(Var("result")))))))),SDefT("gpp-vertical-sep",[],[DefaultVarDec("xpos")],Seq(Match(Var("sopt")),Seq(BA(CallT(SVar("gpp-vs-chars"),[],[App(CallT(SVar("gpp-is-chars"),[],[App(CallT(SVar("gpp-copy"),[],[NoAnnoList(Char("' '"))]),Var("xpos"))]),Var("sopt"))]),Var("sopt")),CallNoArgs(SVar("implode-string")))))])])
